"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[5660],{70815:function(e,t,n){n.d(t,{r:function(){return h}});var o=n(1413),r=n(29439),a=n(45987),i=n(55291),d=n(86345),s=n(47313),l=n(40169),c=n(46417),u=["onChange","checked","recordId","allowChange"],h=function(e){var t=e.onChange,n=e.checked,h=e.recordId,g=e.allowChange,f=void 0===g||g,p=(0,a.Z)(e,u),Z=(0,s.useState)({loading:!1,checked:!1}),m=(0,r.Z)(Z,2),x=m[0],j=m[1];return(0,s.useEffect)((function(){j((0,o.Z)((0,o.Z)({},x),{},{checked:n}))}),[n]),(0,c.jsx)(d.Z,{checked:x.checked,onChange:function(e){!0===f?(j((0,o.Z)((0,o.Z)({},x),{},{loading:!0})),t(e,h,p).then((function(t){j((0,o.Z)((0,o.Z)({},x),{},{checked:e,loading:!1})),i.ZP.success(t.data.message)})).catch((function(e){j((0,o.Z)((0,o.Z)({},x),{},{loading:!1}));var t=(0,l.P)(e);"string"===typeof t.message?i.ZP.error(t.message):i.ZP.error("Something went wrong")}))):i.ZP.error("You don't have permission to change this record, please contact your admin.")},loading:x.loading})}},95660:function(e,t,n){n.r(t),n.d(t,{default:function(){return E}});var o=n(1413),r=n(29439),a=n(47313),i=n(7532),d=n(25019),s=n(55291),l=n(86345),c=n(82626),u=n(17327),h=n(49355),g=n(3798),f=n(46646),p=n(40169),Z=n(73257),m=n(46417),x=function(e){var t=e.openModal,n=e.onCancel,i=e.type,x=e.record,j=e.reloadTableData,C=e.permissions,P=C.createProjectState,b=C.updateProjectState,v=d.Z.useForm(),k=(0,r.Z)(v,1)[0],S=new Z.x,y=(0,a.useState)(),w=(0,r.Z)(y,2),I=w[0],T=w[1],L=function(e){var t=(0,p.P)(e);if("string"==typeof t.message)T((0,o.Z)((0,o.Z)({},I),{},{error:t.message}));else{var n=(0,f.O)(t.message,[]);k.setFields(n),T((0,o.Z)((0,o.Z)({},I),{},{error:""}))}},E=(0,a.useCallback)((function(){T((0,o.Z)((0,o.Z)({},I),{},{loading:!0})),S.getRecordById(x).then((function(e){e.data&&e.data.data&&k.setFieldsValue((0,o.Z)((0,o.Z)({translations:e.data.data.localization},e.data.data),{},{isPublished:e.data.data.isPublished,shouldCloseProject:e.data.data.shouldCloseProject,status:e.data.data.status,bgColor:e.data.data.bgColor,textColor:e.data.data.textColor}))})).catch((function(e){L(e)})).finally((function(){T((0,o.Z)((0,o.Z)({},I),{},{loading:!1}))}))}),[k,x]);(0,a.useEffect)((function(){"edit"===i?E():k.resetFields()}),[i]);var R=function(e){var t=e.target,n=(0,g.V3)(t.value);k.setFieldsValue({slug:n})};return(0,m.jsx)(c.P0,{visible:t,closable:!0,onCancel:n,titleText:"edit"===i?"Edit Project State":"Add New Project State",showFooter:!1,children:null!==I&&void 0!==I&&I.loading?(0,m.jsx)(h.Z,{items:10}):(0,m.jsxs)(d.Z,{className:u.Z.form,onFinish:function(e){switch(console.log(e),T((0,o.Z)((0,o.Z)({},I),{},{buttonLoading:!0})),i){case"edit":!0===b?S.updateRecord(e,x).then((function(e){j(),n(),T((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){L(e),T((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})):(T((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})})),s.ZP.error("You don't have permission to update this record"));break;case"new":!0===P?S.createRecord(e).then((function(e){j(),n(),T((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){L(e),T((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})):(T((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})})),s.ZP.error("You don't have permission to create this record"))}},form:k,children:[(null===I||void 0===I?void 0:I.error)&&(0,m.jsx)(c.EQ,{description:null===I||void 0===I?void 0:I.error,isClosable:!0,onClose:function(){T((0,o.Z)((0,o.Z)({},I),{},{error:""}))}}),(0,m.jsx)("div",{children:(0,m.jsx)(d.Z.Item,{name:"title",rules:[{required:!0,message:"Please add a title"}],children:(0,m.jsx)(c.t7,{onChange:R,size:"w100",label:"Title",asterisk:!0,type:"text",placeHolder:"Enter project state"})})}),(0,m.jsxs)("div",{children:[(0,m.jsx)(d.Z.Item,{name:"slug",rules:[{required:!0,message:"Please add a slug"}],children:(0,m.jsx)(c.t7,{onChange:R,size:"w100",label:"Slug",asterisk:!0,type:"text"})}),(0,m.jsx)(d.Z.Item,{name:"order",rules:[{required:!0,message:"Please add order"}],children:(0,m.jsx)(c.t7,{size:"w100",label:"Order",asterisk:!0,type:"number"})})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)(d.Z.Item,{name:"bgColor",rules:[{required:!0,message:"Please add a background color"}],children:(0,m.jsx)(c.t7,{label:"Background Color",asterisk:!0,type:"color",defaultValue:k.getFieldValue("bgColor")})}),(0,m.jsx)(d.Z.Item,{name:"textColor",rules:[{required:!0,message:"Please add a text color"}],children:(0,m.jsx)(c.t7,{label:"Text Color",asterisk:!0,type:"color",defaultValue:k.getFieldValue("textColor")})})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)(d.Z.Item,{name:"status",label:"Status",children:(0,m.jsx)(l.Z,{checkedChildren:"Active",unCheckedChildren:"Inactive",defaultChecked:k.getFieldValue("status")})}),(0,m.jsx)(d.Z.Item,{name:"shouldCloseProject",label:"Should close project",children:(0,m.jsx)(l.Z,{checkedChildren:"Yes",unCheckedChildren:"No",defaultChecked:k.getFieldValue("shouldCloseProject")})})]}),(0,m.jsxs)("div",{className:"d-flex justify-end",children:[(0,m.jsx)(c.op,{size:"normal",fontSize:"sm",onClick:n,type:"plain",children:"Cancel"}),(0,m.jsx)(c.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:null===I||void 0===I?void 0:I.buttonLoading,children:"edit"===i?"Edit Project State":"Add Project State"})]})]})})},j=n(5900),C=n(41586),P=n(98676),b=n(3109),v=n(70815),k=n(85554),S=function(e){var t=e.record,n=e.onEditIconClick,i=e.reloadTableData,d=e.permissions.deleteProjectState,l=(0,a.useState)({confirmLoading:!1,openPopConfirm:!1}),c=(0,r.Z)(l,2),h=c[0],g=c[1],f=(0,a.useMemo)((function(){return new Z.x}),[]);return(0,m.jsxs)("div",{className:u.Z.actions,children:[(0,m.jsx)("span",{onClick:function(){return n(t)},children:(0,m.jsx)("img",{src:"/images/editicon.svg",alt:""})}),(0,m.jsx)(j.Z,{open:h.openPopConfirm,placement:"top",title:"Are you sure?",onConfirm:function(){if(g((0,o.Z)((0,o.Z)({},h),{},{confirmLoading:!0})),!1===d)return s.ZP.error("You don't have permission to delete this record, please contact your admin."),void g((0,o.Z)((0,o.Z)({},h),{},{openPopConfirm:!1}));f.deleteRecord(t.id).then((function(e){g((0,o.Z)((0,o.Z)({},h),{},{openPopConfirm:!1,confirmLoading:!1})),i()})).catch((function(e){g((0,o.Z)((0,o.Z)({},h),{},{confirmLoading:!1}))}))},onCancel:function(){return g((0,o.Z)((0,o.Z)({},h),{},{openPopConfirm:!1}))},okButtonProps:{loading:h.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:function(e){e||g((0,o.Z)((0,o.Z)({},h),{},{openPopConfirm:!1}))},children:(0,m.jsx)(P.Z,{className:u.Z.bg__red,onClick:function(){g((0,o.Z)((0,o.Z)({},h),{},{openPopConfirm:!0}))}})})]})};function y(e){var t=e.tableData,n=e.tableLoading,r=e.onEditIconClick,a=e.reloadTableData,i=e.meta,d=e.filters,s=(0,k.v9)((function(e){return e.usersReducer})).userPermissions,l=new Z.x,c=function(e,t){return l.updateRecord({isPublished:e},t)},h=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,t,n){return n+1},width:"5%"},{title:"Title",dataIndex:"localization",key:"localization",render:function(e,t){return(0,m.jsx)(b.Z,{color:"dark-main",size:"sm",weight:"bold",children:t.title})}},{title:"Slug",dataIndex:"slug",key:"slug",render:function(e,t){return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(b.Z,{color:"dark-main",size:"sm",weight:"bold",children:t.slug})})}},{title:"Colors",dataIndex:"colors",key:"colors",render:function(e,t){return(0,m.jsxs)(m.Fragment,{children:[t.bgColor&&(0,m.jsxs)("div",{className:"d-flex align-center",children:["Background:",(0,m.jsx)("div",{style:{width:"15px",height:"15px",backgroundColor:t.bgColor,marginLeft:"10px"}})]}),t.textColor&&(0,m.jsxs)("div",{className:"d-flex align-center mt-1",children:["Text:",(0,m.jsx)("div",{style:{width:"15px",height:"15px",backgroundColor:t.textColor,marginLeft:"10px"}})]})]})}},{title:"Published",dataIndex:"isPublished",key:"isPublished",render:function(e,t){return(0,m.jsx)(v.r,{checked:e,onChange:c,recordId:t.id,allowChange:s.updateProjectState})}},{title:"Actions",dataIndex:"actions",key:"actions",render:function(e,t){return(0,m.jsx)(S,{record:t,onEditIconClick:r,reloadTableData:a,permissions:s})}}];return(0,m.jsx)("div",{className:u.Z.antdTableWrapper,children:(0,m.jsx)(C.Z,{sticky:!0,dataSource:t,columns:h,pagination:{current:null===i||void 0===i?void 0:i.page,total:null===i||void 0===i?void 0:i.total,hideOnSinglePage:!0,pageSize:null===i||void 0===i?void 0:i.perPage,onChange:function(e,t){a((0,o.Z)((0,o.Z)({},d),{},{page:e,perPage:t}))}},scroll:{x:991},loading:n,rowKey:function(e){return"project-state-".concat(e.id)}})})}var w=n(18515),I=function(e){return e.CREATE="createProjectState",e.UPDATE="updateProjectState",e.DELETE="deleteProjectState",e.READ="readProjectState",e}({}),T=n(29079),L=[{text:"Home",isLink:!0,path:"/"},{isLink:!0,text:"Site Settings",path:"/siteSettings"},{isLink:!1,text:"Project State"}];var E=function(){var e=(0,g.aY)(I),t=(0,k.v9)((function(e){return e.usersReducer})).userPermissions,n=t.readProjectState,d=t.createProjectState,l=t.updateProjectState,u=(0,a.useState)({editType:"new",recordId:0,openModal:!1}),h=(0,r.Z)(u,2),f=h[0],p=h[1],j=new Z.x,C=(0,a.useState)({page:1,perPage:10}),P=(0,r.Z)(C,2),b=P[0],v=(P[1],(0,T.$5)({method:j.getAllRecords,initialQuery:(0,o.Z)({},b)})),S=v.data,E=v.onRefresh,R=(v.setData,v.loading),z=v.meta,D=function(){!1!==d?p((0,o.Z)((0,o.Z)({},f),{},{openModal:!f.openModal,editType:"new"})):s.ZP.error("You don't have permission to create new record")};return(0,m.jsxs)(i.default,{permissionSlug:e,children:[(0,m.jsx)(c.mr,{heading:"Project States",buttonText:"Add Project State",onButtonClick:D,breadCrumbData:L,showAdd:!0===d}),!0===n&&(0,m.jsx)(y,{tableData:S,tableLoading:R,onEditIconClick:function(e){!1!==l?p((0,o.Z)((0,o.Z)({},f),{},{editType:"edit",recordId:e.id,openModal:!0})):s.ZP.error("You don't have permission to update this record")},reloadTableData:E,meta:z,filters:b}),!1===n&&(0,m.jsx)(w.a$,{mainMessage:"You don't have permission to view this data"}),f.openModal&&(0,m.jsx)(x,{record:f.recordId,type:f.editType,reloadTableData:E,onCancel:D,openModal:f.openModal,permissions:t})]})}},73257:function(e,t,n){n.d(t,{x:function(){return i}});var o=n(43144),r=n(15671),a=n(49075),i=(0,o.Z)((function e(){var t=this;(0,r.Z)(this,e),this.endPoint="project-state",this.getAllRecords=function(e){return a.Z.get(t.endPoint,{params:e})},this.getPublishedRecords=function(e){return a.Z.get("".concat(t.endPoint,"/find-published"),{params:e})},this.getRecordById=function(e){return a.Z.get(t.endPoint+"/"+e)},this.deleteRecord=function(e){return a.Z.delete(t.endPoint+"/"+e)},this.createRecord=function(e){return a.Z.post(t.endPoint,e)},this.updateRecord=function(e,n){return a.Z.patch(t.endPoint+"/"+n,e)}}))}}]);