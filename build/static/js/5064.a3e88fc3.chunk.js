"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[5064],{41746:function(e,n,t){var o=t(29439),r=t(47313),i=t(28080),a=t(32697),d=t(78267),l=t(45705),s=t(32344),u=t(25568),c=t(46417);n.Z=function(e){var n=e.options,t=e.onChange,p=e.value,v=(0,r.useState)(!1),g=(0,o.Z)(v,2),y=g[0],m=g[1],h=(0,c.jsx)(i.Z,{children:(0,c.jsx)("div",{className:"pa-3",children:(0,c.jsx)(a.Z.Group,{className:u.Z.checkboxGroup,options:n,onChange:function(e){t(e),m(!1)},value:p})})});return(0,c.jsx)("div",{children:(0,c.jsx)(d.Z,{trigger:["click"],open:y,onOpenChange:function(e){return m(e)},dropdownRender:function(){return h},children:(0,c.jsx)("div",{className:u.Z.label,children:(0,c.jsxs)(l.Z,{children:[(0,c.jsx)("span",{children:"More Filters"}),(0,c.jsx)(s.Z,{})]})})})})}},65064:function(e,n,t){t.r(n),t.d(n,{default:function(){return C}});var o=t(4942),r=t(1413),i=t(29439),a=t(47313),d=t(82626),l=t(49355),s=t(8570),u=t(41586),c=t(98505),p=t(48897),v=t(46417),g=s.Z.Paragraph;function y(e){var n=e.tableData,t=e.tableLoading,o=e.emptyText,r=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,n,t){return t+1},width:"60px"},{title:"Slug",dataIndex:"slug",key:"slug",render:function(e,n){return(0,v.jsx)("div",{className:"d-flex",children:(0,v.jsxs)("div",{className:"my-auto",children:[(null===n||void 0===n?void 0:n.slug)&&(0,v.jsxs)(g,{title:n.slug,ellipsis:{rows:1,expandable:!1},copyable:{text:n.slug},className:"font-size-xs color-dark-sub mb-0 mt-1",children:["Slug:  ",n.slug]}),(0,v.jsx)(d.ZT,{color:"dark-sub",size:"xs",children:"Added: ".concat((0,c.Ny)(null===n||void 0===n?void 0:n.addedDate,"dd M,yy-t"))}),(null===n||void 0===n?void 0:n.modifiedDate)&&(0,v.jsx)(d.ZT,{color:"dark-sub",size:"xs",children:"Modified: ".concat((0,c.Ny)(null===n||void 0===n?void 0:n.modifiedDate,"dd M,yy-t"))})]})})}},{title:"Message",dataIndex:"message",key:"message",render:function(e){return(0,v.jsx)(d.ZT,{color:"dark-main",size:"sm",children:e})}},{title:"Agent",dataIndex:"agent",key:"agent",render:function(e,n){var t,o,r,i,a,d,l,s,u,c,p,y,m,h,f,x,b,I,Z;return(0,v.jsx)(v.Fragment,{children:(null===n||void 0===n||null===(t=n.property)||void 0===t?void 0:t.assignedTo)&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(g,{title:"".concat(null===(o=n.property.assignedTo)||void 0===o?void 0:o.firstName," ").concat(null===(r=n.property.assignedTo)||void 0===r?void 0:r.lastName),ellipsis:{rows:1,expandable:!1},copyable:{text:"".concat(null===(i=n.property.assignedTo)||void 0===i?void 0:i.firstName," ").concat(null===(a=n.property.assignedTo)||void 0===a?void 0:a.lastName)},className:"font-size-xs color-dark-sub mb-0 mt-1",children:["Name: ","".concat(null===(d=n.property.assignedTo)||void 0===d?void 0:d.firstName," ").concat(null===(l=n.property.assignedTo)||void 0===l?void 0:l.lastName)]}),(0,v.jsxs)(g,{title:null===(s=n.property.assignedTo)||void 0===s?void 0:s.email,ellipsis:{rows:1,expandable:!1},copyable:{text:null===(u=n.property.assignedTo)||void 0===u?void 0:u.email},className:"font-size-xs color-dark-sub mb-0 mt-1",children:["Email: ",null===(c=n.property.assignedTo)||void 0===c?void 0:c.email]}),(0,v.jsxs)(g,{title:"".concat(null===(p=n.property.assignedTo)||void 0===p?void 0:p.phoneCode).concat(null===(y=n.property.assignedTo)||void 0===y?void 0:y.phone),ellipsis:{rows:1,expandable:!1},copyable:{text:"".concat(null===(m=n.property.assignedTo)||void 0===m?void 0:m.phoneCode).concat(null===(h=n.property.assignedTo)||void 0===h?void 0:h.phone)},className:"font-size-xs color-dark-sub mb-0 mt-1",children:["Phone: ","".concat(null===(f=n.property.assignedTo)||void 0===f?void 0:f.phoneCode).concat(null===(x=n.property.assignedTo)||void 0===x?void 0:x.phone)]}),(0,v.jsx)(g,{title:"".concat(null===(b=n.property.assignedTo)||void 0===b?void 0:b.id),ellipsis:{rows:1,expandable:!1},copyable:{text:"".concat(null===(I=n.property.assignedTo)||void 0===I?void 0:I.id)},className:"font-size-sm color-dark-main mb-0 mt-1",children:"ID: ".concat(null===(Z=n.property.assignedTo)||void 0===Z?void 0:Z.id)})]})})}},{title:"Property",dataIndex:"property",key:"property",render:function(e){var n,t,o,r,i;return(0,v.jsxs)(v.Fragment,{children:[(null===e||void 0===e?void 0:e.id)&&(0,v.jsx)(d.ZT,{color:"dark-main",size:"sm",children:"ID: ".concat(null===e||void 0===e?void 0:e.id)}),(null===e||void 0===e?void 0:e.localization)&&(0,v.jsxs)(g,{title:null===(n=e.localization[0])||void 0===n?void 0:n.title,ellipsis:{rows:1,expandable:!1},copyable:{text:null===(t=e.localization[0])||void 0===t?void 0:t.title},className:"font-size-xs color-dark-sub mb-0 mt-1",children:["Name: ",null===(o=e.localization[0])||void 0===o?void 0:o.title]}),(null===e||void 0===e||null===(r=e.category)||void 0===r?void 0:r.slug)&&(0,v.jsx)(d.ZT,{color:"dark-sub",size:"xs",children:'""'}),(null===e||void 0===e?void 0:e.slug)&&(0,v.jsxs)("div",{className:"d-flex",children:[(0,v.jsx)(d.ZT,{color:"dark-main",size:"sm",weight:"bold",children:"View Property:"}),(0,v.jsx)("a",{href:"".concat(p.JH,"/en/property/").concat(e.slug),target:"_blank",rel:"noreferrer",title:null===(i=e.localization[0])||void 0===i?void 0:i.title,children:(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",height:"16px",width:"17px",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"})})})]})]})}},{title:"User",dataIndex:"userAgent",key:"userAgent",render:function(e,n){return(0,v.jsxs)(v.Fragment,{children:[(null===n||void 0===n?void 0:n.userIP)&&(0,v.jsxs)(g,{title:n.userIP,ellipsis:{rows:1,expandable:!1},copyable:{text:n.userIP},className:"font-size-xs color-dark-sub mb-0 mt-1",children:["IP: ",n.userIP]}),(null===n||void 0===n?void 0:n.userAgent)&&(0,v.jsxs)(g,{title:n.userAgent,copyable:{text:n.userAgent},className:"font-size-xs color-dark-sub mb-0 mt-1",children:["User Agent: ",n.userAgent]})]})}},{title:"Organisation",dataIndex:"agency",key:"agency",render:function(e,n){var t,o,r,i,a,l,s,u;return(0,v.jsxs)(v.Fragment,{children:[(null===n||void 0===n||null===(t=n.property)||void 0===t?void 0:t.agency)&&(0,v.jsxs)(g,{title:null===n||void 0===n||null===(o=n.property)||void 0===o||null===(r=o.agency)||void 0===r?void 0:r.name,ellipsis:{rows:1,expandable:!1},copyable:{text:null===n||void 0===n||null===(i=n.property)||void 0===i||null===(a=i.agency)||void 0===a?void 0:a.name},className:"font-size-xs color-dark-sub mb-0 mt-1",children:["Name: ",null===n||void 0===n||null===(l=n.property)||void 0===l||null===(s=l.agency)||void 0===s?void 0:s.name]}),(null===n||void 0===n?void 0:n.property)&&(0,v.jsx)(d.ZT,{color:"dark-main",size:"sm",children:"ID: ".concat(null===n||void 0===n||null===(u=n.property)||void 0===u?void 0:u.agency.id)})]})}}];return(0,v.jsx)("div",{children:(0,v.jsx)(u.Z,{sticky:!0,dataSource:n,columns:r,pagination:!1,scroll:{x:991},loading:t,rowKey:function(e){return"leads-tracking-".concat(e.id)},locale:{emptyText:o}})})}var m=t(42819),h=t(17327),f=t(98522),x=t(7532),b=t(3798),I=t(55291),Z=t(38308),j=t(5190),P=t(42623),N=t(41746),k=[{text:"Home",isLink:!0,path:"/"},{isLink:!0,text:"Site Settings",path:"/siteSettings"},{isLink:!0,text:"Leads",path:"/siteSettings/leads"},{isLink:!1,text:"Tracking"}],C=function(){var e,n,t,s,u,p,g=(0,b.aY)(f.P),C=(0,a.useMemo)((function(){return new Z.b}),[]),z=(0,a.useMemo)((function(){return new j.L}),[]),R=(0,a.useState)([]),T=(0,i.Z)(R,2),S=T[0],A=T[1],w=(0,a.useState)({loading:!1,data:[]}),U=(0,i.Z)(w,2),D=U[0],L=U[1],M=(0,a.useState)(""),F=(0,i.Z)(M,2),X=F[0],_=F[1],O=(0,P.N)(X,500),E=(0,a.useState)({data:[],loading:!1}),B=(0,i.Z)(E,2),W=B[0],H=B[1],G=(0,a.useState)({data:[],loading:!1}),V=(0,i.Z)(G,2),J=V[0],K=V[1],Y=(0,a.useState)({dateRange:[""],propertyId:0,userAgent:"",userIP:"",propertyUrl:"",source:void 0,organizationId:0,propertyCategory:void 0,agentId:0}),q=(0,i.Z)(Y,2),Q=q[0],$=q[1],ee=(0,a.useState)(!1),ne=(0,i.Z)(ee,2),te=ne[0],oe=ne[1],re=(0,a.useMemo)((function(){return new m.S}),[]),ie=function(e){var n=null===e||void 0===e?void 0:e.target,t=n.name,i=n.value;if(("organizationId"===t||"propertyId"===t||"agentId"===t)&&!(0,b.hj)(i)){var a="";switch(t){case"organizationId":a="Organization ID";break;case"propertyId":a="Property ID";break;case"agentId":a="Agent ID"}return I.ZP.error("".concat(a," should be a number"))}$((0,r.Z)((0,r.Z)({},Q),{},(0,o.Z)({},t,i)))},ae=(0,a.useCallback)((function(e,n){e&&(oe(!0),$((0,r.Z)((0,r.Z)({},Q),{},(0,o.Z)({},e,n))))}),[Q]),de=(0,a.useCallback)((function(){O&&(H((function(e){return(0,r.Z)((0,r.Z)({},e),{},{loading:!0})})),z.findPublished({name:O}).then((function(e){var n,t=null===(n=e.data)||void 0===n?void 0:n.data;if(t){var o=t.filter((function(e,n){return t.findIndex((function(n){return n.id===e.id}))===n}));H((function(e){return(0,r.Z)((0,r.Z)({},e),{},{data:o})}))}})).catch((function(e){var n,t;I.ZP.error((null===e||void 0===e||null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.message)||"Something went wrong")})).finally((function(){H((function(e){return(0,r.Z)((0,r.Z)({},e),{},{loading:!1})}))})))}),[O,z]);(0,a.useEffect)((function(){de()}),[de]);var le=(0,a.useCallback)((function(){C.getAllRecords().then((function(e){K(e.data)})).catch((function(e){K((0,r.Z)((0,r.Z)({},J),{},{loading:!1}))}))}),[J]);(0,a.useEffect)((function(){le()}),[]);var se=(0,a.useCallback)((function(){var e,n,t=(null===(e=Q.dateRange)||void 0===e?void 0:e[0])||"",o=(null===(n=Q.dateRange)||void 0===n?void 0:n[1])||"";t&&(0,c.Ny)(t,"yy-mm-dd"),o&&(0,c.Ny)(o,"yy-mm-dd"),Number(Q.propertyId)>0&&Number(Q.propertyId),Q.propertyUrl&&Q.propertyUrl,Q.source&&Q.source,Q.userAgent&&Q.userAgent,Q.userIP&&Q.userIP,Number(Q.organizationId)>0&&Number(Q.organizationId),Q.propertyCategory&&Q.propertyCategory,Number(Q.agentId)>0&&Number(Q.agentId)}),[Q,re]),ue=(0,a.useCallback)((function(e,n){var t,o;L((0,r.Z)((0,r.Z)({},D),{},{loading:!0}));var i=(null===(t=Q.dateRange)||void 0===t?void 0:t[0])||"",a=(null===(o=Q.dateRange)||void 0===o?void 0:o[1])||"";i&&(0,c.Ny)(i,"yy-mm-dd"),a&&(0,c.Ny)(a,"yy-mm-dd"),Number(Q.propertyId)>0&&Number(Q.propertyId),Q.propertyUrl&&Q.propertyUrl,Q.source&&Q.source,Q.userAgent&&Q.userAgent,Q.userIP&&Q.userIP,Number(Q.organizationId)>0&&Number(Q.organizationId),Q.propertyCategory&&Q.propertyCategory,Number(Q.agentId)>0&&Number(Q.agentId)}),[Q,re]);(0,a.useEffect)((function(){te&&se();var e=setTimeout((function(){oe(!1)}),2e3);return function(){return clearTimeout(e)}}),[te,Q,se]);var ce=(0,a.useCallback)((function(e){}),[re]);(0,a.useEffect)((function(){L((0,r.Z)((0,r.Z)({},D),{},{loading:!0})),ce()}),[]);var pe=(0,a.useCallback)((function(){var e,n,t,o,r=(null===(e=Q.dateRange)||void 0===e?void 0:e[0])||"",i=(null===(n=Q.dateRange)||void 0===n?void 0:n[1])||"",a=r?(0,c.Ny)(r,"yy-mm-dd"):void 0,d=i?(0,c.Ny)(i,"yy-mm-dd"):void 0;ce({perPage:(null===D||void 0===D||null===(t=D.meta)||void 0===t?void 0:t.perPage)||10,page:(null===D||void 0===D||null===(o=D.meta)||void 0===o?void 0:o.page)||1,propertyId:Number(Q.propertyId)>0?Number(Q.propertyId):void 0,propertyUrl:Q.propertyUrl?Q.propertyUrl:void 0,userAgent:Q.userAgent?Q.userAgent:void 0,userIP:Q.userIP?Q.userIP:void 0,fromDate:a,toDate:d,organizationId:Number(Q.organizationId)>0?Number(Q.organizationId):void 0,propertyCategory:Q.propertyCategory?Q.propertyCategory:void 0,agentId:Number(Q.agentId)>0?Number(Q.agentId):void 0})}),[D,Q]),ve=[{label:"Organization",value:"organizationId"},{label:"Agent ID",value:"agentId"},{label:"Property URL",value:"propertyUrl"},{label:"Property Category",value:"propertyCategory"}],ge={organizationId:(0,v.jsx)(d.Xy,{type:"radio",label:"Organization",name:"organizationId",withSearch:!0,options:(null===W||void 0===W||null===(e=W.data)||void 0===e?void 0:e.map((function(e){return{label:e.name,value:"".concat(e.id)}})))||[],onChange:ie,value:Number(null===Q||void 0===Q?void 0:Q.organizationId)>0?String(null===Q||void 0===Q?void 0:Q.organizationId):"",onReset:function(){oe(!0),ae("organizationId",0),_("")},onUpdate:se,loading:null===W||void 0===W?void 0:W.loading,searchTerm:X,onSearch:function(e){return _(e.currentTarget.value)}}),agentId:(0,v.jsx)(d.Xy,{type:"input",label:"Agent ID",name:"agentId",value:0===(null===Q||void 0===Q?void 0:Q.agentId)?"":String(null===Q||void 0===Q?void 0:Q.agentId),onChange:ie,onReset:function(){return ae("agentId",0)},onUpdate:se}),propertyUrl:(0,v.jsx)(d.Xy,{type:"input",label:"Property URL",name:"propertyUrl",value:String(null===Q||void 0===Q?void 0:Q.propertyUrl),onChange:ie,onReset:function(){return ae("propertyUrl","")},onUpdate:se}),propertyCategory:(0,v.jsx)(d.Xy,{type:"radio",label:"Property Category",name:"propertyCategory",options:null===J||void 0===J||null===(n=J.data)||void 0===n?void 0:n.map((function(e){return{label:e.localization[0].title,value:e.slug}})),value:String(null===Q||void 0===Q?void 0:Q.propertyCategory),onChange:ie,onReset:function(){return ae("propertyCategory","")},onUpdate:se})};return(0,v.jsxs)(x.default,{permissionSlug:g,children:[(0,v.jsx)(d.mr,{heading:"Leads Tracker",breadCrumbData:k,filters:(0,v.jsxs)("div",{className:h.Z.filterWrapper,children:[(0,v.jsx)("div",{children:(0,v.jsx)(d.Xy,{type:"radio",label:"Source",name:"source",options:[],value:String(null===Q||void 0===Q?void 0:Q.source),onChange:ie,onReset:function(){return ae("source","")},onUpdate:se})}),(0,v.jsx)("div",{children:(0,v.jsx)(d.Xy,{type:"input",label:"Property ID",name:"propertyId",value:Number(null===Q||void 0===Q?void 0:Q.propertyId)>0?String(null===Q||void 0===Q?void 0:Q.propertyId):"",onChange:ie,onReset:function(){return ae("propertyId",0)},onUpdate:se})}),(0,v.jsx)("div",{children:(0,v.jsx)(d.Xy,{type:"input",label:"User Agent",name:"userAgent",value:String(null===Q||void 0===Q?void 0:Q.userAgent),onChange:ie,onReset:function(){return ae("userAgent","")},onUpdate:se})}),(0,v.jsx)("div",{children:(0,v.jsx)(d.Xy,{type:"input",label:"User IP",name:"userIP",value:String(null===Q||void 0===Q?void 0:Q.userIP),onChange:ie,onReset:function(){return ae("userIP","")},onUpdate:se})}),(0,v.jsx)("div",{children:(0,v.jsx)(d.Xy,{type:"datepicker",label:"Date",name:"dateRange",onChange:function(e){$((0,r.Z)((0,r.Z)({},Q),{},{dateRange:e}))},onReset:function(){return ae("dateRange",[])},onUpdate:se})}),Object.keys(ge).map((function(e){return(null===S||void 0===S?void 0:S.includes(e))&&ge[e]})),(0,v.jsx)("div",{children:(0,v.jsx)(N.Z,{options:null===ve||void 0===ve?void 0:ve.map((function(e){return{label:e.label,value:e.value}})),onChange:function(e){A(e)},value:S})})]})}),D.loading?(0,v.jsx)(l.Z,{items:5,fullWidth:!0}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:h.Z.antdTableWrapper,children:(0,v.jsx)(y,{tableData:null===D||void 0===D?void 0:D.data,tableLoading:null===D||void 0===D?void 0:D.loading,reloadTableData:pe,onEditIconClick:function(){}})}),(0,v.jsx)(d.tl,{total:null===D||void 0===D||null===(t=D.meta)||void 0===t?void 0:t.total,current:null===D||void 0===D||null===(s=D.meta)||void 0===s?void 0:s.page,defaultPageSize:null!==D&&void 0!==D&&null!==(u=D.meta)&&void 0!==u&&u.perPage?null===D||void 0===D||null===(p=D.meta)||void 0===p?void 0:p.perPage:10,pageSizeOptions:[10,20,50,100],onChange:ue})]})]})}},42819:function(e,n,t){t.d(n,{S:function(){return d}});var o=t(43144),r=t(15671),i=t(49075),a=t(3135),d=(0,o.Z)((function e(){var n=this;(0,r.Z)(this,e),this.endPoint="leads",this.getAllRecords=function(e){return i.Z.get(n.endPoint,{params:e})},this.getRecordById=function(e){return i.Z.get("".concat(n.endPoint,"/").concat(e))},this.getNoteById=function(e){return i.Z.get("".concat(n.endPoint,"/notes/").concat(e))},this.createRecord=function(e){return i.Z.post(n.endPoint+"/",e)},this.updateRecord=function(e,t){return i.Z.patch("".concat(n.endPoint,"/").concat(t),e)},this.changeStatus=function(e,t){return i.Z.patch("".concat(n.endPoint,"/changeStatus/").concat(e),{status:t})},this.addNote=function(e,t){return i.Z.post("".concat(n.endPoint,"/addNote/").concat(e),t)},this.notelogs=function(e,t){return i.Z.get("".concat(n.endPoint,"/logs/").concat(e),{params:t})},this.assignLead=function(e,t){return i.Z.patch("".concat(n.endPoint,"/assignLead/").concat(t),e)},this.deleteRecord=function(e){return i.Z.delete("".concat(n.endPoint,"/remove/").concat(e))},this.removeNote=function(e){return i.Z.delete("".concat(n.endPoint,"/removeNote/").concat(e))},this.uploadFile=function(e){return i.Z.post("".concat(n.endPoint,"/uploadLeadsDocuments"),e,{headers:a.C})},this.removeFile=function(e){return i.Z.delete("".concat(n.endPoint,"/removeDocument/").concat(e))},this.markConcernAsResolved=function(e){return i.Z.patch("".concat(n.endPoint,"/markConcernAsResolved/").concat(e))},this.getCounts=function(){return i.Z.get("".concat(n.endPoint,"/getCounts"))}}))},5190:function(e,n,t){t.d(n,{L:function(){return d}});var o=t(43144),r=t(15671),i=t(49075),a=t(3135),d=(0,o.Z)((function e(){var n=this;(0,r.Z)(this,e),this.endPoint="organization",this.getAllRecords=function(e){return i.Z.get(n.endPoint,{params:e})},this.findPublished=function(e){return i.Z.get(n.endPoint+"/find-published",{params:e})},this.getRecordById=function(e){return i.Z.get("".concat(n.endPoint,"/").concat(e))},this.deleteRecord=function(e){return i.Z.delete("".concat(n.endPoint,"/").concat(e))},this.createRecord=function(e){return i.Z.post(n.endPoint,e,{headers:a.C})},this.updateRecord=function(e,t){return i.Z.patch("".concat(n.endPoint,"/").concat(t),e,{headers:a.C})},this.getTenants=function(){return i.Z.get("xero/getTenants")}}))},38308:function(e,n,t){t.d(n,{b:function(){return a}});var o=t(43144),r=t(15671),i=t(49075),a=(0,o.Z)((function e(){var n=this;(0,r.Z)(this,e),this.endPoint="project-type",this.getAllRecords=function(){return i.Z.get(i._+n.endPoint)},this.getRecordById=function(e){return i.Z.get(i._+n.endPoint+"/"+e)},this.deleteRecord=function(e){return i.Z.delete(i._+n.endPoint+"/"+e)},this.createRecord=function(e){return i.Z.post(i._+n.endPoint,e)},this.updateRecord=function(e,t){return i.Z.patch(i._+n.endPoint+"/"+t,e)}}))}}]);