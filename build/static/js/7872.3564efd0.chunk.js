"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[7872],{97872:function(e,t,n){n.r(t),n.d(t,{default:function(){return F}});var o=n(74165),r=n(15861),i=n(1413),a=n(29439),d=n(47313),c=n(25019),s=n(55291),l=n(14254),u=n(82626),p=n(3113),f=n(49355),h=n(46646),Z=n(40169),m=n(75010),x=n(59816),g=n(46417),v=function(e){var t=e.openModal,n=e.onCancel,o=e.type,r=e.record,v=e.reloadTableData,y=e.permissions,b=y.createTaxRate,T=y.updateTaxRate,R=e.callback,j=c.Z.useForm(),P=(0,a.Z)(j,1)[0],C=new m.L,k=((0,d.useMemo)((function(){return new x.Y}),[]),(0,d.useState)()),w=(0,a.Z)(k,2),L=w[0],I=w[1],S=function(e){var t=(0,Z.P)(e);if("string"==typeof t.message)I((0,i.Z)((0,i.Z)({},L),{},{error:t.message}));else{var n=(0,h.O)(t.message,[]);P.setFields(n),I((0,i.Z)((0,i.Z)({},L),{},{error:""}))}},E=(0,d.useCallback)((function(){C.getRecordById(r).then((function(e){e.data&&e.data.data&&(P.setFieldsValue((0,i.Z)({},e.data.data)),I((0,i.Z)((0,i.Z)({},e.data),{},{loading:!1})))})).catch((function(e){S(e)}))}),[P,r,C]);(0,d.useEffect)((function(){"edit"===o?(I({loading:!0}),E()):P.resetFields()}),[]);return(0,g.jsx)(u.P0,{visible:t,closable:!0,onCancel:n,titleText:"edit"===o?"Edit Tax Rate":"Add New Tax Rate",showFooter:!1,children:null!==L&&void 0!==L&&L.loading?(0,g.jsx)(f.Z,{items:3}):(0,g.jsxs)(c.Z,{className:p.Z.form,onFinish:function(e){switch(I((0,i.Z)((0,i.Z)({},L),{},{buttonLoading:!0})),o){case"edit":!0===T?C.updateRecord(e,r).then((function(e){v(),n(),I((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){S(e),I((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})}))})):(I((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})})),s.ZP.error("You don't have permission to update this record"));break;case"new":!0===b?C.createRecord(e).then((function(e){var t=(null===e||void 0===e?void 0:e.data).data;v(),R&&R(null===t||void 0===t?void 0:t.id),n(),I((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){S(e),I((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})}))})):(I((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})})),s.ZP.error("You don't have permission to create this record"))}},form:P,children:[(null===L||void 0===L?void 0:L.error)&&(0,g.jsx)(u.EQ,{description:null===L||void 0===L?void 0:L.error,isClosable:!0,onClose:function(){I((0,i.Z)((0,i.Z)({},L),{},{error:""}))}}),(0,g.jsx)(c.Z.Item,{name:"title",rules:[{required:!0,message:"Please add a title"}],children:(0,g.jsx)(u.t7,{size:"w100",label:"Title",asterisk:!0,type:"text",placeHolder:"Enter TaxRate title"})}),(0,g.jsx)(c.Z.Item,{name:"taxType",children:(0,g.jsx)(u.t7,{size:"w100",label:"Tax Type",type:"text"})}),(0,g.jsxs)(c.Z.Item,{name:"rate",children:[(0,g.jsx)("span",{className:"font-size-sm",children:"Rate"}),(0,g.jsx)(l.Z,{defaultValue:P.getFieldValue("rate"),onChange:function(e){P.setFieldValue("rate",e)},style:{width:"100%",borderRadius:"0.25rem",border:"2px solid var(--color-border)"},type:"number"})]}),(0,g.jsxs)("div",{className:"d-flex justify-end",children:[(0,g.jsx)(u.op,{size:"normal",fontSize:"sm",onClick:n,type:"plain",children:"Cancel"}),(0,g.jsx)(u.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:null===L||void 0===L?void 0:L.buttonLoading,children:"edit"===o?"Edit Tax Rate":"Add Tax Rate"})]})]})})},y=n(5900),b=n(86136),T=n(41586),R=n(98676),j=n(3109),P=n(85554),C=n(3798),k=function(e){var t=e.record,n=e.onEditIconClick,o=e.reloadTableData,r=e.permissions.deleteTaxRate,c=(0,d.useState)({confirmLoading:!1,openPopConfirm:!1}),l=(0,a.Z)(c,2),u=l[0],f=l[1],h=new m.L;return(0,g.jsxs)("div",{className:p.Z.actions,children:[(0,g.jsx)("span",{onClick:function(){return n(t)},children:(0,g.jsx)("img",{src:"/images/editicon.svg",alt:""})}),(0,g.jsx)(y.Z,{open:u.openPopConfirm,placement:"top",title:"Are you sure?",onConfirm:function(){if(f((0,i.Z)((0,i.Z)({},u),{},{confirmLoading:!0})),!1===r)return s.ZP.error("You don't have permission to delete this record, please contact your admin."),void f((0,i.Z)((0,i.Z)({},u),{},{openPopConfirm:!1}));h.deleteRecord(t.id).then((function(e){f((0,i.Z)((0,i.Z)({},u),{},{openPopConfirm:!1,confirmLoading:!1})),o()})).catch((function(e){f((0,i.Z)((0,i.Z)({},u),{},{confirmLoading:!1}))}))},onCancel:function(){return f((0,i.Z)((0,i.Z)({},u),{},{openPopConfirm:!1}))},okButtonProps:{loading:u.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:function(e){e||f((0,i.Z)((0,i.Z)({},u),{},{openPopConfirm:!1}))},children:(0,g.jsx)(R.Z,{className:p.Z.bg__red,onClick:function(){f((0,i.Z)((0,i.Z)({},u),{},{openPopConfirm:!0}))}})})]})};function w(e){var t=e.tableData,n=e.tableLoading,o=e.onEditIconClick,r=e.reloadTableData,i=e.meta,c=e.filters,s=(0,P.v9)((function(e){return e.usersReducer})).userPermissions,l=(0,d.useState)(""),u=(0,a.Z)(l,2),p=u[0],f=u[1],h=(0,d.useState)({page:(null===i||void 0===i?void 0:i.page)||1,perPage:(null===i||void 0===i?void 0:i.perPage)||10}),Z=(0,a.Z)(h,2),m=Z[0],x=Z[1],v=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,t,n){return(0,C.k7)(n,m)},width:"60px"},{title:"Title",dataIndex:"title",key:"title",render:function(e,t){return(0,g.jsx)(j.Z,{color:"dark-main",size:"sm",weight:"bold",children:t.title})}},{title:"Tax Type",dataIndex:"taxType",key:"taxType",render:function(e,t){return(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(j.Z,{color:"dark-main",size:"sm",weight:"bold",children:null===t||void 0===t?void 0:t.taxType})})}},{title:"Rate",dataIndex:"rate",key:"rate",render:function(e,t){return(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(j.Z,{color:"dark-main",size:"sm",weight:"bold",children:t.rate})})}},{title:"Actions",dataIndex:"actions",key:"actions",render:function(e,t){return(0,g.jsx)(k,{record:t,onEditIconClick:o,reloadTableData:r,permissions:s})}}];return(0,g.jsxs)("div",{children:[(0,g.jsx)(b.Z,{type:"input",placeholder:"Search by title",onChange:function(e){f(e.target.value)},value:c.name,allowClear:!0,style:{border:"1.5px solid var(--color-border)",borderRadius:"0.25rem",width:"25%",marginBottom:"1rem"},prefix:(0,g.jsx)("img",{style:{padding:"0rem 0.5rem"},src:"/images/searchIcon.svg",alt:""})}),(0,g.jsx)(T.Z,{sticky:!0,dataSource:null===t||void 0===t?void 0:t.filter((function(e){var t,n;return null===e||void 0===e||null===(t=e.title)||void 0===t||null===(n=t.toLowerCase())||void 0===n?void 0:n.includes(p.toLowerCase())})),columns:v,scroll:{x:991},loading:n,rowKey:function(e){return"TaxRate-".concat(e.id)},pagination:{current:null===i||void 0===i?void 0:i.page,total:null===i||void 0===i?void 0:i.total,hideOnSinglePage:!0,pageSize:null===i||void 0===i?void 0:i.perPage,onChange:function(e,t){x({page:e,perPage:t})}}})]})}var L=n(59491),I=n(18515),S=n(54060),E=n(29079),z=n(23571),A=n(19552),D=[{text:"Home",isLink:!0,path:"/"},{isLink:!1,text:"Tax Rate"}];var F=function(){var e=(0,d.useState)(!1),t=(0,a.Z)(e,2),n=t[0],c=t[1],l=(0,C.aY)(z.s),p=(0,P.v9)((function(e){return e.usersReducer})).userPermissions,f=p.readTaxRate,h=p.createTaxRate,Z=p.updateTaxRate,x=(0,d.useState)({page:1,perPage:25}),y=(0,a.Z)(x,2),b=y[0],T=(y[1],(0,d.useState)({editType:"new",recordId:0,openModal:!1})),R=(0,a.Z)(T,2),j=R[0],k=R[1],F=new m.L,M=new A.l,Y=(0,E.$5)({method:F.getAllRecords,initialQuery:(0,i.Z)({},b)}),N=Y.data,B=Y.onRefresh,V=(Y.setData,Y.loading),_=Y.meta,O=function(){!1!==h?k((0,i.Z)((0,i.Z)({},j),{},{openModal:!j.openModal,editType:"new"})):s.ZP.error("You don't have permission to create new record")},H=function(){var e=(0,r.Z)((0,o.Z)().mark((function e(){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.prev=1,e.next=4,M.syncTaxRates();case 4:s.ZP.success("Synced successfully"),B(),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),t=(0,C.S3)(e.t0),s.ZP.error(t||"Something went wrong");case 12:return e.prev=12,c(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,8,12,15]])})));return function(){return e.apply(this,arguments)}}();return(0,g.jsxs)(S.Z,{permissionSlug:l,children:[(0,g.jsx)(u.mr,{heading:"Tax Rate",buttonText:"Add Tax Rate",onButtonClick:O,breadCrumbData:D,showAdd:!0===h,excelExport:(0,g.jsx)(L.Z,{loading:n,style:{marginRight:"1rem",height:"2.25rem"},onClick:H,children:"Sync with Xero"})}),!0===f&&(0,g.jsx)(w,{tableData:N,tableLoading:V,onEditIconClick:function(e){!1!==Z?k((0,i.Z)((0,i.Z)({},j),{},{editType:"edit",recordId:e.id,openModal:!0})):s.ZP.error("You don't have permission to update this record")},reloadTableData:B,meta:_,filters:b}),!1===f&&(0,g.jsx)(I.a$,{mainMessage:"You don't have permission to view this data"}),j.openModal&&(0,g.jsx)(v,{record:j.recordId,type:j.editType,reloadTableData:function(){return B()},onCancel:O,openModal:j.openModal,permissions:p})]})}},59816:function(e,t,n){n.d(t,{Y:function(){return d}});var o=n(43144),r=n(15671),i=n(49075),a=n(3135),d=(0,o.Z)((function e(){var t=this;(0,r.Z)(this,e),this.endPoint="country",this.allEndpoint="country/all",this.getAllRecords=function(){return i.Z.get(t.allEndpoint)},this.getAvailableRecords=function(){return i.Z.get("".concat(t.endPoint,"/available-country"))},this.getRecordById=function(e){return i.Z.get("".concat(t.endPoint,"/").concat(e))},this.deleteRecord=function(e){return i.Z.delete("".concat(t.endPoint,"/").concat(e))},this.createRecord=function(e){return i.Z.post(t.endPoint+"/",e,{headers:a.C})},this.updateRecord=function(e,n){return i.Z.patch("".concat(t.endPoint,"/").concat(n),e,{headers:a.C})}}))},75010:function(e,t,n){n.d(t,{L:function(){return a}});var o=n(43144),r=n(15671),i=n(49075),a=(0,o.Z)((function e(){var t=this;(0,r.Z)(this,e),this.endPoint="tax-rate",this.getAllRecords=function(e){return i.Z.get(t.endPoint,{params:e})},this.getRecordById=function(e){return i.Z.get("".concat(t.endPoint,"/").concat(e))},this.deleteRecord=function(e){return i.Z.delete("".concat(t.endPoint,"/").concat(e))},this.createRecord=function(e){return i.Z.post(t.endPoint,e)},this.updateRecord=function(e,n){return i.Z.patch("".concat(t.endPoint,"/").concat(n),e)}}))}}]);