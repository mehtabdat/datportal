"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[9656],{99656:function(e,t,n){n.r(t),n.d(t,{default:function(){return z}});var o=n(1413),a=n(29439),i=n(47313),r=n(25019),s=n(55291),d=n(31513),c=n(98276),l=n(82626),u=n(3113),p=n(49355),m=n(46646),f=n(40169),h=n(64217),Z=n(37936),v=n(3798),g=n(46417),x=function(e){var t,n,x=e.openModal,y=e.onCancel,j=e.type,b=e.record,C=e.reloadTableData,P=e.permissions,k=P.createCompanyAsset,w=P.updateCompanyAsset,N=r.Z.useForm(),A=(0,a.Z)(N,1)[0],I=new h.S,S=(0,i.useState)(),L=(0,a.Z)(S,2),R=L[0],T=L[1],z=function(e){var t=(0,f.P)(e);if("string"==typeof t.message)T((0,o.Z)((0,o.Z)({},R),{},{error:t.message}));else{var n=(0,m.O)(t.message,[]);A.setFields(n),T((0,o.Z)((0,o.Z)({},R),{},{error:""}))}},D=(0,i.useCallback)((function(){I.getRecordById(b).then((function(e){e.data&&e.data.data&&(A.setFieldsValue((0,o.Z)({},e.data.data)),T((0,o.Z)((0,o.Z)({},e.data),{},{loading:!1})))})).catch((function(e){z(e)}))}),[A,b,I]);(0,i.useEffect)((function(){"edit"===j?(T({loading:!0}),D()):A.resetFields()}),[]);return(0,g.jsx)(l.P0,{visible:x,closable:!0,onCancel:y,titleText:"edit"===j?"Edit Asset":"Add New Asset",showFooter:!1,children:null!==R&&void 0!==R&&R.loading?(0,g.jsx)(p.Z,{items:3}):(0,g.jsxs)(r.Z,{className:u.Z.form,onFinish:function(e){switch(T((0,o.Z)((0,o.Z)({},R),{},{buttonLoading:!0})),j){case"edit":!0===w?I.updateRecord(e,b).then((function(e){C(),y(),T((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){z(e),T((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})):(T((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})})),s.ZP.error("You don't have permission to update this record"));break;case"new":!0===k?I.createRecord(e).then((function(e){C(),y(),T((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){z(e),T((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})):(T((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})})),s.ZP.error("You don't have permission to create this record"))}},form:A,children:[(null===R||void 0===R?void 0:R.error)&&(0,g.jsx)(l.EQ,{description:null===R||void 0===R?void 0:R.error,isClosable:!0,onClose:function(){T((0,o.Z)((0,o.Z)({},R),{},{error:""}))}}),(0,g.jsxs)("div",{children:[(0,g.jsx)(r.Z.Item,{name:"assetName",rules:[{required:!0,message:"Please add a name"}],children:(0,g.jsx)(l.t7,{size:"w100",label:"Name",asterisk:!0,type:"text",placeHolder:"Enter asset name"})}),(0,g.jsx)(r.Z.Item,{name:"assetDetail",children:(0,g.jsx)(l.t7,{size:"w100",label:"Detail",type:"text"})})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)(r.Z.Item,{name:"code",rules:[{required:!0,message:"Please add a code"}],children:(0,g.jsx)(l.t7,{size:"w100",label:"Code",asterisk:!0,type:"text",placeHolder:"Enter code"})}),(0,g.jsx)(r.Z.Item,{name:"quantity",rules:[{required:!0,message:"Please add quantity"}],children:(0,g.jsx)(l.t7,{size:"w100",label:"Quantity",type:"number",asterisk:!0,defaultValue:"edit"===j?null===R||void 0===R?void 0:R.data.quantity:void 0})})]}),(0,g.jsx)("div",{children:(0,g.jsxs)(r.Z.Item,{name:"type",rules:[{required:!0,message:"Please select a department"}],children:[(0,g.jsxs)("label",{className:"font-size-sm",children:["Type  ",(0,g.jsx)("span",{className:"color-red-yp",children:"*"})]}),(0,g.jsx)(d.Z,{allowClear:!0,style:{width:"100%"},defaultValue:null===R||void 0===R||null===(t=R.data)||void 0===t?void 0:t.type,placeholder:"Search for the asset type",className:"selectAntdCustom",onChange:function(e){return A.setFieldsValue({type:e})},showSearch:!0,onSearch:function(e){},optionFilterProp:"label",options:null===(n=Object.entries(Z.mm))||void 0===n?void 0:n.map((function(e){var t=(0,a.Z)(e,2),n=t[0],o=t[1];return{label:(0,v.kC)(n.replace("_"," ")),value:Number(o)}})),notFoundContent:(0,g.jsx)(c.Z,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:100},description:(0,g.jsx)("span",{children:"No data found, Please search for the type"})})})]})}),(0,g.jsxs)("div",{className:"d-flex justify-end",children:[(0,g.jsx)(l.op,{size:"normal",fontSize:"sm",onClick:y,type:"plain",children:"Cancel"}),(0,g.jsx)(l.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:null===R||void 0===R?void 0:R.buttonLoading,children:"edit"===j?"Edit Asset":"Add Asset"})]})]})})},y=n(5900),j=n(41586),b=n(98676),C=n(3109),P=n(85554),k=function(e){var t=e.record,n=e.onEditIconClick,r=e.reloadTableData,d=e.permissions.deleteCompanyAsset,c=(0,i.useState)({confirmLoading:!1,openPopConfirm:!1}),l=(0,a.Z)(c,2),p=l[0],m=l[1],f=new h.S;return(0,g.jsxs)("div",{className:u.Z.actions,children:[(0,g.jsx)("span",{onClick:function(){return n(t)},children:(0,g.jsx)("img",{src:"/images/editicon.svg",alt:""})}),(0,g.jsx)(y.Z,{open:p.openPopConfirm,placement:"top",title:"Are you sure?",onConfirm:function(){if(m((0,o.Z)((0,o.Z)({},p),{},{confirmLoading:!0})),!1===d)return s.ZP.error("You don't have permission to delete this record, please contact your admin."),void m((0,o.Z)((0,o.Z)({},p),{},{openPopConfirm:!1}));f.deleteRecord(t.id).then((function(e){m((0,o.Z)((0,o.Z)({},p),{},{openPopConfirm:!1,confirmLoading:!1})),r()})).catch((function(e){m((0,o.Z)((0,o.Z)({},p),{},{confirmLoading:!1}))}))},onCancel:function(){return m((0,o.Z)((0,o.Z)({},p),{},{openPopConfirm:!1}))},okButtonProps:{loading:p.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:function(e){e||m((0,o.Z)((0,o.Z)({},p),{},{openPopConfirm:!1}))},children:(0,g.jsx)(b.Z,{className:u.Z.bg__red,onClick:function(){m((0,o.Z)((0,o.Z)({},p),{},{openPopConfirm:!0}))}})})]})};function w(e){var t=e.tableData,n=e.tableLoading,a=e.onEditIconClick,i=e.reloadTableData,r=e.meta,s=e.filters,d=(0,P.v9)((function(e){return e.usersReducer})).userPermissions,c=(new h.S,[{title:"S.No",dataIndex:"index",key:"index",render:function(e,t,n){return n+1},width:"5%"},{title:"Name",dataIndex:"assetName",key:"assetName",render:function(e,t){return(0,g.jsx)(C.Z,{color:"dark-main",size:"sm",weight:"bold",children:t.assetName})}},{title:"Detail",dataIndex:"assetDetail",key:"assetDetail",render:function(e,t){return(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(C.Z,{color:"dark-main",size:"sm",weight:"bold",children:e})})}},{title:"Code",dataIndex:"code",key:"code",render:function(e,t){return(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(C.Z,{color:"dark-main",size:"sm",weight:"bold",children:e})})}},{title:"Quantity",dataIndex:"quantity",key:"quantity",render:function(e,t){return(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(C.Z,{color:"dark-main",size:"sm",weight:"bold",children:e})})}},{title:"Actions",dataIndex:"actions",key:"actions",render:function(e,t){return(0,g.jsx)(k,{record:t,onEditIconClick:a,reloadTableData:i,permissions:d})}}]);return(0,g.jsx)("div",{className:u.Z.antdTableWrapper,children:(0,g.jsx)(j.Z,{sticky:!0,dataSource:t,columns:c,scroll:{x:991},loading:n,rowKey:function(e){return"project-type-".concat(e.id)},pagination:{current:null===r||void 0===r?void 0:r.page,total:null===r||void 0===r?void 0:r.total,hideOnSinglePage:!0,pageSize:null===r||void 0===r?void 0:r.perPage,onChange:function(e,t){i((0,o.Z)((0,o.Z)({},s),{},{page:e,perPage:t}))}}})})}var N=n(86136),A=n(18515),I=n(23901),S=n(54060),L=n(29079),R=n(42623),T=[{text:"Home",isLink:!0,path:"/"},{isLink:!1,text:"Company Assets"}];var z=function(){var e=(0,v.aY)(I.I),t=(0,P.v9)((function(e){return e.usersReducer})).userPermissions,n=t.readCompanyAsset,r=t.createCompanyAsset,d=t.updateCompanyAsset,c=(0,i.useState)({code:void 0,assetName:void 0,type:void 0,page:1,perPage:10}),u=(0,a.Z)(c,2),p=u[0],m=u[1],f=(0,i.useState)({editType:"new",recordId:0,openModal:!1}),y=(0,a.Z)(f,2),j=y[0],b=y[1],C=(0,R.N)(p.assetName,500);(0,i.useEffect)((function(){F(p)}),[C]);var k=new h.S,z=(0,L.$5)({method:k.getAllRecords,initialQuery:(0,o.Z)({},p)}),D=z.data,F=z.onRefresh,E=(z.setData,z.loading),q=z.meta,M=function(){!1!==r?b((0,o.Z)((0,o.Z)({},j),{},{openModal:!j.openModal,editType:"new"})):s.ZP.error("You don't have permission to create new record")};return(0,g.jsxs)(S.Z,{permissionSlug:e,children:[(0,g.jsx)(l.mr,{heading:"Company Assets",buttonText:"Add Asset",onButtonClick:M,breadCrumbData:T,showAdd:!0===r,filters:(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{children:(0,g.jsx)(N.Z,{type:"input",placeholder:"Asset Name",name:"assetName",onChange:function(e){var t=(0,o.Z)((0,o.Z)({},p),{},{assetName:e.target.value});m(t)},value:p.assetName,allowClear:!0,style:{border:"1.5px solid var(--color-border)",borderRadius:"0.25rem"},prefix:(0,g.jsx)("img",{style:{padding:"0rem 0.5rem"},src:"/images/searchIcon.svg",alt:""})})}),(0,g.jsx)("div",{children:(0,g.jsx)(l.Xy,{type:"input",label:"Code",name:"code",withSearch:!1,onChange:function(e){var t=(0,o.Z)((0,o.Z)({},p),{},{code:e.target.value});m(t)},value:p.code,onReset:function(){var e=(0,o.Z)((0,o.Z)({},p),{},{code:void 0});m(e),F(e)},onUpdate:function(){return F(p)}})}),(0,g.jsx)("div",{children:(0,g.jsx)(l.Xy,{type:"radio",label:"Type",name:"type",withSearch:!1,options:Object.entries(Z.mm).map((function(e){var t=(0,a.Z)(e,2),n=t[0],o=t[1];return{label:(0,v.kC)(null===n||void 0===n?void 0:n.replaceAll("_"," ")),value:o}})),onChange:function(e){var t=(0,o.Z)((0,o.Z)({},p),{},{type:e.target.value});m(t)},value:p.type,onReset:function(){var e=(0,o.Z)((0,o.Z)({},p),{},{type:void 0});m(e),F(e)},onUpdate:function(){return F(p)}})})]})}),!0===n&&(0,g.jsx)(w,{tableData:D,tableLoading:E,onEditIconClick:function(e){!1!==d?b((0,o.Z)((0,o.Z)({},j),{},{editType:"edit",recordId:e.id,openModal:!0})):s.ZP.error("You don't have permission to update this record")},reloadTableData:F,meta:q,filters:p}),!1===n&&(0,g.jsx)(A.a$,{mainMessage:"You don't have permission to view this data"}),j.openModal&&(0,g.jsx)(x,{record:j.recordId,type:j.editType,reloadTableData:function(){return F()},onCancel:M,openModal:j.openModal,permissions:t})]})}},64217:function(e,t,n){n.d(t,{S:function(){return r}});var o=n(43144),a=n(15671),i=n(49075),r=(0,o.Z)((function e(){var t=this;(0,a.Z)(this,e),this.endPoint="company-asset",this.getAllRecords=function(e){return i.Z.get(t.endPoint,{params:e})},this.getCars=function(e){return i.Z.get(t.endPoint+"/findCompanyCars",{params:e})},this.getRecordById=function(e){return i.Z.get("".concat(t.endPoint,"/").concat(e))},this.deleteRecord=function(e){return i.Z.delete("".concat(t.endPoint,"/").concat(e))},this.createRecord=function(e){return i.Z.post(t.endPoint,e)},this.updateRecord=function(e,n){return i.Z.patch("".concat(t.endPoint,"/").concat(n),e)},this.allocateResources=function(e){return i.Z.post("".concat(t.endPoint,"/allocate"),e)},this.revokeResources=function(e){return i.Z.delete("".concat(t.endPoint,"/revoke/").concat(e))}}))}}]);