"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[1786],{70815:function(e,n,t){t.d(n,{r:function(){return p}});var a=t(1413),r=t(29439),o=t(45987),i=t(55291),s=t(86345),d=t(47313),c=t(40169),l=t(46417),u=["onChange","checked","recordId","allowChange"],p=function(e){var n=e.onChange,t=e.checked,p=e.recordId,f=e.allowChange,m=void 0===f||f,h=(0,o.Z)(e,u),Z=(0,d.useState)({loading:!1,checked:!1}),g=(0,r.Z)(Z,2),x=g[0],S=g[1];return(0,d.useEffect)((function(){S((0,a.Z)((0,a.Z)({},x),{},{checked:t}))}),[t]),(0,l.jsx)(s.Z,{checked:x.checked,onChange:function(e){!0===m?(S((0,a.Z)((0,a.Z)({},x),{},{loading:!0})),n(e,p,h).then((function(n){S((0,a.Z)((0,a.Z)({},x),{},{checked:e,loading:!1})),i.ZP.success(n.data.message)})).catch((function(e){S((0,a.Z)((0,a.Z)({},x),{},{loading:!1}));var n=(0,c.P)(e);"string"===typeof n.message?i.ZP.error(n.message):i.ZP.error("Something went wrong")}))):i.ZP.error("You don't have permission to change this record, please contact your admin.")},loading:x.loading})}},91786:function(e,n,t){t.r(n),t.d(n,{default:function(){return Y}});var a=t(1413),r=t(29439),o=t(47313),i=t(7532),s=t(25019),d=t(55291),c=t(82626),l=t(17327),u=t(49355),p=t(46646),f=t(40169),m=t(99396),h=t(59816),Z=t(3798),g=t(37936),x=t(46417),S=function(e){var n=e.openModal,t=e.onCancel,i=e.type,S=e.record,v=e.reloadTableData,j=e.permissions,P=j.createSMS,b=j.updateSMS,k=s.Z.useForm(),y=(0,r.Z)(k,1)[0],w=(0,o.useMemo)((function(){return new h.Y}),[]),C=(0,o.useMemo)((function(){return new m.e}),[]),I=(0,o.useState)([]),M=(0,r.Z)(I,2),D=M[0],T=M[1],A=(0,o.useState)(),L=(0,r.Z)(A,2),N=L[0],R=L[1],E=function(e){var n=(0,f.P)(e);if("string"==typeof n.message)R((0,a.Z)((0,a.Z)({},N),{},{error:n.message}));else{var t=(0,p.O)(n.message,[]);y.setFields(t),R((0,a.Z)((0,a.Z)({},N),{},{error:""}))}},z=(0,o.useCallback)((function(){C.getRecordById(S).then((function(e){e.data&&e.data.data&&(y.setFieldsValue((0,a.Z)((0,a.Z)({},e.data.data),{},{isPublished:e.data.data.isPublished,test:e.data.data.test})),R((0,a.Z)((0,a.Z)({},e.data),{},{loading:!1})))})).catch((function(e){E(e)}))}),[y,S,C]),Y=(0,o.useCallback)((function(){w.getAllRecords().then((function(e){e.data&&e.data.data&&T(e.data.data)}))}),[w]);(0,o.useEffect)((function(){"edit"===i?(R({loading:!0}),z(),Y()):(Y(),y.resetFields())}),[n,i,y,z,Y]);return(0,x.jsx)(c.P0,{visible:n,closable:!0,onCancel:t,titleText:"edit"===i?"Edit SMS Config":"Add New SMS Config",showFooter:!1,children:null!==N&&void 0!==N&&N.loading?(0,x.jsx)(u.Z,{items:10}):(0,x.jsxs)(s.Z,{className:l.Z.form,onFinish:function(e){R((0,a.Z)((0,a.Z)({},N),{},{buttonLoading:!0}));var n=(0,Z.Dm)(e.gateway);switch(i){case"edit":!0===b?C.updateRecord((0,a.Z)((0,a.Z)({},e),{},{gateway:n}),null===N||void 0===N?void 0:N.data.id).then((function(e){v(),t(),R((function(e){return(0,a.Z)((0,a.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){E(e),R((function(e){return(0,a.Z)((0,a.Z)({},e),{},{buttonLoading:!1})}))})):(R((function(e){return(0,a.Z)((0,a.Z)({},e),{},{buttonLoading:!1})})),d.ZP.error("You don't have permission to update this record"));break;case"new":!0===P?C.createRecord((0,a.Z)((0,a.Z)({},e),{},{gateway:n})).then((function(e){v(),t(),R((function(e){return(0,a.Z)((0,a.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){E(e),R((function(e){return(0,a.Z)((0,a.Z)({},e),{},{buttonLoading:!1})}))})):(R((function(e){return(0,a.Z)((0,a.Z)({},e),{},{buttonLoading:!1})})),d.ZP.error("You don't have permission to create this record"))}},form:y,children:[(null===N||void 0===N?void 0:N.error)&&(0,x.jsx)(c.EQ,{description:null===N||void 0===N?void 0:N.error,isClosable:!0,onClose:function(){R((0,a.Z)((0,a.Z)({},N),{},{error:""}))}}),(0,x.jsx)("div",{children:(0,x.jsx)(s.Z.Item,{name:"title",rules:[{required:!0,message:"Please add SMS config title"}],children:(0,x.jsx)(c.t7,{size:"w100",label:"Title",asterisk:!0,type:"text"})})}),(0,x.jsxs)("div",{children:[(0,x.jsx)(s.Z.Item,{name:"slug",rules:[{required:!0,message:"Please select SMS config slug"}],children:(0,x.jsx)(c.AP,{label:"Slug",placeholder:"Please select a slug",options:[],asterisk:!0})}),(0,x.jsx)(s.Z.Item,{name:"gateway",rules:[{required:!0,message:"Please add SMS gateway url "}],children:(0,x.jsx)(c.t7,{size:"w100",label:"SMS Gateway",asterisk:!0,type:"text"})})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)(s.Z.Item,{name:"senderId",rules:[{required:!0,message:"Please add sender id"}],children:(0,x.jsx)(c.t7,{size:"w100",label:"Sender ID",asterisk:!0,type:"text"})}),(0,x.jsx)(s.Z.Item,{name:"senderIdType",rules:[{required:!0,message:"Please select sender id type"}],children:(0,x.jsx)(c.AP,{label:"Sender Id Type",options:Object.entries(g.GF).map((function(e){var n=(0,r.Z)(e,2);return{label:n[0],value:n[1]}})),asterisk:!0})})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)(s.Z.Item,{name:"appId",rules:[{required:!0,message:"Please add app id"}],children:(0,x.jsx)(c.t7,{size:"w100",label:"App ID",asterisk:!0,type:"text"})}),(0,x.jsx)(s.Z.Item,{name:"appPassword",rules:[{required:!0,message:"Please add app password"}],children:(0,x.jsx)(c.t7,{size:"w100",label:"App Password",asterisk:!0,type:"text"})})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)(s.Z.Item,{name:"countryId",rules:[{required:!0,message:"Please Select a country!"}],children:(0,x.jsx)(c.AP,{label:"Country",placeholder:"Please select country",options:null===D||void 0===D?void 0:D.map((function(e){return{label:e.name,value:e.id}})),asterisk:!0})}),(0,x.jsx)(s.Z.Item,{name:"priority",rules:[{required:!0,message:"Please add priority"}],children:(0,x.jsx)(c.t7,{size:"w100",label:"Priority",asterisk:!0,type:"text"})})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)(s.Z.Item,{name:"test",children:(0,x.jsx)(c.AP,{label:"Test",options:[{value:!0,label:"Yes"},{value:!1,label:"No"}]})}),(0,x.jsx)(s.Z.Item,{name:"isPublished",children:(0,x.jsx)(c.AP,{label:"Published",options:[{value:!0,label:"Yes"},{value:!1,label:"No"}]})})]}),(0,x.jsxs)("div",{className:l.Z.footer,children:[(0,x.jsx)(c.op,{size:"normal",fontSize:"sm",onClick:t,type:"plain",children:"Cancel"}),(0,x.jsx)(c.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:null===N||void 0===N?void 0:N.buttonLoading,children:"Submit"})]})]})})},v=t(4942),j=t(74165),P=t(15861),b=t(8570),k=t(5900),y=t(41586),w=t(98676),C=t(3109),I=t(70815),M=t(32147),D=t(98505),T=t(85554),A=b.Z.Paragraph,L=function(e){var n=e.record,t=e.onEditIconClick,i=e.reloadTableData,s=e.permissions.deleteSMS,c=(0,o.useState)({confirmLoading:!1,openPopConfirm:!1}),u=(0,r.Z)(c,2),p=u[0],f=u[1],h=(0,o.useMemo)((function(){return new m.e}),[]);return(0,x.jsxs)("div",{className:l.Z.actions,children:[(0,x.jsx)("span",{onClick:function(){return t(n)},children:(0,x.jsx)("img",{src:"/images/editicon.svg",alt:""})}),(0,x.jsx)(k.Z,{open:p.openPopConfirm,placement:"top",title:"Are you sure?",onConfirm:function(){if(f((0,a.Z)((0,a.Z)({},p),{},{confirmLoading:!0})),!1===s)return d.ZP.error("You don't have permission to delete this record, please contact your admin."),void f((0,a.Z)((0,a.Z)({},p),{},{openPopConfirm:!1}));h.deleteRecord(n.id).then((function(e){f((0,a.Z)((0,a.Z)({},p),{},{openPopConfirm:!1,confirmLoading:!1})),i()})).catch((function(e){var n,t;f((0,a.Z)((0,a.Z)({},p),{},{confirmLoading:!1})),d.ZP.error(null===e||void 0===e||null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.message)}))},onCancel:function(){return f((0,a.Z)((0,a.Z)({},p),{},{openPopConfirm:!1}))},okButtonProps:{loading:p.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:function(e){e||f((0,a.Z)((0,a.Z)({},p),{},{openPopConfirm:!1}))},children:(0,x.jsx)(w.Z,{className:l.Z.bg__red,onClick:function(){f((0,a.Z)((0,a.Z)({},p),{},{openPopConfirm:!0}))}})})]})};function N(e){var n=e.tableData,t=e.tableLoading,i=e.onEditIconClick,s=e.reloadTableData,d=(0,T.v9)((function(e){return e.usersReducer})).userPermissions,c=new m.e,u=function(){var e=(0,P.Z)((0,j.Z)().mark((function e(n,t){var a,r;return(0,j.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.makeDefault(t);case 2:return(r=e.sent)&&null!==r&&void 0!==r&&null!==(a=r.data)&&void 0!==a&&a.data&&s(),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),p=function(e,n){return c.updateRecord({isPublished:e},n)},f=function(e,n){return c.updateRecord({test:e},n)},h=(0,o.useState)({}),Z=(0,r.Z)(h,2),g=Z[0],S=Z[1],b=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,n,t){return t+1},width:"6%"},{title:"Title",dataIndex:"title",key:"title",render:function(e,n){return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(C.Z,{color:"dark-main",size:"normal",children:e}),(0,x.jsx)(C.Z,{color:"dark-main",size:"xs",className:"my-1",children:"Slug: ".concat(n.slug)}),(0,x.jsx)(C.Z,{color:"dark-main",size:"xs",children:"Gateway: ".concat(n.gateway)}),(0,x.jsxs)("div",{className:"d-flex mt-1",children:[(0,x.jsx)(M.$$,{className:"mr-2"}),(0,x.jsx)(C.Z,{color:"dark-sub",size:"sm",children:"".concat((0,D.Ny)(n.addedDate,"dd MM yy"))})]})]})},width:"20%"},{title:"Sender ID",dataIndex:"senderId",key:"senderId",render:function(e,n){return(0,x.jsx)(C.Z,{color:"dark-main",size:"sm",children:"".concat(e," (").concat(n.senderIdType,")")})}},{title:"App",dataIndex:"appId",key:"appId",render:function(e,n){return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(C.Z,{color:"dark-main",size:"sm",className:"mb-1",children:"ID: ".concat(e)}),g[n.id]?(0,x.jsxs)("div",{className:"d-flex align-center",children:[(0,x.jsx)(M.ON,{close:!0,onClick:function(){return S((0,a.Z)((0,a.Z)({},g),{},(0,v.Z)({},n.id,!1)))},className:"mr-2 cursor-pointer"}),(0,x.jsxs)(A,{ellipsis:{rows:2,expandable:!1},copyable:{text:n.appPassword},className:"font-size-sm color-dark-main pa-0 ma-0",children:["Password: ",n.appPassword]})]}):(0,x.jsxs)("div",{className:"d-flex align-center",children:[(0,x.jsx)(M.ON,{onClick:function(){return S((0,a.Z)((0,a.Z)({},g),{},(0,v.Z)({},n.id,!0)))},className:"mr-2 cursor-pointer"}),(0,x.jsx)(A,{ellipsis:{rows:2,expandable:!1},className:"font-size-sm color-dark-main pa-0 ma-0",children:"Password: ".concat(n.appPassword.replace(/./g,"*"))})]})]})},width:"15%"},{title:"Default",dataIndex:"isDefault",key:"isDefault",render:function(e,n){return(0,x.jsx)(I.r,{checked:e,onChange:u,recordId:n.id,allowChange:d.makeDefault})}},{title:"Test",dataIndex:"test",key:"test",render:function(e,n){return(0,x.jsx)(I.r,{checked:e,onChange:f,recordId:n.id,allowChange:d.updateSMS})}},{title:"Published",dataIndex:"isPublished",key:"isPublished",render:function(e,n){return(0,x.jsx)(I.r,{checked:e,onChange:p,recordId:n.id,allowChange:d.updateSMS})}},{title:"Actions",dataIndex:"actions",key:"actions",render:function(e,n){return(0,x.jsx)(L,{record:n,onEditIconClick:i,reloadTableData:s,permissions:d})}}];return(0,x.jsx)("div",{className:l.Z.antdTableWrapper,children:(0,x.jsx)(y.Z,{sticky:!0,dataSource:n,columns:b,pagination:!1,scroll:{x:991},loading:t,rowKey:function(e){return"site-SMS-".concat(e.id)}})})}var R=function(e){return e.CREATE="createSMS",e.UPDATE="updateSMS",e.DELETE="deleteSMS",e.READ="readSMS",e.MAKE_DEFAULT="makeDefault",e.READ_LOGS="readSMSLogs",e}({}),E=t(18515),z=[{text:"Home",isLink:!0,path:"/"},{isLink:!0,text:"Site Settings",path:"/siteSettings"},{isLink:!1,text:"SMS Configuration"}];var Y=function(){var e=(0,Z.aY)(R),n=(0,T.v9)((function(e){return e.usersReducer})).userPermissions,t=n.readSMS,s=n.createSMS,l=n.updateSMS,u=(0,o.useState)({editType:"new",recordId:0,openModal:!1}),p=(0,r.Z)(u,2),f=p[0],h=p[1],g=new m.e,v=(0,o.useState)({data:[]}),j=(0,r.Z)(v,2),P=j[0],b=j[1],k=function(){!1!==s?h((0,a.Z)((0,a.Z)({},f),{},{openModal:!f.openModal,editType:"new"})):d.ZP.error("You don't have permission to create new record")},y=function(){b((0,a.Z)((0,a.Z)({},P),{},{loading:!0})),g.getAllRecords().then((function(e){b(e.data)})).catch((function(e){}))};return(0,o.useEffect)((function(){y()}),[]),(0,x.jsxs)(i.default,{permissionSlug:e,children:[(0,x.jsx)(c.mr,{heading:"SMS Configuration",buttonText:"Add New SMS Config",onButtonClick:k,breadCrumbData:z,showAdd:!0===s}),!0===t&&(0,x.jsx)(N,{tableData:P.data,tableLoading:P.loading,onEditIconClick:function(e){!1!==l?h((0,a.Z)((0,a.Z)({},f),{},{editType:"edit",recordId:e.id,openModal:!0})):d.ZP.error("You don't have permission to update record")},reloadTableData:y}),!1===t&&(0,x.jsx)(E.a$,{mainMessage:"You don't have permission to view this data"}),f.openModal&&(0,x.jsx)(S,{record:f.recordId,type:f.editType,reloadTableData:y,onCancel:k,openModal:f.openModal,permissions:n})]})}},59816:function(e,n,t){t.d(n,{Y:function(){return s}});var a=t(43144),r=t(15671),o=t(49075),i=t(3135),s=(0,a.Z)((function e(){var n=this;(0,r.Z)(this,e),this.endPoint="country",this.allEndpoint="country/all",this.getAllRecords=function(){return o.Z.get(n.allEndpoint)},this.getAvailableRecords=function(){return o.Z.get("".concat(n.endPoint,"/available-country"))},this.getRecordById=function(e){return o.Z.get("".concat(n.endPoint,"/").concat(e))},this.deleteRecord=function(e){return o.Z.delete("".concat(n.endPoint,"/").concat(e))},this.createRecord=function(e){return o.Z.post(n.endPoint+"/",e,{headers:i.C})},this.updateRecord=function(e,t){return o.Z.patch("".concat(n.endPoint,"/").concat(t),e,{headers:i.C})}}))},99396:function(e,n,t){t.d(n,{e:function(){return i}});var a=t(43144),r=t(15671),o=t(49075),i=(0,a.Z)((function e(){var n=this;(0,r.Z)(this,e),this.endPoint="sms",this.getAllRecords=function(){return o.Z.get(n.endPoint)},this.getRecordById=function(e){return o.Z.get("".concat(n.endPoint,"/").concat(e))},this.deleteRecord=function(e){return o.Z.delete("".concat(n.endPoint,"/").concat(e))},this.createRecord=function(e){return o.Z.post(n.endPoint+"/",e)},this.updateRecord=function(e,t){return o.Z.patch("".concat(n.endPoint,"/").concat(t),e)},this.makeDefault=function(e){return o.Z.patch("".concat(n.endPoint,"/makeDefaultSMSGateway/").concat(e))},this.getLogs=function(e){return o.Z.get("".concat(n.endPoint,"/readSmsSentLogs"),{params:e})}}))}}]);