"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[4575],{14575:function(e,n,t){t.r(n),t.d(n,{default:function(){return S}});var o=t(1413),i=t(29439),a=t(47313),r=t(67194),d=t(41586),l=t(3109),s=t(3113),c=t(85554),u=t(55291),p=t(5900),h=t(98676),m=t(48297),f=t(46417),v=function(e){var n=e.record,t=e.onEditIconClick,r=e.reloadTableData,d=e.permissions.deleteClient,l=(0,a.useState)({confirmLoading:!1,openPopConfirm:!1}),c=(0,i.Z)(l,2),v=c[0],Z=c[1],g=(0,a.useMemo)((function(){return new m.V}),[]);return(0,f.jsxs)("div",{className:s.Z.actions,children:[(0,f.jsx)("span",{onClick:function(){return t(n)},children:(0,f.jsx)("img",{src:"/images/editicon.svg",alt:""})}),(0,f.jsx)(p.Z,{open:v.openPopConfirm,placement:"top",title:"Are you sure?",onConfirm:function(){if(Z((0,o.Z)((0,o.Z)({},v),{},{confirmLoading:!0})),!1===d)return u.ZP.error("You don't have permission to delete this record, please contact your admin."),void Z((0,o.Z)((0,o.Z)({},v),{},{openPopConfirm:!1}));g.deleteRecord(n.id).then((function(e){Z((0,o.Z)((0,o.Z)({},v),{},{openPopConfirm:!1,confirmLoading:!1})),r()})).catch((function(e){Z((0,o.Z)((0,o.Z)({},v),{},{confirmLoading:!1}))}))},onCancel:function(){return Z((0,o.Z)((0,o.Z)({},v),{},{openPopConfirm:!1}))},okButtonProps:{loading:v.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:function(e){e||Z((0,o.Z)((0,o.Z)({},v),{},{openPopConfirm:!1}))},children:(0,f.jsx)(h.Z,{className:s.Z.bg__red,onClick:function(){Z((0,o.Z)((0,o.Z)({},v),{},{openPopConfirm:!0}))}})})]})},Z=t(2135);function g(e){var n=e.tableData,t=e.tableLoading,i=e.onEditIconClick,a=e.reloadTableData,r=e.meta,u=e.filters,p=(0,c.v9)((function(e){return e.usersReducer})).userPermissions,h=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,n,t){return t+1},width:"5%"},{title:"Name",dataIndex:"name",key:"name",render:function(e,n){return(0,f.jsx)(Z.rU,{to:"/clients/".concat(null===n||void 0===n?void 0:n.uuid,"?id=").concat(null===n||void 0===n?void 0:n.id),children:(0,f.jsx)(l.Z,{color:"dark-main",size:"sm",children:e})})}},{title:"Phone",dataIndex:"phone",key:"phone",render:function(e,n){return(0,f.jsx)(l.Z,{color:"dark-main",size:"sm",children:["0","undefined",null].includes(e)?"-":n.phoneCode+e})}},{title:"Email",dataIndex:"email",key:"email",render:function(e){return(0,f.jsx)(l.Z,{color:"dark-main",size:"sm",children:e})}},{title:"Actions",dataIndex:"actions",key:"actions",render:function(e,n){return(0,f.jsx)(v,{record:n,onEditIconClick:i,reloadTableData:a,permissions:p})}}];return(0,f.jsx)("div",{className:s.Z.antdTableWrapper,children:(0,f.jsx)(d.Z,{sticky:!0,dataSource:n,columns:h,scroll:{x:991},loading:t,rowKey:function(e){return"client-".concat(e.id)},pagination:{current:null===r||void 0===r?void 0:r.page,total:null===r||void 0===r?void 0:r.total,hideOnSinglePage:!0,pageSize:null===r||void 0===r?void 0:r.perPage,onChange:function(e,n){a((0,o.Z)((0,o.Z)({},u),{},{page:e,perPage:n}))}}})})}var x=t(82626),j=t(86136),y=t(18515),b=t(46389),C=t(54060),P=t(37936),I=t(29079),k=t(3798),w=t(42623),R=[{text:"Home",isLink:!0,path:"/"},{isLink:!1,text:"Clients"}];var S=function(){var e=(0,k.aY)(b.r),n=(0,c.v9)((function(e){return e.usersReducer})).userPermissions,t=n.readClient,d=n.createClient,l=n.updateClient,s=(0,a.useState)({name:void 0,type:void 0,email:void 0,phone:void 0,page:1,perPage:10}),p=(0,i.Z)(s,2),h=p[0],v=p[1],Z=(0,w.N)(h.name,500);(0,a.useEffect)((function(){M(h)}),[Z]);var S=(0,a.useState)({editType:"new",recordId:0,openModal:!1}),N=(0,i.Z)(S,2),T=N[0],E=N[1],L=new m.V,z=(0,I.$5)({method:L.getAllRecords,initialQuery:(0,o.Z)({},h)}),A=z.data,M=z.onRefresh,D=(z.setData,z.loading),X=z.meta,Y=function(){!1!==d?E((0,o.Z)((0,o.Z)({},T),{},{openModal:!T.openModal,editType:"new"})):u.ZP.error("You don't have permission to create new record")};return(0,f.jsxs)(C.Z,{permissionSlug:e,children:[(0,f.jsx)(x.mr,{heading:"Clients",buttonText:"Add Client",onButtonClick:Y,breadCrumbData:R,showAdd:!0===d,filters:(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{children:(0,f.jsx)(j.Z,{type:"input",placeholder:"Name",name:"name",onChange:function(e){var n=(0,o.Z)((0,o.Z)({},h),{},{name:e.target.value});v(n)},value:h.name,allowClear:!0,style:{border:"1.5px solid var(--color-border)",borderRadius:"0.25rem"},prefix:(0,f.jsx)("img",{style:{padding:"0rem 0.5rem"},src:"/images/searchIcon.svg",alt:""})})}),(0,f.jsx)("div",{children:(0,f.jsx)(x.Xy,{type:"email",label:"Email",name:"email",withSearch:!1,onChange:function(e){var n=(0,o.Z)((0,o.Z)({},h),{},{email:e.target.value});v(n)},value:h.email,onReset:function(){var e=(0,o.Z)((0,o.Z)({},h),{},{email:void 0});v(e),M(e)},onUpdate:function(){return M(h)}})}),(0,f.jsx)("div",{children:(0,f.jsx)(x.Xy,{type:"input",label:"Phone",name:"phone",withSearch:!1,onChange:function(e){var n=(0,o.Z)((0,o.Z)({},h),{},{phone:e.target.value});v(n)},value:h.phone,onReset:function(){var e=(0,o.Z)((0,o.Z)({},h),{},{phone:void 0});v(e),M(e)},onUpdate:function(){return M(h)}})}),(0,f.jsx)("div",{children:(0,f.jsx)(x.Xy,{type:"radio",label:"Type",name:"type",withSearch:!1,options:Object.entries(P.IX).map((function(e){var n=(0,i.Z)(e,2),t=n[0],o=n[1];return{label:(0,k.kC)(t),value:o}})),onChange:function(e){var n=(0,o.Z)((0,o.Z)({},h),{},{type:e.target.value});v(n)},value:h.type,onReset:function(){var e=(0,o.Z)((0,o.Z)({},h),{},{type:void 0});v(e),M(e)},onUpdate:function(){return M(h)}})})]})}),!0===t&&(0,f.jsx)(g,{tableData:A,tableLoading:D,onEditIconClick:function(e){!1!==l?E((0,o.Z)((0,o.Z)({},T),{},{editType:"edit",recordId:e.id,openModal:!0})):u.ZP.error("You don't have permission to update this record")},reloadTableData:M,meta:X,filters:h}),!1===t&&(0,f.jsx)(y.a$,{mainMessage:"You don't have permission to view this data"}),T.openModal&&(0,f.jsx)(r.i,{record:T.recordId,type:T.editType,reloadTableData:function(){return M()},onCancel:Y,openModal:T.openModal,permissions:n})]})}},67194:function(e,n,t){t.d(n,{i:function(){return w}});var o=t(45987),i=t(1413),a=t(93433),r=t(29439),d=t(31513),l=t(25019),s=t(55291),c=t(39180),u=t(14254),p=t(98276),h=t(82626),m=t(3113),f=t(49355),v=t(47313),Z=t(3798),g=t(46646),x=t(40169),j=t(48297),y=t(59816),b=t(42623),C=t(37936),P=t(46417),I=["phoneCode","phone"],k=d.Z.Option,w=function(e){var n,t=e.openModal,w=e.onCancel,R=e.type,S=e.record,N=e.reloadTableData,T=e.permissions,E=T.createClient,L=T.updateClient,z=e.callback,A=l.Z.useForm(),M=(0,r.Z)(A,1)[0],D=new j.V,X=(0,v.useMemo)((function(){return new y.Y}),[]),Y=(0,v.useState)(),F=(0,r.Z)(Y,2),V=F[0],B=F[1],O=(0,v.useState)(),H=(0,r.Z)(O,2),U=H[0],_=H[1],q=(0,v.useState)(""),W=(0,r.Z)(q,2),Q=W[0],$=W[1],G=(0,b.N)(Q,500),K=(0,v.useState)([]),J=(0,r.Z)(K,2),ee=J[0],ne=J[1],te=(0,v.useCallback)((function(){G&&D.findPublished({name:G,type:1}).then((function(e){ne((function(n){var t,o,i=null===e||void 0===e||null===(t=e.data)||void 0===t||null===(o=t.data)||void 0===o?void 0:o.filter((function(e){return!(null!==n&&void 0!==n&&n.find((function(n){return n.id===e.id})))}));return[].concat((0,a.Z)(n),(0,a.Z)(i))}))})).catch((function(e){s.ZP.error(e.response.data.message)}))}),[G]);(0,v.useEffect)((function(){te()}),[te]);var oe=(0,v.useState)([]),ie=(0,r.Z)(oe,2),ae=ie[0],re=ie[1],de=(0,v.useCallback)((function(){X.getAvailableRecords().then((function(e){e.data&&e.data.data&&re(e.data.data)}))}),[X]),le=function(e){var n=(0,x.P)(e);if("string"==typeof n.message)B((0,i.Z)((0,i.Z)({},V),{},{error:n.message}));else{var t=(0,g.O)(n.message,[]);M.setFields(t),B((0,i.Z)((0,i.Z)({},V),{},{error:""}))}},se=(0,v.useCallback)((function(){D.getRecordById(S).then((function(e){if(e.data&&e.data.data){var n,t,o=e.data.data.type,a=null===e||void 0===e||null===(n=e.data)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.companyId;M.setFieldsValue((0,i.Z)((0,i.Z)({},e.data.data),{},{type:1===o?C.IX.company:C.IX.individual})),B((0,i.Z)((0,i.Z)({},e.data),{},{loading:!1})),_(1===o?C.IX.company:C.IX.individual),a&&D.getRecordById(a).then((function(e){var n;ne([null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.data])})).catch((function(e){s.ZP.error(e.response.data.message)}))}})).catch((function(e){le(e)}))}),[M,S,D]);(0,v.useEffect)((function(){"edit"===R?(B({loading:!0}),se(),de()):(M.resetFields(),de())}),[]);return(0,P.jsx)(h.P0,{visible:t,closable:!0,onCancel:w,titleText:"edit"===R?"Edit Client":"Add New Client",showFooter:!1,children:null!==V&&void 0!==V&&V.loading?(0,P.jsx)(f.Z,{items:3}):(0,P.jsxs)(l.Z,{className:m.Z.form,onFinish:function(e){B((0,i.Z)((0,i.Z)({},V),{},{buttonLoading:!0}));var n=e.phoneCode,t=e.phone,a=(0,o.Z)(e,I);switch(R){case"edit":!0===L?D.updateRecord((0,i.Z)((0,i.Z)({},a),{},{type:e.type,phoneCode:n&&t?String(n):void 0,phone:String(t)}),S).then((function(e){N(),w(),B((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){le(e),B((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})}))})):(B((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})})),s.ZP.error("You don't have permission to update this record"));break;case"new":!0===E?D.createRecord((0,i.Z)((0,i.Z)({},a),{},{type:e.type,phoneCode:n&&t?String(n):void 0,phone:t?String(t):void 0})).then((function(e){var n=(null===e||void 0===e?void 0:e.data).data;N(),z&&z(null===n||void 0===n?void 0:n.id),w(),B((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){le(e),B((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})}))})):(B((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})})),s.ZP.error("You don't have permission to create this record"))}},form:M,children:[(null===V||void 0===V?void 0:V.error)&&(0,P.jsx)(h.EQ,{description:null===V||void 0===V?void 0:V.error,isClosable:!0,onClose:function(){B((0,i.Z)((0,i.Z)({},V),{},{error:""}))}}),(0,P.jsxs)("label",{children:["Client Type",(0,P.jsx)(l.Z.Item,{name:"type",rules:[{required:!0,message:"Please select an option"}],children:(0,P.jsx)(c.ZP.Group,{onChange:function(e){var n=e.target.value;_(n)},value:U,children:Object.entries(C.IX).map((function(e){var n=(0,r.Z)(e,2),t=n[0],o=n[1];return(0,P.jsx)(c.ZP,{value:o,children:(0,Z.kC)(t)},t)}))})})]}),(0,P.jsxs)("div",{children:[(0,P.jsx)(l.Z.Item,{name:"name",rules:[{required:!0,message:"Please add a name"}],children:(0,P.jsx)(h.t7,{size:"w100",label:"Name",asterisk:!0,type:"text",placeHolder:"Enter client name"})}),(0,P.jsx)(l.Z.Item,{name:"address",children:(0,P.jsx)(h.t7,{size:"w100",label:"Address",type:"text"})})]}),(0,P.jsxs)("div",{children:[(0,P.jsx)(l.Z.Item,{name:"email",rules:[{required:!0,message:"Please add email"},{type:"email",message:"Please add valid email"}],children:(0,P.jsx)(h.t7,{asterisk:!0,size:"w100",label:"Email",type:"email"})}),(0,P.jsx)("div",{children:(0,P.jsxs)("label",{className:"font-size-sm",children:["Phone",(0,P.jsx)(l.Z.Item,{name:"phone",children:(0,P.jsx)(u.Z,{type:"number",addonBefore:(0,P.jsx)(l.Z.Item,{name:"phoneCode",style:{marginBottom:0},initialValue:"971",children:(0,P.jsx)(d.Z,{style:{width:98},placeholder:"Select phone code",defaultValue:"971",children:null===ae||void 0===ae?void 0:ae.map((function(e){return(0,P.jsxs)(k,{value:e.phoneCode,children:[(0,P.jsx)("span",{children:e.flag}),(0,P.jsx)("span",{className:"ml-1",children:"+".concat(e.phoneCode)})]})}))})}),placeholder:"Enter phone number",controls:!1})})]})})]}),(0,P.jsx)("div",{children:(0,P.jsx)(l.Z.Item,{name:"taxRegistrationNumber",children:(0,P.jsx)(h.t7,{label:"Tax Registration Number",placeHolder:"Enter Tax RegistrationNumber Number",size:"w100"})})}),(0,P.jsxs)("div",{children:[(0,P.jsx)(l.Z.Item,{name:"whatsapp",children:(0,P.jsx)(h.t7,{label:"WhatsApp Number",placeHolder:"Enter WhatsApp Number",size:"w100"})}),U===C.IX.individual&&(0,P.jsx)("div",{children:(0,P.jsxs)(l.Z.Item,{name:"companyId",children:[(0,P.jsx)("label",{className:"font-size-sm",children:"Company"}),(0,P.jsx)(d.Z,{allowClear:!0,style:{width:"100%"},defaultValue:null===V||void 0===V||null===(n=V.data)||void 0===n?void 0:n.companyId,placeholder:"Search for the company",className:"selectAntdCustom",onChange:function(e){return M.setFieldsValue({companyId:e})},showSearch:!0,onSearch:function(e){return $(e)},optionFilterProp:"label",options:null===ee||void 0===ee?void 0:ee.map((function(e){return{label:e.name,value:e.id}})),notFoundContent:(0,P.jsx)(p.Z,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:100},description:(0,P.jsx)("span",{children:"No data found, Please search for the company"})})})]})})]}),(0,P.jsxs)("div",{className:"d-flex justify-end",children:[(0,P.jsx)(h.op,{size:"normal",fontSize:"sm",onClick:w,type:"plain",children:"Cancel"}),(0,P.jsx)(h.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:null===V||void 0===V?void 0:V.buttonLoading,children:"edit"===R?"Edit Client":"Add Client"})]})]})})}},48297:function(e,n,t){t.d(n,{V:function(){return r}});var o=t(43144),i=t(15671),a=t(49075),r=(0,o.Z)((function e(){var n=this;(0,i.Z)(this,e),this.endPoint="client",this.getAllRecords=function(e){return a.Z.get(n.endPoint,{params:e})},this.getRecordById=function(e){return a.Z.get("".concat(n.endPoint,"/").concat(e))},this.findPublished=function(e){return a.Z.get("".concat(n.endPoint,"/find-published"),{params:e})},this.deleteRecord=function(e){return a.Z.delete("".concat(n.endPoint,"/").concat(e))},this.createRecord=function(e){return a.Z.post(n.endPoint,e)},this.updateRecord=function(e,t){return a.Z.patch("".concat(n.endPoint,"/").concat(t),e)}}))},59816:function(e,n,t){t.d(n,{Y:function(){return d}});var o=t(43144),i=t(15671),a=t(49075),r=t(3135),d=(0,o.Z)((function e(){var n=this;(0,i.Z)(this,e),this.endPoint="country",this.allEndpoint="country/all",this.getAllRecords=function(){return a.Z.get(n.allEndpoint)},this.getAvailableRecords=function(){return a.Z.get("".concat(n.endPoint,"/available-country"))},this.getRecordById=function(e){return a.Z.get("".concat(n.endPoint,"/").concat(e))},this.deleteRecord=function(e){return a.Z.delete("".concat(n.endPoint,"/").concat(e))},this.createRecord=function(e){return a.Z.post(n.endPoint+"/",e,{headers:r.C})},this.updateRecord=function(e,t){return a.Z.patch("".concat(n.endPoint,"/").concat(t),e,{headers:r.C})}}))}}]);