"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[3581],{83581:function(e,n,t){t.r(n),t.d(n,{default:function(){return Ae}});var o=t(1413),a=t(29439),i=t(47313),r=t(7532),s=t(74165),l=t(15861),d=t(93433),c=t(31513),u=t(25019),f=t(55291),v=t(98276),m=t(14254),h=t(82626),p=t(17327),g=t(49355),Z=t(48897),x=t(46646),j=t(40169),y=t(84825),b=t(59816),w=t(42623),C=t(5190),k=t(99420),N=t(46417),P=c.Z.Option,S=function(e){var n,t,r,S,_,z,I,R,D=e.openModal,O=e.onCancel,T=e.type,L=e.record,A=e.reloadTableData,F=e.permissions,M=F.createUser,U=F.updateUser,E=u.Z.useForm(),Y=(0,a.Z)(E,1)[0],B=(0,i.useMemo)((function(){return new y.z}),[]),V=(0,i.useState)(""),H=(0,a.Z)(V,2),W=H[0],q=H[1],X=(0,w.N)(W,500),K=(0,i.useState)([]),G=(0,a.Z)(K,2),J=G[0],Q=G[1],$=(0,i.useMemo)((function(){return new C.L}),[]),ee=(0,i.useMemo)((function(){return new b.Y}),[]),ne=(0,i.useMemo)((function(){return new k.U}),[]),te=(0,i.useState)(),oe=(0,a.Z)(te,2),ae=oe[0],ie=oe[1],re=(0,i.useState)([]),se=(0,a.Z)(re,2),le=se[0],de=se[1],ce=(0,i.useState)([]),ue=(0,a.Z)(ce,2),fe=ue[0],ve=ue[1],me=function(e){var n=(0,j.P)(e);if("string"==typeof n.message)ie((0,o.Z)((0,o.Z)({},ae),{},{error:n.message}));else{var t=(0,x.O)(n.message,[]);Y.setFields(t),ie((0,o.Z)((0,o.Z)({},ae),{},{error:""}))}},he=(0,i.useCallback)((function(){X&&$.findPublished({name:X}).then((function(e){Q((function(n){var t,o,a=null===e||void 0===e||null===(t=e.data)||void 0===t||null===(o=t.data)||void 0===o?void 0:o.filter((function(e){return!(null!==n&&void 0!==n&&n.find((function(n){return n.id===e.id})))}));return[].concat((0,d.Z)(n),(0,d.Z)(a))}))})).catch((function(e){f.ZP.error(e.response.data.message)}))}),[$,X]);(0,i.useEffect)((function(){he()}),[he]);var pe=(0,i.useCallback)((function(){B.getRecordById(L).then((function(e){var n,t,a,i,r=null===e||void 0===e||null===(n=e.data)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.organization;e.data&&e.data.data&&(Y.setFieldsValue((0,o.Z)((0,o.Z)({},e.data.data),{},{translations:e.data.data.localization,isPublished:e.data.data.isPublished,userCountryList:null===(a=e.data.data)||void 0===a||null===(i=a.userCountryList)||void 0===i?void 0:i.map((function(e){return e.countryId})).join(","),organizationId:null===r||void 0===r?void 0:r.id})),ie((0,o.Z)((0,o.Z)({},e.data),{},{loading:!1})));r&&$.getRecordById(r.id).then((function(e){var n;Q([null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.data])})).catch((function(e){f.ZP.error(e.response.data.message)}))})).catch((function(e){me(e)}))}),[Y,L,B,$]),ge=(0,i.useCallback)((function(){"edit"!==T&&"seo"!==T&&ne.getAllRecords().then((function(e){var n,t;e.data&&null!==(n=e.data)&&void 0!==n&&n.data&&ve(null===(t=e.data)||void 0===t?void 0:t.data)})).catch((function(e){me(e)}))}),[ne,T]),Ze=(0,i.useCallback)((function(){ee.getAvailableRecords().then((function(e){e.data&&e.data.data&&de(e.data.data)}))}),[ee]);(0,i.useEffect)((function(){"edit"===T?(ie({loading:!0}),pe(),Ze()):(Ze(),Y.resetFields(),ge())}),[D,T,Y,pe,Ze,ge]);return(0,N.jsx)(h.P0,{visible:D,closable:!0,onCancel:O,titleText:"edit"===T?"Edit User":"Add New User",showFooter:!1,children:null!==ae&&void 0!==ae&&ae.loading?(0,N.jsx)(g.Z,{items:10}):(0,N.jsxs)(u.Z,{className:p.Z.form,onFinish:function(e){var n=e.roleIds;delete e.roleIds,void 0===e.displayOrgContact&&(e.displayOrgContact=!1),ie((0,o.Z)((0,o.Z)({},ae),{},{buttonLoading:!0}));var t=new FormData,a=["profile","translations"];switch(Object.entries(e).forEach((function(e){a.includes(e[0])||t.append(e[0],e[1])})),e.profile&&"string"!==typeof e.profile&&e.profile.fileList.length>0&&t.append("profile",e.profile.fileList[0].originFileObj),e.translations&&e.translations.forEach((function(e,n){t.append("translations[".concat(n+1,"][language]"),e.language),t.append("translations[".concat(n+1,"][title]"),e.title)})),t.append("phoneCode","971"),T){case"edit":var i;if(!0===U)B.updateRecord(t,null===ae||void 0===ae||null===(i=ae.data)||void 0===i?void 0:i.id).then((function(e){A(),O(),ie((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){me(e),ie((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))}));else ie((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})})),f.ZP.error("You don't have permission to update this user");break;case"new":!0===M?B.createRecord(t).then(function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t){var a,i,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null===(a=t.data)||void 0===a||null===(i=a.data)||void 0===i?void 0:i.id,e.next=3,B.addRoles({roleIds:n},r).then((function(e){A(),O(),ie((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){me(e),ie((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))}));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){me(e),ie((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})):(ie((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})})),f.ZP.error("You don't have permission to create a new user"))}},form:Y,children:[(null===ae||void 0===ae?void 0:ae.error)&&(0,N.jsx)(h.EQ,{description:null===ae||void 0===ae?void 0:ae.error,isClosable:!0,onClose:function(){ie((0,o.Z)((0,o.Z)({},ae),{},{error:""}))}}),(0,N.jsx)("div",{children:(0,N.jsxs)(u.Z.Item,{name:"organizationId",rules:[{required:!0,message:"Please select an organization"}],children:[(0,N.jsxs)("label",{className:"font-size-sm",children:["Organization  ",(0,N.jsx)("span",{className:"color-red-yp",children:"*"})]}),(0,N.jsx)(c.Z,{allowClear:!0,style:{width:"100%"},defaultValue:null===ae||void 0===ae||null===(n=ae.data)||void 0===n||null===(t=n.Organization)||void 0===t?void 0:t.id,placeholder:"Search for the organization",className:"selectAntdCustom",onChange:function(e){return Y.setFieldsValue({organizationId:e})},showSearch:!0,onSearch:function(e){return q(e)},optionFilterProp:"label",options:null===J||void 0===J?void 0:J.map((function(e){return{label:e.name,value:e.id}})),notFoundContent:(0,N.jsx)(v.Z,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:100},description:(0,N.jsx)("span",{children:"No data found, Please search for the organization"})})})]})}),(0,N.jsxs)("div",{children:[(0,N.jsx)(u.Z.Item,{name:"firstName",rules:[{required:"new"===T,message:"Please add first name"}],children:(0,N.jsx)(h.t7,{size:"w100",label:"First Name",asterisk:"new"===T,type:"text"})}),(0,N.jsx)(u.Z.Item,{name:"lastName",rules:[{required:"new"===T,message:"Please add last name"}],children:(0,N.jsx)(h.t7,{size:"w100",label:"Last Name",asterisk:"new"===T,type:"text"})})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)(u.Z.Item,{name:"email",rules:[{required:"new"===T,message:"Please add email"},{type:"email",message:"Please add valid email"}],children:(0,N.jsx)(h.t7,{size:"w100",label:"Email",asterisk:"new"===T,type:"email"})}),"new"===T&&(0,N.jsx)(u.Z.Item,{name:"password",rules:[{required:!0,message:"Please add password"},{min:6,message:"Password must be at least 6 characters"}],children:(0,N.jsx)(h.t7,{size:"w100",label:"Password",asterisk:!0,type:"password"})})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("div",{children:(0,N.jsxs)("label",{className:"font-size-sm",children:["Phone  ",(0,N.jsx)("span",{className:"color-red-yp",children:"*"}),(0,N.jsx)(u.Z.Item,{name:"phone",rules:[{required:!0,message:"Please add phone"}],children:(0,N.jsx)(m.Z,{type:"number",addonBefore:(0,N.jsx)(c.Z,{style:{width:98},placeholder:"Select phone code",defaultValue:"new"===T?"971":(null===ae||void 0===ae||null===(r=ae.data)||void 0===r?void 0:r.phoneCode)||"971",children:null===le||void 0===le?void 0:le.map((function(e){return(0,N.jsxs)(P,{value:e.phoneCode,children:[(0,N.jsx)("span",{children:e.flag}),(0,N.jsx)("span",{className:"ml-1",children:"".concat(e.phoneCode)})]})}))}),placeholder:"Enter phone number",defaultValue:"new"===T?"":null===ae||void 0===ae||null===(S=ae.data)||void 0===S?void 0:S.phone,controls:!1})})]})}),(0,N.jsx)(u.Z.Item,{name:"address",rules:[{required:"new"===T,message:"Please add address"}],children:(0,N.jsx)(h.t7,{size:"w100",label:"Address",asterisk:"new"===T,type:"text"})})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)(u.Z.Item,{name:"isPublished",children:(0,N.jsx)(h.AP,{label:"Published",options:[{value:!0,label:"Yes"},{value:!1,label:"No"}]})}),(0,N.jsx)(u.Z.Item,{name:"preferences",children:(0,N.jsx)("div",{className:"pt-1",children:(0,N.jsx)(h.t7,{label:"Preferences",type:"text",size:"w100"})})})]}),"new"===T&&(0,N.jsx)("div",{children:(0,N.jsxs)(u.Z.Item,{name:"roleIds",rules:[{required:!0,message:"Please select at least one role"}],children:[(0,N.jsxs)("label",{className:"font-size-sm",children:["Select Roles ",(0,N.jsx)("span",{className:"color-red-yp",children:"*"})]}),(0,N.jsx)(c.Z,{mode:"multiple",allowClear:!0,style:{width:"100%"},placeholder:"Please select at least one role",className:"selectAntdCustom",onChange:function(e){return Y.setFieldsValue({roleIds:e})},showSearch:!0,optionFilterProp:"label",options:fe.map((function(e){return{label:null===e||void 0===e?void 0:e.title,value:null===e||void 0===e?void 0:e.id}}))}),(0,N.jsx)("p",{className:"mb-0",children:(0,N.jsx)("small",{className:"color-dark-main",children:"Select roles for this user!. You can select multiple roles."})})]})}),(0,N.jsxs)("div",{children:[(0,N.jsx)(u.Z.Item,{name:"whatsapp",children:(0,N.jsx)(h.t7,{label:"WhatsApp Number",placeHolder:"Enter WhatsApp Number",size:"w100"})}),(0,N.jsxs)(u.Z.Item,{name:"displayOrgContact",children:[(0,N.jsx)(h.AP,{label:"Display Organization Contact",options:[{value:!0,label:"Yes"},{value:!1,label:"No"}],placeholder:"Select Display Organization Contact",defaultValue:!1}),(0,N.jsx)("p",{className:"mb-0",children:(0,N.jsx)("small",{className:"color-dark-main",children:"If you select yes, your organization contact will be displayed on your profile on Yallah agent page and agent properties."})})]})]}),(0,N.jsx)("div",{children:(0,N.jsx)(h.wA,{name:"profile",defaultFileList:"edit"===T&&ae&&(null===(_=ae.data)||void 0===_?void 0:_.profile)&&[{uid:null===(z=ae.data)||void 0===z?void 0:z.id,name:null===(I=ae.data)||void 0===I?void 0:I.profile,status:"done",url:Z.lj+(null===(R=ae.data)||void 0===R?void 0:R.profile)}]})}),(0,N.jsxs)("div",{className:p.Z.footer,children:[(0,N.jsx)(h.op,{size:"normal",fontSize:"sm",onClick:O,type:"plain",children:"Cancel"}),(0,N.jsx)(h.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:null===ae||void 0===ae?void 0:ae.buttonLoading,children:"Submit"})]})]})})},_=t(8570),z=t(28080),I=t(37388),R=t(46155),D=t(5900),O=t(78267),T=t(45705),L=t(21680),A=t(30646),F=t(41586),M=t(98676),U=t(32344),E={forgotPasswordImg:"styles_forgotPasswordImg__zXqJM",dropdown:"styles_dropdown__Kjfi6",overlay:"styles_overlay__Npz1+",overlay_item:"styles_overlay_item__aLcEf",overlay_card_item:"styles_overlay_card_item__opRvX",disabledButton:"styles_disabledButton__GjUwL",profileScoreWrap:"styles_profileScoreWrap__KOXcQ",scoreOverlay:"styles_scoreOverlay__BCI7C",cardWrap:"styles_cardWrap__b32CC",card:"styles_card__YeNjf",card__green:"styles_card__green__Zeer2",card__info:"styles_card__info__KpeSA",manualActionTooltip:"styles_manualActionTooltip__qSJ4a"},Y=t(32147),B=t(28770),V=t(59491),H=t(39180),W=t(3798),q=_.Z.Paragraph,X=function(e){var n=e.isOpen,t=e.handleCancel,o=e.record,r=e.updateUser,s=(0,i.useState)("auto"),l=(0,a.Z)(s,2),d=l[0],c=l[1],v=(0,i.useState)("select"),m=(0,a.Z)(v,2),p=m[0],g=m[1],Z=(0,i.useState)(""),x=(0,a.Z)(Z,2),j=x[0],b=x[1],w=(0,i.useState)(!1),C=(0,a.Z)(w,2),k=C[0],P=C[1],S=(0,i.useMemo)((function(){return new y.z}),[]);return(0,N.jsx)(B.Z,{title:"Reset password for ".concat(null===o||void 0===o?void 0:o.firstName," ").concat(null===o||void 0===o?void 0:o.lastName),visible:n,onCancel:t,footer:(0,N.jsxs)("div",{children:[(0,N.jsx)(V.Z,{className:"rounded-5",type:"text",onClick:t,children:"Cancel"}),(0,N.jsx)(V.Z,{className:"ml-2 rounded-5",type:"primary",onClick:function(){return"select"===p?function(){if(!0===r){var e=(0,W.F2)();"auto"===d&&b(e),g("next"),S.updateRecord({password:"auto"===d?e:j},null===o||void 0===o?void 0:o.id).then((function(e){g("next")})).catch((function(e){var n,t,o=(null===e||void 0===e||null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.message)||"Something went wrong";f.ZP.error(o)}))}else{var n="You don't have permission to reset password for\n             ".concat(null===o||void 0===o?void 0:o.firstName," ").concat(null===o||void 0===o?void 0:o.lastName,", please contact\n             your administrator");f.ZP.error(n)}}():t()},children:"select"===p?"Reset":"Done"})]}),children:"select"===p?(0,N.jsxs)(H.ZP.Group,{name:"password-reset-options",style:{display:"flex",flexDirection:"column"},onChange:function(e){return c(e.target.value)},defaultValue:d,children:[(0,N.jsxs)(H.ZP,{value:"auto",className:"font-size-md color-dark-main",children:["Automatically generate a password",(0,N.jsx)("p",{className:"font-size-sm color-dark-sub mb-0",children:"You will be able to view and copy the password in the next step."})]}),(0,N.jsx)(H.ZP,{value:"create",className:"font-size-md color-dark-main mt-2",children:"Create password"}),"create"===d&&(0,N.jsx)("div",{className:"mt-1 ml-6",children:(0,N.jsx)(u.Z,{children:(0,N.jsx)(h.t7,{label:"Password",placeHolder:"Enter password",type:"password",className:"mb-2",onChange:function(e){return b(e.target.value)}})})})]}):(0,N.jsxs)("div",{children:[(0,N.jsx)("img",{src:"/images/forgot-password.svg",className:E.forgotPasswordImg,alt:"forgot-password"}),(0,N.jsx)(h.ZT,{color:"dark-sub",size:"md",weight:"semi",className:"text-center my-4",children:"Password has been reset successfully."}),(0,N.jsxs)(q,{copyable:{text:j},className:"font-size-md color-dark-main text-center mb-0",children:["Password: ","",(0,N.jsx)("span",{className:"font-weight-bold",children:k?j:"********"})]}),(0,N.jsx)("p",{className:"font-size-sm color-dark-sub text-center mb-0 mt-2 cursor-pointer",onClick:function(){return P(!k)},children:k?"Hide Password":"Show Password"})]})})},K=t(37936),G=t(85554),J=t(69686),Q=t(40096),$=function(e){var n=e.isOpen,t=e.handleCancel,o=e.record,a=e.loginAsOtherUser,r=(0,i.useMemo)((function(){return new J.n}),[]);return(0,N.jsx)(B.Z,{title:"Login as ".concat(null===o||void 0===o?void 0:o.firstName," ").concat(null===o||void 0===o?void 0:o.lastName),visible:n,onCancel:t,footer:(0,N.jsxs)("div",{children:[(0,N.jsx)(V.Z,{className:"rounded-5",type:"text",onClick:t,children:"Cancel"}),(0,N.jsx)(V.Z,{className:"ml-2 rounded-5",type:"primary",onClick:function(){return function(){if(!0===a)r.loginAsUser(null===o||void 0===o?void 0:o.id).then((function(e){var n,a=null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.data;if(null!==a&&void 0!==a&&a.token){var i,r,s,l="Login as ".concat(null===o||void 0===o?void 0:o.firstName," ").concat(null===o||void 0===o?void 0:o.lastName," successfully"),d=Q.Z.getUserData(),c=Q.Z.getLocalAccessToken()||"",u=Q.Z.getLocalRefreshToken()||"";Q.Z.saveTempUserData(d),Q.Z.updateTempAccessToken(c),Q.Z.updateTempRefreshToken(u),Q.Z.updateLocalAccessToken(null===a||void 0===a||null===(i=a.token)||void 0===i?void 0:i.access_token),Q.Z.updateLocalRefreshToken(null===a||void 0===a||null===(r=a.token)||void 0===r?void 0:r.refresh_token),Q.Z.saveUserData(null===(s=e.data.data)||void 0===s?void 0:s.userData),f.ZP.success(l),t(),window.location.href="/"}})).catch((function(e){var n,t,a=(null===e||void 0===e||null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.message)||"Login as ".concat(null===o||void 0===o?void 0:o.firstName," ").concat(null===o||void 0===o?void 0:o.lastName," failed");f.ZP.error(a)}));else{var e="You don't have permission to login as \n            ".concat(null===o||void 0===o?void 0:o.firstName," ").concat(null===o||void 0===o?void 0:o.lastName,",\n             please contact your administrator");f.ZP.error(e)}}()},children:"Continue"})]}),children:(0,N.jsx)(h.ZT,{color:"dark-main",size:"normal",className:"text-center my-4",children:"When logging in as ".concat(null===o||void 0===o?void 0:o.firstName," ").concat(null===o||void 0===o?void 0:o.lastName,",\n                    we'll send them an email to let them know you've logged in\n                    as them. including your name and email address.")})})};var ee=function(e){var n=e.children,t=e.user,o=(0,i.useState)(!1),r=(0,a.Z)(o,2),s=r[0],l=r[1],d=(0,N.jsx)(z.Z,{className:E.scoreOverlay,children:(0,N.jsxs)("div",{className:"d-flex justify-space-between",children:[(0,N.jsx)(h.ZT,{color:"dark-main",size:"lg",children:"".concat(t.firstName," ").concat(t.lastName,"'s Score")}),(0,N.jsx)(Y.DX,{onClick:function(){return l(!1)},style:{cursor:"pointer"}})]})});return(0,N.jsx)(O.Z,{dropdownRender:function(){return d},open:s,onOpenChange:function(){return l(!0)},children:n})},ne=t(98505),te=_.Z.Paragraph,oe=function(e){var n=e.record,t=e.onEditIconClick,r=e.reloadTableData,s=e.onCountryAccessClick,l=e.onPasswordResetClick,d=e.onLoginAsClick,c=e.permissions,u=c.deleteUser,v=c.updateUser,m=c.loginAsOtherUser,g=c.addUserCountry,Z=(0,G.v9)((function(e){return e.usersReducer})).loggedInUserData,x=null===Z||void 0===Z?void 0:Z.data,j=(0,i.useState)({confirmLoading:!1,openPopConfirm:!1}),b=(0,a.Z)(j,2),w=b[0],C=b[1],k=(0,i.useState)(!1),P=(0,a.Z)(k,2),S=P[0],_=P[1],T=(0,i.useMemo)((function(){return new y.z}),[]),L=(0,N.jsxs)(z.Z,{className:"".concat(E.overlay," pa-2"),children:[!0===g&&(0,N.jsxs)("div",{className:"".concat(p.Z.actions," ").concat(E.overlay_card_item),onClick:function(){s(n),_(!1)},children:[(0,N.jsx)("span",{children:(0,N.jsx)(Y.U6,{width:18,height:18,color:"#fff"})}),"Country Access"]}),!0===v&&(0,N.jsxs)("div",{className:"".concat(p.Z.actions," ").concat(E.overlay_card_item),onClick:function(){t(n),_(!1)},children:[(0,N.jsx)("span",{children:(0,N.jsx)("img",{src:"/images/editicon.svg",alt:""})}),"Edit"]}),!0===v&&(0,N.jsx)(N.Fragment,{children:null!==K.Bl&&void 0!==K.Bl&&K.Bl.includes(n.email)?(0,N.jsx)(I.Z,{title:"You cannot reset password for super admin.",placement:"left",children:(0,N.jsxs)("div",{className:"".concat(p.Z.actions," ").concat(E.overlay_card_item),style:{cursor:"not-allowed",opacity:"0.6"},children:[(0,N.jsx)("span",{children:(0,N.jsx)(Y.Ob,{color:"#fff",width:18,height:18})}),"Reset Password"]})}):(0,N.jsx)(I.Z,{title:"Reset Password for this user.",placement:"left",children:(0,N.jsxs)("div",{className:"".concat(p.Z.actions," ").concat(E.overlay_card_item),onClick:function(){l(n),_(!1)},children:[(0,N.jsx)("span",{children:(0,N.jsx)(Y.Ob,{color:"#fff",width:18,height:18})}),"Reset Password"]})})}),!0===m&&(0,N.jsx)(I.Z,{title:"Login as ".concat(null===n||void 0===n?void 0:n.firstName," ").concat(null===n||void 0===n?void 0:n.lastName),placement:"left",children:(0,N.jsxs)("div",{className:"".concat(p.Z.actions," ").concat(E.overlay_card_item),onClick:function(){d(n),_(!1)},children:[(0,N.jsx)("span",{children:(0,N.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",color:"#fff",width:20,height:20,children:(0,N.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"})})}),"Login as"]})}),(0,N.jsx)(h.oK,{onConfirm:function(e){!function(e){var n=e.value,t=e.message,o=e.id,a=n.replace("_",""),i={value:Number(a),message:t};T.manualAction(i,o).then((function(e){r(),_(!1),f.ZP.success(e.data.message)})).catch((function(e){f.ZP.error(e.message||"Something went wrong")}))}({value:e.value,message:e.message,id:n.id})},children:(0,N.jsxs)("div",{className:"".concat(p.Z.actions," ").concat(E.overlay_card_item),children:[(0,N.jsx)("span",{children:(0,N.jsx)(Y.U6,{width:18,height:18,color:"#fff"})}),"Manual Action"]})}),(0,N.jsx)(R.Z,{className:"my-2"}),(null===x||void 0===x?void 0:x.id)===(null===n||void 0===n?void 0:n.id)?(0,N.jsx)(I.Z,{title:"You cannot delete yourself.",children:(0,N.jsxs)("div",{className:p.Z.actions,style:{cursor:"not-allowed",opacity:"0.2"},children:[(0,N.jsx)(M.Z,{className:p.Z.bg__red}),"Delete User"]})}):(0,N.jsx)(D.Z,{open:w.openPopConfirm,placement:"left",title:"Are you sure?",onConfirm:function(){if(C((0,o.Z)((0,o.Z)({},w),{},{confirmLoading:!0})),!1===u)return f.ZP.error("You don't have permission to delete this user, please contact your admin."),void C((0,o.Z)((0,o.Z)({},w),{},{openPopConfirm:!1}));T.deleteRecord(n.id).then((function(e){C((0,o.Z)((0,o.Z)({},w),{},{openPopConfirm:!1,confirmLoading:!1})),r(),_(!1),f.ZP.success(e.data.message)})).catch((function(e){C((0,o.Z)((0,o.Z)({},w),{},{confirmLoading:!1})),f.ZP.error(e.message||"Something went wrong")}))},onCancel:function(){return C((0,o.Z)((0,o.Z)({},w),{},{openPopConfirm:!1}))},okButtonProps:{loading:w.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:function(e){e||C((0,o.Z)((0,o.Z)({},w),{},{openPopConfirm:!1}))},children:(0,N.jsxs)("div",{className:p.Z.actions,style:{cursor:"pointer"},onClick:function(){C((0,o.Z)((0,o.Z)({},w),{},{openPopConfirm:!0}))},children:[(0,N.jsx)(M.Z,{className:p.Z.bg__red}),"Delete User"]})})]});return(0,N.jsx)(O.Z,{trigger:["click"],dropdownRender:function(){return L},open:S,onOpenChange:function(e){return _(e)},children:(0,N.jsx)("span",{style:{cursor:"pointer",padding:"5px"},children:(0,N.jsx)(Y.nX,{height:25,width:25,color:"#7e869a"})})})},ae={1:"#00A884",2:"#f50"},ie=function(e){var n=e.record,t=e.status,o=e.reloadTableData,r=e.permissions.updateUser,s=f.ZP.useMessage(),l=(0,a.Z)(s,2),d=l[0],c=l[1],u=(0,i.useMemo)((function(){return new y.z}),[]),v=function(e){d.open({key:e.key,type:e.type,content:e.content,duration:"loading"===e.type?0:2})},m=(0,i.useState)(!1),h=(0,a.Z)(m,2),p=h[0],g=h[1],Z=(0,N.jsxs)(z.Z,{className:"".concat(E.overlay," pa-2"),children:[c,Object.entries(K.J0).map((function(e){var i=(0,a.Z)(e,2),s=i[0],l=i[1];return(0,N.jsx)("div",{className:E.overlay_item,onClick:function(){t!==Number(l)&&!0===r&&function(e){null!==n&&void 0!==n&&n.id&&!0===r?(v({key:"update",type:"loading",content:"Updating..."}),u.updateRecord({status:e},null===n||void 0===n?void 0:n.id).then((function(e){var n,t;null!==e&&void 0!==e&&null!==(n=e.data)&&void 0!==n&&n.data&&(v({key:"update",type:"success",content:null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message}),g(!p),o())})).catch((function(e){var n,t;v({key:"update",type:"error",content:null===e||void 0===e||null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.message})}))):v({key:"update",type:"error",content:"You don't have permission to change status"})}(Number(l))},children:(0,N.jsx)("span",{className:t===Number(l)?E.disabledButton:"",children:(0,W.kC)(s)})},"user-status-".concat(s))}))]});return(0,N.jsx)("div",{children:(0,N.jsx)(O.Z,{dropdownRender:function(){return Z},trigger:!0===r?["click"]:[],open:!0===r&&p,onOpenChange:function(e){g(e)},className:E.dropdown,children:(0,N.jsx)("div",{children:(0,N.jsxs)(T.Z,{style:{backgroundColor:ae[t],color:"#fff",padding:"0.2rem 0.5rem",borderRadius:"0.25rem",fontSize:"0.8rem",display:"flex",width:"100%",justifyContent:"space-between"},children:[Object.entries(K.J0).map((function(e){var n=(0,a.Z)(e,2),o=n[0];return n[1]===String(t)&&(0,W.kC)(o)})),!0===r&&(0,N.jsx)(U.Z,{})]})})})})};function re(e){var n=e.tableData,t=e.tableLoading,r=e.onEditIconClick,s=e.reloadTableData,l=e.onManageRolesClick,d=e.onCountryAccessClick,c=(0,G.v9)((function(e){return e.usersReducer})).userPermissions,u=c.updateUser,v=c.loginAsOtherUser,m=(0,i.useState)({isOpen:!1,record:void 0}),g=(0,a.Z)(m,2),x=g[0],j=g[1],y=function(e){!0===u?j({isOpen:!0,record:e}):f.ZP.error("You don't have permission to reset password for ".concat(null===e||void 0===e?void 0:e.firstName," ").concat(null===e||void 0===e?void 0:e.lastName))},b=(0,i.useState)({isOpen:!1,record:void 0}),w=(0,a.Z)(b,2),C=w[0],k=w[1],P=function(e){!0===v?k({isOpen:!0,record:e}):f.ZP.error("You don't have permission to login as ".concat(null===e||void 0===e?void 0:e.firstName," ").concat(null===e||void 0===e?void 0:e.lastName))},S=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,n,t){return t+1},width:"5%"},{title:"ID / UUID",dataIndex:"uuid",key:"uuid",render:function(e,n){return(0,N.jsxs)("div",{children:[(0,N.jsxs)(te,{className:"font-size-xs color-dark-sub",title:n.id.toString(),children:["[",n.id,"]"]}),(0,N.jsxs)(te,{title:e,ellipsis:{rows:1,expandable:!1},copyable:{text:e},className:"font-size-xs color-dark-sub",children:["[",e,"]"]})]})},width:"120px"},{title:"Name",dataIndex:"name",key:"name",render:function(e,n){var t,o;return(0,N.jsxs)("div",{children:[(0,N.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,N.jsx)(h.ZT,{color:"dark-main",size:"sm",weight:"bold",className:"my-auto mr-1",children:"".concat(n.firstName," ").concat(n.lastName)})}),(0,N.jsx)("div",{children:(0,N.jsx)(te,{ellipsis:{rows:1,expandable:!1},className:"my-0 color-dark-sub",children:(0,N.jsx)("a",{href:"mailto:".concat(n.email),className:"font-size-xs",children:(0,N.jsx)("span",{className:"color-dark-sub",children:n.email})})})}),(0,N.jsx)("div",{children:n.phone?(0,N.jsx)("a",{href:"tel:".concat(n.phone),className:"color-dark-sub font-size-xs",children:null!==n.phone&&null!==n.phoneCode?"+"+(null===n||void 0===n?void 0:n.phoneCode)+n.phone:"N/A"}):(0,N.jsx)(h.ZT,{color:"dark-sub",size:"xs",children:"N/A"})}),n.addedDate&&(0,N.jsxs)("div",{className:"d-flex mt-4",children:[(0,N.jsx)(Y.$$,{className:"mr-2"}),(0,N.jsx)(h.ZT,{color:"dark-sub",size:"sm",children:"".concat((0,ne.Ny)(n.addedDate,"dd MM yy"))})]}),(null===(t=n.Organization)||void 0===t?void 0:t.name)&&(0,N.jsxs)(te,{ellipsis:{rows:1,expandable:!1},className:"my-0 color-dark-sub font-size-sm mt-2",children:["Org:",null===(o=n.Organization)||void 0===o?void 0:o.name]})]})}},{title:"Profile",dataIndex:"profile",key:"profile",render:function(e,n){return(0,N.jsx)(L.Z,{width:40,height:40,src:"".concat(Z.lj).concat(e),preview:!1,rootClassName:"object-fit-cover",style:{borderRadius:"100%"}})},width:"200px"},{title:"Profile Score",dataIndex:"profileScore",key:"profileScore",render:function(e,n){return(0,N.jsx)(ee,{user:n,children:(0,N.jsxs)("div",{className:E.profileScoreWrap,children:[(0,N.jsx)(A.Z,{type:"circle",format:function(){return""},percent:e,status:"success",width:25,strokeWidth:12}),(0,N.jsx)(h.ZT,{color:"dark-sub",size:"sm",children:"".concat(e?"".concat(e,"%"):"0%")})]})})}},{title:"Stats",dataIndex:"averageReplyTime",key:"averageReplyTime",render:function(e,n){return(0,N.jsx)(N.Fragment,{children:(0,N.jsx)(h.ZT,{color:"dark-sub",size:"sm",children:"Avg. Reply Time: ".concat(e)})})}},{title:"Role",dataIndex:"role",key:"role",render:function(e,n){return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(te,{ellipsis:{rows:1,expandable:!1},className:"my-0 color-dark-sub",children:(0,N.jsx)("ul",{style:{listStyle:"none",padding:0},children:n.userRole.map((function(e){return(0,N.jsx)("li",{className:"font-size-xs ml-0",children:e.Role.title})}))})}),(0,N.jsx)("p",{className:"color-dark-main font-weight-bold font-size-sm mb-0 ml-1 cursor-pointer",onClick:function(){return l(n)},children:"Manage Roles"})]})}},{title:"Status",dataIndex:"status",key:"status",render:function(e,n){return(0,N.jsx)(ie,{status:e,record:n,reloadTableData:s,permissions:c})},width:"150px"},{title:"Actions",dataIndex:"actions",key:"actions",render:function(e,n){return(0,N.jsx)(oe,{record:n,onEditIconClick:r,reloadTableData:s,onCountryAccessClick:d,onPasswordResetClick:y,onLoginAsClick:P,permissions:c})},className:"text-center"}];return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{className:p.Z.antdTableWrapper,children:(0,N.jsx)(F.Z,{sticky:!0,dataSource:n,columns:S,pagination:!1,scroll:{x:991},loading:t,rowKey:function(e){return"site-user-".concat(e.id)}})}),x.isOpen&&(0,N.jsx)(X,{isOpen:x.isOpen,handleCancel:function(){return j((0,o.Z)((0,o.Z)({},x),{},{isOpen:!1}))},record:x.record,updateUser:u}),C.isOpen&&(0,N.jsx)($,{isOpen:C.isOpen,handleCancel:function(){return k((0,o.Z)((0,o.Z)({},C),{},{isOpen:!1}))},record:C.record,loginAsOtherUser:v})]})}var se=t(4942),le=t(37831),de=t(45987),ce=t(32697),ue="styles_freeText__o99yJ",fe="styles_active__CspjP",ve="styles_checkboxGroup__QBcic",me="styles_dateWrap__l8hni",he="styles_inputsWrap__eRflV",pe="styles_noOption__L+Bfr",ge="styles_searchItems__I2cfi",Ze="styles_webIdFilter__qUesn",xe="styles_footerButtonWrap__De2Bu",je=t(33179),ye=["value","onChange","data","filters","type","label","onFilter","show","filterType","getChild","showFooter","searchProps"];function be(e){var n=e.values,t=e.setValues,o=e.setVisible,r=e.visible,s=e.moreItems,l=(0,i.useState)(""),d=(0,a.Z)(l,2)[1],c=(0,i.useState)(s),u=(0,a.Z)(c,2),f=u[0],v=u[1],m=(0,i.useCallback)((function(e){d(e.target.value),v(s.filter((function(n){return n.label.toLowerCase().includes(e.target.value)})))}),[s]);return(0,N.jsx)("div",{className:"".concat(ue),children:(0,N.jsx)(je.Z,{onVisibleChange:function(e){o(e)},visible:r,items:[{key:1,label:(0,N.jsxs)("div",{children:[(0,N.jsx)(le.Z,{size:"w100",onChange:m,placeHolder:"Search",icon:(0,N.jsx)("img",{src:"/images/searchIcon.svg",alt:""})}),(null===f||void 0===f?void 0:f.length)>0?(0,N.jsx)(ce.Z.Group,{value:n,onChange:t,className:ve,options:null===f||void 0===f?void 0:f.map((function(e){return{label:e.label,value:e.value}}))}):(0,N.jsx)("div",{className:pe,children:"No Options"})]})}],children:"More+"})})}var we=function(e){var n,t,r,s,l=(0,i.useState)(!1),c=(0,a.Z)(l,2),u=c[0],v=c[1],m=e.value,h=e.onChange,p=e.data,g=e.filters,Z=e.type,x=e.label,j=e.onFilter,y=e.show,b=e.filterType,w=void 0===b?"multi":b,C=e.getChild,k=e.showFooter,P=void 0===k||k,S=e.searchProps,_=(0,de.Z)(e,ye),z=(0,i.useState)([]),I=(0,a.Z)(z,2),R=I[0],D=I[1];(0,i.useEffect)((function(){v(y)}),[y]);var O=(0,N.jsxs)("div",{children:["multi"===w?(0,N.jsxs)(N.Fragment,{children:[S?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(le.Z,(0,o.Z)((0,o.Z)({icon:(0,N.jsx)("img",{src:"/images/searchIcon.svg",alt:""}),size:"w100",placeHolder:"Enter value"},_),{},{allowClear:!0,onChange:function(e){return S.onSearch(e.target.value)}})),(0,N.jsx)("div",{className:ge,children:R.map((function(e){return(0,N.jsxs)("span",{children:[null===e||void 0===e?void 0:e.name,(0,N.jsx)("h5",{onClick:function(){return function(e){var n=m.filter((function(n){return n!==e}));D((function(n){return n.filter((function(n){return n.value!==e}))})),h(n,Z)}(e.value)},children:"X"})]})}))})]}):null,(0,N.jsx)(ce.Z.Group,{value:m,onChange:function(e){if(S){var n=new Set([].concat((0,d.Z)(e.filter((function(e){return-1===m.indexOf(e)}))),(0,d.Z)(m.filter((function(n){return-1===e.indexOf(n)}))))),t=(0,a.Z)(n,1)[0],o=p.filter((function(e){return e.value===t}));D((function(e){var n=e.filter((function(e){return e.value===t})).length?e.filter((function(e){return e.value!==t})):[o[0]].concat((0,d.Z)(e)),a=n.map((function(e){return e.value}));return h(a,Z),n}))}else h(e,Z)},className:ve,options:p})]}):"single"===w?(0,N.jsx)(H.ZP.Group,{value:m,onChange:function(e){return h(e.target.value,Z)},className:ve,options:p}):(0,N.jsxs)("div",{className:Ze,children:[(0,N.jsx)(le.Z,(0,o.Z)({value:m,placeHolder:"Enter value",type:Z,onChange:function(e){return h("number"===Z?e:e.target.value,Z)},allowClear:!0},_)),(0,N.jsx)(V.Z,{type:"primary",onClick:function(){if("email"===Z&&!(0,W.oH)(m))return f.ZP.error("Please enter valid email");j(v)},children:"Update"})]}),P?(0,N.jsxs)("div",{className:xe,children:[(0,N.jsx)(V.Z,{onClick:function(){D([]),h([],Z)},children:"Reset"}),(0,N.jsx)(V.Z,{type:"primary",onClick:function(){return j(v)},children:"Update"})]}):null]});return!0===C?O:(0,N.jsx)("div",{className:"".concat(ue," ").concat(null!==(n=g[Z])&&void 0!==n&&n.length?fe:""),children:(0,N.jsxs)(je.Z,{visible:u,onVisibleChange:function(e){v(e)},items:[{key:1,label:O||""}],children:[(null===(t=g[Z])||void 0===t?void 0:t.length)>0?"".concat(x,": ").concat("single"===w?p.filter((function(e){return e.value===g[Z]}))[0].label:"input"===w?g[Z]:S?null===(r=p.filter((function(e){return e.value===g[Z][0]}))[0])||void 0===r?void 0:r.name:p.filter((function(e){return e.value===g[Z][0]}))[0].label):x,(null===(s=g[Z])||void 0===s?void 0:s.length)>1&&"multi"===w?(0,N.jsx)("h5",{children:"+".concat(g[Z].length-1)}):null]})})},Ce=t(69309),ke=t(3109),Ne=function(e){var n,t,o,r,s=(0,i.useState)(!1),l=(0,a.Z)(s,2),d=l[0],c=l[1],u=e.values,f=e.onChange,v=e.filters,m=e.labels,h=e.label,p=e.onFilter,g=e.show,Z=e.subTypes,x=e.type,j=e.showFooter,y=e.children,b=e.types,w=void 0===b?["input","input"]:b;return(0,i.useEffect)((function(){c(g)}),[g]),(0,N.jsx)("div",{className:"".concat(ue," ").concat(v[Z[0]]?fe:""),children:(0,N.jsxs)(je.Z,{visible:d,onVisibleChange:function(e){c(e)},items:[{key:1,label:(0,N.jsxs)("div",{children:[(0,N.jsxs)("div",{className:"input"===w[0]?he:me,children:[Z[0]?(0,N.jsx)("div",{children:"input"===w[0]?(0,N.jsx)(le.Z,{size:"w100",value:u[0],label:m[0],placeHolder:"",onChange:function(e){return f(e.target.value,Z[0])}}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(ke.Z,{color:"dark-main",size:"sm",children:m[0]}),(0,N.jsx)(Ce.Z,{value:u[0],onChange:function(e){return f(e,Z[0])}})]})}):null,Z[1]?(0,N.jsx)("div",{children:"input"===w[1]?(0,N.jsx)(le.Z,{size:"w100",value:u[1],label:m[1],placeHolder:"",onChange:function(e){return f(e.target.value,Z[1])}}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(ke.Z,{color:"dark-main",size:"sm",children:m[1]}),(0,N.jsx)(Ce.Z,{value:u[1],onChange:function(e){return f(e,Z[1])}})]})}):null]}),y||null,j?(0,N.jsxs)("div",{className:xe,children:[(0,N.jsx)(V.Z,{onClick:function(){f(null,x)},children:"Reset"}),(0,N.jsx)(V.Z,{type:"primary",onClick:function(){return p(c)},children:"Update"})]}):null]})}],children:[null!==Z&&void 0!==Z&&Z.length?"".concat(null!==(n=v[Z[0]])&&void 0!==n&&n.length?"".concat(h,":").concat(v[Z[0]]):null!==(t=v[Z[0]]&&Object.keys(v[Z[0]]))&&void 0!==t&&t.length?"".concat(h,":").concat((0,ne.Ny)(v[Z[0]],"dd/mm/yy")):h):h,(null===Z||void 0===Z?void 0:Z.length)>1?"".concat(null!==(o=v[Z[1]])&&void 0!==o&&o.length?" - ".concat(v[Z[1]]):null!==(r=v[Z[1]]&&Object.keys(v[Z[1]]))&&void 0!==r&&r.length?" - ".concat((0,ne.Ny)(v[Z[1]],"dd/mm/yy")):""):null,(null===Z||void 0===Z?void 0:Z.length)>2?"".concat(v[Z[2]]?" ( ".concat(v[Z[2]]," )"):""):null]})})},Pe=[{label:"Published",value:"true"},{label:"Not Published",value:"false"},{label:"Ascending",value:"asc"},{label:"Descending",value:"desc"}],Se=[{label:"Organization",value:"organization"},{label:"Email",value:"email"},{label:"Phone",value:"phone"},{label:"Role",value:"role"}],_e=[{label:"Name",value:"name"},{label:"Email",value:"email"},{label:"Date Added",value:"addedDate"}],ze=function(e){var n,t=e.filters,r=e.setFilters,s=(0,i.useState)(""),l=(0,a.Z)(s,2),c=l[0],u=l[1],v=(0,w.N)(c,500),m=(0,i.useState)([]),p=(0,a.Z)(m,2),g=p[0],Z=p[1],x=(0,i.useState)(""),j=(0,a.Z)(x,2),b=j[0],P=j[1],S=(0,i.useState)(!1),_=(0,a.Z)(S,2),z=_[0],I=_[1],R=(0,i.useState)({data:[],loading:!1}),D=(0,a.Z)(R,2),O=D[0],T=D[1],L=(0,i.useState)([]),A=(0,a.Z)(L,2),F=A[0],M=A[1],U=(0,i.useState)(!1),E=(0,a.Z)(U,2),Y=E[0],B=E[1],V=(0,i.useState)(""),H=(0,a.Z)(V,2),q=H[0],X=H[1],G=(0,w.N)(q,500),J=(0,i.useMemo)((function(){return new y.z}),[]),Q=(0,i.useMemo)((function(){return new C.L}),[]),$=(0,i.useMemo)((function(){return new k.U}),[]),ee=(0,i.useState)({}),ne=(0,a.Z)(ee,2),te=ne[0],oe=ne[1];(0,i.useEffect)((function(){r(v?(0,o.Z)((0,o.Z)({},te),{},{name:v}):(0,o.Z)({},te))}),[v]);var ae=(0,i.useCallback)((function(e){r((0,o.Z)((0,o.Z)({},te),e))}),[te,r]),ie=(0,i.useCallback)((function(e,n){var t=(0,o.Z)((0,o.Z)({},te),{},(0,se.Z)({},n,e));"phone"===n&&(t.phone=null===e||void 0===e?void 0:e.replace(/[^0-9]/g,"")),"date"===n?(t.fromDate=null,t.toDate=null,r(t)):0===(null===e||void 0===e?void 0:e.length)&&r(t),oe(t)}),[te,r]),re=(0,i.useCallback)((function(){G&&(T((function(e){return(0,o.Z)((0,o.Z)({},e),{},{loading:!0})})),Q.findPublished({name:G}).then((function(e){var n,t=null===(n=e.data)||void 0===n?void 0:n.data;if(t){var a=t.filter((function(e,n){return t.findIndex((function(n){return n.id===e.id}))===n}));T((function(e){return(0,o.Z)((0,o.Z)({},e),{},{data:a})}))}})).catch((function(e){var n,t;f.ZP.error((null===e||void 0===e||null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.message)||"Something went wrong")})).finally((function(){T((function(e){return(0,o.Z)((0,o.Z)({},e),{},{loading:!1})}))})))}),[G,Q]);(0,i.useEffect)((function(){re()}),[re]),(0,i.useEffect)((function(){Y&&ae();var e=setTimeout((function(){B(!1)}),2e3);return function(){return clearTimeout(e)}}),[Y,te.organizationId,ae]),(0,i.useEffect)((function(){$.getAllRecords().then((function(e){var n,t=null===(n=e.data)||void 0===n?void 0:n.data;t&&M(t)})).catch((function(e){var n,t;f.ZP.error((null===e||void 0===e||null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.message)||"Something went wrong")}))}),[]);var de={email:(0,N.jsx)(we,{filterType:"input",value:te.email,onChange:ie,type:"email",label:"Email",filters:t,data:[],onFilter:ae,show:"email"===b,showFooter:!1}),phone:(0,N.jsx)(we,{filterType:"input",value:te.phone,onChange:ie,type:"phone",label:"Phone",placeHolder:"Enter phone",filters:t,data:[],onFilter:ae,show:"phone"===b,showFooter:!1}),organization:(0,N.jsx)(h.Xy,{type:"radio",label:"Organization",name:"organizationId",withSearch:!0,options:(null===O||void 0===O||null===(n=O.data)||void 0===n?void 0:n.map((function(e){return{label:e.name,value:"".concat(e.id)}})))||[],onChange:function(e){var n=e.target.value;oe((0,o.Z)((0,o.Z)({},te),{},{organizationId:n}))},value:null===te||void 0===te?void 0:te.organizationId,onReset:function(){B(!0),oe((0,o.Z)((0,o.Z)({},te),{},{organizationId:""})),X("")},onUpdate:function(){return ae()},loading:null===O||void 0===O?void 0:O.loading,searchTerm:q,onSearch:function(e){return X(e.currentTarget.value)}}),role:(0,N.jsx)(h.Xy,{type:"multiSelect",label:"Role",name:"roleIds",options:null===F||void 0===F?void 0:F.map((function(e){return{label:e.title,value:"".concat(e.id)}})),onChange:function(e){return oe((0,o.Z)((0,o.Z)({},te),{},{roleIds:e}))},onReset:function(){B(!0),oe((0,o.Z)((0,o.Z)({},te),{},{roleIds:[]})),ie([],"roleIds")},onUpdate:function(){return ae()}})},ce=(0,i.useMemo)((function(){return Object.entries(t).filter((function(e){var n=(0,a.Z)(e,2)[1];return!!(n&&n.length>0)})).length>0||c.length>0}),[t,c]);return(0,N.jsxs)("div",{className:"d-flex align-center",children:[(0,N.jsx)("div",{children:(0,N.jsx)(le.Z,{value:c,onChange:function(e){return u(e.target.value)},size:"w100",label:"",placeHolder:"Search by Name",icon:(0,N.jsx)("img",{src:"/images/searchIcon.svg",alt:""})})}),(0,N.jsx)(we,{filterType:"single",show:!1,value:te.status,onChange:ie,type:"status",label:"Status",filters:t,data:Object.entries(K.J0).map((function(e){var n=(0,a.Z)(e,2),t=n[0],o=n[1];return{label:(0,W.kC)(t),value:o}})),onFilter:ae}),(0,N.jsx)(Ne,{values:[te.fromDate,te.toDate],onChange:ie,subTypes:["fromDate","toDate"],label:"Registered Between",type:"date",labels:["From Date","To Date"],filters:t,onFilter:ae,show:!1,showFooter:!0,types:["fromDate","toDate"]}),(0,N.jsx)(we,{filterType:"single",show:!1,value:te.isPublished,onChange:ie,type:"isPublished",label:"Published",filters:t,data:Pe,onFilter:ae}),Object.keys(de).map((function(e){return g.includes(e)?de[e]:null})),(0,N.jsx)(be,{values:g,setValues:function(e){Z((function(n){var t=new Set([].concat((0,d.Z)(e.filter((function(e){return-1===n.indexOf(e)}))),(0,d.Z)(n.filter((function(n){return-1===e.indexOf(n)}))))),i=(0,a.Z)(t,1)[0];if(I(!1),n.includes(i)){var s=(0,o.Z)((0,o.Z)({},te),{},(0,se.Z)({},i,[]));oe(s),r(s)}else P(i);return e}))},setVisible:I,visible:z,moreItems:Se}),ce&&(0,N.jsx)("p",{onClick:function(){u(""),r({}),oe({}),Z([]),J.getAllRecords()},style:{cursor:"pointer",color:"red",marginBottom:"0"},children:"Reset All"}),(0,N.jsx)("div",{style:{marginLeft:"auto",marginRight:"0px"},children:(0,N.jsx)(h.Xy,{type:"radio",label:"Sort By",name:"sortByField",options:_e,onChange:function(e){var n=e.target.value;oe((0,o.Z)((0,o.Z)({},te),{},{sortByField:n}))},value:null===te||void 0===te?void 0:te.sortByField,onReset:function(){B(!0),oe((0,o.Z)((0,o.Z)({},te),{},{sortByField:""}))},onUpdate:function(e){return ae(e)},withSort:!0})})]})},Ie=t(7655),Re=function(e){var n,t,r=e.openModal,s=e.onCancel,l=e.record,d=e.reloadTableData,c=e.recordData,v=e.permissions.addUserRole,m=u.Z.useForm(),Z=(0,a.Z)(m,1)[0],b=(0,i.useMemo)((function(){return new y.z}),[]),w=(0,i.useMemo)((function(){return new k.U}),[]),C=(0,i.useState)(),P=(0,a.Z)(C,2),S=P[0],_=P[1],z=[];c&&c.userRole&&(null===c||void 0===c||null===(t=c.userRole)||void 0===t||t.map((function(e){return z.push(e.Role.id.toString())})));var I=(0,i.useState)(z),R=(0,a.Z)(I,2),D=R[0],O=R[1],T=function(e){var n=(0,j.P)(e);if("string"==typeof n.message)_((0,o.Z)((0,o.Z)({},S),{},{error:n.message}));else{var t=(0,x.O)(n.message,[]);Z.setFields(t),_((0,o.Z)((0,o.Z)({},S),{},{error:""}))}},L=(0,i.useCallback)((function(){w.getAllRecords().then((function(e){var n;e.data&&null!==(n=e.data)&&void 0!==n&&n.data&&_((0,o.Z)((0,o.Z)({},e.data),{},{loading:!1}))})).catch((function(e){T(e)}))}),[Z,l,b,w]);(0,i.useEffect)((function(){_({loading:!0}),L()}),[r,Z]);return(0,N.jsx)(h.P0,{visible:r,closable:!0,onCancel:s,titleText:"Manage Roles",showFooter:!1,children:null!==S&&void 0!==S&&S.loading?(0,N.jsx)(g.Z,{items:10}):(0,N.jsxs)(u.Z,{className:p.Z.form,onFinish:function(e){if(e.roleIds)if(!0===v){var n;_((0,o.Z)((0,o.Z)({},S),{},{buttonLoading:!0}));var t=null===e||void 0===e||null===(n=e.roleIds)||void 0===n?void 0:n.map((function(e){return Number(e)}));b.addRoles({roleIds:t},l).then((function(e){d(),s(),_((function(e){return(0,o.Z)((0,o.Z)({},e),{},{loading:!1})})),f.ZP.success("Saved Successfully")})).catch((function(e){T(e),_((function(e){return(0,o.Z)((0,o.Z)({},e),{},{loading:!1})}))}));var a=[];z.map((function(e){return!D.includes(e)&&a.push(Number(e))})),(null===a||void 0===a?void 0:a.length)>0&&b.removeRoles({roleIds:a},l).catch((function(e){f.ZP.error(e.message)}))}else f.ZP.error("You don't have permission to manage roles, please contact admin");else f.ZP.info("No changes made"),s()},form:Z,children:[(null===S||void 0===S?void 0:S.error)&&(0,N.jsx)(h.EQ,{description:null===S||void 0===S?void 0:S.error,isClosable:!0,onClose:function(){_((0,o.Z)((0,o.Z)({},S),{},{error:""}))}}),(0,N.jsx)("div",{children:(0,N.jsx)(u.Z.Item,{name:"roleIds",rules:[{required:!1}],children:(0,N.jsx)(Ie.Z,{dataSource:null===S||void 0===S||null===(n=S.data)||void 0===n?void 0:n.map((function(e,n){var t;return{key:e.id.toString(),title:e.title,description:null===(t=e.title)||void 0===t?void 0:t.toLowerCase()}})),listStyle:{width:250,height:400},showSearch:!0,filterOption:function(e,n){var t;return(null===n||void 0===n||null===(t=n.description)||void 0===t?void 0:t.indexOf(null===e||void 0===e?void 0:e.toLowerCase()))>-1},targetKeys:D,onChange:function(e){O(e)},render:function(e){return e.title}})})}),(0,N.jsxs)("div",{className:p.Z.footer,children:[(0,N.jsx)(h.op,{size:"normal",fontSize:"sm",onClick:s,type:"plain",children:"Cancel"}),(0,N.jsx)(h.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:null===S||void 0===S?void 0:S.buttonLoading,children:"Save"})]})]})})},De=function(e){var n,t=e.openModal,r=e.onCancel,d=e.record,c=e.reloadTableData,v=(e.recordData,e.permissions),m=v.addUserCountry,Z=v.removeUserCountry,w=u.Z.useForm(),C=(0,a.Z)(w,1)[0],k=(0,i.useMemo)((function(){return new y.z}),[]),P=(0,i.useMemo)((function(){return new b.Y}),[]),S=(0,i.useState)(),_=(0,a.Z)(S,2),z=_[0],I=_[1],R=(0,i.useState)(),D=(0,a.Z)(R,2),O=D[0],T=D[1],L=[],A=(0,i.useState)(L),F=(0,a.Z)(A,2),M=F[0],U=F[1],E=function(e){var n=(0,j.P)(e);if("string"==typeof n.message)I((0,o.Z)((0,o.Z)({},z),{},{error:n.message}));else{var t=(0,x.O)(n.message,[]);C.setFields(t),I((0,o.Z)((0,o.Z)({},z),{},{error:""}))}},Y=(0,i.useCallback)((function(){k.getRecordById(d).then((function(e){e.data&&e.data.data&&I((0,o.Z)((0,o.Z)({},e.data),{},{loading:!1}))})).catch((function(e){E(e)})),P.getAllRecords().then((function(e){e.data&&e.data.data&&T((0,o.Z)((0,o.Z)({},e.data),{},{loading:!1}))})).catch((function(e){E(e)}))}),[C,d,k,P]);(0,i.useEffect)((function(){I({loading:!0}),Y()}),[t,C]);var B=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(n){var t,a,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.userCountryList){e.next=22;break}if(I((0,o.Z)((0,o.Z)({},z),{},{buttonLoading:!0})),a=null===n||void 0===n||null===(t=n.userCountryList)||void 0===t?void 0:t.map((function(e){return Number(e)})),!0!==m){e.next=8;break}return e.next=6,k.addCountryAccess({userCountryList:a,userId:d}).then((function(e){I((function(e){return(0,o.Z)((0,o.Z)({},e),{},{loading:!1})})),f.ZP.success("Saved Successfully")})).catch((function(e){E(e),I((function(e){return(0,o.Z)((0,o.Z)({},e),{},{loading:!1})}))}));case 6:e.next=9;break;case 8:f.ZP.error("You don't have permission to add country access");case 9:if(i=[],L.map((function(e){return!M.includes(e)&&i.push(Number(e))})),!((null===i||void 0===i?void 0:i.length)>0)){e.next=18;break}if(!0!==Z){e.next=17;break}return e.next=15,k.removeCountryAccess({userCountryList:i,userId:d}).catch((function(e){f.ZP.error(e.message)}));case 15:e.next=18;break;case 17:f.ZP.error("You don't have permission to remove country access");case 18:c(),r(),e.next=24;break;case 22:f.ZP.info("No changes made"),r();case 24:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,N.jsx)(h.P0,{visible:t,closable:!0,onCancel:r,titleText:"Manage User Country Access",showFooter:!1,children:null!==z&&void 0!==z&&z.loading?(0,N.jsx)(g.Z,{items:10}):(0,N.jsxs)(u.Z,{className:p.Z.form,onFinish:B,form:C,children:[(null===z||void 0===z?void 0:z.error)&&(0,N.jsx)(h.EQ,{description:null===z||void 0===z?void 0:z.error,isClosable:!0,onClose:function(){I((0,o.Z)((0,o.Z)({},z),{},{error:""}))}}),(0,N.jsx)("div",{children:(0,N.jsx)(u.Z.Item,{name:"userCountryList",rules:[{required:!1}],children:(0,N.jsx)(Ie.Z,{dataSource:null===O||void 0===O||null===(n=O.data)||void 0===n?void 0:n.map((function(e,n){var t;return{key:e.id.toString(),title:e.name,description:null===(t=e.name)||void 0===t?void 0:t.toLowerCase()}})),listStyle:{width:250,height:400},showSearch:!0,filterOption:function(e,n){return n.description.indexOf(e.toLowerCase())>-1},targetKeys:M,onChange:function(e){U(e)},render:function(e){return e.title}})})}),(0,N.jsxs)("div",{className:p.Z.footer,children:[(0,N.jsx)(h.op,{size:"normal",fontSize:"sm",onClick:r,type:"plain",children:"Cancel"}),(0,N.jsx)(h.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:null===z||void 0===z?void 0:z.buttonLoading,children:"Save"})]})]})})},Oe=t(18136),Te=t(18515),Le=[{text:"Home",isLink:!0,path:"/"},{isLink:!0,text:"Site Settings",path:"/siteSettings"},{isLink:!1,text:"Users"}];var Ae=function(){var e,n,t,s,l=(0,W.aY)(Oe.f),d=(0,G.v9)((function(e){return e.usersReducer})).userPermissions,c=d.readUser,u=d.createUser,v=d.updateUser,m=d.addUserCountry,p=d.addUserRole,g=(0,i.useState)({editType:"new",recordId:0,openModal:!1}),Z=(0,a.Z)(g,2),x=Z[0],j=Z[1],b=(0,i.useState)({recordId:0,openModal:!1,recordData:{}}),w=(0,a.Z)(b,2),C=w[0],k=w[1],P=(0,i.useState)({recordId:0,openModal:!1,recordData:{}}),_=(0,a.Z)(P,2),z=_[0],I=_[1],R=(0,i.useMemo)((function(){return new y.z}),[]),D=(0,i.useState)({loading:!1,error:{},data:[]}),O=(0,a.Z)(D,2),T=O[0],L=O[1],A=(0,i.useState)({}),F=(0,a.Z)(A,2),M=F[0],U=F[1],E=function(){!1!==u?j((0,o.Z)((0,o.Z)({},x),{},{openModal:!x.openModal,editType:"new"})):f.ZP.error("You don't have permission to create new user")},Y=(0,i.useCallback)((function(e){var n,t;L((0,o.Z)((0,o.Z)({},T),{},{loading:!0}));var i=(0,o.Z)({},M);if(null!==i&&void 0!==i&&i.fromDate){var r,s=null===i||void 0===i||null===(r=i.fromDate)||void 0===r?void 0:r.format("YYYY-MM-DD");i.fromDate=s}if(null!==i&&void 0!==i&&i.toDate){var l,d=null===i||void 0===i||null===(l=i.toDate)||void 0===l?void 0:l.format("YYYY-MM-DD");i.toDate=d}var c={};Object.entries(i).map((function(e){var n=(0,a.Z)(e,2),t=n[0],o=n[1];return(0,N.jsx)(N.Fragment,{children:o&&"number"===typeof o||o&&o.length>0?c[t]=o:null})}));var u=(0,o.Z)((0,o.Z)({page:null===T||void 0===T||null===(n=T.meta)||void 0===n?void 0:n.page,perPage:null===T||void 0===T||null===(t=T.meta)||void 0===t?void 0:t.perPage},c),e);R.getAllRecords(u).then((function(e){L(e.data)})).catch((function(e){var n;L((0,o.Z)((0,o.Z)({},T),{},{loading:!1,error:null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.data}))}))}),[M,R]);return(0,i.useEffect)((function(){Y()}),[Y]),(0,N.jsxs)(r.default,{permissionSlug:l,children:[(0,N.jsx)(h.mr,{heading:"Users",buttonText:"Add New User",onButtonClick:E,breadCrumbData:Le,filters:!0===c?(0,N.jsx)(ze,{filters:M,setFilters:U}):null,showAdd:!0===u}),!0===c&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(re,{tableData:T.data,tableLoading:T.loading,onEditIconClick:function(e){!1!==v?j((0,o.Z)((0,o.Z)({},x),{},{editType:"edit",recordId:e.id,openModal:!0})):f.ZP.error("You don't have permission to update this user")},reloadTableData:Y,onManageRolesClick:function(e){!1!==p?k((0,o.Z)((0,o.Z)({},C),{},{recordId:e.id,recordData:e,openModal:!0})):f.ZP.error("You don't have permission to manage roles for this user")},onCountryAccessClick:function(e){!1!==m?I((0,o.Z)((0,o.Z)({},z),{},{recordId:e.id,recordData:e,openModal:!0})):f.ZP.error("You don't have permission to manage country access for this user")}}),(0,N.jsx)(h.tl,{total:null===T||void 0===T||null===(e=T.meta)||void 0===e?void 0:e.total,current:null===T||void 0===T||null===(n=T.meta)||void 0===n?void 0:n.page,defaultPageSize:null!==T&&void 0!==T&&null!==(t=T.meta)&&void 0!==t&&t.perPage?null===T||void 0===T||null===(s=T.meta)||void 0===s?void 0:s.perPage:10,pageSizeOptions:[10,20,50,100],onChange:function(e,n){return Y({page:e,perPage:n})}})]}),!1===c&&(0,N.jsx)(Te.a$,{mainMessage:"You don't have permission to view this data"}),x.openModal&&(0,N.jsx)(S,{record:x.recordId,type:x.editType,reloadTableData:Y,onCancel:E,openModal:x.openModal,permissions:d}),C.openModal&&(0,N.jsx)(Re,{record:C.recordId,recordData:C.recordData,type:"edit",reloadTableData:Y,onCancel:function(){return k((0,o.Z)((0,o.Z)({},C),{},{openModal:!1}))},openModal:C.openModal,permissions:d}),z.openModal&&(0,N.jsx)(De,{record:z.recordId,recordData:z.recordData,type:"edit",reloadTableData:Y,onCancel:function(){return I((0,o.Z)((0,o.Z)({},z),{},{openModal:!1}))},openModal:z.openModal,permissions:d})]})}},59816:function(e,n,t){t.d(n,{Y:function(){return s}});var o=t(43144),a=t(15671),i=t(49075),r=t(3135),s=(0,o.Z)((function e(){var n=this;(0,a.Z)(this,e),this.endPoint="country",this.allEndpoint="country/all",this.getAllRecords=function(){return i.Z.get(n.allEndpoint)},this.getAvailableRecords=function(){return i.Z.get("".concat(n.endPoint,"/available-country"))},this.getRecordById=function(e){return i.Z.get("".concat(n.endPoint,"/").concat(e))},this.deleteRecord=function(e){return i.Z.delete("".concat(n.endPoint,"/").concat(e))},this.createRecord=function(e){return i.Z.post(n.endPoint+"/",e,{headers:r.C})},this.updateRecord=function(e,t){return i.Z.patch("".concat(n.endPoint,"/").concat(t),e,{headers:r.C})}}))},5190:function(e,n,t){t.d(n,{L:function(){return s}});var o=t(43144),a=t(15671),i=t(49075),r=t(3135),s=(0,o.Z)((function e(){var n=this;(0,a.Z)(this,e),this.endPoint="organization",this.getAllRecords=function(e){return i.Z.get(n.endPoint,{params:e})},this.findPublished=function(e){return i.Z.get(n.endPoint+"/find-published",{params:e})},this.getRecordById=function(e){return i.Z.get("".concat(n.endPoint,"/").concat(e))},this.deleteRecord=function(e){return i.Z.delete("".concat(n.endPoint,"/").concat(e))},this.createRecord=function(e){return i.Z.post(n.endPoint,e,{headers:r.C})},this.updateRecord=function(e,t){return i.Z.patch("".concat(n.endPoint,"/").concat(t),e,{headers:r.C})},this.getTenants=function(){return i.Z.get("xero/getTenants")}}))},99420:function(e,n,t){t.d(n,{U:function(){return r}});var o=t(43144),a=t(15671),i=t(49075),r=(0,o.Z)((function e(){var n=this;(0,a.Z)(this,e),this.endPoint="role",this.getAllRecords=function(e){return i.Z.get(n.endPoint,{params:e})},this.getRecordById=function(e){return i.Z.get("".concat(n.endPoint,"/").concat(e,"?all=true"))},this.deleteRecord=function(e){return i.Z.delete("".concat(n.endPoint,"/").concat(e))},this.createRecord=function(e){return i.Z.post(n.endPoint+"/",e)},this.updateRecord=function(e,t){return i.Z.patch("".concat(n.endPoint,"/").concat(t),e)},this.addElements=function(e,t){return i.Z.post("".concat(n.endPoint,"/addDashboardElement/").concat(t),e)},this.removeElements=function(e,t){return i.Z.post("".concat(n.endPoint,"/removeDashboardElement/").concat(t),e)}}))}}]);