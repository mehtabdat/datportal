"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[5609],{50008:function(e,t,n){n.d(t,{t:function(){return r}});var o=n(47312),i="styles_card__cH2rF",a=n(46417),r=function(){return(0,a.jsx)("div",{className:i,children:(0,a.jsx)(o.Z,{active:!0})})}},87971:function(e,t,n){var o=n(1413),i=n(45987),a=n(47313),r=n(86136),s=n(37388),l=n(67907),d=n(1623),c=n(46417),u=["label","hint","asterisk","helperText","className"],m=r.Z.TextArea,p=(0,a.forwardRef)((function(e,t){var n=e.label,a=e.hint,r=e.asterisk,p=e.helperText,v=e.className,_=(0,i.Z)(e,u);return(0,c.jsxs)(c.Fragment,{children:[n?(0,c.jsxs)("label",{className:d.Z.labelWrap,children:[(0,c.jsx)("span",{children:n}),a?(0,c.jsx)(s.Z,{title:a,children:(0,c.jsx)(l.Z,{})}):null,r?(0,c.jsx)("span",{className:d.Z.asterisk,children:"*"}):null]}):null,(0,c.jsx)(m,(0,o.Z)((0,o.Z)({ref:t},_),{},{className:"".concat(d.Z.inpt," ").concat(v)})),p?(0,c.jsx)("small",{className:d.Z.helperText,children:p}):null]})}));p.defaultProps={autoSize:{minRows:4},placeholder:"Enter text here",asterisk:!1,hint:""},t.Z=p},55891:function(e,t,n){var o=n(78267),i=n(45705),a=n(32344),r=n(80663),s=n(46417);t.Z=function(e){var t=e.label,n=e.children,l=e.placement,d=(0,s.jsx)("div",{className:r.Z.dropdown,children:n});return(0,s.jsx)(o.Z,{trigger:["click"],dropdownRender:function(){return d},placement:l,children:(0,s.jsxs)(i.Z,{className:r.Z.dropdownTrigger,children:[(0,s.jsx)("span",{children:t}),(0,s.jsx)(a.Z,{})]})})}},93082:function(e,t,n){n.d(t,{Z:function(){return k}});var o=n(1413),i=n(29439),a=n(47313),r=n(69309),s=n(25019),l=n(55291),d=n(28770),c=n(39180),u=n(37831),m=n(85336),p=n(5190),v=n(29079),_="styles_date_picker_dropdown__iV82J",h=n(87971),f=n(70816),y=n.n(f),Z=n(42954),g=n(3798),j=n(6027),x=n(46417),P=r.Z.RangePicker,b=[{label:"7 days",value:"7_days"},{label:"15 days",value:"15_days"},{label:"30 days",value:"30_days"},{label:"45 days",value:"45_days"},{label:"90 days",value:"90_days"},{label:"Custom",value:"custom"}],k=function(e){var t=e.setNewProject,n=e.newProject,r=e.onRefresh,f=e.permissions.updateQuotation,k=s.Z.useForm(),w=(0,i.Z)(k,1)[0],q=(0,a.useMemo)((function(){return new p.L}),[]),Y=(0,a.useMemo)((function(){return new Z.K}),[]),I=(0,a.useMemo)((function(){return new j.i}),[]),C=(0,a.useState)(),T=(0,i.Z)(C,2),D=T[0],R=T[1],S=(0,a.useState)({startDate:"",endDate:""}),z=(0,i.Z)(S,2),N=z[0],M=z[1],A=(0,v.K2)({method:q.findPublished,condition:null===n||void 0===n?void 0:n.isOpen}).data,B=(0,v.K2)({method:I.getPublishRecords,condition:null===n||void 0===n?void 0:n.isOpen,initialQuery:{perPage:100}}).data;return(0,x.jsx)(d.Z,{title:"Create Project",open:null===n||void 0===n?void 0:n.isOpen,okText:"Create",cancelText:"Cancel",destroyOnClose:!0,okButtonProps:{loading:null===n||void 0===n?void 0:n.loading},onOk:function(){return w.submit()},zIndex:1e4,onCancel:function(){t({isOpen:!1,quoteId:0,loading:!1,submissionById:0,projectTypeId:0})},wrapProps:{onClick:function(e){return e.stopPropagation()}},children:(0,x.jsxs)(s.Z,{form:w,onFinish:function(e){t((function(e){return(0,o.Z)((0,o.Z)({},e),{},{loading:!0})}));var i=new Date,a=y()(i).format("YYYY-MM-DD"),s="";switch(e.deadlineValue){case"7_days":s=y()(i).add(7,"days").format("YYYY-MM-DD");break;case"15_days":s=y()(i).add(15,"days").format("YYYY-MM-DD");break;case"30_days":s=y()(i).add(30,"days").format("YYYY-MM-DD");break;case"45_days":s=y()(i).add(45,"days").format("YYYY-MM-DD");break;case"90_days":s=y()(i).add(90,"days").format("YYYY-MM-DD");break;case"custom":a=N.startDate,s=N.endDate}delete e.deadlineValue,delete e.rangePicker;var d=(0,o.Z)((0,o.Z)({},e),{},{quoteId:null===n||void 0===n?void 0:n.quoteId,startDate:a,endDate:s});!0===f?Y.autoCreateFromApprovedQuotation(d).then((function(e){var n;l.ZP.success((null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message)||"Project created successfully"),r(),t((function(e){return(0,o.Z)((0,o.Z)({},e),{},{isOpen:!1})}))})).catch((function(e){var t=(0,g.S3)(e);l.ZP.error(t||"Something went wrong")})).finally((function(){t((function(e){return(0,o.Z)((0,o.Z)({},e),{},{loading:!1})}))})):l.ZP.error("You don't have permission to create project, please contact your admin")},name:"create-project-form",children:[(0,x.jsx)(s.Z.Item,{name:"title",rules:[{required:!0,message:"Please input project title!"}],children:(0,x.jsx)(u.Z,{type:"text",placeHolder:"Enter project title",label:"Project Title",size:"w100",asterisk:!0,autoSize:{minRows:2,maxRows:6}})}),(0,x.jsx)(s.Z.Item,{name:"submissionById",initialValue:(null===n||void 0===n?void 0:n.submissionById)||void 0,children:(0,x.jsx)(m.Z,{disabled:!(null===n||void 0===n||!n.submissionById),label:"Submission By",options:null===A||void 0===A?void 0:A.map((function(e){return{label:e.name,value:e.id}}))})}),(0,x.jsx)(s.Z.Item,{name:"projectTypeId",initialValue:(null===n||void 0===n?void 0:n.projectTypeId)||void 0,rules:[{required:!0,message:"Please select project type"}],children:(0,x.jsx)(m.Z,{label:"Project Type",asterisk:!0,placeholder:"Select Project Type",options:null===B||void 0===B?void 0:B.map((function(e){return{value:e.id,label:e.title}}))})}),(0,x.jsxs)("label",{className:"font-size-sm",children:["Deadline  ",(0,x.jsx)("span",{className:"color-red-yp",children:"*"})]}),(0,x.jsxs)("div",{style:{flexDirection:"column",fontSize:"var(--font-size-sm)",gap:0},children:[(0,x.jsx)(s.Z.Item,{name:"deadlineValue",rules:[{required:!0,message:"Please select deadline"}],children:(0,x.jsx)(c.ZP.Group,{optionType:"button",onChange:function(e){var t=e.target;return R(t.value)},children:b.map((function(e,t){return(0,x.jsx)(c.ZP.Button,{value:e.value,children:e.label},t)}))})}),"custom"===D&&(0,x.jsx)(s.Z.Item,{name:"rangePicker",rules:[{required:!0,message:"Please select deadline"}],children:(0,x.jsx)(P,{onChange:function(e){var t,n;2===(null===e||void 0===e?void 0:e.length)&&M({startDate:(null===(t=e[0])||void 0===t?void 0:t.format("YYYY-MM-DD"))||"",endDate:(null===(n=e[1])||void 0===n?void 0:n.format("YYYY-MM-DD"))||""})},dropdownClassName:_})})]}),(0,x.jsx)(s.Z.Item,{name:"instructions",children:(0,x.jsx)(h.Z,{placeholder:"Enter instructions",label:"Instructions",autoSize:{minRows:2,maxRows:6}})}),(0,x.jsx)(s.Z.Item,{name:"xeroReference",help:(0,x.jsx)("small",{className:"color-yellow-dark",children:"CAUTION: Do not add XERO reference if you are not sure about it."}),children:(0,x.jsx)(u.Z,{type:"text",placeHolder:"Enter Project Xero Reference",label:"Project Xero Reference",size:"w100"})})]})})}},76017:function(e,t,n){var o=n(1413),i=n(47313),a=n(55291),r=n(5900),s=n(59491),l=n(37936),d=n(3798),c=n(42954),u=n(82626),m=n(46417);t.Z=function(e){var t=e.item,n=e.onRefresh,p=e.permissions,v=e.setDrawer,_=e.setNewProject,h=p.updateQuotation,f=(0,i.useMemo)((function(){return new c.K}),[]);return(0,m.jsxs)("div",{className:"d-flex flex-column align-center font-size-sm color-dark-800",children:[(null===t||void 0===t?void 0:t.status)!==l.nE.New&&(null===t||void 0===t?void 0:t.status)!==l.nE.Sent&&(0,m.jsx)("span",{children:l.nE[null===t||void 0===t?void 0:t.status]}),(null===t||void 0===t?void 0:t.status)===l.nE.New&&(0,m.jsx)(u.Tr,{trigger:["click"],size:"small",type:"ghost",label:"Submit Now",onClick:function(e){e.stopPropagation(),v((function(e){return(0,o.Z)((0,o.Z)({},e),{},{open:!0,quoteId:null===t||void 0===t?void 0:t.id,type:"preview",quotation:t})}))},items:[{label:"Mark as sent",value:"markAsSent"}].map((function(e,o){return{key:"option-".concat(o),label:e.label,onClick:function(){return e=null===t||void 0===t?void 0:t.id,void(!0===h?f.markAsSent(e).then((function(e){var t;a.ZP.success((null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Quotation marked as sent successfully"),n()})).catch((function(e){var t=(0,d.S3)(e);a.ZP.error(t||"Something went wrong")})):a.ZP.error("You don't have permission to mark quotation as sent"));var e}}}))}),(null===t||void 0===t?void 0:t.status)===l.nE.Sent&&(0,m.jsxs)("div",{className:"d-flex",children:[t.projectId>0?(0,m.jsx)(r.Z,{title:"Approving this quotation will link it to the existing project. Are you sure?",okText:"Yes",cancelText:"No",placement:"bottomRight",zIndex:1e4,onCancel:function(e){return null===e||void 0===e?void 0:e.stopPropagation()},onConfirm:function(e){null===e||void 0===e||e.stopPropagation(),function(e){!0===h?f.autoCreateFromApprovedQuotation(e).then((function(){a.ZP.success("Quotation linked to project successfully"),n()})).catch((function(e){var t=(0,d.S3)(e);a.ZP.error(t||"Something went wrong")})):a.ZP.error("You don't have permission to link quotation to project, please contact your administrator")}({quoteId:null===t||void 0===t?void 0:t.id,title:"Existing Project"})},destroyTooltipOnHide:!0,children:(0,m.jsx)(s.Z,{type:"ghost",size:"small",style:{fontSize:"0.7rem",borderColor:"var(--color-primary-main)",color:"var(--color-primary-main)"},onClick:function(e){return e.stopPropagation()},children:"Approve"})}):(0,m.jsx)(s.Z,{type:"ghost",size:"small",style:{fontSize:"0.8rem",borderColor:"var(--color-primary-main)",color:"var(--color-primary-main)"},onClick:function(e){var n,i,a,r;e.stopPropagation(),v((function(e){return(0,o.Z)((0,o.Z)({},e),{},{open:!1})})),_&&_({isOpen:!0,quoteId:null===t||void 0===t?void 0:t.id,loading:!1,submissionById:null===t||void 0===t||null===(n=t.Lead)||void 0===n||null===(i=n.SubmissionBy)||void 0===i?void 0:i.id,projectTypeId:null===t||void 0===t||null===(a=t.Lead)||void 0===a||null===(r=a.ProjectType)||void 0===r?void 0:r.id})},children:"Approve"}),(0,m.jsx)(s.Z,{type:"ghost",size:"small",style:{fontSize:"0.8rem",borderColor:"#FFA000",color:"#FFA000"},className:"ml-1",onClick:function(e){null===e||void 0===e||e.stopPropagation(),v((function(e){return(0,o.Z)((0,o.Z)({},e),{},{open:!0,quoteId:null===t||void 0===t?void 0:t.id,type:"revise",quotation:t})}))},children:"Revise & Resend"}),(0,m.jsx)(r.Z,{title:"Are you sure you want to reject this quotation?",okText:"Yes",cancelText:"No",placement:"bottomRight",onCancel:function(e){return null===e||void 0===e?void 0:e.stopPropagation()},onConfirm:function(e){var o,i;null===e||void 0===e||e.stopPropagation(),o=null===t||void 0===t?void 0:t.id,i=l.nE.Rejected,!0===h?f.changeStatus(o,i).then((function(e){var t;a.ZP.success((null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Quotation status updated successfully"),n()})).catch((function(e){var t=(0,d.S3)(e);a.ZP.error(t||"Something went wrong")})):a.ZP.error("You don't have permission to update quotation status")},destroyTooltipOnHide:!0,zIndex:1e4,children:(0,m.jsx)(s.Z,{type:"ghost",size:"small",danger:!0,className:"ml-1",style:{fontSize:"0.8rem"},onClick:function(e){return e.stopPropagation()},children:"Reject"})})]})]})}},5190:function(e,t,n){n.d(t,{L:function(){return s}});var o=n(43144),i=n(15671),a=n(49075),r=n(3135),s=(0,o.Z)((function e(){var t=this;(0,i.Z)(this,e),this.endPoint="organization",this.getAllRecords=function(e){return a.Z.get(t.endPoint,{params:e})},this.findPublished=function(e){return a.Z.get(t.endPoint+"/find-published",{params:e})},this.getRecordById=function(e){return a.Z.get("".concat(t.endPoint,"/").concat(e))},this.deleteRecord=function(e){return a.Z.delete("".concat(t.endPoint,"/").concat(e))},this.createRecord=function(e){return a.Z.post(t.endPoint,e,{headers:r.C})},this.updateRecord=function(e,n){return a.Z.patch("".concat(t.endPoint,"/").concat(n),e,{headers:r.C})},this.getTenants=function(){return a.Z.get("xero/getTenants")}}))},55768:function(e,t,n){n.d(t,{Z:function(){return l}});var o=n(87462),i=n(47313),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"},r=n(16141),s=function(e,t){return i.createElement(r.Z,(0,o.Z)({},e,{ref:t,icon:a}))};var l=i.forwardRef(s)},80663:function(e,t){t.Z={quotations:"styles_quotations__QMx7r",quotation_item:"styles_quotation_item__kZKZP",quotation_item_header:"styles_quotation_item_header__1LbXZ",quotation_item_header_left:"styles_quotation_item_header_left__hOOqB",quotation_item_header_actions:"styles_quotation_item_header_actions__qQc2E",quotation_item_header_actions_items:"styles_quotation_item_header_actions_items__l0APz",quotation_item_header_actions_status:"styles_quotation_item_header_actions_status__Ghlfk",quotation_item_header_actions_more:"styles_quotation_item_header_actions_more__fk7Bo",quotation_item_header_title:"styles_quotation_item_header_title__7rMq7",quotation_item_header_email:"styles_quotation_item_header_email__fXZiR",quotation_item_header_phone:"styles_quotation_item_header_phone__j5CBI",quotation_item_cards:"styles_quotation_item_cards__I4Nh1",quotation_item_body:"styles_quotation_item_body__JAx+k",dropdownTrigger:"styles_dropdownTrigger__yXekU",dropdown:"styles_dropdown__wJtT1",table_column:"styles_table_column__+Bpjs",accordianItem:"styles_accordianItem__dOT51"}}}]);