"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[3791],{70815:function(e,n,t){t.d(n,{r:function(){return h}});var o=t(1413),r=t(29439),i=t(45987),a=t(55291),d=t(86345),c=t(47313),s=t(40169),u=t(46417),l=["onChange","checked","recordId","allowChange"],h=function(e){var n=e.onChange,t=e.checked,h=e.recordId,m=e.allowChange,Z=void 0===m||m,f=(0,i.Z)(e,l),p=(0,c.useState)({loading:!1,checked:!1}),g=(0,r.Z)(p,2),x=g[0],y=g[1];return(0,c.useEffect)((function(){y((0,o.Z)((0,o.Z)({},x),{},{checked:t}))}),[t]),(0,u.jsx)(d.Z,{checked:x.checked,onChange:function(e){!0===Z?(y((0,o.Z)((0,o.Z)({},x),{},{loading:!0})),n(e,h,f).then((function(n){y((0,o.Z)((0,o.Z)({},x),{},{checked:e,loading:!1})),a.ZP.success(n.data.message)})).catch((function(e){y((0,o.Z)((0,o.Z)({},x),{},{loading:!1}));var n=(0,s.P)(e);"string"===typeof n.message?a.ZP.error(n.message):a.ZP.error("Something went wrong")}))):a.ZP.error("You don't have permission to change this record, please contact your admin.")},loading:x.loading})}},3791:function(e,n,t){t.r(n),t.d(n,{default:function(){return E}});var o=t(1413),r=t(29439),i=t(47313),a=t(7532),d=t(25019),c=t(55291),s=t(82626),u=t(17327),l=t(49355),h=t(46646),m=t(40169),Z=t(43144),f=t(15671),p=t(49075),g=(0,Z.Z)((function e(){var n=this;(0,f.Z)(this,e),this.endPoint="currency",this.getAllRecords=function(){return p.Z.get(n.endPoint)},this.getRecordById=function(e){return p.Z.get("".concat(n.endPoint,"/").concat(e))},this.deleteRecord=function(e){return p.Z.delete("".concat(n.endPoint,"/").concat(e))},this.createRecord=function(e){return p.Z.post(n.endPoint+"/",e)},this.updateRecord=function(e,t){return p.Z.patch("".concat(n.endPoint,"/").concat(t),e)}})),x=t(46417),y=function(e){var n=e.openModal,t=e.onCancel,a=e.type,Z=e.record,f=e.reloadTableData,p=e.permissions,y=p.createCurrency,b=p.updateCurrency,C=d.Z.useForm(),v=(0,r.Z)(C,1)[0],k=(0,i.useMemo)((function(){return new g}),[]),j=(0,i.useState)(),P=(0,r.Z)(j,2),w=P[0],I=P[1],L=function(e){var n=(0,m.P)(e);if("string"==typeof n.message)I((0,o.Z)((0,o.Z)({},w),{},{error:n.message}));else{var t=(0,h.O)(n.message,[]);v.setFields(t),I((0,o.Z)((0,o.Z)({},w),{},{error:""}))}},T=(0,i.useCallback)((function(){k.getRecordById(Z).then((function(e){e.data&&e.data.data&&(v.setFieldsValue((0,o.Z)((0,o.Z)({translations:e.data.data.localization},e.data.data),{},{isPublished:e.data.data.isPublished})),I((0,o.Z)((0,o.Z)({},e.data),{},{loading:!1})))})).catch((function(e){L(e)}))}),[v,Z,k]);(0,i.useEffect)((function(){"edit"===a?(I({loading:!0}),T()):v.resetFields()}),[n,a,v,T]);return(0,x.jsx)(s.P0,{visible:n,closable:!0,onCancel:t,titleText:"edit"===a?"Edit Currency":"Add New Currency",showFooter:!1,children:null!==w&&void 0!==w&&w.loading?(0,x.jsx)(l.Z,{items:10}):(0,x.jsxs)(d.Z,{className:u.Z.form,onFinish:function(e){switch(I((0,o.Z)((0,o.Z)({},w),{},{buttonLoading:!0})),a){case"new":!0===y?k.createRecord(e).then((function(e){f(),t(),I((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){L(e),I((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})):(I((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})})),c.ZP.error("You don't have permission to create a new record"));break;case"edit":!0===b?k.updateRecord(e,null===w||void 0===w?void 0:w.data.id).then((function(e){f(),t(),I((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){L(e),I((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})):(I((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})})),c.ZP.error("You don't have permission to update this record"))}},form:v,children:[(null===w||void 0===w?void 0:w.error)&&(0,x.jsx)(s.EQ,{description:null===w||void 0===w?void 0:w.error,isClosable:!0,onClose:function(){I((0,o.Z)((0,o.Z)({},w),{},{error:""}))}}),(0,x.jsx)("div",{children:(0,x.jsx)(d.Z.Item,{name:"name",rules:[{required:!0,message:"Please add currency name"}],children:(0,x.jsx)(s.t7,{size:"w100",label:"Name",asterisk:!0,type:"text"})})}),(0,x.jsxs)("div",{children:[(0,x.jsx)(d.Z.Item,{name:"code",rules:[{required:!0,message:"Please add currency code"}],children:(0,x.jsx)(s.t7,{size:"w100",label:"Code",asterisk:!0,type:"text"})}),(0,x.jsx)(d.Z.Item,{name:"rate",rules:[{required:!0,message:"Please add currency rate"}],children:(0,x.jsx)(s.t7,{size:"w100",label:"Rate",asterisk:!0,type:"text"})})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)(d.Z.Item,{name:"symbol",rules:[{required:!0,message:"Please add currency symbol"}],children:(0,x.jsx)(s.t7,{size:"w100",label:"Symbol",asterisk:!0,type:"text"})}),(0,x.jsx)(d.Z.Item,{name:"isPublished",children:(0,x.jsx)(s.AP,{label:"Published",options:[{value:!0,label:"Yes"},{value:!1,label:"No"}]})})]}),(0,x.jsx)("div",{}),(0,x.jsxs)("div",{className:u.Z.footer,children:[(0,x.jsx)(s.op,{size:"normal",fontSize:"sm",onClick:t,type:"plain",children:"Cancel"}),(0,x.jsx)(s.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:null===w||void 0===w?void 0:w.buttonLoading,children:"Submit"})]})]})})},b=t(5900),C=t(41586),v=t(98676),k=t(3109),j=t(70815),P=t(85554),w=function(e){var n=e.record,t=e.onEditIconClick,a=e.reloadTableData,d=e.permissions.deleteCurrency,s=(0,i.useState)({confirmLoading:!1,openPopConfirm:!1}),l=(0,r.Z)(s,2),h=l[0],m=l[1],Z=(0,i.useMemo)((function(){return new g}),[]);return(0,x.jsxs)("div",{className:u.Z.actions,children:[(0,x.jsx)("span",{onClick:function(){return t(n)},children:(0,x.jsx)("img",{src:"/images/editicon.svg",alt:""})}),(0,x.jsx)(b.Z,{open:h.openPopConfirm,placement:"top",title:"Are you sure?",onConfirm:function(){if(m((0,o.Z)((0,o.Z)({},h),{},{confirmLoading:!0})),!1===d)return c.ZP.error("You don't have permission to delete this record, please contact your admin."),void m((0,o.Z)((0,o.Z)({},h),{},{openPopConfirm:!1}));Z.deleteRecord(n.id).then((function(e){m((0,o.Z)((0,o.Z)({},h),{},{openPopConfirm:!1,confirmLoading:!1})),a()})).catch((function(e){m((0,o.Z)((0,o.Z)({},h),{},{confirmLoading:!1}))}))},onCancel:function(){return m((0,o.Z)((0,o.Z)({},h),{},{openPopConfirm:!1}))},okButtonProps:{loading:h.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:function(e){e||m((0,o.Z)((0,o.Z)({},h),{},{openPopConfirm:!1}))},children:(0,x.jsx)(v.Z,{className:u.Z.bg__red,onClick:function(){m((0,o.Z)((0,o.Z)({},h),{},{openPopConfirm:!0}))}})})]})};function I(e){var n=e.tableData,t=e.tableLoading,o=e.onEditIconClick,r=e.reloadTableData,i=(0,P.v9)((function(e){return e.usersReducer})).userPermissions,a=new g,d=function(e,n){return a.updateRecord({isPublished:e},n)},c=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,n,t){return t+1},width:"6%"},{title:"Name",dataIndex:"name",key:"name",render:function(e){return(0,x.jsx)(k.Z,{color:"dark-main",size:"sm",weight:"bold",children:e})}},{title:"Code",dataIndex:"code",key:"code",render:function(e){return(0,x.jsx)(k.Z,{color:"dark-main",size:"sm",weight:"bold",children:e})}},{title:"Symbol",dataIndex:"symbol",key:"symbol",render:function(e){return(0,x.jsx)(k.Z,{color:"dark-main",size:"sm",weight:"bold",children:e})}},{title:"Rate",dataIndex:"rate",key:"rate",render:function(e){return(0,x.jsx)(k.Z,{color:"dark-main",size:"sm",weight:"bold",children:e})}},{title:"Published",dataIndex:"isPublished",key:"isPublished",render:function(e,n){return(0,x.jsx)(j.r,{checked:e,onChange:d,recordId:n.id,allowChange:i.updateCurrency})}},{title:"Actions",dataIndex:"actions",key:"actions",render:function(e,n){return(0,x.jsx)(w,{record:n,onEditIconClick:o,reloadTableData:r,permissions:i})}}];return(0,x.jsx)("div",{className:u.Z.antdTableWrapper,children:(0,x.jsx)(C.Z,{sticky:!0,dataSource:n,columns:c,pagination:!1,scroll:{x:991},loading:t,rowKey:function(e){return"site-currency-".concat(e.id)}})})}var L=function(e){return e.CREATE="createCurrency",e.UPDATE="updateCurrency",e.DELETE="deleteCurrency",e.READ="readCurrency",e}({}),T=t(18515),R=t(3798),S=[{text:"Home",isLink:!0,path:"/"},{isLink:!0,text:"Site Settings",path:"/siteSettings"},{isLink:!1,text:"Currency"}];var E=function(){var e=(0,R.aY)(L),n=(0,P.v9)((function(e){return e.usersReducer})).userPermissions,t=n.readCurrency,d=n.createCurrency,u=n.updateCurrency,l=(0,i.useState)({editType:"new",recordId:0,openModal:!1}),h=(0,r.Z)(l,2),m=h[0],Z=h[1],f=new g,p=(0,i.useState)({data:[]}),b=(0,r.Z)(p,2),C=b[0],v=b[1],k=function(){!1!==d?Z((0,o.Z)((0,o.Z)({},m),{},{openModal:!m.openModal,editType:"new"})):c.ZP.error("You don't have permission to update this record")},j=function(){v((0,o.Z)((0,o.Z)({},C),{},{loading:!0})),f.getAllRecords().then((function(e){v(e.data)})).catch((function(e){}))};return(0,i.useEffect)((function(){j()}),[]),(0,x.jsxs)(a.default,{permissionSlug:e,children:[(0,x.jsx)(s.mr,{heading:"Currency",buttonText:"Add New Currency",onButtonClick:k,breadCrumbData:S,showAdd:!0===d}),!0===t&&(0,x.jsx)(I,{tableData:C.data,tableLoading:C.loading,onEditIconClick:function(e){!1!==u?Z((0,o.Z)((0,o.Z)({},m),{},{editType:"edit",recordId:e.id,openModal:!0})):c.ZP.error("You don't have permission to update this record")},reloadTableData:j}),!1===t&&(0,x.jsx)(T.a$,{mainMessage:"You don't have permission to view this data"}),m.openModal&&(0,x.jsx)(y,{record:m.recordId,type:m.editType,reloadTableData:j,onCancel:k,openModal:m.openModal,permissions:n})]})}}}]);