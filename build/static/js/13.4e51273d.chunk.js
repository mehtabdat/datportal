"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[13],{70815:function(e,n,t){t.d(n,{r:function(){return f}});var o=t(1413),i=t(29439),a=t(45987),r=t(55291),s=t(86345),c=t(47313),d=t(40169),l=t(46417),u=["onChange","checked","recordId","allowChange"],f=function(e){var n=e.onChange,t=e.checked,f=e.recordId,g=e.allowChange,h=void 0===g||g,p=(0,a.Z)(e,u),Z=(0,c.useState)({loading:!1,checked:!1}),m=(0,i.Z)(Z,2),v=m[0],x=m[1];return(0,c.useEffect)((function(){x((0,o.Z)((0,o.Z)({},v),{},{checked:t}))}),[t]),(0,l.jsx)(s.Z,{checked:v.checked,onChange:function(e){!0===h?(x((0,o.Z)((0,o.Z)({},v),{},{loading:!0})),n(e,f,p).then((function(n){x((0,o.Z)((0,o.Z)({},v),{},{checked:e,loading:!1})),r.ZP.success(n.data.message)})).catch((function(e){x((0,o.Z)((0,o.Z)({},v),{},{loading:!1}));var n=(0,d.P)(e);"string"===typeof n.message?r.ZP.error(n.message):r.ZP.error("Something went wrong")}))):r.ZP.error("You don't have permission to change this record, please contact your admin.")},loading:v.loading})}},30013:function(e,n,t){t.r(n),t.d(n,{default:function(){return M}});var o=t(1413),i=t(29439),a=t(47313),r=t(7532),s=t(25019),c=t(55291),d=t(82626),l=t(17327),u=t(49355),f=t(3798),g=t(46646),h=t(40169),p=t(71522),Z=t(46417),m=function(e){var n,t=e.openModal,r=e.onCancel,m=e.type,v=e.record,x=e.reloadTableData,P=e.permissions,S=P.createSitePagesSection,C=P.updateSitePagesSection,b=s.Z.useForm(),j=(0,i.Z)(b,1)[0],k=(0,a.useMemo)((function(){return new p.Y}),[]),w=(0,a.useState)(),y=(0,i.Z)(w,2),I=y[0],E=y[1],T=function(e){var n=(0,h.P)(e);if("string"==typeof n.message)E((0,o.Z)((0,o.Z)({},I),{},{error:n.message}));else{var t=(0,g.O)(n.message,[]);j.setFields(t),E((0,o.Z)((0,o.Z)({},I),{},{error:""}))}},L=(0,a.useCallback)((function(){k.getRecordById(v).then((function(e){e.data&&e.data.data&&(j.setFieldsValue((0,o.Z)({},e.data.data)),E((0,o.Z)((0,o.Z)({},e.data),{},{loading:!1})))})).catch((function(e){T(e)}))}),[j,v,k]);(0,a.useEffect)((function(){"edit"===m?(E({loading:!0}),L()):j.resetFields()}),[t,m,j,L]);return(0,Z.jsx)(d.P0,{visible:t,closable:!0,onCancel:r,titleText:"edit"===m?"Edit Pages Section":"Add New Pages Section",showFooter:!1,children:null!==I&&void 0!==I&&I.loading?(0,Z.jsx)(u.Z,{items:10}):(0,Z.jsxs)(s.Z,{className:l.Z.form,onFinish:function(e){E((0,o.Z)((0,o.Z)({},I),{},{buttonLoading:!0}));var n=e;switch(m){case"edit":!0===C?k.updateRecord(n,null===I||void 0===I?void 0:I.data.id).then((function(e){x(),r(),E((function(e){return(0,o.Z)((0,o.Z)({},e),{},{loading:!1})}))})).catch((function(e){T(e),E((function(e){return(0,o.Z)((0,o.Z)({},e),{},{loading:!1})}))})):(E((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})})),c.ZP.error("You don't have permission to update this record"));break;case"new":!0===S?k.createRecord(n).then((function(e){x(),r(),E((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){T(e),E((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})):(E((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})})),c.ZP.error("You don't have permission to create new record"))}},form:j,children:[(null===I||void 0===I?void 0:I.error)&&(0,Z.jsx)(d.EQ,{description:null===I||void 0===I?void 0:I.error,isClosable:!0,onClose:function(){E((0,o.Z)((0,o.Z)({},I),{},{error:""}))}}),(0,Z.jsxs)("div",{children:[(0,Z.jsx)(s.Z.Item,{name:"title",rules:[{required:!0,message:"Please name a section"}],children:(0,Z.jsx)(d.t7,{size:"w100",label:"Title",asterisk:!0,type:"text"})}),(0,Z.jsx)(s.Z.Item,{name:"slug",rules:[{required:!0,message:"Please add a slug"}],children:(0,Z.jsx)(d.t7,{onChange:function(e){var n=e.target,t=(0,f.V3)(n.value);j.setFieldsValue({slug:t})},size:"w100",label:"Slug",asterisk:!0,type:"text"})})]}),(0,Z.jsx)("div",{children:(0,Z.jsx)(s.Z.Item,{name:"description",rules:[{required:!1}],children:(0,Z.jsx)(d.t7,{size:"w100",label:"Description",type:"textArea",defaultValue:null===I||void 0===I||null===(n=I.data)||void 0===n?void 0:n.description})})}),(0,Z.jsx)("div",{children:(0,Z.jsx)(s.Z.Item,{name:"isPublished",children:(0,Z.jsx)(d.AP,{label:"Published",options:[{value:!0,label:"Yes"},{value:!1,label:"No"}]})})}),(0,Z.jsxs)("div",{className:l.Z.footer,children:[(0,Z.jsx)(d.op,{size:"normal",fontSize:"sm",onClick:r,type:"plain",children:"Cancel"}),(0,Z.jsx)(d.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:null===I||void 0===I?void 0:I.buttonLoading,children:"Submit"})]})]})})},v=t(8570),x=t(5900),P=t(41586),S=t(98676),C=t(70815),b=t(23369),j=t(85554),k=v.Z.Paragraph,w=function(e){var n=e.record,t=e.onEditIconClick,r=e.reloadTableData,s=e.permissions.deleteSitePagesSection,d=(0,a.useState)({confirmLoading:!1,openPopConfirm:!1}),u=(0,i.Z)(d,2),f=u[0],g=u[1],h=(0,a.useMemo)((function(){return new p.Y}),[]);return(0,Z.jsxs)("div",{className:l.Z.actions,children:[(0,Z.jsx)("span",{onClick:function(){return t(n)},children:(0,Z.jsx)("img",{src:"/images/editicon.svg",alt:""})}),(0,Z.jsx)(x.Z,{open:f.openPopConfirm,placement:"top",title:"Are you sure?",onConfirm:function(){if(g((0,o.Z)((0,o.Z)({},f),{},{confirmLoading:!0})),!1===s)return c.ZP.error("You don't have permission to delete this record, please contact your admin."),void g((0,o.Z)((0,o.Z)({},f),{},{openPopConfirm:!1}));h.deleteRecord(n.id).then((function(e){g((0,o.Z)((0,o.Z)({},f),{},{openPopConfirm:!1,confirmLoading:!1})),r()})).catch((function(e){g((0,o.Z)((0,o.Z)({},f),{},{confirmLoading:!1}))}))},onCancel:function(){return g((0,o.Z)((0,o.Z)({},f),{},{openPopConfirm:!1}))},okButtonProps:{loading:f.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:function(e){e||g((0,o.Z)((0,o.Z)({},f),{},{openPopConfirm:!1}))},children:(0,Z.jsx)(S.Z,{className:l.Z.bg__red,onClick:function(){g((0,o.Z)((0,o.Z)({},f),{},{openPopConfirm:!0}))}})})]})};function y(e){var n=e.tableData,t=e.tableLoading,o=e.onEditIconClick,i=e.reloadTableData,a=(0,j.v9)((function(e){return e.usersReducer})).userPermissions,r=a.updateSitePagesSection,s=a.readSitePagesContent,c=new p.Y,d=function(e,n){return c.updateRecord({isPublished:e},n)},u=function(e,n){return e?c.allowMultiples(n):c.disallowMultiples(n)},f=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,n,t){return t+1},width:"5%"},{title:"Title",dataIndex:"title",key:"title",render:function(e,n){return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("h3",{className:"mb-0 font-size-normal",children:e}),(0,Z.jsx)(k,{title:n.slug,ellipsis:{rows:1,expandable:!1},copyable:{text:n.slug},className:"font-size-sm color-dark-sub mb-0",children:n.slug}),(0,Z.jsx)("p",{className:"mb-0 font-size-sm color-dark-sub",children:null===n||void 0===n?void 0:n.description})]})}},{title:"Pages Content",key:"pageContent",render:function(e,n){return(0,Z.jsx)(Z.Fragment,{children:!0===s?(0,Z.jsx)("a",{href:"/siteSettings/pages-section/content?sectionId=".concat(n.id),target:"_blank",rel:"noreferrer",children:"Manage Content"}):null})}},{title:"Allow Multiple Content",dataIndex:"hasMultipleItems",key:"hasMultipleItems",render:function(e,n){return(0,Z.jsx)(C.r,{checked:e,onChange:u,recordId:n.id,allowChange:r})}},{title:"Published",dataIndex:"isPublished",key:"isPublished",render:function(e,n){return(0,Z.jsx)(C.r,{checked:e,onChange:d,recordId:n.id,allowChange:r})}},{title:"Actions",dataIndex:"actions",key:"actions",render:function(e,n){return(0,Z.jsx)(w,{record:n,onEditIconClick:o,reloadTableData:i,permissions:a})}}];return(0,Z.jsx)("div",{className:l.Z.antdTableWrapper,children:(0,Z.jsx)(P.Z,{sticky:!0,dataSource:n,columns:f,pagination:!1,scroll:{x:991},loading:t,rowKey:function(e){return"site-pages-section-".concat(e.id)}})})}var I=t(42623),E=t(18812),T=t(18515),L=[{text:"Home",isLink:!0,path:"/"},{isLink:!0,text:"Site Settings",path:"/siteSettings"},{isLink:!0,text:"Site Pages",path:"/siteSettings/site-pages"},{isLink:!1,text:"Site Pages Section"}];var M=function(){var e=(0,f.aY)(E.v);e.push(b.f.READ);var n=(0,j.v9)((function(e){return e.usersReducer})).userPermissions,t=n.readSitePagesSection,s=n.createSitePagesSection,l=n.updateSitePagesSection,u=(0,a.useState)({editType:"new",recordId:0,openModal:!1}),g=(0,i.Z)(u,2),h=g[0],v=g[1],x=new p.Y,P=(0,a.useState)({isLoading:!1,error:{},data:[]}),S=(0,i.Z)(P,2),C=S[0],k=S[1],w=(0,a.useState)(""),M=(0,i.Z)(w,2),R=M[0],A=M[1],D=(0,I.N)(R,500),Y=(0,a.useState)(),N=(0,i.Z)(Y,2),z=N[0],F=N[1],_=function(){!1!==s?v((0,o.Z)((0,o.Z)({},h),{},{openModal:!h.openModal,editType:"new"})):c.ZP.error("You don't have permission to create new record")},B=function(){k((0,o.Z)((0,o.Z)({},C),{},{loading:!0})),x.getAllRecords().then((function(e){k(e.data)})).catch((function(e){}))};(0,a.useEffect)((function(){B()}),[]);var V=(0,a.useCallback)((function(){if(D){var e=(null===C||void 0===C?void 0:C.data).filter((function(e){return e.title.toLowerCase().includes(D.toLowerCase())}));F(e)}else F(void 0)}),[D,null===C||void 0===C?void 0:C.data]);return(0,a.useEffect)((function(){V()}),[V]),(0,Z.jsxs)(r.default,{permissionSlug:e,children:[(0,Z.jsx)(d.mr,{heading:"Site Pages Section",buttonText:"Add new section",onButtonClick:_,breadCrumbData:L,showAdd:!0===s,filters:!0===t?(0,Z.jsx)("div",{children:(0,Z.jsx)("div",{children:(0,Z.jsx)(d.t7,{placeHolder:"Search...",icon:(0,Z.jsx)("img",{src:"/images/searchIcon.svg",alt:"Search Icon"}),size:"w100",className:"py-1",value:R,onChange:function(e){var n=e.currentTarget.value;A(n)}})})}):null}),!0===t&&(0,Z.jsx)(y,{tableData:z||(null===C||void 0===C?void 0:C.data),tableLoading:C.loading,onEditIconClick:function(e){!1!==l?v((0,o.Z)((0,o.Z)({},h),{},{editType:"edit",recordId:e.id,openModal:!0})):c.ZP.error("You don't have permission to update this record")},reloadTableData:B}),!1===t&&(0,Z.jsx)(T.a$,{mainMessage:"You don't have permission to view this data"}),h.openModal&&(0,Z.jsx)(m,{record:h.recordId,type:h.editType,reloadTableData:B,onCancel:_,openModal:h.openModal,permissions:n})]})}},71522:function(e,n,t){t.d(n,{Y:function(){return s}});var o=t(43144),i=t(15671),a=t(49075),r=t(3135),s=(0,o.Z)((function e(){var n=this;(0,i.Z)(this,e),this.endPoint="site-pages-section",this.createRecord=function(e){return a.Z.post(n.endPoint+"/",e,{headers:r.C})},this.getAllRecords=function(e){return a.Z.get(n.endPoint,{params:e})},this.getRecordById=function(e){return a.Z.get("".concat(n.endPoint,"/").concat(e,"?all=true"))},this.updateRecord=function(e,t){return a.Z.patch("".concat(n.endPoint,"/").concat(t),e,{headers:r.C})},this.allowMultiples=function(e){return a.Z.patch("".concat(n.endPoint,"/allowMultiples/").concat(e))},this.disallowMultiples=function(e){return a.Z.patch("".concat(n.endPoint,"/disallowMultiples/").concat(e))},this.deleteRecord=function(e){return a.Z.delete("".concat(n.endPoint,"/").concat(e))}}))},18812:function(e,n,t){t.d(n,{v:function(){return o}});var o=function(e){return e.CREATE="createSitePagesSection",e.UPDATE="updateSitePagesSection",e.DELETE="deleteSitePagesSection",e.READ="readSitePagesSection",e}({})},23369:function(e,n,t){t.d(n,{f:function(){return o}});var o=function(e){return e.CREATE="createSitePagesContent",e.UPDATE="updateSitePagesContent",e.DELETE="deleteSitePagesContent",e.READ="readSitePagesContent",e}({})}}]);