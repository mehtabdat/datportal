"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[6800],{70815:function(e,n,t){t.d(n,{r:function(){return h}});var i=t(1413),o=t(29439),a=t(45987),r=t(55291),d=t(86345),s=t(47313),l=t(40169),c=t(46417),u=["onChange","checked","recordId","allowChange"],h=function(e){var n=e.onChange,t=e.checked,h=e.recordId,p=e.allowChange,g=void 0===p||p,f=(0,a.Z)(e,u),m=(0,s.useState)({loading:!1,checked:!1}),Z=(0,o.Z)(m,2),v=Z[0],x=Z[1];return(0,s.useEffect)((function(){x((0,i.Z)((0,i.Z)({},v),{},{checked:t}))}),[t]),(0,c.jsx)(d.Z,{checked:v.checked,onChange:function(e){!0===g?(x((0,i.Z)((0,i.Z)({},v),{},{loading:!0})),n(e,h,f).then((function(n){x((0,i.Z)((0,i.Z)({},v),{},{checked:e,loading:!1})),r.ZP.success(n.data.message)})).catch((function(e){x((0,i.Z)((0,i.Z)({},v),{},{loading:!1}));var n=(0,l.P)(e);"string"===typeof n.message?r.ZP.error(n.message):r.ZP.error("Something went wrong")}))):r.ZP.error("You don't have permission to change this record, please contact your admin.")},loading:v.loading})}},96800:function(e,n,t){t.r(n),t.d(n,{default:function(){return S}});var i=t(1413),o=t(29439),a=t(47313),r=t(7532),d=t(25019),s=t(55291),l=t(86345),c=t(82626),u=t(17327),h=t(49355),p=t(3798),g=t(46646),f=t(40169),m=t(35367),Z=t(46417),v=function(e){var n=e.openModal,t=e.onCancel,r=e.type,v=e.record,x=e.reloadTableData,y=e.permissions,b=y.createLeaveType,j=y.updateLeaveType,T=d.Z.useForm(),P=(0,o.Z)(T,1)[0],k=new m.F,C=(0,a.useState)(),L=(0,o.Z)(C,2),w=L[0],I=L[1],F=function(e){var n=(0,f.P)(e);if("string"==typeof n.message)I((0,i.Z)((0,i.Z)({},w),{},{error:n.message}));else{var t=(0,g.O)(n.message,[]);P.setFields(t),I((0,i.Z)((0,i.Z)({},w),{},{error:""}))}},S=(0,a.useCallback)((function(){k.getRecordById(v).then((function(e){e.data&&e.data.data&&(P.setFieldsValue((0,i.Z)((0,i.Z)({translations:e.data.data.localization},e.data.data),{},{isPublished:e.data.data.isPublished})),I((0,i.Z)((0,i.Z)({},e.data),{},{loading:!1})))})).catch((function(e){F(e)}))}),[P,v,k]);(0,a.useEffect)((function(){"edit"===r?(I({loading:!0}),S()):P.resetFields()}),[n,r]);var z=function(e){var n=e.target,t=(0,p.V3)(n.value);P.setFieldsValue({slug:t})};return(0,Z.jsx)(c.P0,{visible:n,closable:!0,onCancel:t,titleText:"edit"===r?"Edit Leave Type":"Add New Leave Type",showFooter:!1,children:null!==w&&void 0!==w&&w.loading?(0,Z.jsx)(h.Z,{items:10}):(0,Z.jsxs)(d.Z,{className:u.Z.form,onFinish:function(e){switch(I((0,i.Z)((0,i.Z)({},w),{},{buttonLoading:!0})),r){case"edit":!0===j?k.updateRecord(e,v).then((function(e){x(),t(),I((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){F(e),I((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})}))})):(I((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})})),s.ZP.error("You don't have permission to update this record"));break;case"new":!0===b?k.createRecord(e).then((function(e){x(),t(),I((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){F(e),I((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})}))})):(I((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})})),s.ZP.error("You don't have permission to create this record"))}},form:P,children:[(null===w||void 0===w?void 0:w.error)&&(0,Z.jsx)(c.EQ,{description:null===w||void 0===w?void 0:w.error,isClosable:!0,onClose:function(){I((0,i.Z)((0,i.Z)({},w),{},{error:""}))}}),(0,Z.jsx)("div",{children:(0,Z.jsx)(d.Z.Item,{name:"title",rules:[{required:!0,message:"Please add a title"}],children:(0,Z.jsx)(c.t7,{size:"w100",label:"Title",asterisk:!0,type:"text",placeHolder:"Enter Leave Type",onChange:z})})}),(0,Z.jsx)("div",{children:(0,Z.jsx)(d.Z.Item,{name:"slug",rules:[{required:!0,message:"Please add a slug"}],children:(0,Z.jsx)(c.t7,{onChange:z,size:"w100",label:"Slug",asterisk:!0,type:"text"})})}),(0,Z.jsx)("div",{children:(0,Z.jsx)(d.Z.Item,{name:"isPaid",label:"Paid Or Unpaid",children:(0,Z.jsx)(l.Z,{checkedChildren:"Paid",defaultChecked:"edit"===r&&P.getFieldValue("isPaid"),unCheckedChildren:"Unpaid"})})}),(0,Z.jsx)("div",{children:(0,Z.jsx)(d.Z.Item,{name:"threshold",rules:[{required:!0,message:"Please add a threshold"}],children:(0,Z.jsx)(c.t7,{defaultValue:P.getFieldValue("threshold"),size:"w100",label:"Threshold",asterisk:!0,type:"number"})})}),(0,Z.jsx)("div",{children:(0,Z.jsxs)(d.Z.Item,{name:"thresholdType",children:[(0,Z.jsx)(c.AP,{label:"Threshold Type",options:[{value:"monthly",label:"Monthly"},{value:"yearly",label:"Yearly"}],placeholder:"Select Threshold Type",onChange:function(e){return P.setFieldValue("thresholdType",e)},defaultValue:P.getFieldValue("thresholdType")}),(0,Z.jsx)("p",{className:"mb-0",children:(0,Z.jsx)("small",{className:"color-dark-main",children:"If you select yes, your organization contact will be displayed on your profile on Yallah agent page and agent properties."})})]})}),(0,Z.jsx)("div",{children:(0,Z.jsx)(d.Z.Item,{name:"isPublished",label:"Status",children:(0,Z.jsx)(l.Z,{checkedChildren:"Active",unCheckedChildren:"Inactive",defaultChecked:"edit"===r&&P.getFieldValue("isPublished")})})}),(0,Z.jsxs)("div",{className:"d-flex justify-end",children:[(0,Z.jsx)(c.op,{size:"normal",fontSize:"sm",onClick:t,type:"plain",children:"Cancel"}),(0,Z.jsx)(c.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:null===w||void 0===w?void 0:w.buttonLoading,children:"edit"===r?"Edit Leave Type":"Add Leave Type"})]})]})})},x=t(5900),y=t(41586),b=t(98676),j=t(3109),T=t(70815),P=t(85554),k=function(e){var n=e.record,t=e.onEditIconClick,r=e.reloadTableData,d=e.permissions.deleteLeaveType,l=(0,a.useState)({confirmLoading:!1,openPopConfirm:!1}),c=(0,o.Z)(l,2),h=c[0],p=c[1],g=new m.F;return(0,Z.jsxs)("div",{className:u.Z.actions,children:[(0,Z.jsx)("span",{onClick:function(){return t(n)},children:(0,Z.jsx)("img",{src:"/images/editicon.svg",alt:""})}),(0,Z.jsx)(x.Z,{open:h.openPopConfirm,placement:"top",title:"Are you sure?",onConfirm:function(){if(p((0,i.Z)((0,i.Z)({},h),{},{confirmLoading:!0})),!1===d)return s.ZP.error("You don't have permission to delete this record, please contact your admin."),void p((0,i.Z)((0,i.Z)({},h),{},{openPopConfirm:!1}));g.deleteRecord(n.id).then((function(e){p((0,i.Z)((0,i.Z)({},h),{},{openPopConfirm:!1,confirmLoading:!1})),r()})).catch((function(e){p((0,i.Z)((0,i.Z)({},h),{},{confirmLoading:!1}))}))},onCancel:function(){return p((0,i.Z)((0,i.Z)({},h),{},{openPopConfirm:!1}))},okButtonProps:{loading:h.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:function(e){e||p((0,i.Z)((0,i.Z)({},h),{},{openPopConfirm:!1}))},children:(0,Z.jsx)(b.Z,{className:u.Z.bg__red,onClick:function(){p((0,i.Z)((0,i.Z)({},h),{},{openPopConfirm:!0}))}})})]})};function C(e){var n=e.tableData,t=e.tableLoading,o=e.onEditIconClick,a=e.reloadTableData,r=e.meta,d=e.filters,s=(0,P.v9)((function(e){return e.usersReducer})).userPermissions,l=new m.F,c=function(e,n){return l.updateRecord({isPublished:e},n)},h=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,n,t){return t+1},width:"5%"},{title:"Title",dataIndex:"localization",key:"localization",render:function(e,n){return(0,Z.jsx)(j.Z,{color:"dark-main",size:"sm",weight:"bold",children:n.title})}},{title:"Slug",dataIndex:"slug",key:"slug",render:function(e,n){return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(j.Z,{color:"dark-main",size:"sm",weight:"bold",children:n.slug})})}},{title:"Paid",dataIndex:"isPaid",key:"slug",render:function(e,n){return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(j.Z,{color:"dark-main",size:"sm",weight:"bold",children:"".concat(e?"Yes":"No")})})}},{title:"Threshold",dataIndex:"threshold",key:"threshold",render:function(e,n){return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(j.Z,{color:"dark-main",size:"sm",weight:"bold",children:n.threshold})})}},{title:"Threshold type",dataIndex:"thresholdType",key:"thresholdType",render:function(e,n){return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(j.Z,{color:"dark-main",size:"sm",weight:"bold",children:(0,p.kC)(n.thresholdType)})})}},{title:"Published",dataIndex:"isPublished",key:"isPublished",render:function(e,n){return(0,Z.jsx)(T.r,{checked:e,onChange:c,recordId:n.id,allowChange:s.updateLeaveType})}},{title:"Actions",dataIndex:"actions",key:"actions",render:function(e,n){return(0,Z.jsx)(k,{record:n,onEditIconClick:o,reloadTableData:a,permissions:s})}}];return(0,Z.jsx)("div",{className:u.Z.antdTableWrapper,children:(0,Z.jsx)(y.Z,{sticky:!0,dataSource:n,columns:h,pagination:{current:null===r||void 0===r?void 0:r.page,total:null===r||void 0===r?void 0:r.total,hideOnSinglePage:!0,pageSize:null===r||void 0===r?void 0:r.perPage,onChange:function(e,n){a((0,i.Z)((0,i.Z)({},d),{},{page:e,perPage:n}))}},scroll:{x:991},loading:t,rowKey:function(e){return"LeaveType-".concat(e.id)}})})}var L=t(18515),w=function(e){return e.CREATE="createLeaveType",e.UPDATE="updateLeaveType",e.DELETE="deleteLeaveType",e.READ="readLeaveType",e}({}),I=t(29079),F=[{text:"Home",isLink:!0,path:"/"},{isLink:!0,text:"Site Settings",path:"/siteSettings"},{isLink:!1,text:"Leave Type"}];var S=function(){var e=(0,p.aY)(w),n=(0,P.v9)((function(e){return e.usersReducer})).userPermissions,t=n.readLeaveType,d=n.createLeaveType,l=n.updateLeaveType,u=(0,a.useState)({editType:"new",recordId:0,openModal:!1}),h=(0,o.Z)(u,2),g=h[0],f=h[1],x=new m.F,y=(0,a.useState)({page:1,perPage:10}),b=(0,o.Z)(y,2),j=b[0],T=(b[1],(0,I.$5)({method:x.getAllRecords,initialQuery:(0,i.Z)({},j)})),k=T.data,S=T.onRefresh,z=(T.setData,T.loading),E=T.meta,R=function(){!1!==d?f((0,i.Z)((0,i.Z)({},g),{},{openModal:!g.openModal,editType:"new"})):s.ZP.error("You don't have permission to create new record")};return(0,Z.jsxs)(r.default,{permissionSlug:e,children:[(0,Z.jsx)(c.mr,{heading:"Leave Type",buttonText:"Add Leave Type",onButtonClick:R,breadCrumbData:F,showAdd:!0===d}),!0===t&&(0,Z.jsx)(C,{tableData:k,tableLoading:z,onEditIconClick:function(e){!1!==l?f((0,i.Z)((0,i.Z)({},g),{},{editType:"edit",recordId:e.id,openModal:!0})):s.ZP.error("You don't have permission to update this record")},reloadTableData:S,meta:E,filters:j}),!1===t&&(0,Z.jsx)(L.a$,{mainMessage:"You don't have permission to view this data"}),g.openModal&&(0,Z.jsx)(v,{record:g.recordId,type:g.editType,reloadTableData:S,onCancel:R,openModal:g.openModal,permissions:n})]})}},35367:function(e,n,t){t.d(n,{F:function(){return r}});var i=t(43144),o=t(15671),a=t(49075),r=(0,i.Z)((function e(){var n=this;(0,o.Z)(this,e),this.endPoint="leave-type",this.getAllRecords=function(e){return a.Z.get(n.endPoint,{params:e})},this.getAllPublishedRecords=function(e){return a.Z.get(n.endPoint+"/find-published",{params:e})},this.getRecordById=function(e){return a.Z.get(a._+n.endPoint+"/"+e)},this.deleteRecord=function(e){return a.Z.delete(a._+n.endPoint+"/"+e)},this.createRecord=function(e){return a.Z.post(a._+n.endPoint,e)},this.updateRecord=function(e,t){return a.Z.patch(a._+n.endPoint+"/"+t,e)}}))}}]);