"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[7511],{37511:function(e,t,n){n.r(t),n.d(t,{default:function(){return I}});var i=n(1413),o=n(29439),s=n(47313),c=n(2135),r="styles_header__JHFcj",a="styles_opacity_6__FOxuP",d=n(82626),l=n(55291),u=n(98276),m=n(31513),f=n(99420),h=n(50753),g=n(49355),v=n(17),x=n(21680),Z=n(41586),p=n(48897),P=n(32147),j=n(46417);function N(e){var t=e.tableData,n=e.tableLoading,i=e.rolePermissions,s=(0,c.lr)(),r=(0,o.Z)(s,1)[0].get("roleId"),l=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,t,n){return n+1},width:"60px"},{title:"Name",dataIndex:"name",key:"name",render:function(e,t){return(0,j.jsxs)("div",{className:"d-flex",children:[(0,j.jsx)("div",{className:"w-50",children:t.icon?(0,j.jsx)(x.Z,{width:20,height:20,src:"".concat(p.lj).concat(t.icon),preview:!1,rootClassName:"object-fit-contain"}):(0,j.jsx)(j.Fragment,{})}),(0,j.jsxs)("div",{children:[(0,j.jsx)(d.ZT,{color:"dark-main",size:"sm",weight:"bold",children:e}),(0,j.jsx)("p",{className:"color-light-800 font-size-xs",children:t.description})]})]})}},{title:"Permissions",dataIndex:"Permissions",key:"permissions",render:function(e){return(0,j.jsx)("div",{children:null===e||void 0===e?void 0:e.map((function(e){return(0,j.jsx)("div",{className:"d-flex",children:-1!==i.indexOf(e.action)?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{className:"pa-0 ma-0 font-size-sm color-green-yp",children:e.name}),(0,j.jsx)("div",{className:"ml-2",children:(0,j.jsx)(P.Ol,{className:"color-green-yp"})})]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{className:"pa-0 ma-0 font-size-sm color-red-yp ".concat(a),children:e.name}),(0,j.jsx)("div",{className:"ml-2 ".concat(a),children:(0,j.jsx)(P.DX,{className:"color-red-yp"})})]})})}))})}},{title:"Action",dataIndex:"action",key:"action",render:function(e,t){return(0,j.jsx)("div",{children:(0,j.jsxs)(c.rU,{to:"/siteSettings/roles/permissions?roleId=".concat(Number(r),"&moduleId=").concat(t.id),className:"d-flex",children:[(0,j.jsx)(P.iK,{className:"my-auto"}),(0,j.jsx)(d.ZT,{color:"dark-sub",size:"sm",className:"ml-2",children:"Manage Permissions"})]})})}}];return(0,j.jsx)("div",{children:(0,j.jsx)(Z.Z,{sticky:!0,dataSource:t,columns:l,pagination:!1,scroll:{x:991},loading:n,rowKey:function(e){return"roles-permission-view-".concat(e.id)}})})}var R=n(7532),b=[{text:"Home",isLink:!0,path:"/"},{isLink:!0,text:"Roles",path:"/siteSettings/roles"},{isLink:!1,text:"Role Permissions"}],I=function(){var e=(0,s.useState)(0),t=(0,o.Z)(e,2),n=t[0],a=t[1],x=(0,s.useState)({loading:!1}),Z=(0,o.Z)(x,2),p=Z[0],P=(Z[1],(0,c.lr)()),I=(0,o.Z)(P,2),y=I[0],w=I[1],k=y.get("roleId"),C=y.get("moduleId"),S=function(e){w((0,c.fW)({roleId:String(e)}))},E=(0,s.useMemo)((function(){return new f.U}),[]),_=(0,s.useMemo)((function(){return new h.z}),[]),z=(0,s.useMemo)((function(){return new v.B}),[]),A=(0,s.useState)({data:[],loading:!1}),D=(0,o.Z)(A,2),F=D[0],B=D[1],L=(0,s.useState)({data:[],loading:!1,selectedId:0}),M=(0,o.Z)(L,2),T=M[0],H=M[1],O=(0,s.useState)([]),U=(0,o.Z)(O,2),K=U[0],J=U[1],V=(0,s.useState)(),W=(0,o.Z)(V,2),X=W[0],Y=W[1],q=(0,s.useCallback)((function(){_.getAllRecords().then((function(e){var t;e.data&&null!==(t=e.data)&&void 0!==t&&t.data&&B((0,i.Z)((0,i.Z)({},e.data),{},{loading:!1}))}))}),[k]);(0,s.useEffect)((function(){q()}),[]);(0,s.useEffect)((function(){n&&0!==n&&T.selectedId&&0!==T.selectedId&&S(T.selectedId),T.selectedId&&0!==T.selectedId&&z.getRolePermissions(T.selectedId).then((function(e){var t,n,i=null===(t=e.data)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.map((function(e){var t;return null===(t=e.Permission)||void 0===t?void 0:t.action}));J(i),S(T.selectedId)})).catch((function(e){l.ZP.error(e.message)}))}),[n,T.selectedId]),(0,s.useEffect)((function(){C&&a(Number(C))}),[C]),(0,s.useEffect)((function(){H((0,i.Z)((0,i.Z)({},T),{},{selectedId:Number(k),loading:!0})),E.getAllRecords().then((function(e){H((0,i.Z)((0,i.Z)({},T),{},{data:e.data.data,selectedId:Number(k),loading:!1}))}))}),[E]);var G=(0,s.useCallback)((function(){if(0!==Number(k)){var e=T.data.find((function(e){return e.id===Number(k)}));Y(e)}}),[k,T.data]);return(0,s.useEffect)((function(){G()}),[G]),(0,j.jsxs)(R.default,{children:[(0,j.jsx)(d.mr,{heading:"Role Permissions",breadCrumbData:b}),(0,j.jsx)("div",{className:"d-flex overflow-hidden",children:(0,j.jsxs)("div",{className:"d-flex flex-column w-100",children:[(0,j.jsxs)("div",{className:r+" d-flex pb-4",children:[(0,j.jsx)("div",{className:"my-auto color-dark-main",children:"You are viewing permission of"}),(0,j.jsx)("div",{className:"ml-3",children:(0,j.jsx)(m.Z,{onChange:function(e){return H((0,i.Z)((0,i.Z)({},T),{},{selectedId:e}))},placeholder:"Choose role",allowClear:!0,style:{width:200},className:"selectAntdCustom",loading:T.loading,options:T.data.map((function(e){return{label:e.title,value:e.id}})),defaultValue:Number(k)&&0!==Number(k)?Number(k):null})})]}),(0,j.jsx)("div",{className:"overflow-auto",children:(0,j.jsx)("div",{children:p.loading?(0,j.jsx)(g.Z,{items:16}):Number(k)&&0!==F.data.length?(0,j.jsx)("div",{children:(0,j.jsx)(N,{tableData:F.data,tableLoading:F.loading,rolePermissions:K,roleData:X})}):(0,j.jsx)(u.Z,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:200},description:(0,j.jsx)("span",{children:"Please select a role to view the associated permissions"})})})})]})})]})}},17:function(e,t,n){n.d(t,{B:function(){return r}});var i=n(43144),o=n(15671),s=n(49075),c=n(3135),r=(0,i.Z)((function e(){var t=this;(0,o.Z)(this,e),this.endPoint="permissions",this.getAllRecords=function(){return s.Z.get(t.endPoint)},this.getRecordById=function(e){return s.Z.get("".concat(t.endPoint,"/").concat(e))},this.deleteRecord=function(e){return s.Z.delete("".concat(t.endPoint,"/").concat(e))},this.createRecord=function(e){return s.Z.post(t.endPoint+"/",e,{headers:c.C})},this.updateRecord=function(e,n){return s.Z.patch("".concat(t.endPoint,"/").concat(n),e,{headers:c.C})},this.getRolePermissions=function(e){return s.Z.get("".concat(t.endPoint,"/getRolePermissions/").concat(e))},this.getRolePermissionsByModuleId=function(e,n){return s.Z.get("".concat(t.endPoint,"/getRolePermissions/").concat(e,"/").concat(n))},this.grantPrivilegesToRole=function(e){return s.Z.post("".concat(t.endPoint,"/grantPrivilegesToRole"),e)},this.revokePrivilegesFromRole=function(e){return s.Z.post("".concat(t.endPoint,"/revokePrivilegesFromRole"),e)}}))},99420:function(e,t,n){n.d(t,{U:function(){return c}});var i=n(43144),o=n(15671),s=n(49075),c=(0,i.Z)((function e(){var t=this;(0,o.Z)(this,e),this.endPoint="role",this.getAllRecords=function(e){return s.Z.get(t.endPoint,{params:e})},this.getRecordById=function(e){return s.Z.get("".concat(t.endPoint,"/").concat(e,"?all=true"))},this.deleteRecord=function(e){return s.Z.delete("".concat(t.endPoint,"/").concat(e))},this.createRecord=function(e){return s.Z.post(t.endPoint+"/",e)},this.updateRecord=function(e,n){return s.Z.patch("".concat(t.endPoint,"/").concat(n),e)},this.addElements=function(e,n){return s.Z.post("".concat(t.endPoint,"/addDashboardElement/").concat(n),e)},this.removeElements=function(e,n){return s.Z.post("".concat(t.endPoint,"/removeDashboardElement/").concat(n),e)}}))},50753:function(e,t,n){n.d(t,{z:function(){return r}});var i=n(43144),o=n(15671),s=n(49075),c=n(3135),r=(0,i.Z)((function e(){var t=this;(0,o.Z)(this,e),this.endPoint="system-modules",this.getAllRecords=function(){return s.Z.get(t.endPoint)},this.getRecordById=function(e){return s.Z.get("".concat(t.endPoint,"/").concat(e))},this.deleteRecord=function(e){return s.Z.delete("".concat(t.endPoint,"/").concat(e))},this.createRecord=function(e){return s.Z.post(t.endPoint+"/",e,{headers:c.C})},this.updateRecord=function(e,n){return s.Z.patch("".concat(t.endPoint,"/").concat(n),e,{headers:c.C})}}))}}]);