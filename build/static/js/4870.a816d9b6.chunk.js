"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[4870],{70815:function(e,n,t){t.d(n,{r:function(){return h}});var o=t(1413),a=t(29439),i=t(45987),r=t(55291),d=t(86345),s=t(47313),c=t(40169),l=t(46417),u=["onChange","checked","recordId","allowChange"],h=function(e){var n=e.onChange,t=e.checked,h=e.recordId,m=e.allowChange,f=void 0===m||m,Z=(0,i.Z)(e,u),p=(0,s.useState)({loading:!1,checked:!1}),g=(0,a.Z)(p,2),b=g[0],x=g[1];return(0,s.useEffect)((function(){x((0,o.Z)((0,o.Z)({},b),{},{checked:t}))}),[t]),(0,l.jsx)(d.Z,{checked:b.checked,onChange:function(e){!0===f?(x((0,o.Z)((0,o.Z)({},b),{},{loading:!0})),n(e,h,Z).then((function(n){x((0,o.Z)((0,o.Z)({},b),{},{checked:e,loading:!1})),r.ZP.success(n.data.message)})).catch((function(e){x((0,o.Z)((0,o.Z)({},b),{},{loading:!1}));var n=(0,c.P)(e);"string"===typeof n.message?r.ZP.error(n.message):r.ZP.error("Something went wrong")}))):r.ZP.error("You don't have permission to change this record, please contact your admin.")},loading:b.loading})}},44870:function(e,n,t){t.r(n),t.d(n,{default:function(){return L}});var o=t(1413),a=t(29439),i=t(47313),r=t(7532),d=t(25019),s=t(55291),c=t(86345),l=t(82626),u=t(17327),h=t(49355),m=t(46646),f=t(40169),Z=t(9985),p=t(46417),g=function(e){var n=e.openModal,t=e.onCancel,r=e.type,g=e.record,b=e.reloadTableData,x=e.permissions,v=x.createDashboardElement,C=x.updateDashboardElement,P=d.Z.useForm(),k=(0,a.Z)(P,1)[0],j=new Z.o,E=(0,i.useState)(),D=(0,a.Z)(E,2),y=D[0],w=D[1],I=function(e){var n=(0,f.P)(e);if("string"==typeof n.message)w((0,o.Z)((0,o.Z)({},y),{},{error:n.message}));else{var t=(0,m.O)(n.message,[]);k.setFields(t),w((0,o.Z)((0,o.Z)({},y),{},{error:""}))}},T=(0,i.useCallback)((function(){j.getRecordById(g).then((function(e){e.data&&e.data.data&&(console.log(e.data.data),k.setFieldsValue((0,o.Z)((0,o.Z)({translations:e.data.data.localization},e.data.data),{},{isPublished:e.data.data.isPublished})))})).catch((function(e){I(e)}))}),[k,g,j]);(0,i.useEffect)((function(){"edit"===r?T():k.resetFields()}),[n,r,k,T]);return(0,p.jsx)(l.P0,{visible:n,closable:!0,onCancel:t,titleText:"edit"===r?"Edit Dashboard Element":"Add New Dashboard Element",showFooter:!1,children:null!==y&&void 0!==y&&y.loading?(0,p.jsx)(h.Z,{items:10}):(0,p.jsxs)(d.Z,{className:u.Z.form,onFinish:function(e){switch(w((0,o.Z)((0,o.Z)({},y),{},{buttonLoading:!0})),r){case"edit":!0===C?j.updateRecord(e,g).then((function(e){b(),t(),w((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){I(e),w((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})):(w((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})})),s.ZP.error("You don't have permission to update this record"));break;case"new":!0===v?j.createRecord(e).then((function(e){b(),t(),w((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){I(e),w((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})):(w((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})})),s.ZP.error("You don't have permission to create this record"))}},form:k,children:[(null===y||void 0===y?void 0:y.error)&&(0,p.jsx)(l.EQ,{description:null===y||void 0===y?void 0:y.error,isClosable:!0,onClose:function(){w((0,o.Z)((0,o.Z)({},y),{},{error:""}))}}),(0,p.jsx)("div",{children:(0,p.jsx)(d.Z.Item,{name:"title",rules:[{required:!0,message:"Please add a title"}],children:(0,p.jsx)(l.t7,{size:"w100",label:"Title",asterisk:!0,type:"text",placeHolder:"Enter title"})})}),(0,p.jsx)("div",{children:(0,p.jsx)(d.Z.Item,{name:"slug",rules:[{required:!0,message:"Please add a slug"}],children:(0,p.jsx)(l.t7,{size:"w100",label:"Slug",asterisk:!0,type:"text"})})}),(0,p.jsx)("div",{children:(0,p.jsx)(d.Z.Item,{name:"status",label:"Status",children:(0,p.jsx)(c.Z,{checkedChildren:"Active",unCheckedChildren:"Inactive",defaultChecked:!0})})}),(0,p.jsxs)("div",{className:"d-flex justify-end",children:[(0,p.jsx)(l.op,{size:"normal",fontSize:"sm",onClick:t,type:"plain",children:"Cancel"}),(0,p.jsx)(l.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:null===y||void 0===y?void 0:y.buttonLoading,children:"edit"===r?"Edit Dashboard Element":"Add Dashboard Element"})]})]})})},b=t(5900),x=t(41586),v=t(98676),C=t(3109),P=t(70815),k=t(85554),j=function(e){var n=e.record,t=e.onEditIconClick,r=e.reloadTableData,d=e.permissions.deleteDashboardElement,c=(0,i.useState)({confirmLoading:!1,openPopConfirm:!1}),l=(0,a.Z)(c,2),h=l[0],m=l[1],f=new Z.o;return(0,p.jsxs)("div",{className:u.Z.actions,children:[(0,p.jsx)("span",{onClick:function(){return t(n)},children:(0,p.jsx)("img",{src:"/images/editicon.svg",alt:""})}),(0,p.jsx)(b.Z,{open:h.openPopConfirm,placement:"top",title:"Are you sure?",onConfirm:function(){if(m((0,o.Z)((0,o.Z)({},h),{},{confirmLoading:!0})),!1===d)return s.ZP.error("You don't have permission to delete this record, please contact your admin."),void m((0,o.Z)((0,o.Z)({},h),{},{openPopConfirm:!1}));f.deleteRecord(n.id).then((function(e){m((0,o.Z)((0,o.Z)({},h),{},{openPopConfirm:!1,confirmLoading:!1})),r()})).catch((function(e){m((0,o.Z)((0,o.Z)({},h),{},{confirmLoading:!1}))}))},onCancel:function(){return m((0,o.Z)((0,o.Z)({},h),{},{openPopConfirm:!1}))},okButtonProps:{loading:h.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:function(e){e||m((0,o.Z)((0,o.Z)({},h),{},{openPopConfirm:!1}))},children:(0,p.jsx)(v.Z,{className:u.Z.bg__red,onClick:function(){m((0,o.Z)((0,o.Z)({},h),{},{openPopConfirm:!0}))}})})]})};function E(e){var n=e.tableData,t=e.tableLoading,a=e.onEditIconClick,i=e.reloadTableData,r=e.meta,d=e.filters,s=(0,k.v9)((function(e){return e.usersReducer})).userPermissions,c=new Z.o,l=function(e,n){return c.updateRecord({isPublished:e},n)},h=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,n,t){return t+1},width:"5%"},{title:"Title",dataIndex:"localization",key:"localization",render:function(e,n){return(0,p.jsx)(C.Z,{color:"dark-main",size:"sm",weight:"bold",children:n.title})}},{title:"Slug",dataIndex:"slug",key:"slug",render:function(e,n){return(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(C.Z,{color:"dark-main",size:"sm",weight:"bold",children:n.slug})})}},{title:"Published",dataIndex:"isPublished",key:"isPublished",render:function(e,n){return(0,p.jsx)(P.r,{checked:e,onChange:l,recordId:n.id,allowChange:s.updateDashboardElement})}},{title:"Actions",dataIndex:"actions",key:"actions",render:function(e,n){return(0,p.jsx)(j,{record:n,onEditIconClick:a,reloadTableData:i,permissions:s})}}];return(0,p.jsx)("div",{className:u.Z.antdTableWrapper,children:(0,p.jsx)(x.Z,{sticky:!0,dataSource:n,columns:h,pagination:{current:null===r||void 0===r?void 0:r.page,total:null===r||void 0===r?void 0:r.total,hideOnSinglePage:!0,pageSize:null===r||void 0===r?void 0:r.perPage,onChange:function(e,n){i((0,o.Z)((0,o.Z)({},d),{},{page:e,perPage:n}))}},scroll:{x:991},loading:t,rowKey:function(e){return"DashboardElement-".concat(e.id)}})})}var D=t(18515),y=function(e){return e.CREATE="createDashboardElement",e.UPDATE="updateDashboardElement",e.DELETE="deleteDashboardElement",e.READ="readDashboardElement",e}({}),w=t(29079),I=t(3798),T=[{text:"Home",isLink:!0,path:"/"},{isLink:!0,text:"Site Settings",path:"/siteSettings"},{isLink:!1,text:"Dashboard Element"}];var L=function(){var e=(0,I.aY)(y),n=(0,k.v9)((function(e){return e.usersReducer})).userPermissions,t=n.readDashboardElement,d=n.createDashboardElement,c=n.updateDashboardElement,u=(0,i.useState)({editType:"new",recordId:0,openModal:!1}),h=(0,a.Z)(u,2),m=h[0],f=h[1],b=new Z.o,x=(0,i.useState)({page:1,perPage:10}),v=(0,a.Z)(x,2),C=v[0],P=(v[1],(0,w.$5)({method:b.getAllRecords,initialQuery:(0,o.Z)({},C)})),j=P.data,L=P.onRefresh,S=(P.setData,P.loading),R=P.meta,z=function(){!1!==d?f((0,o.Z)((0,o.Z)({},m),{},{openModal:!m.openModal,editType:"new"})):s.ZP.error("You don't have permission to create new record")};return(0,p.jsxs)(r.default,{permissionSlug:e,children:[(0,p.jsx)(l.mr,{heading:"Dashboard Element",buttonText:"Add Element",onButtonClick:z,breadCrumbData:T,showAdd:!0===d}),!0===t&&(0,p.jsx)(E,{tableData:j,tableLoading:S,onEditIconClick:function(e){!1!==c?f((0,o.Z)((0,o.Z)({},m),{},{editType:"edit",recordId:e.id,openModal:!0})):s.ZP.error("You don't have permission to update this record")},reloadTableData:L,meta:R,filters:C}),!1===t&&(0,p.jsx)(D.a$,{mainMessage:"You don't have permission to view this data"}),m.openModal&&(0,p.jsx)(g,{record:m.recordId,type:m.editType,reloadTableData:L,onCancel:z,openModal:m.openModal,permissions:n})]})}},9985:function(e,n,t){t.d(n,{o:function(){return r}});var o=t(43144),a=t(15671),i=t(49075),r=(0,o.Z)((function e(){var n=this;(0,a.Z)(this,e),this.endPoint="dashboard-elements",this.getAllRecords=function(e){return i.Z.get(n.endPoint,{params:e})},this.getDashboardContent=function(){return i.Z.get(n.endPoint+"/get-dashboard-content")},this.getRecordById=function(e){return i.Z.get(i._+n.endPoint+"/"+e)},this.deleteRecord=function(e){return i.Z.delete(i._+n.endPoint+"/"+e)},this.createRecord=function(e){return i.Z.post(i._+n.endPoint,e)},this.updateRecord=function(e,t){return i.Z.patch(i._+n.endPoint+"/"+t,e)}}))}}]);