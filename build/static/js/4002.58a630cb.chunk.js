"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[4002],{74002:function(e,n,t){t.r(n),t.d(n,{default:function(){return J}});var o=t(93433),i=t(1413),r=t(29439),a=t(47313),d=t(31513),s=t(25019),c=t(55291),l=t(98276),u=t(69309),m=t(82626),h=t(3113),f=t(49355),p=t(46646),v=t(40169),Z=t(42623),g=t(5599),y=t(84825),b=t(70816),x=t.n(b),j=t(46417),k=(d.Z.Option,function(e){var n,t=e.openModal,b=e.onCancel,k=e.type,C=e.record,I=e.reloadTableData,P=e.permissions,S=P.createBiometrics,w=P.updateBiometrics,N=s.Z.useForm(),B=(0,r.Z)(N,1)[0],R=new g.r,T=(0,a.useState)(),D=(0,r.Z)(T,2),L=D[0],z=D[1],E=(0,a.useState)(""),A=(0,r.Z)(E,2),M=A[0],_=A[1],F=(0,Z.N)(M,500),O=(0,a.useState)([]),U=(0,r.Z)(O,2),V=U[0],Y=U[1],q=(0,a.useMemo)((function(){return new y.z}),[]),H=(0,a.useCallback)((function(){F&&q.getAllRecords({name:F}).then((function(e){Y((function(n){var t,i,r=null===e||void 0===e||null===(t=e.data)||void 0===t||null===(i=t.data)||void 0===i?void 0:i.filter((function(e){return!(null!==n&&void 0!==n&&n.find((function(n){return n.id===e.id})))}));return[].concat((0,o.Z)(n),(0,o.Z)(r))}))})).catch((function(e){c.ZP.error(e.response.data.message)}))}),[F]);(0,a.useEffect)((function(){H()}),[H]);var J=function(e){var n=(0,v.P)(e);if("string"==typeof n.message)z((0,i.Z)((0,i.Z)({},L),{},{error:n.message}));else{var t=(0,p.O)(n.message,[]);B.setFields(t),z((0,i.Z)((0,i.Z)({},L),{},{error:""}))}},X=(0,a.useCallback)((function(){R.getRecordById(C).then((function(e){var n,t,o=null===e||void 0===e||null===(n=e.data)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.userId;e.data&&e.data.data&&(B.setFieldsValue((0,i.Z)((0,i.Z)({},e.data.data),{},{userId:o,checkIn:x()(e.data.data.checkIn)})),z((0,i.Z)((0,i.Z)({},e.data),{},{loading:!1})),o&&q.getRecordById(o).then((function(e){var n;Y([null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.data])})).catch((function(e){c.ZP.error(e.response.data.message)})))})).catch((function(e){J(e)}))}),[B,C,R]);(0,a.useEffect)((function(){"edit"===k?(z({loading:!0}),X()):B.resetFields()}),[]);return(0,j.jsx)(m.P0,{visible:t,closable:!0,onCancel:b,titleText:"edit"===k?"Edit Biometric":"Add New Biometric",showFooter:!1,children:null!==L&&void 0!==L&&L.loading?(0,j.jsx)(f.Z,{items:3}):(0,j.jsxs)(s.Z,{className:h.Z.form,onFinish:function(e){switch(z((0,i.Z)((0,i.Z)({},L),{},{buttonLoading:!0})),k){case"edit":!0===w?R.updateRecord((0,i.Z)((0,i.Z)({},e),{},{checkIn:e.checkIn._d.toISOString()}),C).then((function(e){I(),b(),z((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){J(e),z((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})}))})):(z((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})})),c.ZP.error("You don't have permission to update this record"));break;case"new":!0===S?R.createRecord((0,i.Z)((0,i.Z)({},e),{},{checkIn:e.checkIn._d.toISOString()})).then((function(e){I(),b(),z((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){J(e),z((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})}))})):(z((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})})),c.ZP.error("You don't have permission to create this record"))}},form:B,children:[(null===L||void 0===L?void 0:L.error)&&(0,j.jsx)(m.EQ,{description:null===L||void 0===L?void 0:L.error,isClosable:!0,onClose:function(){z((0,i.Z)((0,i.Z)({},L),{},{error:""}))}}),(0,j.jsx)("div",{children:(0,j.jsxs)(s.Z.Item,{name:"userId",rules:[{required:!0,message:"Please select an employee"}],children:[(0,j.jsxs)("label",{className:"font-size-sm",children:["Employee  ",(0,j.jsx)("span",{className:"color-red-yp",children:"*"})]}),(0,j.jsx)(d.Z,{allowClear:!0,style:{width:"100%"},defaultValue:null===L||void 0===L||null===(n=L.data)||void 0===n?void 0:n.userId,placeholder:"Search for the employee",className:"selectAntdCustom",onChange:function(e){return B.setFieldsValue({userId:e})},showSearch:!0,onSearch:function(e){return _(e)},optionFilterProp:"label",options:null===V||void 0===V?void 0:V.map((function(e){return{label:e.firstName+" "+e.lastName,value:e.id}})),notFoundContent:(0,j.jsx)(l.Z,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:100},description:(0,j.jsx)("span",{children:"No data found, Please search for the employee"})})})]})}),(0,j.jsx)("div",{children:(0,j.jsx)(s.Z.Item,{name:"mode",rules:[{required:!0,message:"Please select a mode"}],children:(0,j.jsx)(m.AP,{asterisk:!0,label:"Mode",options:[{value:"in",label:"Check In"},{value:"out",label:"Check Out"}],placeholder:"Select Mode"})})}),(0,j.jsx)("div",{children:(0,j.jsxs)("label",{style:{fontSize:"var(--font-size-sm)",color:"var(--color-dark-main)"},children:["Date and time",(0,j.jsx)("span",{style:{color:"var(--color-red-yp)"},children:" *"}),(0,j.jsx)(s.Z.Item,{name:"checkIn",rules:[{required:!0,message:"Please select date and time"}],children:(0,j.jsx)(u.Z,{dropdownClassName:"hide-disabled-hours",showTime:!0,disabledTime:function(){return{disabledHours:function(){return[0,1,2,3,4,5,6]}}},showSecond:!1,style:{borderRadius:"0.25rem",borderWidth:2,width:"100%",borderColor:"var(--color-border)"}})})]})}),(0,j.jsxs)("div",{className:"d-flex justify-end",children:[(0,j.jsx)(m.op,{size:"normal",fontSize:"sm",onClick:b,type:"plain",children:"Cancel"}),(0,j.jsx)(m.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:null===L||void 0===L?void 0:L.buttonLoading,children:"edit"===k?"Edit Biometric":"Add Biometric"})]})]})})}),C=t(5900),I=t(21680),P=t(41586),S=t(98676),w=t(3109),N=t(85554),B=t(98505),R=t(3798),T=t(68331),D=t(40096),L=t(49075),z=t(37936),E={selfieImage:"styles_selfieImage__sBBuf",entryTypeStyles:"styles_entryTypeStyles__ELDTk",wrapperEntryTypes:"styles_wrapperEntryTypes__0mebI",forceStyle:"styles_forceStyle__8DEDh"},A=function(e){var n=e.record,t=e.onEditIconClick,o=e.reloadTableData,d=e.permissions,s=d.deleteBiometrics,l=d.updateBiometrics,u=(0,a.useState)({confirmLoading:!1,openPopConfirm:!1}),m=(0,r.Z)(u,2),f=m[0],p=m[1],v=new g.r;return(0,j.jsxs)("div",{className:h.Z.actions,children:[l&&(0,j.jsx)("span",{onClick:function(){return t(n)},children:(0,j.jsx)("img",{src:"/images/editicon.svg",alt:""})}),s&&(0,j.jsx)(C.Z,{open:f.openPopConfirm,placement:"top",title:"Are you sure?",onConfirm:function(){if(p((0,i.Z)((0,i.Z)({},f),{},{confirmLoading:!0})),!1===s)return c.ZP.error("You don't have permission to delete this record, please contact your admin."),void p((0,i.Z)((0,i.Z)({},f),{},{openPopConfirm:!1}));v.deleteRecord(n.id).then((function(e){p((0,i.Z)((0,i.Z)({},f),{},{openPopConfirm:!1,confirmLoading:!1})),o()})).catch((function(e){p((0,i.Z)((0,i.Z)({},f),{},{confirmLoading:!1}))}))},onCancel:function(){return p((0,i.Z)((0,i.Z)({},f),{},{openPopConfirm:!1}))},okButtonProps:{loading:f.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:function(e){e||p((0,i.Z)((0,i.Z)({},f),{},{openPopConfirm:!1}))},children:(0,j.jsx)(S.Z,{className:h.Z.bg__red,onClick:function(){p((0,i.Z)((0,i.Z)({},f),{},{openPopConfirm:!0}))}})})]})};function M(e){var n=e.tableData,t=e.tableLoading,o=e.onEditIconClick,r=e.reloadTableData,a=e.meta,d=e.filters,s=(0,N.v9)((function(e){return e.usersReducer})).userPermissions,c=D.Z.getLocalAccessToken(),l=(new g.r,[{title:"S.No",dataIndex:"index",key:"index",render:function(e,n,t){return(0,R.k7)(t,a)},width:"5%"},{title:"Name",dataIndex:"name",key:"name",render:function(e,n){var t,o;return(0,j.jsx)(w.Z,{color:"dark-main",size:"sm",weight:"bold",children:(null===n||void 0===n||null===(t=n.User)||void 0===t?void 0:t.firstName)+" "+(null===n||void 0===n||null===(o=n.User)||void 0===o?void 0:o.lastName)})}},{title:"Mode",dataIndex:"mode",key:"mode",render:function(e,n){return(0,j.jsxs)("div",{className:E.wrapperEntryTypes,children:[(0,j.jsx)(w.Z,{color:"dark-main",size:"sm",type:"span",lineHeight:1,weight:"bold",children:"Check "+(0,R.kC)(n.mode)}),n.type!==Number(z.yV.auto)&&(0,j.jsx)("div",{className:"my-auto",children:(0,j.jsxs)("span",{className:E.entryTypeStyles+" "+(n.type===Number(z.yV.forced)?E.forceStyle:""),children:["(",(0,R.RT)(z.yV,String(n.type)),")"]})})]})}},{title:"Time",dataIndex:"checkIn",key:"checkIn",render:function(e,n){var t,o,i,r;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(w.Z,{color:"dark-main",size:"sm",weight:"bold",children:(0,B.Ny)(n.checkIn,"dd M,yy-t")}),n.type===Number(z.yV.manual)&&n.AddedBy&&(0,j.jsxs)("small",{style:{color:"var(--color-dark-sub)",fontSize:"0.6rem"},children:[(0,j.jsx)("span",{children:"Added on "}),(0,j.jsxs)("span",{children:[" ",n.addedDate&&(0,B.Ny)(n.addedDate,"dd M,yy")]}),(0,j.jsx)("span",{children:" by "}),(0,j.jsx)("span",{className:"inline-block",children:(null===(t=n.AddedBy)||void 0===t?void 0:t.firstName)+" "+(null===(o=n.AddedBy)||void 0===o?void 0:o.lastName)+" "})]}),n.ModifiedBy&&(0,j.jsxs)("small",{style:{color:"var(--color-dark-sub)",fontSize:"0.6rem"},children:[(0,j.jsx)("span",{children:"Modified on "}),(0,j.jsxs)("span",{children:[" ",n.modifiedDate&&(0,B.Ny)(n.modifiedDate,"dd M,yy")]}),(0,j.jsx)("span",{children:" by "}),(0,j.jsx)("span",{className:"inline-block",children:(null===(i=n.ModifiedBy)||void 0===i?void 0:i.firstName)+" "+(null===(r=n.ModifiedBy)||void 0===r?void 0:r.lastName)+" "})]})]})}},{title:"Selfie",dataIndex:"selfie",key:"selfie",render:function(e,n){return(0,j.jsx)(j.Fragment,{children:e&&(0,j.jsx)("div",{style:{height:"60px"},children:(0,j.jsx)(I.Z,{style:{maxHeight:"60px",width:"auto"},src:"".concat(L._,"resources/all/").concat(e,"?authKey=").concat(c)})})})}},{title:"Location",dataIndex:"location",key:"location",render:function(e,n){return(0,j.jsx)(j.Fragment,{children:(0,j.jsx)("iframe",{width:"300",height:"100",frameBorder:"0",style:{border:0},src:"https://www.google.com/maps?q=".concat(n.latitude,",").concat(n.longitude,"&hl=es;z=14&output=embed"),allowFullScreen:!0})})},width:"30%"},s.updateBiometrics||s.deleteBiometrics?{title:"Actions",dataIndex:"actions",key:"actions",render:function(e,n){return(0,j.jsx)(A,{record:n,onEditIconClick:o,reloadTableData:r,permissions:s})}}:{}]);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{className:h.Z.antdTableWrapper,children:(0,j.jsx)(P.Z,{sticky:!0,dataSource:n,columns:l,pagination:!1,scroll:{x:991},loading:t,rowKey:function(e){return"biometric-type-".concat(e.id)}})}),(0,j.jsx)(T.t,{total:null===a||void 0===a?void 0:a.total,current:null===a||void 0===a?void 0:a.page,defaultPageSize:(null===a||void 0===a?void 0:a.perPage)||25,pageSizeOptions:[10,20,50,100],onChange:function(e,n){r((0,i.Z)((0,i.Z)({},d),{},{page:e,perPage:n}))}})]})}var _=t(59491),F=t(18515),O=t(54060),U=t(29079),V=t(95946),Y=t(19723),q=t(5190),H=[{text:"Home",isLink:!0,path:"/"},{isLink:!1,text:"Biometrics"}];var J=function(){var e,n=(0,R.aY)(V.r),t=(0,N.v9)((function(e){return e.usersReducer})).userPermissions,s=t,u=t,h=new q.L,f=s.readBiometrics,p=s.createBiometrics,v=s.updateBiometrics,b=s.readAllBiometrics,x=u.createBiometricsJob,C=(0,a.useState)({mode:void 0,type:void 0,fromDate:void 0,toDate:void 0,userId:void 0,organizationId:void 0,page:1,perPage:25}),I=(0,r.Z)(C,2),P=I[0],S=I[1],w=(0,a.useState)({editType:"new",recordId:0,openModal:!1}),B=(0,r.Z)(w,2),T=B[0],D=B[1],L=new g.r,E=(0,U.$5)({method:L.getAllRecords,initialQuery:P}),A=E.data,J=E.onRefresh,X=(E.setData,E.loading),K=E.meta,Q=(0,U.$5)({method:h.findPublished,initialQuery:{}}),$=Q.data;Q.onRefresh,console.log($);var W=function(){!1!==p?D((0,i.Z)((0,i.Z)({},T),{},{openModal:!T.openModal,editType:"new"})):c.ZP.error("You don't have permission to create new record")},G=(0,a.useState)(""),ee=(0,r.Z)(G,2),ne=ee[0],te=ee[1],oe=(0,Z.N)(ne,500),ie=(0,a.useState)([]),re=(0,r.Z)(ie,2),ae=re[0],de=re[1],se=(0,a.useMemo)((function(){return new y.z}),[]),ce=(0,a.useCallback)((function(){oe&&se.getAllRecords({name:oe}).then((function(e){de((function(n){var t,i,r=null===e||void 0===e||null===(t=e.data)||void 0===t||null===(i=t.data)||void 0===i?void 0:i.filter((function(e){return!(null!==n&&void 0!==n&&n.find((function(n){return n.id===e.id})))}));return[].concat((0,o.Z)(n),(0,o.Z)(r))}))})).catch((function(e){c.ZP.error(e.response.data.message)}))}),[oe]);return(0,a.useEffect)((function(){ce()}),[ce]),(0,j.jsxs)(O.Z,{permissionSlug:[].concat((0,o.Z)(n),[Y.q.CREATE]),children:[(0,j.jsx)(m.mr,{heading:"Biometrics",buttonText:"Add Biometric",onButtonClick:W,breadCrumbData:H,showAdd:!0===p,excelExport:x&&(0,j.jsx)(_.Z,{href:"/biometrics/bulk-upload-job?openModal=true",style:{background:"var(--color-light)",border:"none",height:"2.25rem",borderRadius:"0.25rem",marginRight:"0.5rem",display:"flex",alignItems:"center"},children:"Bulk Upload"}),filters:(0,j.jsxs)("div",{children:[b&&(0,j.jsx)("div",{children:(0,j.jsx)(d.Z,{allowClear:!0,placeholder:"Search for the employee",className:"selectAntdCustom",onChange:function(e){var n=(0,i.Z)((0,i.Z)({},P),{},{userId:e});S(n),J(n)},value:P.userId?P.userId:void 0,showSearch:!0,onSearch:function(e){return te(e)},optionFilterProp:"label",options:null===ae||void 0===ae?void 0:ae.map((function(e){return{label:e.firstName+" "+e.lastName,value:e.id}})),notFoundContent:(0,j.jsx)(l.Z,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:100},description:(0,j.jsx)("span",{children:"No data found, Please search for the employee"})})})}),(0,j.jsx)("div",{children:(0,j.jsx)(m.Xy,{type:"radio",label:"Type",name:"type",withSearch:!1,options:Object.entries(z.yV).map((function(e){var n=(0,r.Z)(e,2),t=n[0],o=n[1];return{label:(0,R.kC)(t),value:o}})),onChange:function(e){var n=(0,i.Z)((0,i.Z)({},P),{},{type:Number(e.target.value)});S(n)},value:null===(e=P.type)||void 0===e?void 0:e.toString(),onReset:function(){var e=(0,i.Z)((0,i.Z)({},P),{},{type:void 0});S(e),J(e)},onUpdate:function(){return J(P)}})}),(0,j.jsx)("div",{children:(0,j.jsx)(m.Xy,{type:"datepicker",label:"Date",name:"dateRange",onChange:function(e){var n,t,o,r,a=(0,i.Z)((0,i.Z)({},P),{},{fromDate:e?null===(n=e[0])||void 0===n||null===(t=n._d)||void 0===t?void 0:t.toISOString().substring(0,10):void 0,toDate:e?null===(o=e[1])||void 0===o||null===(r=o._d)||void 0===r?void 0:r.toISOString().substring(0,10):void 0});S(a)},onReset:function(){var e=(0,i.Z)((0,i.Z)({},P),{},{fromDate:void 0,toDate:void 0});S(e),J(e)},onUpdate:function(){return J(P)}})}),(0,j.jsx)("div",{children:(0,j.jsx)(m.Xy,{type:"radio",label:"Mode",name:"mode",withSearch:!1,options:[{label:"Check In",value:"in"},{label:"Check Out",value:"out"}],onChange:function(e){var n=(0,i.Z)((0,i.Z)({},P),{},{mode:e.target.value});S(n)},value:P.mode,onReset:function(){var e=(0,i.Z)((0,i.Z)({},P),{},{mode:void 0});S(e),J(e)},onUpdate:function(){return J(P)}})}),(0,j.jsx)("div",{children:(0,j.jsx)(m.Xy,{type:"radio",label:"Organization",name:"organizationId",withSearch:!1,options:$?null===$||void 0===$?void 0:$.map((function(e){return{label:e.name,value:String(e.id)}})):[],onChange:function(e){var n=(0,i.Z)((0,i.Z)({},P),{},{organizationId:e.target.value});S(n)},value:String(P.organizationId),onReset:function(){var e=(0,i.Z)((0,i.Z)({},P),{},{organizationId:void 0});S(e),J(e)},onUpdate:function(){return J(P)}})})]})}),!0===f&&(0,j.jsx)(M,{tableData:A,tableLoading:X,onEditIconClick:function(e){!1!==v?D((0,i.Z)((0,i.Z)({},T),{},{editType:"edit",recordId:e.id,openModal:!0})):c.ZP.error("You don't have permission to update this record")},reloadTableData:J,meta:K,filters:P}),!1===f&&(0,j.jsx)(F.a$,{mainMessage:"You don't have permission to view this data"}),T.openModal&&(0,j.jsx)(k,{record:T.recordId,type:T.editType,reloadTableData:J,onCancel:W,openModal:T.openModal,permissions:s})]})}},5599:function(e,n,t){t.d(n,{r:function(){return a}});var o=t(43144),i=t(15671),r=t(49075),a=(0,o.Z)((function e(){var n=this;(0,i.Z)(this,e),this.endPoint="biometrics",this.getAllRecords=function(e){return r.Z.get(n.endPoint,{params:e})},this.getRecordById=function(e){return r.Z.get("".concat(n.endPoint,"/").concat(e))},this.findPublished=function(e){return r.Z.get("".concat(n.endPoint,"/published"),{params:e})},this.deleteRecord=function(e){return r.Z.delete("".concat(n.endPoint,"/").concat(e))},this.createRecord=function(e){return r.Z.post(n.endPoint,e)},this.updateRecord=function(e,t){return r.Z.patch("".concat(n.endPoint,"/").concat(t),e)}}))},19723:function(e,n,t){t.d(n,{q:function(){return o}});var o=function(e){return e.CREATE="createBiometricsJob",e.UPDATE="updateBiometricsJob",e.DELETE="deleteBiometricsJob",e.READ="readBiometricsJob",e.ROLLBACK="rollbackBiometricsJob",e}({})},5190:function(e,n,t){t.d(n,{L:function(){return d}});var o=t(43144),i=t(15671),r=t(49075),a=t(3135),d=(0,o.Z)((function e(){var n=this;(0,i.Z)(this,e),this.endPoint="organization",this.getAllRecords=function(e){return r.Z.get(n.endPoint,{params:e})},this.findPublished=function(e){return r.Z.get(n.endPoint+"/find-published",{params:e})},this.getRecordById=function(e){return r.Z.get("".concat(n.endPoint,"/").concat(e))},this.deleteRecord=function(e){return r.Z.delete("".concat(n.endPoint,"/").concat(e))},this.createRecord=function(e){return r.Z.post(n.endPoint,e,{headers:a.C})},this.updateRecord=function(e,t){return r.Z.patch("".concat(n.endPoint,"/").concat(t),e,{headers:a.C})},this.getTenants=function(){return r.Z.get("xero/getTenants")}}))}}]);