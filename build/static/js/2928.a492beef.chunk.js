"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[2928],{62928:function(e,n,t){t.r(n),t.d(n,{default:function(){return x}});var a=t(74165),i=t(15861),o=t(4942),d=t(1413),u=t(29439),s=t(47313),r=t(82626),l=t(7532),c=t(41586),v=t(3798),g=t(98505),m=t(46417);function f(e){var n=e.tableData,t=e.tableLoading,a=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,n,t){return t+1},width:"60px"},{title:"Gateway",dataIndex:"gateway",key:"gateway",render:function(e){return(0,m.jsx)(r.ZT,{color:"dark-main",size:"sm",children:e})}},{title:"Message",dataIndex:"message",key:"message",render:function(e){return(0,m.jsx)(r.ZT,{color:"dark-main",size:"sm",children:e})}},{title:"Mobile Number",dataIndex:"number",key:"number",render:function(e){return(0,m.jsx)(r.ZT,{color:"dark-main",size:"sm",children:e})}},{title:"Sent Date",className:"text-center",dataIndex:"sentDate",key:"sentDate",render:function(e){return(0,m.jsx)(r.ZT,{color:"dark-main",size:"sm",children:(0,g.Ny)(e,"dd M,yy-t")})}},{title:"Status",dataIndex:"status",key:"status",render:function(e){return(0,m.jsx)(r.ZT,{color:"dark-main",size:"sm",children:"".concat((0,v.kC)(e))})}}];return(0,m.jsx)("div",{children:(0,m.jsx)(c.Z,{sticky:!0,dataSource:n,columns:a,pagination:!1,scroll:{x:991},loading:t})})}var h=t(3113),y=t(99396),Z=t(55291),p=[{text:"Home",isLink:!0,path:"/"},{text:"Site Settings",isLink:!0,path:"/siteSettings"},{isLink:!1,text:"SMS Logs"}],x=function(){var e,n,t,c,x=(0,s.useState)({loading:!1,data:[]}),b=(0,u.Z)(x,2),k=b[0],j=b[1],S=(0,s.useMemo)((function(){return new y.e}),[]),w=(0,s.useState)({message:"",userId:0,gateway:"",number:"",status:""}),I=(0,u.Z)(w,2),R=I[0],C=I[1],D=(0,s.useState)(!1),P=(0,u.Z)(D,2),L=P[0],N=P[1],M=function(e){var n=null===e||void 0===e?void 0:e.target,t=n.name,a=n.value;if(("userId"===t||"number"===t)&&!(0,v.hj)(a)){var i="";switch(t){case"userId":i="User ID";break;case"number":i="Phone Number"}return Z.ZP.error("".concat(i," should be a number"))}C((0,d.Z)((0,d.Z)({},R),{},(0,o.Z)({},t,a)))},T=(0,s.useCallback)((0,i.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j({loading:!0}),S.getLogs().then((function(e){j((0,d.Z)((0,d.Z)({},e.data),{},{loading:!1}))})).catch((function(e){j({loading:!1})}));case 2:case"end":return e.stop()}}),e)}))),[S]);(0,s.useEffect)((function(){T()}),[T]);var U=(0,s.useCallback)((function(){var e,n,t=(null===(e=R.dateRange)||void 0===e?void 0:e[0])||"",a=(null===(n=R.dateRange)||void 0===n?void 0:n[1])||"",i=t?(0,g.Ny)(t,"yy-mm-dd"):void 0,o=a?(0,g.Ny)(a,"yy-mm-dd"):void 0,u={status:(null===R||void 0===R?void 0:R.status)||void 0,message:(null===R||void 0===R?void 0:R.message)||void 0,userId:(null===R||void 0===R?void 0:R.userId)||void 0,gateway:(null===R||void 0===R?void 0:R.gateway)||void 0,number:(null===R||void 0===R?void 0:R.number)||void 0,fromDate:i,toDate:o};S.getLogs(u).then((function(e){j((0,d.Z)((0,d.Z)({},e.data),{},{loading:!1}))})).catch((function(e){j({loading:!1})}))}),[R,S]),z=(0,s.useCallback)((function(e,n){e&&(N(!0),C((0,d.Z)((0,d.Z)({},R),{},(0,o.Z)({},e,n))))}),[R]),X=(0,s.useCallback)((function(e,n){var t,a;j((0,d.Z)((0,d.Z)({},k),{},{loading:!0}));var i=(null===(t=R.dateRange)||void 0===t?void 0:t[0])||"",o=(null===(a=R.dateRange)||void 0===a?void 0:a[1])||"",u=i?(0,g.Ny)(i,"yy-mm-dd"):void 0,s=o?(0,g.Ny)(o,"yy-mm-dd"):void 0,r={page:e,perPage:n,status:(null===R||void 0===R?void 0:R.status)||void 0,message:(null===R||void 0===R?void 0:R.message)||void 0,userId:(null===R||void 0===R?void 0:R.userId)||void 0,gateway:(null===R||void 0===R?void 0:R.gateway)||void 0,number:(null===R||void 0===R?void 0:R.number)||void 0,fromDate:u,toDate:s};S.getLogs(r).then((function(e){j((0,d.Z)((0,d.Z)({},e.data),{},{loading:!1}))})).catch((function(e){j({loading:!1})}))}),[S,R,k]);return(0,s.useEffect)((function(){L&&U();var e=setTimeout((function(){N(!1)}),2e3);return function(){return clearTimeout(e)}}),[L,R,U]),(0,m.jsxs)(l.default,{children:[(0,m.jsx)(r.mr,{heading:"SMS Logs",breadCrumbData:p,filters:(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{children:(0,m.jsx)(r.Xy,{type:"datepicker",label:"Date",name:"dateRange",onChange:function(e){C((0,d.Z)((0,d.Z)({},R),{},{dateRange:e}))},onReset:function(){return z("dateRange",[])},onUpdate:U})}),(0,m.jsx)("div",{children:(0,m.jsx)(r.Xy,{type:"input",label:"User ID",name:"userId",value:null!==R&&void 0!==R&&R.userId?String(null===R||void 0===R?void 0:R.userId):"",onChange:M,onReset:function(){N(!0),C((0,d.Z)((0,d.Z)({},R),{},{userId:0}))},onUpdate:U})}),(0,m.jsx)("div",{children:(0,m.jsx)(r.Xy,{type:"input",label:"Gateway",name:"gateway",value:null!==R&&void 0!==R&&R.gateway?String(null===R||void 0===R?void 0:R.gateway):"",onChange:M,onReset:function(){N(!0),C((0,d.Z)((0,d.Z)({},R),{},{gateway:""}))},onUpdate:U})}),(0,m.jsx)("div",{children:(0,m.jsx)(r.Xy,{type:"input",label:"Number",name:"number",value:null!==R&&void 0!==R&&R.number?String(null===R||void 0===R?void 0:R.number):"",onChange:M,onReset:function(){N(!0),C((0,d.Z)((0,d.Z)({},R),{},{number:""}))},onUpdate:U})}),(0,m.jsx)("div",{children:(0,m.jsx)(r.Xy,{type:"input",label:"Message",name:"message",value:null!==R&&void 0!==R&&R.message?String(null===R||void 0===R?void 0:R.message):"",onChange:M,onReset:function(){N(!0),C((0,d.Z)((0,d.Z)({},R),{},{message:""}))},onUpdate:U})}),(0,m.jsx)("div",{children:(0,m.jsx)(r.Xy,{type:"input",label:"Status",name:"status",value:null!==R&&void 0!==R&&R.status?String(null===R||void 0===R?void 0:R.status):"",onChange:M,onReset:function(){N(!0),C((0,d.Z)((0,d.Z)({},R),{},{status:""}))},onUpdate:U})})]})}),(0,m.jsx)("div",{className:h.Z.antdTableWrapper,children:(0,m.jsx)(f,{tableData:null===k||void 0===k?void 0:k.data,tableLoading:k.loading})}),(0,m.jsx)(r.tl,{total:null===k||void 0===k||null===(e=k.meta)||void 0===e?void 0:e.total,current:null===k||void 0===k||null===(n=k.meta)||void 0===n?void 0:n.page,defaultPageSize:null!==k&&void 0!==k&&null!==(t=k.meta)&&void 0!==t&&t.perPage?null===k||void 0===k||null===(c=k.meta)||void 0===c?void 0:c.perPage:10,pageSizeOptions:[10,20,50,100],onChange:X})]})}},99396:function(e,n,t){t.d(n,{e:function(){return d}});var a=t(43144),i=t(15671),o=t(49075),d=(0,a.Z)((function e(){var n=this;(0,i.Z)(this,e),this.endPoint="sms",this.getAllRecords=function(){return o.Z.get(n.endPoint)},this.getRecordById=function(e){return o.Z.get("".concat(n.endPoint,"/").concat(e))},this.deleteRecord=function(e){return o.Z.delete("".concat(n.endPoint,"/").concat(e))},this.createRecord=function(e){return o.Z.post(n.endPoint+"/",e)},this.updateRecord=function(e,t){return o.Z.patch("".concat(n.endPoint,"/").concat(t),e)},this.makeDefault=function(e){return o.Z.patch("".concat(n.endPoint,"/makeDefaultSMSGateway/").concat(e))},this.getLogs=function(e){return o.Z.get("".concat(n.endPoint,"/readSmsSentLogs"),{params:e})}}))}}]);