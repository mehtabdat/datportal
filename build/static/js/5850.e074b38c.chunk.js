"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[5850],{70815:function(e,n,t){t.d(n,{r:function(){return p}});var o=t(1413),i=t(29439),r=t(45987),a=t(55291),d=t(86345),c=t(47313),s=t(40169),l=t(46417),u=["onChange","checked","recordId","allowChange"],p=function(e){var n=e.onChange,t=e.checked,p=e.recordId,h=e.allowChange,f=void 0===h||h,Z=(0,r.Z)(e,u),g=(0,c.useState)({loading:!1,checked:!1}),m=(0,i.Z)(g,2),P=m[0],j=m[1];return(0,c.useEffect)((function(){j((0,o.Z)((0,o.Z)({},P),{},{checked:t}))}),[t]),(0,l.jsx)(d.Z,{checked:P.checked,onChange:function(e){!0===f?(j((0,o.Z)((0,o.Z)({},P),{},{loading:!0})),n(e,p,Z).then((function(n){j((0,o.Z)((0,o.Z)({},P),{},{checked:e,loading:!1})),a.ZP.success(n.data.message)})).catch((function(e){j((0,o.Z)((0,o.Z)({},P),{},{loading:!1}));var n=(0,s.P)(e);"string"===typeof n.message?a.ZP.error(n.message):a.ZP.error("Something went wrong")}))):a.ZP.error("You don't have permission to change this record, please contact your admin.")},loading:P.loading})}},25850:function(e,n,t){t.r(n),t.d(n,{default:function(){return E}});var o=t(1413),i=t(29439),r=t(47313),a=t(7532),d=t(25019),c=t(55291),s=t(86345),l=t(82626),u=t(17327),p=t(49355),h=t(3798),f=t(46646),Z=t(40169),g=t(6027),m=t(46417),P=function(e){var n=e.openModal,t=e.onCancel,a=e.type,P=e.record,j=e.reloadTableData,x=e.permissions,v=x.createProjectType,y=x.updateProjectType,b=d.Z.useForm(),C=(0,i.Z)(b,1)[0],k=new g.i,T=(0,r.useState)(),w=(0,i.Z)(T,2),I=w[0],L=w[1],S=function(e){var n=(0,Z.P)(e);if("string"==typeof n.message)L((0,o.Z)((0,o.Z)({},I),{},{error:n.message}));else{var t=(0,f.O)(n.message,[]);C.setFields(t),L((0,o.Z)((0,o.Z)({},I),{},{error:""}))}},E=(0,r.useCallback)((function(){k.getRecordById(P).then((function(e){e.data&&e.data.data&&(console.log(e.data.data),C.setFieldsValue((0,o.Z)((0,o.Z)({},e.data.data),{},{isPublished:e.data.data.isPublished})))})).catch((function(e){S(e)}))}),[C,P,k]);(0,r.useEffect)((function(){"edit"===a?E():C.resetFields()}),[n,a,C,E]);return(0,m.jsx)(l.P0,{visible:n,closable:!0,onCancel:t,titleText:"edit"===a?"Edit Project Type":"Add New Project Type",showFooter:!1,children:null!==I&&void 0!==I&&I.loading?(0,m.jsx)(p.Z,{items:10}):(0,m.jsxs)(d.Z,{className:u.Z.form,onFinish:function(e){switch(L((0,o.Z)((0,o.Z)({},I),{},{buttonLoading:!0})),a){case"edit":!0===y?k.updateRecord(e,P).then((function(e){j(),t(),L((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){S(e),L((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})):(L((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})})),c.ZP.error("You don't have permission to update this record"));break;case"new":!0===v?k.createRecord(e).then((function(e){j(),t(),L((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){S(e),L((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})):(L((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})})),c.ZP.error("You don't have permission to create this record"))}},form:C,children:[(null===I||void 0===I?void 0:I.error)&&(0,m.jsx)(l.EQ,{description:null===I||void 0===I?void 0:I.error,isClosable:!0,onClose:function(){L((0,o.Z)((0,o.Z)({},I),{},{error:""}))}}),(0,m.jsx)("div",{children:(0,m.jsx)(d.Z.Item,{name:"title",rules:[{required:!0,message:"Please add a title"}],children:(0,m.jsx)(l.t7,{size:"w100",label:"Title",asterisk:!0,type:"text",placeHolder:"Enter project type"})})}),(0,m.jsx)("div",{children:(0,m.jsx)(d.Z.Item,{name:"slug",rules:[{required:!0,message:"Please add a slug"}],children:(0,m.jsx)(l.t7,{onChange:function(e){var n=e.target,t=(0,h.V3)(n.value);C.setFieldsValue({slug:t})},size:"w100",label:"Slug",asterisk:!0,type:"text"})})}),(0,m.jsx)("div",{children:(0,m.jsx)(d.Z.Item,{name:"status",label:"Status",children:(0,m.jsx)(s.Z,{checkedChildren:"Active",unCheckedChildren:"Inactive",defaultChecked:!0})})}),(0,m.jsxs)("div",{className:"d-flex justify-end",children:[(0,m.jsx)(l.op,{size:"normal",fontSize:"sm",onClick:t,type:"plain",children:"Cancel"}),(0,m.jsx)(l.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:null===I||void 0===I?void 0:I.buttonLoading,children:"edit"===a?"Edit Project Type":"Add Project Type"})]})]})})},j=t(5900),x=t(41586),v=t(98676),y=t(3109),b=t(70815),C=t(85554),k=function(e){var n=e.record,t=e.onEditIconClick,a=e.reloadTableData,d=e.permissions.deleteProjectType,s=(0,r.useState)({confirmLoading:!1,openPopConfirm:!1}),l=(0,i.Z)(s,2),p=l[0],h=l[1],f=new g.i;return(0,m.jsxs)("div",{className:u.Z.actions,children:[(0,m.jsx)("span",{onClick:function(){return t(n)},children:(0,m.jsx)("img",{src:"/images/editicon.svg",alt:""})}),(0,m.jsx)(j.Z,{open:p.openPopConfirm,placement:"top",title:"Are you sure?",onConfirm:function(){if(h((0,o.Z)((0,o.Z)({},p),{},{confirmLoading:!0})),!1===d)return c.ZP.error("You don't have permission to delete this record, please contact your admin."),void h((0,o.Z)((0,o.Z)({},p),{},{openPopConfirm:!1}));f.deleteRecord(n.id).then((function(e){h((0,o.Z)((0,o.Z)({},p),{},{openPopConfirm:!1,confirmLoading:!1})),a()})).catch((function(e){h((0,o.Z)((0,o.Z)({},p),{},{confirmLoading:!1}))}))},onCancel:function(){return h((0,o.Z)((0,o.Z)({},p),{},{openPopConfirm:!1}))},okButtonProps:{loading:p.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:function(e){e||h((0,o.Z)((0,o.Z)({},p),{},{openPopConfirm:!1}))},children:(0,m.jsx)(v.Z,{className:u.Z.bg__red,onClick:function(){h((0,o.Z)((0,o.Z)({},p),{},{openPopConfirm:!0}))}})})]})};function T(e){var n=e.tableData,t=e.tableLoading,i=e.onEditIconClick,r=e.reloadTableData,a=e.meta,d=e.filters,c=(0,C.v9)((function(e){return e.usersReducer})).userPermissions,s=new g.i,l=function(e,n){return s.updateRecord({isPublished:e},n)},p=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,n,t){return t+1},width:"5%"},{title:"Title",dataIndex:"localization",key:"localization",render:function(e,n){return(0,m.jsx)(y.Z,{color:"dark-main",size:"sm",weight:"bold",children:n.title})}},{title:"Slug",dataIndex:"slug",key:"slug",render:function(e,n){return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(y.Z,{color:"dark-main",size:"sm",weight:"bold",children:n.slug})})}},{title:"Published",dataIndex:"isPublished",key:"isPublished",render:function(e,n){return(0,m.jsx)(b.r,{checked:e,onChange:l,recordId:n.id,allowChange:c.updateProjectType})}},{title:"Actions",dataIndex:"actions",key:"actions",render:function(e,n){return(0,m.jsx)(k,{record:n,onEditIconClick:i,reloadTableData:r,permissions:c})}}];return(0,m.jsx)("div",{className:u.Z.antdTableWrapper,children:(0,m.jsx)(x.Z,{sticky:!0,dataSource:n,columns:p,pagination:{current:null===a||void 0===a?void 0:a.page,total:null===a||void 0===a?void 0:a.total,hideOnSinglePage:!0,pageSize:null===a||void 0===a?void 0:a.perPage,onChange:function(e,n){r((0,o.Z)((0,o.Z)({},d),{},{page:e,perPage:n}))}},scroll:{x:991},loading:t,rowKey:function(e){return"project-type-".concat(e.id)}})})}var w=t(18515),I=function(e){return e.CREATE="createProjectType",e.UPDATE="updateProjectType",e.DELETE="deleteProjectType",e.READ="readProjectType",e}({}),L=t(29079),S=[{text:"Home",isLink:!0,path:"/"},{isLink:!0,text:"Site Settings",path:"/siteSettings"},{isLink:!1,text:"Project Type"}];var E=function(){var e=(0,h.aY)(I),n=(0,C.v9)((function(e){return e.usersReducer})).userPermissions,t=n.readProjectType,d=n.createProjectType,s=n.updateProjectType,u=(0,r.useState)({editType:"new",recordId:0,openModal:!1}),p=(0,i.Z)(u,2),f=p[0],Z=p[1],j=new g.i,x=(0,r.useState)({page:1,perPage:10}),v=(0,i.Z)(x,2),y=v[0],b=(v[1],(0,L.$5)({method:j.getAllRecords,initialQuery:(0,o.Z)({},y)})),k=b.data,E=b.onRefresh,R=(b.setData,b.loading),D=b.meta,A=function(){!1!==d?Z((0,o.Z)((0,o.Z)({},f),{},{openModal:!f.openModal,editType:"new"})):c.ZP.error("You don't have permission to create new record")};return(0,m.jsxs)(a.default,{permissionSlug:e,children:[(0,m.jsx)(l.mr,{heading:"Project Type",buttonText:"Add Project Type",onButtonClick:A,breadCrumbData:S,showAdd:!0===d}),!0===t&&(0,m.jsx)(T,{tableData:k,tableLoading:R,onEditIconClick:function(e){!1!==s?Z((0,o.Z)((0,o.Z)({},f),{},{editType:"edit",recordId:e.id,openModal:!0})):c.ZP.error("You don't have permission to update this record")},reloadTableData:E,meta:D,filters:y}),!1===t&&(0,m.jsx)(w.a$,{mainMessage:"You don't have permission to view this data"}),f.openModal&&(0,m.jsx)(P,{record:f.recordId,type:f.editType,reloadTableData:E,onCancel:A,openModal:f.openModal,permissions:n})]})}},6027:function(e,n,t){t.d(n,{i:function(){return a}});var o=t(43144),i=t(15671),r=t(49075),a=(0,o.Z)((function e(){var n=this;(0,i.Z)(this,e),this.endPoint="project-type",this.getAllRecords=function(e){return r.Z.get(n.endPoint,{params:e})},this.getPublishRecords=function(e){return r.Z.get("".concat(n.endPoint,"/find-published"),{params:e})},this.getRecordById=function(e){return r.Z.get(n.endPoint+"/"+e)},this.deleteRecord=function(e){return r.Z.delete(n.endPoint+"/"+e)},this.createRecord=function(e){return r.Z.post(n.endPoint,e)},this.updateRecord=function(e,t){return r.Z.patch(n.endPoint+"/"+t,e)}}))}}]);