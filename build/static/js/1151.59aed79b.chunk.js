"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[1151],{61151:function(e,n,t){t.r(n),t.d(n,{default:function(){return h}});var a=t(74165),i=t(15861),o=t(4942),d=t(1413),r=t(29439),u=t(47313),s=t(82626),l=t(7532),c=t(41586),v=t(37936),g=t(98505),p=t(46417);function m(e){var n=e.tableData,t=e.tableLoading,a=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,n,t){return t+1},width:"60px"},{title:"User",dataIndex:"user",key:"user",render:function(e){return(0,p.jsxs)(p.Fragment,{children:[(null===e||void 0===e?void 0:e.firstName)&&(0,p.jsx)(s.ZT,{color:"dark-main",size:"sm",children:"Name: ".concat(e.firstName," ").concat(e.lastName)}),(null===e||void 0===e?void 0:e.Organization)&&(0,p.jsx)(s.ZT,{color:"dark-sub",size:"sm",children:"ORG: ".concat(e.Organization.name)})]})}},{title:"User Agent",dataIndex:"userAgent",key:"userAgent",render:function(e){return(0,p.jsx)(s.ZT,{color:"dark-main",size:"sm",children:e})}},{title:"IP Address",dataIndex:"userIP",key:"userIP",render:function(e){return(0,p.jsx)(s.ZT,{color:"dark-main",size:"sm",children:e})}},{title:"Token Type",dataIndex:"tokenType",key:"tokenType",render:function(e){return(0,p.jsx)(s.ZT,{color:"dark-main",size:"sm",children:v.s9[e]})}},{title:"Added Date",dataIndex:"addedDate",key:"addedDate",render:function(e){return(0,p.jsx)(p.Fragment,{children:e?(0,p.jsx)(s.ZT,{color:"dark-main",size:"sm",children:(0,g.Ny)(e,"dd M,yy-t")}):null})}}];return(0,p.jsx)("div",{children:(0,p.jsx)(c.Z,{sticky:!0,dataSource:n,columns:a,pagination:!1,scroll:{x:991},loading:t})})}var f=t(3113),y=t(84825),I=t(3798),x=t(55291),k=[{text:"Home",isLink:!0,path:"/"},{text:"Site Settings",isLink:!0,path:"/siteSettings"},{isLink:!1,text:"Active Users"}],h=function(){var e,n,t,c,h=(0,u.useState)({loading:!1,data:[]}),Z=(0,r.Z)(h,2),j=Z[0],b=Z[1],z=(0,u.useMemo)((function(){return new y.z}),[]),T=(0,u.useState)({userId:0,organizationId:0,userAgent:"",userIP:"",tokenType:"",dateRange:[]}),A=(0,r.Z)(T,2),P=A[0],R=A[1],S=(0,u.useState)(!1),U=(0,r.Z)(S,2),C=U[0],D=U[1],N=function(e){var n=null===e||void 0===e?void 0:e.target,t=n.name,a=n.value;if(("userId"===t||"organizationId"===t)&&!(0,I.hj)(a)){var i="";switch(t){case"userId":i="User Id";break;case"organizationId":i="Organization Id"}return x.ZP.error("".concat(i," should be a number"))}R((0,d.Z)((0,d.Z)({},P),{},(0,o.Z)({},t,a)))},w=(0,u.useCallback)(function(){var e=(0,i.Z)((0,a.Z)().mark((function e(n){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b({loading:!0}),z.getActiveUsers(n).then((function(e){b((0,d.Z)((0,d.Z)({},e.data),{},{loading:!1}))})).catch((function(e){b({loading:!1})}));case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[z]);(0,u.useEffect)((function(){w()}),[w]);var O=(0,u.useCallback)((function(){var e,n,t=(null===(e=P.dateRange)||void 0===e?void 0:e[0])||"",a=(null===(n=P.dateRange)||void 0===n?void 0:n[1])||"",i=t?(0,g.Ny)(t,"yy-mm-dd"):void 0,o=a?(0,g.Ny)(a,"yy-mm-dd"):void 0,d={userId:P.userId||void 0,organizationId:P.organizationId||void 0,userAgent:P.userAgent||void 0,userIP:P.userIP||void 0,tokenType:P.tokenType||void 0,fromDate:i,toDate:o};w(d)}),[P,z]),X=(0,u.useCallback)((function(e,n){e&&(D(!0),R((0,d.Z)((0,d.Z)({},P),{},(0,o.Z)({},e,n))))}),[P]),L=(0,u.useCallback)((function(e,n){var t,a;b((0,d.Z)((0,d.Z)({},j),{},{loading:!0}));var i=(null===(t=P.dateRange)||void 0===t?void 0:t[0])||"",o=(null===(a=P.dateRange)||void 0===a?void 0:a[1])||"",r=i?(0,g.Ny)(i,"yy-mm-dd"):void 0,u=o?(0,g.Ny)(o,"yy-mm-dd"):void 0,s={page:e,perPage:n,userId:P.userId||void 0,organizationId:P.organizationId||void 0,userAgent:P.userAgent||void 0,userIP:P.userIP||void 0,tokenType:P.tokenType||void 0,fromDate:r,toDate:u};w(s)}),[z,P,j]);return(0,u.useEffect)((function(){C&&O();var e=setTimeout((function(){D(!1)}),2e3);return function(){return clearTimeout(e)}}),[C,P,O]),(0,p.jsxs)(l.default,{children:[(0,p.jsx)(s.mr,{heading:"Active Users",breadCrumbData:k,filters:(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{children:(0,p.jsx)(s.Xy,{type:"datepicker",label:"Date",name:"dateRange",onChange:function(e){R((0,d.Z)((0,d.Z)({},P),{},{dateRange:e}))},onReset:function(){return X("dateRange",[])},onUpdate:O})}),(0,p.jsx)("div",{children:(0,p.jsx)(s.Xy,{type:"input",label:"User ID",name:"userId",value:null!==P&&void 0!==P&&P.userId?String(null===P||void 0===P?void 0:P.userId):"",onChange:N,onReset:function(){D(!0),R((0,d.Z)((0,d.Z)({},P),{},{userId:0}))},onUpdate:O})}),(0,p.jsx)("div",{children:(0,p.jsx)(s.Xy,{type:"input",label:"Organization ID",name:"organizationId",value:null!==P&&void 0!==P&&P.organizationId?String(null===P||void 0===P?void 0:P.organizationId):"",onChange:N,onReset:function(){D(!0),R((0,d.Z)((0,d.Z)({},P),{},{organizationId:0}))},onUpdate:O})}),(0,p.jsx)("div",{children:(0,p.jsx)(s.Xy,{type:"input",label:"User Agent",name:"userAgent",value:null!==P&&void 0!==P&&P.userAgent?String(null===P||void 0===P?void 0:P.userAgent):"",onChange:N,onReset:function(){D(!0),R((0,d.Z)((0,d.Z)({},P),{},{userAgent:""}))},onUpdate:O})}),(0,p.jsx)("div",{children:(0,p.jsx)(s.Xy,{type:"input",label:"User IP",name:"userIP",value:null!==P&&void 0!==P&&P.userIP?String(null===P||void 0===P?void 0:P.userIP):"",onChange:N,onReset:function(){D(!0),R((0,d.Z)((0,d.Z)({},P),{},{userIP:""}))},onUpdate:O})}),(0,p.jsx)("div",{children:(0,p.jsx)(s.Xy,{type:"radio",label:"Token Type",name:"tokenType",value:null!==P&&void 0!==P&&P.tokenType?String(null===P||void 0===P?void 0:P.tokenType):"",onChange:N,onReset:function(){D(!0),R((0,d.Z)((0,d.Z)({},P),{},{tokenType:""}))},onUpdate:O,options:Object.entries(v.s9).map((function(e){var n=(0,r.Z)(e,2),t=n[0];return{label:n[1],value:t}}))})})]})}),(0,p.jsx)("div",{className:f.Z.antdTableWrapper,children:(0,p.jsx)(m,{tableData:null===j||void 0===j?void 0:j.data,tableLoading:j.loading})}),(0,p.jsx)(s.tl,{total:null===j||void 0===j||null===(e=j.meta)||void 0===e?void 0:e.total,current:null===j||void 0===j||null===(n=j.meta)||void 0===n?void 0:n.page,defaultPageSize:null!==j&&void 0!==j&&null!==(t=j.meta)&&void 0!==t&&t.perPage?null===j||void 0===j||null===(c=j.meta)||void 0===c?void 0:c.perPage:10,pageSizeOptions:[10,20,50,100],onChange:L})]})}}}]);