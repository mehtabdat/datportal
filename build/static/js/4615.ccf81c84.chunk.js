(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[4615],{50008:function(e,t,n){"use strict";n.d(t,{t:function(){return a}});var s=n(47312),r="styles_card__cH2rF",i=n(46417),a=function(){return(0,i.jsx)("div",{className:r,children:(0,i.jsx)(s.Z,{active:!0})})}},88815:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return C}});var s=n(1413),r=n(93433),i=n(29439),a=n(82626),o=n(54060),l="styles_container__PrN06",d="styles_onlyMyTask__DaQG9",c=n(47313),u=n(55291),v=n(49958),m=n(29079),h=n(85555),f=n(85554),p=n(85921),y=n(42623),_=n(84825),x=n(91181),Z=n(32845),j=n(37936),g=n(3798),R=n(50008),N=n(46417),b=[{text:"Home",isLink:!0,path:"/"},{isLink:!0,text:"Employee Requests",path:"/employee-requests/?all"},{isLink:!1,text:"Car Reservation Request"}],C=function(){var e,t,n=(0,g.aY)(p.b),C=(0,f.v9)((function(e){return e.usersReducer})).userPermissions,D=(0,c.useState)({userId:void 0,fetchOpenRequest:!0,status:void 0,fromDate:void 0,toDate:void 0,page:1,perPage:6}),S=(0,i.Z)(D,2),w=S[0],P=S[1],A=(0,c.useState)({recordId:0}),W=(0,i.Z)(A,2),k=W[0],T=W[1],z=(0,c.useState)(!1),I=(0,i.Z)(z,2),q=I[0],B=I[1],O=(0,c.useMemo)((function(){return new h.k}),[]),L=(0,m.$5)({method:O.getAllRecords,initialQuery:{perPage:w.perPage,page:w.page,fetchOpenRequest:!0}}),M=L.data,H=L.onRefresh,F=L.loading,E=L.meta,G=(0,c.useState)(""),Q=(0,i.Z)(G,2),X=Q[0],J=Q[1],K=(0,y.N)(X,500),U=(0,c.useState)([]),V=(0,i.Z)(U,2),Y=V[0],$=V[1],ee=(0,c.useMemo)((function(){return new _.z}),[]),te=(0,c.useCallback)((function(){K&&ee.getAllRecords({name:K}).then((function(e){$((function(t){var n,s,i=null===e||void 0===e||null===(n=e.data)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.filter((function(e){return!(null!==t&&void 0!==t&&t.find((function(t){return t.id===e.id})))}));return[].concat((0,r.Z)(t),(0,r.Z)(i))}))})).catch((function(e){u.ZP.error(e.response.data.message)}))}),[K]);return(0,c.useEffect)((function(){te()}),[te]),(0,N.jsxs)(o.Z,{permissionSlug:n,children:[(0,N.jsx)(a.mr,{heading:"Car Reservation Request",breadCrumbData:b,filters:(0,N.jsxs)("div",{style:{marginTop:"1.5rem"},children:[(0,N.jsx)("div",{children:(0,N.jsx)(a.Xy,{type:"radio",label:"User",name:"userId",withSearch:!0,options:null===Y||void 0===Y?void 0:Y.map((function(e){return{label:e.firstName+" "+e.lastName,value:e.id.toString()}})),onChange:function(e){var t=(0,s.Z)((0,s.Z)({},w),{},{userId:e.target.value});P(t)},value:null===(e=w.userId)||void 0===e?void 0:e.toString(),onReset:function(){var e=(0,s.Z)((0,s.Z)({},w),{},{userId:void 0});P(e),H(e),J("")},onUpdate:function(){return H(w)},searchTerm:X,onSearch:function(e){return J(e.currentTarget.value)}})}),(0,N.jsx)("div",{children:(0,N.jsx)(a.Xy,{type:"radio",label:"Status",name:"status",withSearch:!1,options:Object.entries(j.t0).map((function(e){var t=(0,i.Z)(e,2),n=t[0],s=t[1];return{label:(0,g.kC)(s.status.replaceAll("_"," ")),value:n}})),onChange:function(e){var t=(0,s.Z)((0,s.Z)({},w),{},{status:e.target.value});P(t)},value:null===(t=w.status)||void 0===t?void 0:t.toString(),onReset:function(){var e=(0,s.Z)((0,s.Z)({},w),{},{status:void 0});P(e),H(e)},onUpdate:function(){return H(w)}})}),(0,N.jsx)("div",{children:(0,N.jsx)(a.Xy,{type:"datepicker",label:"Date",name:"dateRange",onChange:function(e){var t,n,r,i,a=(0,s.Z)((0,s.Z)({},w),{},{fromDate:e?null===(t=e[0])||void 0===t||null===(n=t._d)||void 0===n?void 0:n.toISOString().substring(0,10):void 0,toDate:e?null===(r=e[1])||void 0===r||null===(i=r._d)||void 0===i?void 0:i.toISOString().substring(0,10):void 0});P(a)},onReset:function(){var e=(0,s.Z)((0,s.Z)({},w),{},{fromDate:void 0,toDate:void 0});P(e),H(e)},onUpdate:function(){return H(w)}})}),(0,N.jsx)("div",{style:{backgroundColor:w.fetchOpenRequest?"var(--color-dark-main)":void 0,color:w.fetchOpenRequest?"var(--color-inactive)":void 0},onClick:function(){var e=(0,s.Z)((0,s.Z)({},w),{},{fetchOpenRequest:!w.fetchOpenRequest||void 0});P(e),H(e)},className:d,children:"Open Requests Only"})]})}),(0,N.jsx)("section",{className:l,children:F?(0,r.Z)(new Array(6)).map((function(e,t){return(0,N.jsx)(R.t,{},"shimmer".concat(t))})):0!==(null===M||void 0===M?void 0:M.length)?null===M||void 0===M?void 0:M.map((function(e,t){return(0,N.jsx)(Z.Q,{carReservation:e,onClick:function(){T((0,s.Z)((0,s.Z)({},k),{},{recordId:e.id})),B(!0)}},t)})):(0,N.jsx)("div",{style:{margin:"auto"},children:(0,N.jsx)(a.I$,{description:"No requests found for the given filters, please modify the search criteria"})})}),(0,N.jsx)(v.Z,{hideOnSinglePage:!0,current:null===E||void 0===E?void 0:E.page,total:null===E||void 0===E?void 0:E.total,pageSize:(null===E||void 0===E?void 0:E.perPage)||0,onChange:function(e,t){H((0,s.Z)((0,s.Z)({},w),{},{page:e,perPage:t}))},style:{alignSelf:"flex-end"}}),q&&(0,N.jsx)(x.s,{openDrawer:q,onClose:function(){return B(!1)},permissions:C,record:k.recordId,reloadTableData:H})]})}},91181:function(e,t,n){"use strict";n.d(t,{s:function(){return P}});var s=n(29439),r=n(8570),i=n(25019),a=n(55291),o=n(97258),l=n(21680),d=n(31513),c=n(98276),u=n(39180),v=n(82626),m={drawerContainer:"styles_drawerContainer__19po8",attachmentsWrap:"styles_attachmentsWrap__8LmAx",attachment:"styles_attachment__-7+hR",amountWrap:"styles_amountWrap__yQ40t",priceText:"styles_priceText__xflHo",resourceWrap:"styles_resourceWrap__L8HyO",hrWrap:"styles_hrWrap__X1bet",title:"styles_title__9-84D",hrInputs:"styles_hrInputs__m786G",dateWrap:"styles_dateWrap__ca0Wc",fromDate:"styles_fromDate__Q4dos",bold:"styles_bold__qHoJq",footerWrap:"styles_footerWrap__-JkBg",buttonWrap:"styles_buttonWrap__zwRdC",financeWrap:"styles_financeWrap__+JGmz",actionsWrap:"styles_actionsWrap__y+fYO"},h=n(37936),f=n(47313),p=n(29079),y=n(98505),_=n(85555),x=n(51534),Z=n(82334),j=n(48694),g=n(49075),R=n(40096),N=n(48897),b=n(70816),C=n.n(b),D=n(64217),S=n(46417),w=r.Z.Text,P=function(e){var t,n,r,b,P,A,W,k=e.openDrawer,T=e.onClose,z=e.record,I=e.permissions,q=e.reloadTableData;x.GlobalWorkerOptions.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(x.version,"/pdf.worker.js");var B=i.Z.useForm(),O=(0,s.Z)(B,1)[0],L=(0,f.useState)(!1),M=(0,s.Z)(L,2),H=M[0],F=M[1],E=(0,f.useState)(""),G=(0,s.Z)(E,2),Q=G[0],X=G[1],J=new _.k,K=(0,p.$5)({method:function(){return J.getRecordById(z)}}),U=K.data,V=K.onRefresh,Y=R.Z.getLocalAccessToken(),$=I.updatecarReservationRequest,ee=I.carReservationRequestHRApproval,te=new D.S,ne=(0,p.$5)({method:te.getCars}).data;return(0,S.jsx)("section",{className:m.container,children:(0,S.jsx)(o.Z,{title:"CRR-".concat(null===U||void 0===U?void 0:U.id," - (").concat(null!==U&&void 0!==U&&U.status?null===(t=h.t0[null===U||void 0===U?void 0:U.status])||void 0===t?void 0:t.status:"",")"),placement:"right",size:"large",width:window.innerWidth>768?"60%":"100%",onClose:T,open:k,children:(0,S.jsx)(i.Z,{className:m.form,onFinish:function(e){F(!0),!0===$?J.hrActionCarReservation({companyCarId:e.companyCarId,comment:e.comment,status:e.status},z).then((function(){q(),F(!1),V(),O.resetFields()})).catch((function(e){var t,n;a.ZP.error(null===e||void 0===e||null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message),F(!1)})):(a.ZP.error("You don't have permission to update this record"),F(!1))},form:O,children:(0,S.jsxs)("div",{className:m.drawerContainer,children:[(0,S.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("b",{children:"Name:"}),"\xa0","".concat((null===U||void 0===U||null===(n=U.RequestBy)||void 0===n?void 0:n.firstName)||""," ").concat((null===U||void 0===U||null===(r=U.RequestBy)||void 0===r?void 0:r.lastName)||"")]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("b",{children:"Date:"}),"\xa0",(0,y.Ny)((null===U||void 0===U?void 0:U.addedDate)||"","MM dd,yy")]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("b",{children:"Purpose:"}),(0,S.jsx)("div",{style:{fontSize:"var(--font-size-normal)"},children:null===U||void 0===U?void 0:U.purpose})]}),null!==U&&void 0!==U&&null!==(b=U.Attachments)&&void 0!==b&&b.length?(0,S.jsx)("div",{className:m.attachmentsWrap,children:null===U||void 0===U?void 0:U.Attachments.map((function(e,t){var n;return(0,S.jsx)("div",{className:m.attachment,children:(0,S.jsxs)("div",{className:m.resourceWrap,children:[null!==e&&void 0!==e&&null!==(n=e.mimeType)&&void 0!==n&&n.includes("pdf")?(0,S.jsx)("a",{href:"".concat(N.PO).concat(null===e||void 0===e?void 0:e.file),target:"_blank",rel:"noreferrer",children:(0,S.jsx)(Z.Z,{file:"".concat(g._,"resources/all/").concat(e.file,"?authKey=").concat(Y),children:(0,S.jsx)(j.Z,{renderTextLayer:!1,pageNumber:1})})}):(0,S.jsx)(l.Z,{style:{objectFit:"cover",borderRadius:"0.25rem 0.25rem 0 0"},width:150,height:100,src:"".concat(g._,"resources/all/").concat(e.file,"?authKey=").concat(Y)}),(0,S.jsx)("div",{style:{padding:"0.25rem 0.5rem",borderRadius:"0.25rem",display:"flex",flexDirection:"column"},children:(0,S.jsx)(w,{style:{width:125,fontSize:"var(--font-size-xs)"},strong:!0,ellipsis:!0,children:null===e||void 0===e?void 0:e.title})})]})},t)}))}):null,(null===U||void 0===U?void 0:U.status)!==h.b6.withdrawn&&(0,S.jsxs)("div",{className:m.hrWrap,children:[(0,S.jsx)("div",{className:m.title,children:"HR Department Actions"}),(0,S.jsxs)("div",{className:m.hrInputs,children:[(0,S.jsx)("b",{style:{fontSize:"var(--font-size-sm)"},children:"Reservation date"}),(0,S.jsxs)("div",{className:m.dateWrap,children:[(0,S.jsx)("div",{className:m.fromDate,children:C()(null===U||void 0===U?void 0:U.fromDate).format("dddd")+", "+(0,y.Ny)((null===U||void 0===U?void 0:U.fromDate)||"","dd MM,yy")}),(0,S.jsxs)("div",{className:m.fromDate,children:["(From ",C()(null===U||void 0===U?void 0:U.fromDate).format("LT")]}),(0,S.jsxs)("div",{className:m.fromDate,children:["to ",C()(null===U||void 0===U?void 0:U.toDate).format("LT"),")"]})]}),(0,S.jsxs)("div",{className:m.actionsWrap,children:[(0,S.jsx)("br",{}),null!==U&&void 0!==U&&U.AdminActions.find((function(e){return"hr"===e.Department.slug}))?(0,S.jsx)("div",{style:{textTransform:"capitalize",lineHeight:"1rem"},children:null===(P=h.t0[null===U||void 0===U||null===(A=U.AdminActions[0])||void 0===A?void 0:A.status])||void 0===P?void 0:P.status}):ee?(0,S.jsxs)("div",{style:{display:"flex",gap:"1rem",alignItems:"flex-end"},children:[(0,S.jsxs)(i.Z.Item,{name:"companyCarId",rules:[{required:!0,message:"Please select a car"}],children:[(0,S.jsx)("b",{className:"font-size-sm color-dark-main",children:"Company car"}),(0,S.jsx)(d.Z,{allowClear:!0,style:{width:"100%"},placeholder:"Search for the car",className:"selectAntdCustom",onChange:function(e){var t;O.setFieldsValue({companyCarId:e}),t=e,X(""),J.checkAvailability({companyCarId:t,fromDate:(null===U||void 0===U?void 0:U.fromDate.toString())||"",toDate:(null===U||void 0===U?void 0:U.toDate.toString())||""}).then((function(e){e.data.data.isAvailable||X("The car is already booked for these dates")})).catch((function(){a.ZP.error("Something went wrong")}))},showSearch:!0,onSearch:function(){},optionFilterProp:"label",options:null===ne||void 0===ne?void 0:ne.map((function(e){return{label:e.assetName,value:e.id}})),notFoundContent:(0,S.jsx)(c.Z,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:100},description:(0,S.jsx)("span",{children:"No data found, Please search for the car"})})})]}),(0,S.jsx)(i.Z.Item,{name:"status",rules:[{required:!0,message:"Please select a status"}],children:(0,S.jsx)(u.ZP.Group,{options:h.Y1,optionType:"button",buttonStyle:"solid"})})]}):"No action from HR yet",(0,S.jsx)("div",{style:{color:"var(--color-red-yp)",fontSize:"var(--font-size-xs)"},children:Q})]})]}),(0,S.jsxs)("div",{className:m.footerWrap,children:[null!==U&&void 0!==U&&U.AdminActions.find((function(e){return"hr"===e.Department.slug}))?(0,S.jsxs)("div",{className:m.priceText,children:[(0,S.jsx)("b",{style:{fontSize:"var(--font-size-sm)"},children:"Comment"}),(0,S.jsx)("div",{children:null===U||void 0===U||null===(W=U.AdminActions[0])||void 0===W?void 0:W.comment})]}):ee&&(0,S.jsx)(i.Z.Item,{name:"comment",style:{minWidth:"60%",margin:0},children:(0,S.jsx)(v.t7,{size:"w100",label:(0,S.jsx)("b",{children:"Comment"}),type:"textArea",autoSize:{minRows:2},placeHolder:"Enter comment"})}),null!==U&&void 0!==U&&U.AdminActions.find((function(e){return"hr"===e.Department.slug}))?null:ee&&(0,S.jsxs)("div",{className:m.buttonWrap,children:[(0,S.jsx)(v.op,{size:"normal",fontSize:"sm",onClick:T,type:"plain",children:"Cancel"}),(0,S.jsx)(v.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:H,children:"Save"})]})]})]})]})})})})}},32845:function(e,t,n){"use strict";n.d(t,{Q:function(){return f}});var s=n(8570),r=n(28080),i=n(37388),a=n(10177),o=n(15491),l=n(37936),d=n(15799),c=n(98505),u=n(70816),v=n.n(u),m=n(46417),h=s.Z.Paragraph,f=function(e){var t,n,s=e.carReservation,u=e.onClick,f=e.isFullWidth;return(0,m.jsx)(r.Z,{hoverable:!0,onClick:u,bodyStyle:{height:"100%"},className:"".concat(d.Z.card," ").concat(f?d.Z.fullWidth:""),children:(0,m.jsxs)("div",{className:d.Z.cardBody,children:[(0,m.jsxs)("div",{className:d.Z.cardBodyTop,children:[(0,m.jsxs)("div",{className:d.Z.cardTitle,children:["CRR-",s.id]}),(0,m.jsxs)("div",{className:d.Z.topRight,children:[s._count.Attachments>0&&(0,m.jsxs)("div",{className:d.Z.file,children:[(0,m.jsx)(a.Z,{}),"\xa0",s._count.Attachments]}),(0,m.jsx)("div",{className:d.Z.status,style:{backgroundColor:null===(t=l.t0[null===s||void 0===s?void 0:s.status])||void 0===t?void 0:t.color},children:null===(n=l.t0[s.status])||void 0===n?void 0:n.status})]})]}),(0,m.jsxs)("div",{className:d.Z.cardBodyMiddle,children:[(0,m.jsx)(h,{ellipsis:{rows:2},className:d.Z.purpose,children:s.purpose}),(0,m.jsxs)("div",{className:"font-size-sm",children:["Requested by: ",s.RequestBy.firstName+" "+s.RequestBy.lastName]})]}),(0,m.jsxs)("div",{className:d.Z.cardBodyEnd,children:[(0,m.jsxs)("div",{className:d.Z.dateWrap,children:[(0,m.jsx)("div",{className:d.Z.fromDate,children:v()(null===s||void 0===s?void 0:s.fromDate).format("ddd")+", "+(0,c.Ny)((null===s||void 0===s?void 0:s.fromDate)||"","dd M,yy")}),(0,m.jsxs)("div",{className:d.Z.fromDate,children:["(From ",v()(null===s||void 0===s?void 0:s.fromDate).format("LT")]}),(0,m.jsxs)("div",{className:d.Z.fromDate,children:["to ",v()(null===s||void 0===s?void 0:s.toDate).format("LT"),")"]})]}),(0,m.jsxs)(i.Z,{title:"Requested date",className:d.Z.date,children:[(0,m.jsx)(o.Z,{}),"\xa0\xa0",(0,c.Ny)(s.addedDate,"dd M,yy")]})]})]})})}},85555:function(e,t,n){"use strict";n.d(t,{k:function(){return l}});var s=n(1413),r=n(43144),i=n(15671),a=n(3135),o=n(49075),l=(0,r.Z)((function e(){var t=this;(0,i.Z)(this,e),this.endPoint="car-reservation-request",this.getAllRecords=function(e){return o.Z.get(o._+t.endPoint,{params:(0,s.Z)({sortByField:"order",sortOrder:"asc",perPage:4},e)})},this.getOwnRecords=function(e){return o.Z.get(o._+t.endPoint+"/own",{params:(0,s.Z)({},e)})},this.getRecordById=function(e){return o.Z.get(o._+t.endPoint+"/findOne/"+e)},this.deleteRecord=function(e){return o.Z.delete(o._+t.endPoint+"/remove/"+e)},this.createRecord=function(e){return o.Z.post(o._+t.endPoint,e,{headers:a.C})},this.withdrawCarReservation=function(e){return o.Z.patch(o._+t.endPoint+"/withdraw/".concat(e))},this.employeeActionCarReservation=function(e){return o.Z.patch(o._+t.endPoint+"/submitRequest/".concat(e))},this.hrActionCarReservation=function(e,n){return o.Z.patch(o._+t.endPoint+"/hrAction/".concat(n),e)},this.checkAvailability=function(e){return o.Z.patch(o._+t.endPoint+"/checkAvailability",e)}}))},64217:function(e,t,n){"use strict";n.d(t,{S:function(){return a}});var s=n(43144),r=n(15671),i=n(49075),a=(0,s.Z)((function e(){var t=this;(0,r.Z)(this,e),this.endPoint="company-asset",this.getAllRecords=function(e){return i.Z.get(t.endPoint,{params:e})},this.getCars=function(e){return i.Z.get(t.endPoint+"/findCompanyCars",{params:e})},this.getRecordById=function(e){return i.Z.get("".concat(t.endPoint,"/").concat(e))},this.deleteRecord=function(e){return i.Z.delete("".concat(t.endPoint,"/").concat(e))},this.createRecord=function(e){return i.Z.post(t.endPoint,e)},this.updateRecord=function(e,n){return i.Z.patch("".concat(t.endPoint,"/").concat(n),e)},this.allocateResources=function(e){return i.Z.post("".concat(t.endPoint,"/allocate"),e)},this.revokeResources=function(e){return i.Z.delete("".concat(t.endPoint,"/revoke/").concat(e))}}))},10177:function(e,t,n){"use strict";var s=n(87462),r=n(47313),i=n(63961),a=n(16141),o=function(e,t){return r.createElement(a.Z,(0,s.Z)({},e,{ref:t,icon:i.Z}))};t.Z=r.forwardRef(o)},15491:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var s=n(87462),r=n(47313),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 00-2.3 5.6zm63.5 23.6L779.7 199l45.2 45.1-360.5 359.7-45.7 1.1.7-46.4z"}}]},name:"form",theme:"outlined"},a=n(16141),o=function(e,t){return r.createElement(a.Z,(0,s.Z)({},e,{ref:t,icon:i}))};var l=r.forwardRef(o)},15799:function(e,t){"use strict";t.Z={container:"styles_container__bHeeS",card:"styles_card__jeJvX",cardBody:"styles_cardBody__KpLaW",cardBodyTop:"styles_cardBodyTop__vxxAn",topRight:"styles_topRight__TEZ1N",file:"styles_file__5iGSt",cardTitle:"styles_cardTitle__MNAfV",status:"styles_status__jvgDx",cardBodyMiddle:"styles_cardBodyMiddle__ADFR-",purpose:"styles_purpose__N832s",cardBodyEnd:"styles_cardBodyEnd__kRJOE",dateWrap:"styles_dateWrap__s00RO",fromDate:"styles_fromDate__4t+c3",bold:"styles_bold__mX5LK",date:"styles_date__UTESl",fullWidth:"styles_fullWidth__INEK7"}},93414:function(){},70172:function(){},2001:function(){},33779:function(){},66558:function(){},82258:function(){}}]);