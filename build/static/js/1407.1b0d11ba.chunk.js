"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[1407],{61407:function(e,t,n){n.r(t),n.d(t,{default:function(){return Z}});var r=n(4942),a=n(1413),i=n(29439),d=n(47313),o=n(82626),s=n(49355),l=n(51579),u=n(41586),c=n(98505),p=n(32147),v=n(46417);function m(e){var t=e.tableData,n=e.tableLoading,r=e.emptyText,a=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,t,n){return n+1},width:"60px"},{title:"Rated By",dataIndex:"ratedBy",key:"ratedBy",render:function(e,t){return(0,v.jsx)("div",{className:"d-flex",children:(0,v.jsxs)("div",{className:"my-auto",children:[(0,v.jsx)(o.ZT,{color:"dark-main",size:"sm",children:"".concat(t.name)}),(0,v.jsxs)("div",{className:"d-flex mt-1",children:[(0,v.jsx)(p.$$,{className:"mr-2"}),(0,v.jsx)(o.ZT,{color:"dark-sub",size:"sm",children:"".concat((0,c.Ny)(t.addedDate,"dd MM yy"))})]})]})})},width:"13%"},{title:"Rated To",dataIndex:"user",key:"user",render:function(e){return(0,v.jsx)("div",{className:"d-flex",children:(0,v.jsxs)("div",{className:"my-auto",children:[(0,v.jsx)(o.ZT,{color:"dark-main",size:"sm",children:"Agent: ".concat(e.firstName," ").concat(e.lastName)}),(0,v.jsx)(o.ZT,{color:"dark-sub",size:"sm",children:"Org: ".concat(e.Organization.name)}),(0,v.jsx)(o.ZT,{color:"dark-sub",size:"sm",children:"UserID: ".concat(e.id)})]})})},width:"15%"},{title:"Message",dataIndex:"message",key:"message",render:function(e){return(0,v.jsx)(o.ZT,{color:"dark-main",size:"sm",children:e})},width:"15%"},{title:"Rating",dataIndex:"rating",key:"rating",render:function(e){return(0,v.jsx)(l.Z,{defaultValue:e,allowHalf:!0,disabled:!0,style:{fontSize:"16px"}})}},{title:"Property Link",dataIndex:"propertyLink",key:"propertyLink",className:"text-center",render:function(e){return(0,v.jsx)(v.Fragment,{children:(0,v.jsxs)("a",{href:e,target:"_blank",rel:"noreferrer",title:"View Property On Main Website (Users Website)",children:["View",(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",height:"16px",width:"17px",className:"ml-1",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"})})]})})}},{title:"Reference Number",dataIndex:"referenceNumber",key:"referenceNumber",className:"text-center",render:function(e){return(0,v.jsx)(o.ZT,{color:"dark-main",size:"sm",children:e})}}];return(0,v.jsx)("div",{children:(0,v.jsx)(u.Z,{sticky:!0,dataSource:t,columns:a,pagination:!1,scroll:{x:991},loading:n,rowKey:function(e){return"user-rating-".concat(e.id)},locale:{emptyText:r}})})}var g=n(22702),y=n(3113),f=n(54060),h=n(3798),x=n(55291),k=n(98215),b=n(85554),I=n(18515),j=[{text:"Home",isLink:!0,path:"/"},{isLink:!1,text:"User Ratings"}],Z=function(){var e,t,n,l,u=(0,h.aY)(k._),p=(0,b.v9)((function(e){return e.usersReducer})).userPermissions.readUserRating,Z=(0,d.useState)({loading:!1,data:[]}),N=(0,i.Z)(Z,2),R=N[0],L=N[1],D=(0,d.useState)({status:"",dateRange:[""],propertyId:0,agentId:0,propertyLink:""}),P=(0,i.Z)(D,2),w=P[0],C=P[1],T=(0,d.useState)(!1),U=(0,i.Z)(T,2),S=U[0],A=U[1],z=(0,d.useMemo)((function(){return new g.O}),[]),E=function(e){var t=null===e||void 0===e?void 0:e.target,n=t.name,i=t.value;if(("agentId"===n||"propertyId"===n)&&!(0,h.hj)(i)){var d="";switch(n){case"agentId":d="Agent ID";break;case"propertyId":d="Property ID"}return void x.ZP.error("".concat(d," should be a number"))}C((0,a.Z)((0,a.Z)({},w),{},(0,r.Z)({},n,i)))},M=(0,d.useCallback)((function(e,t){e&&(A(!0),C((0,a.Z)((0,a.Z)({},w),{},(0,r.Z)({},e,t))))}),[w]),O=(0,d.useCallback)((function(){var e,t,n=(null===(e=w.dateRange)||void 0===e?void 0:e[0])||"",r=(null===(t=w.dateRange)||void 0===t?void 0:t[1])||"",i=n?(0,c.Ny)(n,"yy-mm-dd"):void 0,d=r?(0,c.Ny)(r,"yy-mm-dd"):void 0,o={status:w.status?w.status:void 0,propertyId:Number(w.propertyId)>0?Number(w.propertyId):void 0,agentId:Number(w.agentId)>0?Number(w.agentId):void 0,propertyLink:w.propertyLink?w.propertyLink:void 0,fromDate:i,toDate:d};z.getAllRecords(o).then((function(e){var t,n;L((0,a.Z)((0,a.Z)({},R),{},{loading:!1,data:null===(t=e.data)||void 0===t?void 0:t.data,meta:null===(n=e.data)||void 0===n?void 0:n.meta}))}))}),[w,z]),W=(0,d.useCallback)((function(e,t){var n,r;L((0,a.Z)((0,a.Z)({},R),{},{loading:!0}));var i=(null===(n=w.dateRange)||void 0===n?void 0:n[0])||"",d=(null===(r=w.dateRange)||void 0===r?void 0:r[1])||"",o=i?(0,c.Ny)(i,"yy-mm-dd"):void 0,s=d?(0,c.Ny)(d,"yy-mm-dd"):void 0,l={page:e,perPage:t,status:w.status?w.status:void 0,propertyId:Number(w.propertyId)>0?Number(w.propertyId):void 0,agentId:Number(w.agentId)>0?Number(w.agentId):void 0,propertyLink:w.propertyLink?w.propertyLink:void 0,fromDate:o,toDate:s};z.getAllRecords(l).then((function(e){L((0,a.Z)((0,a.Z)({},e.data),{},{loading:!1}))})).catch((function(e){L((0,a.Z)((0,a.Z)({},R),{},{loading:!1}))}))}),[w,z]);(0,d.useEffect)((function(){S&&O();var e=setTimeout((function(){A(!1)}),2e3);return function(){return clearTimeout(e)}}),[S,w,O]);var B=(0,d.useCallback)((function(e){z.getAllRecords(e).then((function(e){L(e.data)})).catch((function(e){}))}),[z]);(0,d.useEffect)((function(){L((0,a.Z)((0,a.Z)({},R),{},{loading:!0})),B()}),[]);var X=(0,d.useCallback)((function(){var e,t,n,r,a=(null===(e=w.dateRange)||void 0===e?void 0:e[0])||"",i=(null===(t=w.dateRange)||void 0===t?void 0:t[1])||"",d=a?(0,c.Ny)(a,"yy-mm-dd"):void 0,o=i?(0,c.Ny)(i,"yy-mm-dd"):void 0;B({perPage:(null===R||void 0===R||null===(n=R.meta)||void 0===n?void 0:n.perPage)||10,page:(null===R||void 0===R||null===(r=R.meta)||void 0===r?void 0:r.page)||1,status:w.status?w.status:void 0,propertyId:Number(w.propertyId)>0?Number(w.propertyId):void 0,agentId:Number(w.agentId)>0?Number(w.agentId):void 0,propertyLink:w.propertyLink?w.propertyLink:void 0,fromDate:d,toDate:o})}),[R,w]);return(0,v.jsxs)(f.Z,{permissionSlug:u,children:[(0,v.jsx)(o.mr,{heading:"User Ratings",breadCrumbData:j,filters:p?(0,v.jsxs)("div",{className:y.Z.filterWrapper,children:[(0,v.jsx)("div",{children:(0,v.jsx)(o.Xy,{type:"radio",label:"Status",name:"status",options:[],value:String(null===w||void 0===w?void 0:w.status),onChange:E,onReset:function(){return M("status","")},onUpdate:O})}),(0,v.jsx)("div",{children:(0,v.jsx)(o.Xy,{type:"input",label:"Agent ID",name:"agentId",value:(null===w||void 0===w?void 0:w.agentId)>0?String(null===w||void 0===w?void 0:w.agentId):"",onChange:E,onReset:function(){return M("agentId",0)},onUpdate:O})}),(0,v.jsx)("div",{children:(0,v.jsx)(o.Xy,{type:"input",label:"Property Link",name:"propertyLink",value:String(null===w||void 0===w?void 0:w.propertyLink),onChange:E,onReset:function(){return M("propertyLink","")},onUpdate:O})}),(0,v.jsx)("div",{children:(0,v.jsx)(o.Xy,{type:"input",label:"Property ID",name:"propertyId",value:Number(null===w||void 0===w?void 0:w.propertyId)>0?String(null===w||void 0===w?void 0:w.propertyId):"",onChange:E,onReset:function(){return M("propertyId",0)},onUpdate:O})}),(0,v.jsx)("div",{children:(0,v.jsx)(o.Xy,{type:"datepicker",label:"Date",name:"dateRange",onChange:function(e){C((0,a.Z)((0,a.Z)({},w),{},{dateRange:e}))},onReset:function(){return M("dateRange",[])},onUpdate:O})})]}):null}),R.loading?(0,v.jsx)(s.Z,{items:5,fullWidth:!0}):(0,v.jsxs)(v.Fragment,{children:[!0===p&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:y.Z.antdTableWrapper,children:(0,v.jsx)(m,{tableData:null===R||void 0===R?void 0:R.data,tableLoading:null===R||void 0===R?void 0:R.loading,reloadTableData:X,onEditIconClick:function(){}})}),(0,v.jsx)(o.tl,{total:null===R||void 0===R||null===(e=R.meta)||void 0===e?void 0:e.total,current:null===R||void 0===R||null===(t=R.meta)||void 0===t?void 0:t.page,defaultPageSize:null!==R&&void 0!==R&&null!==(n=R.meta)&&void 0!==n&&n.perPage?null===R||void 0===R||null===(l=R.meta)||void 0===l?void 0:l.perPage:10,pageSizeOptions:[10,20,50,100],onChange:W})]}),!1===p&&(0,v.jsx)(I.a$,{mainMessage:"You don't have permission to view this data"})]})]})}},22702:function(e,t,n){n.d(t,{O:function(){return d}});var r=n(43144),a=n(15671),i=n(49075),d=(0,r.Z)((function e(){var t=this;(0,a.Z)(this,e),this.endPoint="user-rating",this.getAllRecords=function(e){return i.Z.get(t.endPoint,{params:e})},this.getRecordById=function(e){return i.Z.get("".concat(t.endPoint,"/").concat(e))},this.createRecord=function(e){return i.Z.post(t.endPoint+"/",e)},this.updateRecord=function(e,n){return i.Z.patch("".concat(t.endPoint,"/").concat(n),e)},this.deleteRecord=function(e){return i.Z.delete("".concat(t.endPoint,"/").concat(e))}}))},98215:function(e,t,n){n.d(t,{_:function(){return r}});var r=function(e){return e.CREATE="createUserRating",e.UPDATE="updateUserRating",e.DELETE="deleteUserRating",e.READ="readUserRating",e}({})}}]);