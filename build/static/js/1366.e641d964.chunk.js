"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[1366],{31366:function(e,n,t){t.d(n,{Z:function(){return F}});var o=t(1413),i=t(29439),a=t(47313),r=t(8570),s=t(55291),d=t(41586),l=t(3109),c=t(5900),u=t(98676),v=t(3113),m=t(22367),p=t(46417),f=function(e){var n=e.record,t=e.onEditIconClick,r=e.reloadTableData,d=e.permissions.deleteTransaction,l=(0,a.useMemo)((function(){return new m.e}),[]),f=(0,a.useState)({confirmLoading:!1,openPopConfirm:!1}),h=(0,i.Z)(f,2),g=h[0],x=h[1];return(0,p.jsxs)("div",{className:v.Z.actions,children:[(0,p.jsx)("span",{onClick:function(){return t(n)},children:(0,p.jsx)("img",{src:"/images/editicon.svg",alt:"Edit Icon"})}),(0,p.jsx)(c.Z,{open:g.openPopConfirm,placement:"rightBottom",title:"Are you sure?",onConfirm:function(){if(x((function(e){return(0,o.Z)((0,o.Z)({},e),{},{confirmLoading:!0})})),!1===d)return s.ZP.error("You don't have permission to delete this record, please contact your admin."),void x((function(e){return(0,o.Z)((0,o.Z)({},e),{},{confirmLoading:!1,openPopConfirm:!1})}));l.deleteRecord(n.id).then((function(){x((function(e){return(0,o.Z)((0,o.Z)({},e),{},{openPopConfirm:!1,confirmLoading:!1})})),r()})).catch((function(e){var n,t,i=null===e||void 0===e||null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.message;s.ZP.error(i||"Something went wrong, please try again later."),x((function(e){return(0,o.Z)((0,o.Z)({},e),{},{confirmLoading:!1,openPopConfirm:!1})}))}))},onCancel:function(){return x((0,o.Z)((0,o.Z)({},g),{},{openPopConfirm:!1}))},okButtonProps:{loading:g.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:function(e){e||x((0,o.Z)((0,o.Z)({},g),{},{openPopConfirm:!1}))},children:(0,p.jsx)(u.Z,{className:v.Z.bg__red,onClick:function(){return x((function(e){return(0,o.Z)((0,o.Z)({},e),{},{openPopConfirm:!0})}))}})})]})},h=t(99700),g=t(98505),x=t(84825),y=t(28080),Z=t(47312),j=t(46155),k=t(78267),b=t(45705),w=t(8773),N=t(39548),C=t(42623),P=t(82626),_=t(48897),T={opacity_6:"styles_opacity_6__8byrT",dropdown:"styles_dropdown__2eDzZ",overlay:"styles_overlay__HvoTi",overlay_item:"styles_overlay_item__vbtdW",overlay_popConfirm:"styles_overlay_popConfirm__Kz42o",disabledButton:"styles_disabledButton__b+KIc"},I=function(e){var n=e.AssignedTo,t=e.users,o=e.loading,r=e.permissions.updateTransaction,d=e.getUsers,l=e.transactionId,c=e.reloadTableData,u=e.avatarSize,v=s.ZP.useMessage(),f=(0,i.Z)(v,2),h=f[0],g=f[1],x=(0,a.useMemo)((function(){return new m.e}),[]),I=(0,a.useState)(""),z=(0,i.Z)(I,2),R=z[0],A=z[1],S=(0,C.N)(R,500),D=function(e){h.open({key:e.key,type:e.type,content:e.content,duration:"loading"===e.type?0:2})},M=(0,a.useState)(!1),B=(0,i.Z)(M,2),L=B[0],F=B[1];(0,a.useEffect)((function(){S&&d({name:S})}),[S]);var O=(0,p.jsxs)(y.Z,{className:"".concat(T.overlay," pa-2"),children:[(0,p.jsx)(P.t7,{placeHolder:"Search User...",value:R,size:"w100",onChange:function(e){var n=e.target.value;R!==n&&A(n)},icon:(0,p.jsx)("img",{src:"/images/searchIcon.svg",alt:"Search Icon"})}),o?(0,p.jsx)(Z.Z,{active:!0,className:"mt-1"}):(0,p.jsx)(p.Fragment,{children:(null===t||void 0===t?void 0:t.length)>0?(0,p.jsx)(p.Fragment,{children:null===t||void 0===t?void 0:t.map((function(e){return(0,p.jsxs)("div",{className:T.overlay_item,onClick:function(){if((null===n||void 0===n?void 0:n.id)!==(null===e||void 0===e?void 0:e.id)&&!0===r){var t=Number(null===e||void 0===e?void 0:e.id);(o=t)&&!0===r?(D({key:"update",type:"loading",content:"Updating..."}),x.assignTransaction({assignedToId:o},l).then((function(e){var n,t;null!==e&&void 0!==e&&null!==(n=e.data)&&void 0!==n&&n.data&&(D({key:"update",type:"success",content:null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message}),F(!L),c())})).catch((function(e){var n,t;D({key:"update",type:"error",content:(null===e||void 0===e||null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.message)||"Something went wrong"})}))):D({key:"update",type:"error",content:"You don't have permission to assign Transactions"})}var o},children:[(0,p.jsxs)("span",{className:(null===n||void 0===n?void 0:n.id)===(null===e||void 0===e?void 0:e.id)?T.disabledButton:"",children:[null===e||void 0===e?void 0:e.firstName," ",null===e||void 0===e?void 0:e.lastName," - ","(".concat(null===e||void 0===e?void 0:e.email,")")]}),(0,p.jsx)(j.Z,{className:"my-0"})]},"users-".concat(null===e||void 0===e?void 0:e.id))}))}):(0,p.jsx)("div",{className:T.overlay_item_noData,children:(0,p.jsx)(P.I$,{description:S?"No results found, please modify your search term":"Please search for a user to assign this Transaction to"})})})]});return(0,p.jsxs)(p.Fragment,{children:[g,(0,p.jsx)(k.Z,{dropdownRender:function(){return O},trigger:!0===r?["click"]:[],open:!0===r&&L,onOpenChange:function(e){return F(e)},className:T.dropdown,children:(0,p.jsx)(b.Z,{children:(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center",width:"100%",cursor:!0===r?"pointer":"default"},children:[(0,p.jsx)(w.C,{src:"".concat(_.lj).concat(null===n||void 0===n?void 0:n.profile),icon:(0,p.jsx)(N.Z,{}),size:u||30}),(0,p.jsx)(P.ZT,{color:"dark-sub",size:"sm",className:"ml-1",children:"".concat(null!==n&&void 0!==n&&n.firstName&&null!==n&&void 0!==n&&n.lastName?"".concat(null===n||void 0===n?void 0:n.firstName," ").concat(null===n||void 0===n?void 0:n.lastName):"Assign To")})]})})})]})},z=t(32344),R=t(70584),A=t(37936),S=function(e){var n=e.status,t=e.recordId,o=e.reloadTableData,r=e.permissions.updateTransaction,d=s.ZP.useMessage(),l=(0,i.Z)(d,2),c=l[0],u=l[1],v=(0,a.useMemo)((function(){return new m.e}),[]),f=function(e){c.open({key:e.key,type:e.type,content:e.content,duration:"loading"===e.type?0:2})},h=(0,a.useState)(!1),g=(0,i.Z)(h,2),x=g[0],Z=g[1],j=(0,p.jsx)(y.Z,{className:"".concat(T.overlay," pa-2"),children:R.Ug.map((function(e,i){var a=Number(e.value),s=n===a;return(0,p.jsx)("div",{className:T.overlay_item,onClick:function(){s||function(e){if(t&&!0===r){f({key:"update",type:"loading",content:"Updating..."});var n={status:e};v.updateRecord(n,t).then((function(e){var n,t;null!==e&&void 0!==e&&null!==(n=e.data)&&void 0!==n&&n.data&&(f({key:"update",type:"success",content:null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message}),Z(!x),o())})).catch((function(e){var n,t;f({key:"update",type:"error",content:null===e||void 0===e||null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.message})}))}else f({key:"update",type:"error",content:"You don't have permission to change status"})}(a)},children:(0,p.jsx)("span",{className:s?T.disabledButton:"",style:{width:"100%"},children:e.label})},"transactions-status-".concat(i))}))});return(0,p.jsxs)(p.Fragment,{children:[u,(0,p.jsx)(k.Z,{dropdownRender:function(){return j},trigger:!0===r?["click"]:[],open:!0===r&&x,onOpenChange:function(e){return Z(e)},className:T.dropdown,children:(0,p.jsxs)(b.Z,{style:{padding:"0.2rem 0.5rem",borderRadius:"0.25rem",fontSize:"0.8rem"},children:[A.LN[n],!0===r&&(0,p.jsx)(z.Z,{})]})})]})},D=t(38859),M=t(29079),B=t(3798),L=r.Z.Paragraph,F=function(e){var n=e.tableData,t=e.tableLoading,r=e.onEditIconClick,c=e.reloadTableData,u=e.permissions,v=(0,a.useMemo)((function(){return new x.z}),[]),m=(0,a.useMemo)((function(){return new D.o}),[]),y=(0,M.$5)({method:m.getAllRecords,initialQuery:{slug:"finance"}}).data,Z=(0,a.useState)({data:[],loading:!1}),j=(0,i.Z)(Z,2),k=j[0],b=j[1],w=function(e){var n;b((function(e){return(0,o.Z)((0,o.Z)({},e),{},{loading:!0})}));var t=(0,o.Z)((0,o.Z)({},e),{},{departmentId:null===y||void 0===y||null===(n=y[0])||void 0===n?void 0:n.id});if(!t.departmentId)return s.ZP.error("Cannot find any user in the finance department, please try again later"),void b((function(e){return(0,o.Z)((0,o.Z)({},e),{},{loading:!1})}));v.getAllRecords(t).then((function(e){var n,t=null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.data;b({data:t,loading:!1})})).catch((function(e){var n,t;s.ZP.error((null===e||void 0===e||null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.message)||"Something went wrong"),b((function(e){return(0,o.Z)((0,o.Z)({},e),{},{loading:!1})}))}))},N=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,n,t){return t+1},width:"55px"},{title:"Overview",dataIndex:"title",key:"title",render:function(e,n){var t,o;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"d-flex justify-between",children:(0,p.jsx)(l.Z,{color:"dark-main",size:"sm",weight:"bold",children:e})}),(0,p.jsx)(l.Z,{color:"dark-main",size:"sm",className:"mb-1",children:(null===n||void 0===n||null===(t=n.Invoice)||void 0===t?void 0:t.invoiceNumber)||"No Invoice Attached"}),(0,p.jsxs)("div",{className:"d-flex justify-between",children:[(0,p.jsx)(l.Z,{color:"dark-main",size:"sm",weight:"bold",children:"Authority:"}),(0,p.jsx)(l.Z,{color:"dark-main",size:"sm",className:"ml-1",children:null===n||void 0===n||null===(o=n.Authority)||void 0===o?void 0:o.title})]}),(0,p.jsx)(l.Z,{color:"dark-main",size:"sm",children:n.remarks})]})},width:"300px"},{title:"Project",dataIndex:"Project",key:"Project",render:function(e,n){var t,o,i,a,r,s,d,c,u,v,m,f;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(l.Z,{color:"dark-main",children:null===(t=n.Client)||void 0===t?void 0:t.name}),(null===(o=n.Client)||void 0===o?void 0:o.email)&&(0,p.jsx)(L,{ellipsis:{rows:1,expandable:!1},copyable:{text:null===(i=n.Client)||void 0===i?void 0:i.email},className:"font-size-xs color-dark-sub mb-0",children:(0,p.jsx)("a",{href:"mailto:".concat(null===(a=n.Client)||void 0===a?void 0:a.email),style:{color:"var(--color-dark-sub)"},children:null===(r=n.Client)||void 0===r?void 0:r.email})}),(null===(s=n.Client)||void 0===s?void 0:s.phone)&&(0,p.jsx)(L,{ellipsis:{rows:1,expandable:!1},copyable:{text:"".concat(null===(d=n.Client)||void 0===d?void 0:d.phoneCode).concat(null===(c=n.Client)||void 0===c?void 0:c.phone)},className:"font-size-xs color-dark-sub",children:(0,p.jsx)("a",{href:"tel:".concat(null===(u=n.Client)||void 0===u?void 0:u.phoneCode," ").concat(null===(v=n.Client)||void 0===v?void 0:v.phone),style:{color:"var(--color-dark-sub)"},children:"".concat(null===(m=n.Client)||void 0===m?void 0:m.phoneCode).concat(null===(f=n.Client)||void 0===f?void 0:f.phone)})}),(null===e||void 0===e?void 0:e.slug)&&(0,p.jsxs)("a",{href:"/projects/".concat(null===e||void 0===e?void 0:e.slug,"?id=").concat(null===e||void 0===e?void 0:e.id),target:"_blank",rel:"noreferrer",title:"View Project",className:"d-flex align-center mt-2",children:[(0,p.jsx)(l.Z,{color:"dark-main",size:"sm",children:"".concat((null===e||void 0===e?void 0:e.referenceNumber)||""," ").concat(null!==e&&void 0!==e&&e.referenceNumber?"|":""," ").concat((null===e||void 0===e?void 0:e.title)||"")}),(0,p.jsx)(h.O,{})]})]})},width:"400px"},{title:"Transaction",dataIndex:"amount",key:"amount",render:function(e,n){return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"d-flex justify-between",children:[(0,p.jsx)(l.Z,{color:"dark-main",size:"sm",weight:"bold",children:"Amount:"}),(0,p.jsx)(l.Z,{color:"dark-main",size:"sm",className:"ml-1",children:(0,B.xG)(e)})]}),(0,p.jsxs)("div",{className:"d-flex justify-between",children:[(0,p.jsx)(l.Z,{color:"dark-main",size:"sm",weight:"bold",children:"Reference:"}),(0,p.jsx)(l.Z,{color:"dark-main",size:"sm",className:"ml-1",children:n.transactionReference})]}),(0,p.jsxs)("div",{className:"d-flex justify-between",children:[(0,p.jsx)(l.Z,{color:"dark-main",size:"sm",weight:"bold",children:"Date:"}),(0,p.jsx)(l.Z,{color:"dark-main",size:"sm",className:"ml-1",children:"".concat((0,g.Ny)(n.transactionDate,"MM dd,yy"))})]}),(null===n||void 0===n?void 0:n.receipt)&&(0,p.jsxs)("a",{href:"".concat(_.PO).concat(null===n||void 0===n?void 0:n.receipt),target:"_blank",rel:"noreferrer",title:" View Receipt",className:"d-flex align-center mt-2",children:[(0,p.jsx)(l.Z,{color:"dark-main",size:"sm",children:"View Receipt"}),(0,p.jsx)(h.O,{})]})]})},width:"200px"},{title:"Status",dataIndex:"status",key:"status",render:function(e,n){return(0,p.jsx)(S,{recordId:n.id,status:e,permissions:u,reloadTableData:c})},width:"150px"},{title:"Assigned To",dataIndex:"AssignedTo",key:"AssignedTo",render:function(e,n){return(0,p.jsx)(I,{AssignedTo:e,transactionId:n.id,permissions:u,loading:k.loading,users:k.data,getUsers:w,reloadTableData:c})},width:"150px"},{title:"Actions",dataIndex:"actions",key:"actions",render:function(e,n){return(0,p.jsx)(f,{record:n,onEditIconClick:r,reloadTableData:c,permissions:u})},width:"120px"}];return(0,p.jsx)(d.Z,{sticky:!0,dataSource:n,columns:N,pagination:!1,scroll:{x:991},loading:t,rowKey:function(e){return"transaction-".concat(e.id)}})}},38859:function(e,n,t){t.d(n,{o:function(){return r}});var o=t(43144),i=t(15671),a=t(49075),r=(0,o.Z)((function e(){var n=this;(0,i.Z)(this,e),this.endPoint="department",this.getAllRecords=function(e){return a.Z.get(n.endPoint,{params:e})},this.getAllPublishedRecords=function(e){return a.Z.get(n.endPoint+"/find-published",{params:e})},this.getRecordById=function(e){return a.Z.get(n.endPoint+"/"+e)},this.deleteRecord=function(e){return a.Z.delete(n.endPoint+"/"+e)},this.createRecord=function(e){return a.Z.post(n.endPoint,e)},this.updateRecord=function(e,t){return a.Z.patch(n.endPoint+"/"+t,e)}}))},22367:function(e,n,t){t.d(n,{e:function(){return s}});var o=t(43144),i=t(15671),a=t(49075),r=t(3135),s=(0,o.Z)((function e(){var n=this;(0,i.Z)(this,e),this.endPoint="transactions",this.getAllRecords=function(e){return a.Z.get(n.endPoint,{params:e})},this.getRecordById=function(e){return a.Z.get("".concat(n.endPoint,"/").concat(e))},this.deleteRecord=function(e){return a.Z.delete("".concat(n.endPoint,"/").concat(e))},this.createRecord=function(e){return a.Z.post(n.endPoint,e,{headers:r.C})},this.updateRecord=function(e,t){return a.Z.patch("".concat(n.endPoint,"/").concat(t),e,{headers:r.C})},this.assignTransaction=function(e,t){return a.Z.patch("".concat(n.endPoint,"/assignTransaction/").concat(t),e)}}))}}]);