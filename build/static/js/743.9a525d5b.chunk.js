"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[743],{87927:function(e,n,t){t.d(n,{e:function(){return w}});var s=t(29439),i=t(8570),r=t(25019),l=t(55291),o=t(97258),a=t(21680),d=t(39180),c=t(13666),u=t(46155),m=t(66204),v=t(82626),h={drawerContainer:"styles_drawerContainer__hNuXb",attachmentsWrap:"styles_attachmentsWrap__Ecn7u",attachment:"styles_attachment__fWeH3",amountWrap:"styles_amountWrap__R7Rq5",priceText:"styles_priceText__BxIA5",resourceWrap:"styles_resourceWrap__mOouX",hrWrap:"styles_hrWrap__HgmFZ",title:"styles_title__BycTb",hrInputs:"styles_hrInputs__b+4Ol",footerWrap:"styles_footerWrap__+chGV",buttonWrap:"styles_buttonWrap__qTKoB",financeWrap:"styles_financeWrap__tUX30",actionsWrap:"styles_actionsWrap__HYpE1"},p=t(37936),f=t(47313),x=t(29079),j=t(98505),y=t(8875),_=t(51534),A=t(82334),g=t(48694),Z=t(49075),N=t(40096),b=t(48897),W=t(46417),z=i.Z.Text,w=function(e){var n,t,i,w,D,C,B,R,P,T,S,q,k,I=e.openDrawer,E=e.onClose,H=e.record,F=e.permissions,M=e.reloadTableData;_.GlobalWorkerOptions.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(_.version,"/pdf.worker.js");var O=N.Z.getLocalAccessToken(),Y=F.updateCashAdvance,G=F.cashAdvanceHRApproval,U=F.cashAdvanceFinanceApproval,K=r.Z.useForm(),L=(0,s.Z)(K,1)[0],V=(0,f.useState)(!1),X=(0,s.Z)(V,2),J=X[0],$=X[1],Q=new y.a,ee=(0,x.$5)({method:function(){return Q.getRecordById(H)}}),ne=ee.data,te=ee.onRefresh;(0,f.useEffect)((function(){L.setFieldValue("approvedAmount",null===ne||void 0===ne?void 0:ne.requestAmount)}),[ne]);return(0,W.jsx)("section",{className:h.container,children:(0,W.jsx)(o.Z,{title:(0,W.jsxs)("div",{className:"d-flex align-center justify-space-between",children:[(0,W.jsxs)("div",{children:["CSH-",null===ne||void 0===ne?void 0:ne.id," - (",null!==ne&&void 0!==ne&&ne.status?null===(n=p.zj[null===ne||void 0===ne?void 0:ne.status])||void 0===n?void 0:n.status:"",")"]}),(null===ne||void 0===ne?void 0:ne.status)!==p.Yg.rejected&&(null===ne||void 0===ne?void 0:ne.status)!==p.Yg.withdrawn&&(null===ne||void 0===ne?void 0:ne.status)!==p.Yg.paid_and_closed?(0,W.jsx)("div",{children:(0,W.jsx)(v.op,{type:"primary",size:"normal",fontSize:"sm",onClick:function(){Q.withdrawCashAdvance(H).then((function(){M(),te(),L.resetFields(),E()})).catch((function(e){l.ZP.error(null===e||void 0===e?void 0:e.message)}))},children:"Withdraw Request"})}):null]}),placement:"right",size:"large",width:window.innerWidth>768?"60%":"100%",onClose:E,open:I,children:(0,W.jsx)(r.Z,{className:h.form,onFinish:function(e){$(!0),Y||G||U?e.approvedAmount?Q.hrActionCashAdvance({comment:e.comment,status:e.status,approvedAmount:Number(e.approvedAmount)},H).then((function(e){M(),$(!1),te(),L.resetFields()})).catch((function(e){l.ZP.error(null===e||void 0===e?void 0:e.message),$(!1)})):Q.financeActionCashAdvance({comment:e.comment,status:e.status,numberOfInstallments:null!==e&&void 0!==e&&e.numberOfInstallments?null===e||void 0===e?void 0:e.numberOfInstallments:3},H).then((function(e){M(),$(!1),te(),L.resetFields()})).catch((function(e){l.ZP.error(null===e||void 0===e?void 0:e.message),$(!1)})):(l.ZP.error("You don't have permission to create this record"),$(!1))},form:L,children:(0,W.jsxs)("div",{className:h.drawerContainer,children:[(0,W.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[(0,W.jsxs)("div",{children:[(0,W.jsx)("b",{children:"Name:"}),"\xa0","".concat((null===ne||void 0===ne||null===(t=ne.RequestBy)||void 0===t?void 0:t.firstName)||""," ").concat((null===ne||void 0===ne||null===(i=ne.RequestBy)||void 0===i?void 0:i.lastName)||"")]}),(0,W.jsxs)("div",{children:[(0,W.jsx)("b",{children:"Date:"}),"\xa0",(0,j.Ny)((null===ne||void 0===ne?void 0:ne.addedDate)||"","MM dd,yy")]})]}),(0,W.jsxs)("div",{children:[(0,W.jsx)("b",{children:"Purpose:"}),(0,W.jsx)("div",{style:{fontSize:"var(--font-size-normal)"},children:null===ne||void 0===ne?void 0:ne.purpose})]}),null!==ne&&void 0!==ne&&null!==(w=ne.Attachments)&&void 0!==w&&w.length?(0,W.jsx)("div",{className:h.attachmentsWrap,children:null===ne||void 0===ne?void 0:ne.Attachments.map((function(e,n){var t;return(0,W.jsx)("div",{className:h.attachment,children:(0,W.jsxs)("div",{className:h.resourceWrap,children:[null!==e&&void 0!==e&&null!==(t=e.mimeType)&&void 0!==t&&t.includes("pdf")?(0,W.jsx)("a",{href:"".concat(b.PO).concat(null===e||void 0===e?void 0:e.file),target:"_blank",rel:"noreferrer",children:(0,W.jsx)(A.Z,{file:"".concat(Z._,"resources/all/").concat(e.file,"?authKey=").concat(O),children:(0,W.jsx)(g.Z,{renderTextLayer:!1,pageNumber:1})})}):(0,W.jsx)(a.Z,{style:{objectFit:"cover",borderRadius:"0.25rem 0.25rem 0 0"},width:150,height:100,src:"".concat(Z._,"resources/all/").concat(e.file,"?authKey=").concat(O)}),(0,W.jsx)("div",{style:{padding:"0.25rem 0.5rem",borderRadius:"0.25rem",display:"flex",flexDirection:"column"},children:(0,W.jsx)(z,{style:{width:125,fontSize:"var(--font-size-xs)"},strong:!0,ellipsis:!0,children:null===e||void 0===e?void 0:e.title})})]})},n)}))}):null,(null===ne||void 0===ne?void 0:ne.status)!==p.Yg.withdrawn&&(0,W.jsxs)("div",{className:h.hrWrap,children:[(0,W.jsx)("div",{className:h.title,children:"HR Department Actions"}),(0,W.jsxs)("div",{className:h.hrInputs,children:[null!==ne&&void 0!==ne&&ne.AdminActions.find((function(e){return"hr"===e.Department.slug}))?(0,W.jsx)("div",{children:(0,W.jsxs)("div",{className:h.actionsWrap,children:[(0,W.jsx)("b",{style:{fontSize:"var(--font-size-sm)"},children:"Amount"}),(0,W.jsxs)("div",{style:{textDecoration:(null===ne||void 0===ne?void 0:ne.approvedAmount)!==(null===ne||void 0===ne?void 0:ne.requestAmount)?"line-through":"unset"},children:["AED ",null===ne||void 0===ne?void 0:ne.requestAmount]}),(null===ne||void 0===ne?void 0:ne.approvedAmount)!==ne.requestAmount?(0,W.jsxs)("div",{className:h.approvedAmount,children:["AED ",null===ne||void 0===ne?void 0:ne.approvedAmount]}):null]})}):G?(0,W.jsxs)("div",{children:[(0,W.jsx)("b",{style:{fontSize:"var(--font-size-sm)"},children:"Amount"}),(0,W.jsx)(r.Z.Item,{name:"approvedAmount",rules:[{required:!0,message:"Please enter approved amount."}],children:(0,W.jsx)(v.t7,{prefix:"AED",size:"w100",asterisk:!0,placeHolder:"Enter approved amount"})})]}):"No action from HR yet",(0,W.jsxs)("div",{className:h.actionsWrap,children:[(0,W.jsx)("br",{}),null!==ne&&void 0!==ne&&ne.AdminActions.find((function(e){return"hr"===e.Department.slug}))?(0,W.jsx)("div",{style:{textTransform:"capitalize",lineHeight:"1rem"},children:null===(D=p.zj[null===ne||void 0===ne||null===(C=ne.AdminActions)||void 0===C||null===(B=C.find((function(e){return"hr"===e.Department.slug})))||void 0===B?void 0:B.status])||void 0===D?void 0:D.status}):G&&(0,W.jsx)(r.Z.Item,{name:"status",rules:[{required:!0,message:"Please select a status"}],children:(0,W.jsx)(d.ZP.Group,{options:p.Rj,optionType:"button",buttonStyle:"solid"})})]})]}),(0,W.jsxs)("div",{className:h.footerWrap,children:[null!==ne&&void 0!==ne&&ne.AdminActions.find((function(e){return"hr"===e.Department.slug}))?(0,W.jsxs)("div",{className:h.priceText,children:[(0,W.jsx)("b",{style:{fontSize:"var(--font-size-sm)"},children:"Comment"}),(0,W.jsx)("div",{children:null===ne||void 0===ne||null===(R=ne.AdminActions.find((function(e){return"hr"===e.Department.slug})))||void 0===R?void 0:R.comment})]}):G&&(0,W.jsx)(r.Z.Item,{name:"comment",style:{minWidth:"60%",margin:0},children:(0,W.jsx)(v.t7,{size:"w100",label:(0,W.jsx)("b",{children:"Comment"}),type:"textArea",placeHolder:"Enter comment"})}),null!==ne&&void 0!==ne&&ne.AdminActions.find((function(e){return"hr"===e.Department.slug}))?null:G&&(0,W.jsxs)("div",{className:h.buttonWrap,children:[(0,W.jsx)(v.op,{size:"normal",fontSize:"sm",onClick:E,type:"plain",children:"Cancel"}),(0,W.jsx)(v.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:J,children:"Save"})]})]})]}),(null===ne||void 0===ne?void 0:ne.status)!==p.Yg.withdrawn&&null!==ne&&void 0!==ne&&ne.AdminActions.find((function(e){return"hr"===e.Department.slug}))&&ne.status!==p.Yg.rejected?(0,W.jsxs)("div",{className:h.financeWrap,children:[(0,W.jsx)("div",{className:h.title,children:"Finance Department Actions"}),(0,W.jsxs)("div",{className:h.actionsWrap,children:[null!==ne&&void 0!==ne&&ne.AdminActions.find((function(e){return"finance"===e.Department.slug}))?(0,W.jsx)("div",{style:{textTransform:"capitalize",lineHeight:"1rem"},children:null===(P=p.zj[null===ne||void 0===ne||null===(T=ne.AdminActions)||void 0===T||null===(S=T.find((function(e){return"finance"===e.Department.slug})))||void 0===S?void 0:S.status])||void 0===P?void 0:P.status}):U?(0,W.jsx)(r.Z.Item,{name:"status",rules:[{required:!0,message:"Please select a status"}],children:(0,W.jsx)(d.ZP.Group,{options:p.AO,optionType:"button",buttonStyle:"solid"})}):"No action from Finance yet",null!==ne&&void 0!==ne&&ne.AdminActions.find((function(e){return"finance"===e.Department.slug}))?(0,W.jsxs)("div",{children:[(0,W.jsx)(u.Z,{}),(0,W.jsx)("b",{children:"Installments:"}),null===ne||void 0===ne||null===(q=ne.Installments)||void 0===q?void 0:q.map((function(e){var n;return(0,W.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,W.jsxs)("p",{style:{marginBottom:"0.25rem"},children:[null===(n=(0,j.Ny)(e.monthYear,"dd MM,yy"))||void 0===n?void 0:n.slice(2)," - ",ne.installmentAmount," AED"]}),(0,W.jsx)("p",{children:e.isPaid?(0,W.jsxs)(m.Z,{color:"green",children:["Paid on ",(0,j.Ny)(e.paidDate,"dd MM,yy")]}):(0,W.jsx)(m.Z,{children:"To be paid"})})]})}))]}):U&&(0,W.jsxs)("div",{children:[(0,W.jsx)("b",{style:{fontSize:"var(--font-size-sm)"},children:"Number of installments"}),(0,W.jsx)(r.Z.Item,{name:"numberOfInstallments",children:(0,W.jsx)(c.Z,{marks:p.EI,defaultValue:3,min:1,max:24})})]})]}),(0,W.jsxs)("div",{className:h.footerWrap,children:[null!==ne&&void 0!==ne&&ne.AdminActions.find((function(e){return"finance"===e.Department.slug}))?(0,W.jsxs)("div",{className:h.priceText,children:[(0,W.jsx)("b",{style:{fontSize:"var(--font-size-sm)"},children:"Comment"}),(0,W.jsx)("div",{children:null===ne||void 0===ne||null===(k=ne.AdminActions.find((function(e){return"finance"===e.Department.slug})))||void 0===k?void 0:k.comment})]}):U&&(0,W.jsx)(r.Z.Item,{name:"comment",style:{minWidth:"60%",margin:0},children:(0,W.jsx)(v.t7,{size:"w100",label:(0,W.jsx)("b",{children:"Comment"}),type:"textArea",placeHolder:"Enter comment"})}),null!==ne&&void 0!==ne&&ne.AdminActions.find((function(e){return"finance"===e.Department.slug}))?null:U&&(0,W.jsxs)("div",{className:h.buttonWrap,children:[(0,W.jsx)(v.op,{size:"normal",fontSize:"sm",onClick:E,type:"plain",children:"Cancel"}),(0,W.jsx)(v.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:J,children:"Save"})]})]})]}):null]})})})})}},51093:function(e,n,t){t.d(n,{R:function(){return u}});var s=t(8570),i=t(28080),r=t(10177),l=t(37936),o=t(96369),a=t(98505),d=t(46417),c=s.Z.Paragraph,u=function(e){var n,t,s=e.cashAdvance,u=e.onClick,m=e.isFullWidth;return(0,d.jsx)(i.Z,{hoverable:!0,onClick:u,className:"".concat(o.Z.card," ").concat(m?o.Z.fullWidth:""),children:(0,d.jsxs)("div",{className:o.Z.cardBody,children:[(0,d.jsxs)("div",{className:o.Z.cardBodyTop,children:[(0,d.jsxs)("div",{className:o.Z.cardTitle,children:["CSH-",s.id]}),(0,d.jsxs)("div",{className:o.Z.topRight,children:[s._count.Attachments>0&&(0,d.jsxs)("div",{className:o.Z.file,children:[(0,d.jsx)(r.Z,{}),"\xa0",s._count.Attachments]}),(0,d.jsx)("div",{className:o.Z.status,style:{backgroundColor:null===(n=l.zj[null===s||void 0===s?void 0:s.status])||void 0===n?void 0:n.color},children:null===(t=l.zj[s.status])||void 0===t?void 0:t.status.replaceAll("_"," ")})]})]}),(0,d.jsxs)("div",{className:o.Z.cardBodyMiddle,children:[(0,d.jsx)(c,{ellipsis:{rows:2},className:o.Z.purpose,children:s.purpose}),(0,d.jsxs)("div",{className:"font-size-sm",children:["Requested by: ",s.RequestBy.firstName+" "+s.RequestBy.lastName]})]}),(0,d.jsxs)("div",{className:o.Z.cardBodyEnd,children:[(0,d.jsxs)("div",{className:o.Z.amountWrap,children:[(0,d.jsxs)("div",{className:o.Z.requestAmount+" "+(s.approvedAmount&&s.approvedAmount!==s.requestAmount?o.Z.strike:void 0),children:["AED ",s.requestAmount]}),s.approvedAmount&&s.approvedAmount!==s.requestAmount?(0,d.jsxs)("div",{className:o.Z.approvedAmount,children:["AED ",s.approvedAmount]}):null]}),(0,d.jsx)("div",{className:o.Z.date,children:(0,a.Ny)(s.addedDate,"dd M,yy")})]})]})})}},8875:function(e,n,t){t.d(n,{a:function(){return a}});var s=t(1413),i=t(43144),r=t(15671),l=t(3135),o=t(49075),a=(0,i.Z)((function e(){var n=this;(0,r.Z)(this,e),this.endPoint="cash-advance",this.getAllRecords=function(e){return o.Z.get(o._+n.endPoint,{params:(0,s.Z)({sortByField:"order",sortOrder:"asc",perPage:4},e)})},this.getOwnRecords=function(e){return o.Z.get(o._+n.endPoint+"/own",{params:(0,s.Z)({},e)})},this.getRecordById=function(e){return o.Z.get(o._+n.endPoint+"/findOne/"+e)},this.deleteRecord=function(e){return o.Z.delete(o._+n.endPoint+"/remove/"+e)},this.createRecord=function(e){return o.Z.post(o._+n.endPoint,e,{headers:l.C})},this.withdrawCashAdvance=function(e){return o.Z.patch(o._+n.endPoint+"/withdraw/".concat(e))},this.hrActionCashAdvance=function(e,t){return o.Z.patch(o._+n.endPoint+"/hrAction/".concat(t),e)},this.financeActionCashAdvance=function(e,t){return o.Z.patch(o._+n.endPoint+"/financeAction/".concat(t),e)}}))},96369:function(e,n){n.Z={container:"styles_container__0r9BS",card:"styles_card__U9g9x",cardBody:"styles_cardBody__PL6J1",cardBodyTop:"styles_cardBodyTop__mlTSS",topRight:"styles_topRight__JrS+o",status:"styles_status__BiGAj",file:"styles_file__t5t+B",cardTitle:"styles_cardTitle__lvaIH",cardBodyMiddle:"styles_cardBodyMiddle__k3HUB",purpose:"styles_purpose__Uv0zq",cardBodyEnd:"styles_cardBodyEnd__YrvB0",amountWrap:"styles_amountWrap__r-sf2",requestAmount:"styles_requestAmount__jaZUe",strike:"styles_strike__gMvlb",approvedAmount:"styles_approvedAmount__qM+A8",date:"styles_date__0ymsg",fullWidth:"styles_fullWidth__YE5R5"}}}]);