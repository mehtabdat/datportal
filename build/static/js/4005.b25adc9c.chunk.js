"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[4005],{70815:function(e,n,t){t.d(n,{r:function(){return p}});var o=t(1413),i=t(29439),a=t(45987),r=t(55291),s=t(86345),c=t(47313),d=t(40169),l=t(46417),u=["onChange","checked","recordId","allowChange"],p=function(e){var n=e.onChange,t=e.checked,p=e.recordId,g=e.allowChange,f=void 0===g||g,h=(0,a.Z)(e,u),Z=(0,c.useState)({loading:!1,checked:!1}),m=(0,i.Z)(Z,2),v=m[0],S=m[1];return(0,c.useEffect)((function(){S((0,o.Z)((0,o.Z)({},v),{},{checked:t}))}),[t]),(0,l.jsx)(s.Z,{checked:v.checked,onChange:function(e){!0===f?(S((0,o.Z)((0,o.Z)({},v),{},{loading:!0})),n(e,p,h).then((function(n){S((0,o.Z)((0,o.Z)({},v),{},{checked:e,loading:!1})),r.ZP.success(n.data.message)})).catch((function(e){S((0,o.Z)((0,o.Z)({},v),{},{loading:!1}));var n=(0,d.P)(e);"string"===typeof n.message?r.ZP.error(n.message):r.ZP.error("Something went wrong")}))):r.ZP.error("You don't have permission to change this record, please contact your admin.")},loading:v.loading})}},14005:function(e,n,t){t.r(n),t.d(n,{default:function(){return F}});var o=t(1413),i=t(29439),a=t(47313),r=t(7532),s=t(25019),c=t(55291),d=t(82626),l=t(17327),u=t(49355),p=t(3798),g=t(46646),f=t(40169),h=t(65960),Z=t(46417),m=function(e){var n,t=e.openModal,r=e.onCancel,m=e.type,v=e.record,S=e.reloadTableData,P=e.permissions,x=P.createSitePages,j=P.updateSitePages,C=s.Z.useForm(),b=(0,i.Z)(C,1)[0],E=(0,a.useMemo)((function(){return new h.E}),[]),k=(0,a.useState)(),w=(0,i.Z)(k,2),y=w[0],M=w[1],T=function(e){var n=(0,f.P)(e);if("string"==typeof n.message)M((0,o.Z)((0,o.Z)({},y),{},{error:n.message}));else{var t=(0,g.O)(n.message,[]);b.setFields(t),M((0,o.Z)((0,o.Z)({},y),{},{error:""}))}},I=(0,a.useCallback)((function(){E.getRecordById(v).then((function(e){e.data&&e.data.data&&(b.setFieldsValue((0,o.Z)({},e.data.data)),M((0,o.Z)((0,o.Z)({},e.data),{},{loading:!1})))})).catch((function(e){T(e)}))}),[b,v,E]);(0,a.useEffect)((function(){"edit"===m?(M({loading:!0}),I()):b.resetFields()}),[t,m,b,I]);return(0,Z.jsx)(d.P0,{visible:t,closable:!0,onCancel:r,titleText:"edit"===m?"Edit Page":"Add New Page",showFooter:!1,children:null!==y&&void 0!==y&&y.loading?(0,Z.jsx)(u.Z,{items:10}):(0,Z.jsxs)(s.Z,{className:l.Z.form,onFinish:function(e){M((0,o.Z)((0,o.Z)({},y),{},{buttonLoading:!0}));var n=e;switch(m){case"edit":!0===j?E.updateRecord(n,null===y||void 0===y?void 0:y.data.id).then((function(e){S(),r(),M((function(e){return(0,o.Z)((0,o.Z)({},e),{},{loading:!1})}))})).catch((function(e){T(e),M((function(e){return(0,o.Z)((0,o.Z)({},e),{},{loading:!1})}))})):(M((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})})),c.ZP.error("You don't have permission to update this page"));break;case"new":!0===x?E.createRecord(n).then((function(e){S(),r(),M((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){T(e),M((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})):(M((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})})),c.ZP.error("You don't have permission to create a new page"))}},form:b,children:[(null===y||void 0===y?void 0:y.error)&&(0,Z.jsx)(d.EQ,{description:null===y||void 0===y?void 0:y.error,isClosable:!0,onClose:function(){M((0,o.Z)((0,o.Z)({},y),{},{error:""}))}}),(0,Z.jsxs)("div",{children:[(0,Z.jsx)(s.Z.Item,{name:"title",rules:[{required:!0,message:"Please name a section"}],children:(0,Z.jsx)(d.t7,{size:"w100",label:"Title",asterisk:!0,type:"text"})}),(0,Z.jsx)(s.Z.Item,{name:"slug",rules:[{required:!0,message:"Please add a slug"}],children:(0,Z.jsx)(d.t7,{onChange:function(e){var n=e.target,t=(0,p.V3)(n.value);b.setFieldsValue({slug:t})},size:"w100",label:"Slug",asterisk:!0,type:"text"})})]}),(0,Z.jsx)("div",{children:(0,Z.jsx)(s.Z.Item,{name:"description",rules:[{required:!1}],children:(0,Z.jsx)(d.t7,{size:"w100",label:"Description",type:"textArea",defaultValue:null===y||void 0===y||null===(n=y.data)||void 0===n?void 0:n.description})})}),(0,Z.jsx)("div",{children:(0,Z.jsx)(s.Z.Item,{name:"isPublished",children:(0,Z.jsx)(d.AP,{label:"Published",options:[{value:!0,label:"Yes"},{value:!1,label:"No"}]})})}),(0,Z.jsxs)("div",{className:l.Z.footer,children:[(0,Z.jsx)(d.op,{size:"normal",fontSize:"sm",onClick:r,type:"plain",children:"Cancel"}),(0,Z.jsx)(d.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:null===y||void 0===y?void 0:y.buttonLoading,children:"Submit"})]})]})})},v=t(8570),S=t(5900),P=t(41586),x=t(98676),j=t(70815),C=t(32147),b=t(2135),E=t(18812),k=t(7789),w=t(85554),y=v.Z.Paragraph,M=function(e){var n=e.record,t=e.onEditIconClick,r=e.reloadTableData,s=e.permissions,d=s.deleteSitePages,u=s.readStaticPageSEO,p=(0,a.useState)({confirmLoading:!1,openPopConfirm:!1}),g=(0,i.Z)(p,2),f=g[0],m=g[1],v=(0,a.useMemo)((function(){return new h.E}),[]);return(0,Z.jsxs)("div",{className:l.Z.actions,children:[!0===u&&(0,Z.jsx)("span",{children:(0,Z.jsx)(b.rU,{to:"/siteSettings/static-page-seo?pageId=".concat(n.id),children:(0,Z.jsx)(C.iC,{})})}),(0,Z.jsx)("span",{onClick:function(){return t(n)},children:(0,Z.jsx)("img",{src:"/images/editicon.svg",alt:""})}),(0,Z.jsx)(S.Z,{open:f.openPopConfirm,placement:"top",title:"Are you sure?",onConfirm:function(){if(m((0,o.Z)((0,o.Z)({},f),{},{confirmLoading:!0})),!1===d)return c.ZP.error("You don't have permission to delete this record, please contact your admin."),void m((0,o.Z)((0,o.Z)({},f),{},{openPopConfirm:!1}));v.deleteRecord(n.id).then((function(e){m((0,o.Z)((0,o.Z)({},f),{},{openPopConfirm:!1,confirmLoading:!1})),r()})).catch((function(e){m((0,o.Z)((0,o.Z)({},f),{},{confirmLoading:!1}))}))},onCancel:function(){return m((0,o.Z)((0,o.Z)({},f),{},{openPopConfirm:!1}))},okButtonProps:{loading:f.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:function(e){e||m((0,o.Z)((0,o.Z)({},f),{},{openPopConfirm:!1}))},children:(0,Z.jsx)(x.Z,{className:l.Z.bg__red,onClick:function(){m((0,o.Z)((0,o.Z)({},f),{},{openPopConfirm:!0}))}})})]})};function T(e){var n=e.tableData,t=e.tableLoading,o=e.onEditIconClick,i=e.reloadTableData,a=e.onManageSectionClick,r=(0,w.v9)((function(e){return e.usersReducer})).userPermissions,s=r.updateSitePages,c=r.updateSitePagesSection,d=new h.E,u=function(e,n){return d.updateRecord({isPublished:e},n)},p=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,n,t){return t+1},width:"5%"},{title:"Title",dataIndex:"title",key:"title",render:function(e,n){return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("h3",{className:"mb-0 font-size-normal",children:e}),(0,Z.jsx)(y,{title:n.slug,ellipsis:{rows:1,expandable:!1},copyable:{text:n.slug},className:"font-size-sm color-dark-sub mb-0",children:n.slug}),(0,Z.jsx)("p",{className:"mb-0 font-size-sm color-dark-sub",children:null===n||void 0===n?void 0:n.description})]})}},{title:"Sections",dataIndex:"pageSectionRelation",key:"pageSectionRelation",render:function(e,n){return 0===e.length?(0,Z.jsx)("div",{className:"font-size-sm color-dark-sub",children:"No Sections Added"}):e.map((function(e){var n;return(0,Z.jsxs)("div",{className:"font-size-sm",children:[" -> ",null===e||void 0===e||null===(n=e.pageSection)||void 0===n?void 0:n.title]})}))}},{title:"Pages Content",key:"pageContent",render:function(e,n){return(0,Z.jsx)(Z.Fragment,{children:!0===c?(0,Z.jsx)("div",{className:"cursor-pointer",onClick:function(e){return a(n)},children:"Manage Page Section"}):null})}},{title:"Published",dataIndex:"isPublished",key:"isPublished",render:function(e,n){return(0,Z.jsx)(j.r,{checked:e,onChange:u,recordId:n.id,allowChange:!0===s})}},{title:"Actions",dataIndex:"actions",key:"actions",render:function(e,n){return(0,Z.jsx)(M,{record:n,onEditIconClick:o,reloadTableData:i,permissions:r})}}];return(0,Z.jsx)("div",{className:l.Z.antdTableWrapper,children:(0,Z.jsx)(P.Z,{sticky:!0,dataSource:n,columns:p,pagination:!1,scroll:{x:991},loading:t,rowKey:function(e){return"site-pages-".concat(e.id)}})})}var I=t(7655),R=t(71522),D=function(e){var n,t,r=e.openModal,p=e.onCancel,m=e.record,v=e.reloadTableData,S=e.pageData,P=e.permissions,x=P.updateSitePagesSection,j=P.createSitePagesSection,C=s.Z.useForm(),b=(0,i.Z)(C,1)[0],E=(0,a.useMemo)((function(){return new h.E}),[]),k=(0,a.useMemo)((function(){return new R.Y}),[]),w=(0,a.useState)(),y=(0,i.Z)(w,2),M=y[0],T=y[1],D=[];S&&S.pageSectionRelation&&(null===S||void 0===S||null===(t=S.pageSectionRelation)||void 0===t||t.map((function(e){return D.push(e.pageSectionId.toString())})));var L=(0,a.useState)(D),A=(0,i.Z)(L,2),N=A[0],z=A[1],F=function(e){var n=(0,f.P)(e);if("string"==typeof n.message)T((0,o.Z)((0,o.Z)({},M),{},{error:n.message}));else{var t=(0,g.O)(n.message,[]);b.setFields(t),T((0,o.Z)((0,o.Z)({},M),{},{error:""}))}},Y=(0,a.useCallback)((function(){k.getAllRecords().then((function(e){e.data&&e.data.data&&T((0,o.Z)((0,o.Z)({},e.data),{},{loading:!1}))})).catch((function(e){F(e)}))}),[b,m,E,k]);(0,a.useEffect)((function(){T({loading:!0}),Y()}),[r,b]);return(0,Z.jsx)(d.P0,{visible:r,closable:!0,onCancel:p,titleText:"Manage Section",showFooter:!1,children:null!==M&&void 0!==M&&M.loading?(0,Z.jsx)(u.Z,{items:10}):(0,Z.jsxs)(s.Z,{className:l.Z.form,onFinish:function(e){if(!0===x){T((0,o.Z)((0,o.Z)({},M),{},{buttonLoading:!0}));var n=e;E.updateRecord(n,m).then((function(e){v(),p(),T((function(e){return(0,o.Z)((0,o.Z)({},e),{},{loading:!1})}))})).catch((function(e){F(e),T((function(e){return(0,o.Z)((0,o.Z)({},e),{},{loading:!1})}))}));var t=[];D.map((function(e){return N.includes(e)?[]:t.push(e)})),t.length>0&&E.deleteMultiple(m,t).catch((function(e){c.ZP.error(e.message)}))}else c.ZP.error("You don't have permission to manage pages section, please contact admin.")},form:b,children:[(null===M||void 0===M?void 0:M.error)&&(0,Z.jsx)(d.EQ,{description:null===M||void 0===M?void 0:M.error,isClosable:!0,onClose:function(){T((0,o.Z)((0,o.Z)({},M),{},{error:""}))}}),!0===j&&(0,Z.jsx)("div",{className:"mb-2",children:(0,Z.jsx)("a",{href:"/siteSettings/pages-section",children:"Section not found? Click to add"})}),(0,Z.jsx)("div",{children:(0,Z.jsx)(s.Z.Item,{name:"pageSectionIds",rules:[{required:!1}],children:(0,Z.jsx)(I.Z,{dataSource:null===M||void 0===M||null===(n=M.data)||void 0===n?void 0:n.map((function(e,n){var t;return{key:e.id.toString(),title:e.title,description:null===(t=e.title)||void 0===t?void 0:t.toLowerCase()}})),listStyle:{width:250,height:400},showSearch:!0,filterOption:function(e,n){return n.description.indexOf(e.toLowerCase())>-1},targetKeys:N,onChange:function(e){z(e)},render:function(e){return e.title}})})}),(0,Z.jsxs)("div",{className:l.Z.footer,children:[(0,Z.jsx)(d.op,{size:"normal",fontSize:"sm",onClick:p,type:"plain",children:"Cancel"}),(0,Z.jsx)(d.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:null===M||void 0===M?void 0:M.buttonLoading,children:"Save"})]})]})})},L=t(42623),A=function(e){return e.CREATE="createSitePages",e.UPDATE="updateSitePages",e.DELETE="deleteSitePages",e.READ="readSitePages",e}({}),N=t(18515),z=[{text:"Home",isLink:!0,path:"/"},{isLink:!0,text:"Site Settings",path:"/siteSettings"},{isLink:!1,text:"Site Pages"}];var F=function(){var e=(0,p.aY)(A);e.push(E.v.UPDATE,E.v.READ,E.v.CREATE,k.g.READ);var n=(0,w.v9)((function(e){return e.usersReducer})).userPermissions,t=n.readSitePages,s=n.createSitePages,l=n.updateSitePages,u=n.updateSitePagesSection,g=n.readSitePagesSection,f=(0,a.useState)({editType:"new",recordId:0,openModal:!1}),v=(0,i.Z)(f,2),S=v[0],P=v[1],x=(0,a.useState)({recordId:0,openModal:!1,recordData:{}}),j=(0,i.Z)(x,2),C=j[0],b=j[1],y=new h.E,M=(0,a.useState)({isLoading:!1,error:{},data:[]}),I=(0,i.Z)(M,2),R=I[0],F=I[1],Y=(0,a.useState)(""),O=(0,i.Z)(Y,2),B=O[0],U=O[1],q=(0,L.N)(B,500),V=(0,a.useState)(),_=(0,i.Z)(V,2),H=_[0],K=_[1],Q=function(){!1!==s?P((0,o.Z)((0,o.Z)({},S),{},{openModal:!S.openModal,editType:"new"})):c.ZP.error("You don't have permission to create new record")},W=function(){F((0,o.Z)((0,o.Z)({},R),{},{loading:!0})),y.getAllRecords().then((function(e){F(e.data)})).catch((function(e){}))};(0,a.useEffect)((function(){W()}),[]);var $=(0,a.useCallback)((function(){if(q){var e=(null===R||void 0===R?void 0:R.data).filter((function(e){return e.title.toLowerCase().includes(q.toLowerCase())}));K(e)}else K(void 0)}),[q,null===R||void 0===R?void 0:R.data]);return(0,a.useEffect)((function(){$()}),[$]),(0,Z.jsxs)(r.default,{permissionSlug:e,children:[(0,Z.jsx)(d.mr,{heading:"Site Pages",buttonText:"Add new page",onButtonClick:Q,breadCrumbData:z,showAdd:!0===s,filters:!0===t?(0,Z.jsx)("div",{children:(0,Z.jsx)("div",{children:(0,Z.jsx)(d.t7,{placeHolder:"Search...",icon:(0,Z.jsx)("img",{src:"/images/searchIcon.svg",alt:"Search Icon"}),size:"w100",className:"py-1",value:B,onChange:function(e){var n=e.currentTarget.value;U(n)}})})}):null,children:!0===g&&(0,Z.jsx)("a",{href:"/siteSettings/pages-section",children:(0,Z.jsx)(d.op,{children:"Manage Sections"})})}),!0===t&&(0,Z.jsx)(T,{tableData:H||R.data,tableLoading:R.loading,onEditIconClick:function(e){!1!==l?P((0,o.Z)((0,o.Z)({},S),{},{editType:"edit",recordId:e.id,openModal:!0})):c.ZP.error("You don't have permission to update this record")},onManageSectionClick:function(e){!1!==u?b((0,o.Z)((0,o.Z)({},C),{},{recordId:e.id,recordData:e,openModal:!0})):c.ZP.error("You don't have permission to manage page sections")},reloadTableData:W}),!1===t&&(0,Z.jsx)(N.a$,{mainMessage:"You don't have permission to view this data"}),S.openModal&&(0,Z.jsx)(m,{record:S.recordId,type:S.editType,reloadTableData:W,onCancel:Q,openModal:S.openModal,permissions:n}),C.openModal&&(0,Z.jsx)(D,{record:C.recordId,pageData:C.recordData,type:"edit",reloadTableData:W,onCancel:function(){b((0,o.Z)((0,o.Z)({},S),{},{openModal:!C.openModal}))},openModal:C.openModal,permissions:n})]})}},71522:function(e,n,t){t.d(n,{Y:function(){return s}});var o=t(43144),i=t(15671),a=t(49075),r=t(3135),s=(0,o.Z)((function e(){var n=this;(0,i.Z)(this,e),this.endPoint="site-pages-section",this.createRecord=function(e){return a.Z.post(n.endPoint+"/",e,{headers:r.C})},this.getAllRecords=function(e){return a.Z.get(n.endPoint,{params:e})},this.getRecordById=function(e){return a.Z.get("".concat(n.endPoint,"/").concat(e,"?all=true"))},this.updateRecord=function(e,t){return a.Z.patch("".concat(n.endPoint,"/").concat(t),e,{headers:r.C})},this.allowMultiples=function(e){return a.Z.patch("".concat(n.endPoint,"/allowMultiples/").concat(e))},this.disallowMultiples=function(e){return a.Z.patch("".concat(n.endPoint,"/disallowMultiples/").concat(e))},this.deleteRecord=function(e){return a.Z.delete("".concat(n.endPoint,"/").concat(e))}}))},18812:function(e,n,t){t.d(n,{v:function(){return o}});var o=function(e){return e.CREATE="createSitePagesSection",e.UPDATE="updateSitePagesSection",e.DELETE="deleteSitePagesSection",e.READ="readSitePagesSection",e}({})},65960:function(e,n,t){t.d(n,{E:function(){return s}});var o=t(43144),i=t(15671),a=t(49075),r=t(3135),s=(0,o.Z)((function e(){var n=this;(0,i.Z)(this,e),this.endPoint="site-pages",this.createRecord=function(e){return a.Z.post(n.endPoint+"/",e)},this.getAllRecords=function(e){return a.Z.get(n.endPoint,{params:e})},this.getRecordById=function(e){return a.Z.get("".concat(n.endPoint,"/").concat(e,"?all=true"))},this.updateRecord=function(e,t){return a.Z.patch("".concat(n.endPoint,"/").concat(t),e,{headers:r.C})},this.allowMultiples=function(e){return a.Z.patch("".concat(n.endPoint,"/allowMultiples/").concat(e))},this.disallowMultiples=function(e){return a.Z.patch("".concat(n.endPoint,"/disallowMultiples/").concat(e))},this.deleteRecord=function(e){return a.Z.delete("".concat(n.endPoint,"/").concat(e))},this.deleteMultiple=function(e,t){return a.Z.delete("".concat(n.endPoint,"/removeMultipleSectionFromPage"),{params:{pageId:e,sectionIds:t}})}}))},7789:function(e,n,t){t.d(n,{g:function(){return o}});var o=function(e){return e.CREATE="createStaticPageSEO",e.UPDATE="updateStaticPageSEO",e.DELETE="deleteStaticPageSEO",e.READ="readStaticPageSEO",e}({})}}]);