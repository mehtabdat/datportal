"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[6084],{41746:function(e,n,t){var o=t(29439),i=t(47313),r=t(28080),a=t(32697),d=t(78267),l=t(45705),u=t(32344),s=t(25568),c=t(46417);n.Z=function(e){var n=e.options,t=e.onChange,p=e.value,v=(0,i.useState)(!1),g=(0,o.Z)(v,2),h=g[0],f=g[1],m=(0,c.jsx)(r.Z,{children:(0,c.jsx)("div",{className:"pa-3",children:(0,c.jsx)(a.Z.Group,{className:s.Z.checkboxGroup,options:n,onChange:function(e){t(e),f(!1)},value:p})})});return(0,c.jsx)("div",{children:(0,c.jsx)(d.Z,{trigger:["click"],open:h,onOpenChange:function(e){return f(e)},dropdownRender:function(){return m},children:(0,c.jsx)("div",{className:s.Z.label,children:(0,c.jsxs)(l.Z,{children:[(0,c.jsx)("span",{children:"More Filters"}),(0,c.jsx)(u.Z,{})]})})})})}},66084:function(e,n,t){t.r(n),t.d(n,{default:function(){return F}});var o=t(4942),i=t(1413),r=t(29439),a=t(47313),d=t(82626),l=t(7532),u=t(8570),s=t(41068),c=t(28080),p=t(59491),v=t(41586),g=t(98505),h=t(37936),f=t(48897),m=t(3798),y=t(32147),x=t(46417),Z=u.Z.Paragraph,b={1:"#00337C",2:"#144272",3:"#1F8A70",4:"#AD8E70",5:"#EB1D36",6:"#EB1D36"};function j(e){var n=e.tableData,t=e.tableLoading,l=(0,a.useState)({}),u=(0,r.Z)(l,2),j=u[0],k=u[1],I=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,n,t){return t+1},width:"60px"},{title:"Users",dataIndex:"from",key:"from",render:function(e,n){return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(Z,{title:e,ellipsis:{rows:1,expandable:!1},copyable:{text:e},className:"font-size-xs color-dark-sub mb-0 mt-1",children:["From: ",e]}),(0,x.jsxs)(Z,{title:n.to,ellipsis:{rows:1,expandable:!1},copyable:{text:n.to},className:"font-size-xs color-dark-sub mb-0 mt-1",children:["To: ",n.to]})]})}},{title:"Message / Type",dataIndex:"message",key:"message",render:function(e,n){return(0,x.jsxs)(s.Z.Ribbon,{text:(0,m.kC)(n.type),color:"incoming"===n.type?"green":"",children:[(0,x.jsxs)(c.Z,{title:"Message",size:"small",style:{whiteSpace:"pre-line"},children:[e.length>100&&!j[n.id]?e.slice(0,100)+"...":e,e.length>100&&(0,x.jsx)(p.Z,{type:"link",size:"small",onClick:function(){return k((0,i.Z)((0,i.Z)({},j),{},(0,o.Z)({},n.id,!j[n.id])))},children:j[n.id]?"See Less":"See More"})]}),(0,x.jsxs)("div",{className:"d-flex mt-1",children:[(0,x.jsx)(y.$$,{className:"mr-2"}),(0,x.jsx)(d.ZT,{color:"dark-sub",size:"sm",children:"".concat((0,g.Ny)(n.addedDate,"dd M,yy-t"))||"N/A"})]})]})},width:"20%"},{title:"Property",dataIndex:"property",key:"property",render:function(e){var n,t,o,i,r;return(0,x.jsxs)(x.Fragment,{children:[(null===e||void 0===e?void 0:e.id)&&(0,x.jsx)(d.ZT,{color:"dark-main",size:"sm",children:"ID: ".concat(null===e||void 0===e?void 0:e.id)}),(null===e||void 0===e?void 0:e.localization)&&(0,x.jsxs)(Z,{title:null===(n=e.localization[0])||void 0===n?void 0:n.title,ellipsis:{rows:1,expandable:!1},copyable:{text:null===(t=e.localization[0])||void 0===t?void 0:t.title},className:"font-size-xs color-dark-sub mb-0 mt-1",children:["Name: ",null===(o=e.localization[0])||void 0===o?void 0:o.title]}),(null===e||void 0===e||null===(i=e.category)||void 0===i?void 0:i.slug)&&(0,x.jsx)(d.ZT,{color:"dark-sub",size:"xs",children:'""'}),(null===e||void 0===e?void 0:e.slug)&&(0,x.jsxs)("div",{className:"d-flex",children:[(0,x.jsx)(d.ZT,{color:"dark-main",size:"sm",weight:"bold",children:"View Property:"}),(0,x.jsx)("a",{href:"".concat(f.JH,"/en/property/").concat(e.slug),target:"_blank",rel:"noreferrer",title:null===(r=e.localization[0])||void 0===r?void 0:r.title,children:(0,x.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",height:"16px",width:"17px",children:(0,x.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"})})})]})]})},width:"15%"},{title:"Organization",dataIndex:"organization",key:"organization",render:function(e){return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(d.ZT,{color:"dark-sub",size:"xs",className:"ml-2 my-auto",children:"Name: ".concat(null===e||void 0===e?void 0:e.name)}),(0,x.jsx)(d.ZT,{color:"dark-sub",size:"xs",className:"ml-2 my-auto",children:"ID: ".concat(null===e||void 0===e?void 0:e.id)})]})}},{title:"Status",dataIndex:"status",key:"status",render:function(e){return(0,x.jsx)(d.ZT,{color:"dark-main",size:"sm",style:{backgroundColor:b[e],color:"#fff",padding:"0.2rem 0.5rem",borderRadius:"0.25rem",fontSize:"0.8rem",display:"flex",width:"fit-content",justifyContent:"space-between"},children:"".concat(h.Iu[e])})}}];return(0,x.jsx)("div",{children:(0,x.jsx)(v.Z,{sticky:!0,dataSource:n,columns:I,pagination:!1,scroll:{x:991},loading:t})})}var k=t(3113),I=t(55291),S=t(43144),z=t(15671),C=t(49075),P=(0,S.Z)((function e(){var n=this;(0,z.Z)(this,e),this.endPoint="whatsapp",this.getAllRecords=function(e){return C.Z.get(n.endPoint,{params:e})}})),w=t(38308),R=t(5190),N=t(42623),U=t(41746),T=t(84825),D=function(e){return e.UPDATE="updateWhatsapp",e.DELETE="deleteWhatsapp",e.READ="readWhatsapp",e}({}),A=[{text:"Home",isLink:!0,path:"/"},{text:"Site Settings",isLink:!0,path:"/siteSettings"},{isLink:!1,text:"WhatsApp"}],L=[{label:"Organization",value:"organizationId"},{label:"Phone",value:"phone"},{label:"Property URL",value:"propertyUrl"}],B=[{label:"Date Added",value:"addedDate"}],F=function(){var e,n,t,u,s,c,p,v=(0,m.aY)(D),h=(0,a.useMemo)((function(){return new P}),[]),f=(0,a.useMemo)((function(){return new w.b}),[]),y=(0,a.useMemo)((function(){return new R.L}),[]),Z=(0,a.useMemo)((function(){return new T.z}),[]),b=(0,a.useState)([]),S=(0,r.Z)(b,2),z=S[0],C=S[1],F=(0,a.useState)({loading:!1,data:[]}),E=(0,r.Z)(F,2),M=E[0],O=E[1],X=(0,a.useState)(""),_=(0,r.Z)(X,2),W=_[0],H=_[1],G=(0,N.N)(W,500),V=(0,a.useState)(""),$=(0,r.Z)(V,2),J=$[0],Y=$[1],q=(0,N.N)(J,500),K=(0,a.useState)({data:[],loading:!1}),Q=(0,r.Z)(K,2),ee=Q[0],ne=Q[1],te=(0,a.useState)({data:[],loading:!1}),oe=(0,r.Z)(te,2),ie=oe[0],re=oe[1],ae=(0,a.useState)({data:[],loading:!1}),de=(0,r.Z)(ae,2),le=de[0],ue=de[1],se=(0,a.useState)({sortByField:"",sortOrder:"",phone:"",status:"",dateRange:[],propertyId:0,propertyCategory:void 0,organizationId:0,propertyUrl:"",agentId:0}),ce=(0,r.Z)(se,2),pe=ce[0],ve=ce[1],ge=(0,a.useState)(!1),he=(0,r.Z)(ge,2),fe=he[0],me=he[1],ye=function(e){var n=null===e||void 0===e?void 0:e.target,t=n.name,r=n.value;if(("propertyId"===t||"phone"===t)&&!(0,m.hj)(r)){var a="";switch(t){case"organizationId":a="Organization ID";break;case"phone":a="Phone"}return I.ZP.error("".concat(a," should be a number"))}ve((0,i.Z)((0,i.Z)({},pe),{},(0,o.Z)({},t,r)))},xe=(0,a.useCallback)((function(){G&&(ne((function(e){return(0,i.Z)((0,i.Z)({},e),{},{loading:!0})})),y.findPublished({name:G}).then((function(e){var n,t=null===(n=e.data)||void 0===n?void 0:n.data;if(t){var o=t.filter((function(e,n){return t.findIndex((function(n){return n.id===e.id}))===n}));ne((function(e){return(0,i.Z)((0,i.Z)({},e),{},{data:o})}))}})).catch((function(e){var n,t;I.ZP.error((null===e||void 0===e||null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.message)||"Something went wrong")})).finally((function(){ne((function(e){return(0,i.Z)((0,i.Z)({},e),{},{loading:!1})}))}))),q&&(re((function(e){return(0,i.Z)((0,i.Z)({},e),{},{loading:!0})})),Z.getAgents({name:q}).then((function(e){var n,t=null===(n=e.data)||void 0===n?void 0:n.data;if(t){var o=t.filter((function(e,n){return t.findIndex((function(n){return n.id===e.id}))===n}));re((function(e){return(0,i.Z)((0,i.Z)({},e),{},{data:o})}))}})).catch((function(e){var n,t;I.ZP.error((null===e||void 0===e||null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.message)||"Something went wrong")})).finally((function(){re((function(e){return(0,i.Z)((0,i.Z)({},e),{},{loading:!1})}))})))}),[G,q]);(0,a.useEffect)((function(){xe()}),[xe]);var Ze=(0,a.useCallback)((function(){f.getAllRecords().then((function(e){ue(e.data)})).catch((function(){ue((0,i.Z)((0,i.Z)({},le),{},{loading:!1}))}))}),[le]);(0,a.useEffect)((function(){Ze()}),[]);var be=(0,a.useCallback)((function(e){var n,t,o=(null===(n=pe.dateRange)||void 0===n?void 0:n[0])||"",r=(null===(t=pe.dateRange)||void 0===t?void 0:t[1])||"",a=o?(0,g.Ny)(o,"yy-mm-dd"):void 0,d=r?(0,g.Ny)(r,"yy-mm-dd"):void 0,l=(0,i.Z)({status:pe.status?pe.status:void 0,propertyId:Number(pe.propertyId)>0?Number(pe.propertyId):void 0,phone:pe.phone?pe.phone:void 0,fromDate:a,toDate:d,propertyCategory:pe.propertyCategory?pe.propertyCategory:void 0,organizationId:Number(pe.organizationId)>0?Number(pe.organizationId):void 0,propertyUrl:pe.propertyUrl?pe.propertyUrl:void 0,agentId:Number(pe.agentId)>0?Number(pe.agentId):void 0,sortOrder:pe.sortOrder?pe.sortOrder:void 0,sortByField:pe.sortByField?pe.sortByField:void 0},e);h.getAllRecords(l).then((function(e){O((0,i.Z)((0,i.Z)({},e.data),{},{loading:!1}))})).catch((function(e){var n,t;O({loading:!1}),I.ZP.error((null===e||void 0===e||null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.message)||"Something went wrong")}))}),[pe,h]),je=(0,a.useCallback)((function(e,n){e&&(me(!0),ve((0,i.Z)((0,i.Z)({},pe),{},(0,o.Z)({},e,n))))}),[pe]);(0,a.useEffect)((function(){fe&&be();var e=setTimeout((function(){me(!1)}),2e3);return function(){return clearTimeout(e)}}),[fe,pe,be]);var ke=(0,a.useCallback)((function(e){be(e)}),[be]);(0,a.useEffect)((function(){ke()}),[]);var Ie={organizationId:(0,x.jsx)(d.Xy,{type:"radio",label:"Organization",name:"organizationId",withSearch:!0,options:null===ee||void 0===ee||null===(e=ee.data)||void 0===e?void 0:e.map((function(e){return{label:e.name,value:"".concat(e.id)}})),onChange:ye,value:Number(null===pe||void 0===pe?void 0:pe.organizationId)>0?String(null===pe||void 0===pe?void 0:pe.organizationId):"",onReset:function(){me(!0),je("organizationId",0),H("")},onUpdate:be,loading:null===ee||void 0===ee?void 0:ee.loading,searchTerm:W,onSearch:function(e){return H(e.currentTarget.value)}}),phone:(0,x.jsx)(d.Xy,{type:"input",label:"Phone",name:"phone",value:String(null===pe||void 0===pe?void 0:pe.phone),onChange:ye,onReset:function(){return je("phone","")},onUpdate:be}),propertyUrl:(0,x.jsx)(d.Xy,{type:"input",label:"Property URL",name:"propertyUrl",value:String(null===pe||void 0===pe?void 0:pe.propertyUrl),onChange:ye,onReset:function(){return je("propertyUrl","")},onUpdate:be})};return(0,x.jsxs)(l.default,{permissionSlug:v,children:[(0,x.jsx)(d.mr,{heading:"WhatsApp",breadCrumbData:A,filters:(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{children:(0,x.jsx)(d.Xy,{type:"radio",label:"Status",name:"status",options:[],value:String(null===pe||void 0===pe?void 0:pe.status),onChange:ye,onReset:function(){return je("status","")},onUpdate:be})}),(0,x.jsx)("div",{children:(0,x.jsx)(d.Xy,{type:"input",label:"Property ID",name:"propertyId",value:Number(null===pe||void 0===pe?void 0:pe.propertyId)>0?String(null===pe||void 0===pe?void 0:pe.propertyId):"",onChange:ye,onReset:function(){return je("propertyId",0)},onUpdate:be})}),(0,x.jsx)("div",{children:(0,x.jsx)(d.Xy,{type:"radio",label:"Property Category",name:"propertyCategory",options:null===le||void 0===le||null===(n=le.data)||void 0===n?void 0:n.map((function(e){return{label:e.localization[0].title,value:e.slug}})),value:String(null===pe||void 0===pe?void 0:pe.propertyCategory),onChange:ye,onReset:function(){return je("propertyCategory","")},onUpdate:be})}),(0,x.jsx)("div",{children:(0,x.jsx)(d.Xy,{type:"datepicker",label:"Date",name:"dateRange",onChange:function(e){ve((0,i.Z)((0,i.Z)({},pe),{},{dateRange:e}))},onReset:function(){return je("dateRange",[])},onUpdate:be})}),(0,x.jsx)("div",{children:(0,x.jsx)(d.Xy,{type:"radio",label:"Agent",name:"agentId",withSearch:!0,options:null===ie||void 0===ie||null===(t=ie.data)||void 0===t?void 0:t.map((function(e){return{label:"".concat(e.firstName," ").concat(e.lastName),value:"".concat(e.id)}})),onChange:ye,value:Number(null===pe||void 0===pe?void 0:pe.agentId)>0?String(null===pe||void 0===pe?void 0:pe.agentId):"",onReset:function(){me(!0),je("agentId",0),Y("")},onUpdate:be,loading:null===ie||void 0===ie?void 0:ie.loading,searchTerm:J,onSearch:function(e){return Y(e.currentTarget.value)}})}),Object.keys(Ie).map((function(e){return(null===z||void 0===z?void 0:z.includes(e))&&Ie[e]})),(0,x.jsx)("div",{children:(0,x.jsx)(U.Z,{options:null===L||void 0===L?void 0:L.map((function(e){return{label:e.label,value:e.value}})),onChange:function(e){return C(e)},value:z})}),(0,x.jsx)("div",{style:{marginLeft:"auto",marginRight:"0px"},children:(0,x.jsx)(d.Xy,{type:"radio",label:"Sort By",name:"sortByField",options:B,value:String(null===pe||void 0===pe?void 0:pe.sortByField),onChange:ye,onReset:function(){return je("sortByField","")},onUpdate:be,withSort:!0})})]})}),(0,x.jsx)("div",{className:k.Z.antdTableWrapper,children:(0,x.jsx)(j,{tableData:null===M||void 0===M?void 0:M.data,tableLoading:M.loading})}),(0,x.jsx)(d.tl,{total:null===M||void 0===M||null===(u=M.meta)||void 0===u?void 0:u.total,current:null===M||void 0===M||null===(s=M.meta)||void 0===s?void 0:s.page,defaultPageSize:null!==M&&void 0!==M&&null!==(c=M.meta)&&void 0!==c&&c.perPage?null===M||void 0===M||null===(p=M.meta)||void 0===p?void 0:p.perPage:10,pageSizeOptions:[10,20,50,100],onChange:function(e,n){return be({page:e,perPage:n})}})]})}},5190:function(e,n,t){t.d(n,{L:function(){return d}});var o=t(43144),i=t(15671),r=t(49075),a=t(3135),d=(0,o.Z)((function e(){var n=this;(0,i.Z)(this,e),this.endPoint="organization",this.getAllRecords=function(e){return r.Z.get(n.endPoint,{params:e})},this.findPublished=function(e){return r.Z.get(n.endPoint+"/find-published",{params:e})},this.getRecordById=function(e){return r.Z.get("".concat(n.endPoint,"/").concat(e))},this.deleteRecord=function(e){return r.Z.delete("".concat(n.endPoint,"/").concat(e))},this.createRecord=function(e){return r.Z.post(n.endPoint,e,{headers:a.C})},this.updateRecord=function(e,t){return r.Z.patch("".concat(n.endPoint,"/").concat(t),e,{headers:a.C})},this.getTenants=function(){return r.Z.get("xero/getTenants")}}))},38308:function(e,n,t){t.d(n,{b:function(){return a}});var o=t(43144),i=t(15671),r=t(49075),a=(0,o.Z)((function e(){var n=this;(0,i.Z)(this,e),this.endPoint="project-type",this.getAllRecords=function(){return r.Z.get(r._+n.endPoint)},this.getRecordById=function(e){return r.Z.get(r._+n.endPoint+"/"+e)},this.deleteRecord=function(e){return r.Z.delete(r._+n.endPoint+"/"+e)},this.createRecord=function(e){return r.Z.post(r._+n.endPoint,e)},this.updateRecord=function(e,t){return r.Z.patch(r._+n.endPoint+"/"+t,e)}}))}}]);