"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[9838],{70815:function(e,t,n){n.d(t,{r:function(){return g}});var o=n(1413),i=n(29439),a=n(45987),r=n(55291),d=n(86345),c=n(47313),s=n(40169),l=n(46417),u=["onChange","checked","recordId","allowChange"],g=function(e){var t=e.onChange,n=e.checked,g=e.recordId,h=e.allowChange,f=void 0===h||h,p=(0,a.Z)(e,u),m=(0,c.useState)({loading:!1,checked:!1}),Z=(0,i.Z)(m,2),v=Z[0],P=Z[1];return(0,c.useEffect)((function(){P((0,o.Z)((0,o.Z)({},v),{},{checked:n}))}),[n]),(0,l.jsx)(d.Z,{checked:v.checked,onChange:function(e){!0===f?(P((0,o.Z)((0,o.Z)({},v),{},{loading:!0})),t(e,g,p).then((function(t){P((0,o.Z)((0,o.Z)({},v),{},{checked:e,loading:!1})),r.ZP.success(t.data.message)})).catch((function(e){P((0,o.Z)((0,o.Z)({},v),{},{loading:!1}));var t=(0,s.P)(e);"string"===typeof t.message?r.ZP.error(t.message):r.ZP.error("Something went wrong")}))):r.ZP.error("You don't have permission to change this record, please contact your admin.")},loading:v.loading})}},89838:function(e,t,n){n.r(t),n.d(t,{default:function(){return O}});var o=n(1413),i=n(29439),a=n(47313),r=n(7532),d=n(25019),c=n(55291),s=n(82626),l=n(17327),u=n(49355),g=n(48897),h=n(46646),f=n(40169),p=n(59816),m=n(43144),Z=n(15671),v=n(49075),P=n(3135),x=(0,m.Z)((function e(){var t=this;(0,Z.Z)(this,e),this.endPoint="site-pages-content",this.createRecord=function(e){return v.Z.post(t.endPoint+"/",e,{headers:P.C})},this.getAllRecords=function(e){return v.Z.get(t.endPoint,{params:e})},this.getAllRecordsByCategory=function(e){return v.Z.get(t.endPoint+"/pageContentByCategory/"+e)},this.getRecordById=function(e){return v.Z.get("".concat(t.endPoint,"/").concat(e,"?all=true"))},this.updateRecord=function(e,n){return v.Z.patch("".concat(t.endPoint,"/").concat(n),e,{headers:P.C})},this.deleteRecord=function(e){return v.Z.delete("".concat(t.endPoint,"/").concat(e))}})),C=n(71522),b=n(2135),j=n(46417),y=function(e){var t,n,r,m,Z,v,P=e.openModal,y=e.onCancel,k=e.type,S=e.record,w=e.reloadTableData,I=e.permissions,R=I.createSitePagesContent,A=I.updateSitePagesContent,M=d.Z.useForm(),L=(0,i.Z)(M,1)[0],E=(0,a.useMemo)((function(){return new x}),[]),T=(0,a.useMemo)((function(){return new p.Y}),[]),N=(0,a.useMemo)((function(){return new C.Y}),[]),z=(0,a.useState)(),D=(0,i.Z)(z,2),Y=D[0],F=D[1],B=(0,a.useState)([]),O=(0,i.Z)(B,2),V=O[0],q=O[1],_=(0,a.useState)([]),H=(0,i.Z)(_,2),W=H[0],K=H[1],Q=(0,b.lr)(),U=(0,i.Z)(Q,1)[0].get("sectionId");U&&L.setFieldsValue({pageSectionId:U});var $=function(e){var t=(0,f.P)(e);if("string"==typeof t.message)F((0,o.Z)((0,o.Z)({},Y),{},{error:t.message}));else{var n=(0,h.O)(t.message,[]);L.setFields(n),F((0,o.Z)((0,o.Z)({},Y),{},{error:""}))}},G=(0,a.useCallback)((function(){E.getRecordById(S).then((function(e){e.data&&e.data.data&&(L.setFieldsValue((0,o.Z)((0,o.Z)({translations:e.data.data.localization},e.data.data),{},{isPublished:e.data.data.isPublished})),F((0,o.Z)((0,o.Z)({},e.data),{},{loading:!1})))})).catch((function(e){$(e)}))}),[L,S,E]),J=(0,a.useCallback)((function(){T.getAllRecords().then((function(e){e.data&&e.data.data&&q(e.data.data)}))}),[T]),X=(0,a.useCallback)((function(){N.getAllRecords().then((function(e){e.data&&e.data.data&&K(e.data.data)}))}),[N]);(0,a.useEffect)((function(){"edit"===k?(F({loading:!0}),G(),J(),X()):(J(),X(),L.resetFields())}),[P,k,L,G,J,X]);return(0,j.jsx)(s.P0,{visible:P,size:"900px",closable:!0,onCancel:y,titleText:"edit"===k?"Edit Section Content":"Add New Content",showFooter:!1,children:null!==Y&&void 0!==Y&&Y.loading?(0,j.jsx)(u.Z,{items:10}):(0,j.jsxs)(d.Z,{className:l.Z.form,onFinish:function(e){F((0,o.Z)((0,o.Z)({},Y),{},{buttonLoading:!0}));var t=new FormData,n=["image","translations"];switch(Object.entries(e).forEach((function(e){n.includes(e[0])||t.append(e[0],e[1])})),e.image&&"string"!==typeof e.image&&e.image.fileList.length>0&&t.append("image",e.image.fileList[0].originFileObj),e.translations&&e.translations.forEach((function(e,n){t.append("translations[".concat(n+1,"][language]"),e.language),t.append("translations[".concat(n+1,"][title]"),e.title),t.append("translations[".concat(n+1,"][highlight]"),e.highlight),t.append("translations[".concat(n+1,"][description]"),e.description)})),k){case"edit":!0===A?E.updateRecord(t,null===Y||void 0===Y?void 0:Y.data.id).then((function(e){w(),y(),F((function(e){return(0,o.Z)((0,o.Z)({},e),{},{loading:!1})}))})).catch((function(e){$(e),F((function(e){return(0,o.Z)((0,o.Z)({},e),{},{loading:!1})}))})):(F((function(e){return(0,o.Z)((0,o.Z)({},e),{},{loading:!1})})),c.ZP.error("You don't have permission to update this record"));break;case"new":!0===R?E.createRecord(t).then((function(e){w(),y(),F((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){$(e),F((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})):(F((function(e){return(0,o.Z)((0,o.Z)({},e),{},{loading:!1})})),c.ZP.error("You don't have permission to create this record"))}},form:L,children:[(null===Y||void 0===Y?void 0:Y.error)&&(0,j.jsx)(s.EQ,{description:null===Y||void 0===Y?void 0:Y.error,isClosable:!0,onClose:function(){F((0,o.Z)((0,o.Z)({},Y),{},{error:""}))}}),(0,j.jsxs)("div",{children:[(0,j.jsx)(d.Z.Item,{name:"countryId",rules:[{required:!0,message:"Please Select a country!"}],children:(0,j.jsx)(s.AP,{label:"Country",placeholder:"Please select country",options:null===V||void 0===V?void 0:V.map((function(e){return{label:e.name,value:e.id}})),asterisk:!0})}),(0,j.jsx)(d.Z.Item,{name:"pageSectionId",rules:[{required:!0,message:"Please select a page section"}],children:(0,j.jsx)(s.AP,{label:"Page Section",placeholder:"Please select a section",defaultValue:U||"",options:null===W||void 0===W?void 0:W.map((function(e){return{label:e.title,value:e.id.toString()}})),asterisk:!0})})]}),(0,j.jsx)(s.WH,{title:"Page Content",formName:"translations",description:!0,highlight:!0,form:L,defaultValue:null===Y||void 0===Y||null===(t=Y.data)||void 0===t?void 0:t.localization}),(0,j.jsxs)("div",{children:[(0,j.jsxs)("div",{children:[(0,j.jsx)(d.Z.Item,{name:"imageAlt",rules:[{required:!1}],children:(0,j.jsx)(s.t7,{size:"w100",label:"Image Alt Text",type:"text"})}),(0,j.jsx)(d.Z.Item,{name:"isPublished",children:(0,j.jsx)(s.AP,{label:"Published",options:[{value:!0,label:"Yes"},{value:!1,label:"No"}]})}),(0,j.jsx)(d.Z.Item,{name:"order",rules:[{required:!1}],children:(0,j.jsx)(s.t7,{size:"w100",label:"Order",type:"text"})})]}),(0,j.jsx)(s.wA,{name:"image",defaultFileList:"edit"===k&&Y&&(null===(n=Y.data)||void 0===n?void 0:n.image)&&[{uid:null===(r=Y.data)||void 0===r?void 0:r.id,name:null!==(m=Y.data)&&void 0!==m&&m.image?"..."+(null===(Z=Y.data)||void 0===Z?void 0:Z.image.substr(Y.data.image.length-20,Y.data.image.length)):"",status:"done",url:g.lj+(null===(v=Y.data)||void 0===v?void 0:v.image)}]})]}),(0,j.jsxs)("div",{className:l.Z.footer,children:[(0,j.jsx)(s.op,{size:"normal",fontSize:"sm",onClick:y,type:"plain",children:"Cancel"}),(0,j.jsx)(s.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:null===Y||void 0===Y?void 0:Y.buttonLoading,children:"Submit"})]})]})})},k=n(5900),S=n(21680),w=n(41586),I=n(98676),R=n(3109),A=n(98505),M=n(70815),L=n(85554),E=function(e){var t=e.record,n=e.onEditIconClick,r=e.reloadTableData,d=e.permissions.deleteSitePagesContent,s=(0,a.useState)({confirmLoading:!1,openPopConfirm:!1}),u=(0,i.Z)(s,2),g=u[0],h=u[1],f=(0,a.useMemo)((function(){return new x}),[]);return(0,j.jsxs)("div",{className:l.Z.actions,children:[(0,j.jsx)("span",{onClick:function(){return n(t)},children:(0,j.jsx)("img",{src:"/images/editicon.svg",alt:""})}),(0,j.jsx)(k.Z,{open:g.openPopConfirm,placement:"top",title:"Are you sure?",onConfirm:function(){if(h((0,o.Z)((0,o.Z)({},g),{},{confirmLoading:!0})),!1===d)return c.ZP.error("You don't have permission to delete this record, please contact your admin."),void h((0,o.Z)((0,o.Z)({},g),{},{openPopConfirm:!1}));f.deleteRecord(t.id).then((function(e){h((0,o.Z)((0,o.Z)({},g),{},{openPopConfirm:!1,confirmLoading:!1})),r()})).catch((function(e){h((0,o.Z)((0,o.Z)({},g),{},{confirmLoading:!1}))}))},onCancel:function(){return h((0,o.Z)((0,o.Z)({},g),{},{openPopConfirm:!1}))},okButtonProps:{loading:g.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:function(e){e||h((0,o.Z)((0,o.Z)({},g),{},{openPopConfirm:!1}))},children:(0,j.jsx)(I.Z,{className:l.Z.bg__red,onClick:function(){h((0,o.Z)((0,o.Z)({},g),{},{openPopConfirm:!0}))}})})]})};function T(e){var t=e.tableData,n=e.tableLoading,o=e.onEditIconClick,i=e.reloadTableData,a=(0,L.v9)((function(e){return e.usersReducer})).userPermissions,r=new x,d=function(e,t){return r.updateRecord({isPublished:e},t)},c=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,t,n){return n+1},width:"5%"},{title:"Title",dataIndex:"localization",key:"localization",render:function(e,t){return(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(R.Z,{color:"dark-main",size:"sm",weight:"bold",children:t.localization[0].title})})}},{title:"Country",dataIndex:"country",key:"country",render:function(e,t){return(0,j.jsx)(R.Z,{color:"dark-sub",size:"sm",children:null!==t&&void 0!==t&&t.country?null===t||void 0===t?void 0:t.country.name:""})}},{title:"Image",dataIndex:"image",key:"image",render:function(e,t){return e?(0,j.jsx)(S.Z,{width:50,height:50,src:"".concat(g.lj).concat(e),alt:t.imageAlt,preview:!1,rootClassName:"object-fit-contain"}):(0,j.jsx)(j.Fragment,{})}},{title:"Date",dataIndex:"date",key:"date",render:function(e,t){return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(R.Z,{color:"dark-sub",size:"sm",children:"Added: ".concat((0,A.Ny)(t.addedDate,"MM dd yy"))}),(0,j.jsx)(R.Z,{color:"dark-sub",size:"sm",children:"Modified: ".concat(t.modifiedDate?(0,A.Ny)(null===t||void 0===t?void 0:t.modifiedDate,"MM dd yy"):"Not Modified")})]})}},{title:"Published",dataIndex:"isPublished",key:"isPublished",render:function(e,t){return(0,j.jsx)(M.r,{checked:e,onChange:d,recordId:t.id,allowChange:a.updateSitePagesContent})}},{title:"Actions",dataIndex:"actions",key:"actions",render:function(e,t){return(0,j.jsx)(E,{record:t,onEditIconClick:o,reloadTableData:i,permissions:a})}}];return(0,j.jsx)("div",{className:l.Z.antdTableWrapper,children:(0,j.jsx)(w.Z,{sticky:!0,dataSource:t,columns:c,pagination:!1,scroll:{x:991},loading:n,rowKey:function(e){return"site-pages-content-".concat(e.id)}})})}var N=n(31513),z=n(98276),D=n(23369),Y=n(18515),F=n(3798),B=[{text:"Home",isLink:!0,path:"/"},{isLink:!0,text:"Site Settings",path:"/siteSettings"},{isLink:!0,text:"Site Pages",path:"/siteSettings/site-pages"},{isLink:!0,text:"Pages Section",path:"/siteSettings/pages-section"},{isLink:!1,text:"Site Pages Section Content"}];var O=function(){var e,t=(0,F.aY)(D.f),n=(0,L.v9)((function(e){return e.usersReducer})).userPermissions,d=n.readSitePagesContent,l=n.createSitePagesContent,u=n.updateSitePagesContent,g=(0,a.useState)({editType:"new",recordId:0,openModal:!1}),h=(0,i.Z)(g,2),f=h[0],p=h[1],m=(0,a.useMemo)((function(){return new x}),[]),Z=(0,a.useMemo)((function(){return new C.Y}),[]),v=(0,b.lr)(),P=(0,i.Z)(v,2),k=P[0],S=P[1],w=Number(k.get("sectionId")),I=(0,a.useState)({isLoading:!1,error:{},data:[]}),R=(0,i.Z)(I,2),A=R[0],M=R[1],E=(0,a.useState)({isLoading:!1,error:{},data:[]}),O=(0,i.Z)(E,2),V=O[0],q=O[1],_=function(){!1!==l?p((0,o.Z)((0,o.Z)({},f),{},{openModal:!f.openModal,editType:"new"})):c.ZP.error("You don't have permission to create new record")},H=function(){M((0,o.Z)((0,o.Z)({},A),{},{loading:!0})),m.getAllRecordsByCategory(w).then((function(e){M((0,o.Z)((0,o.Z)({},A),e.data))})).catch((function(e){}))};return(0,a.useEffect)((function(){q((0,o.Z)((0,o.Z)({},V),{},{loading:!0})),Z.getAllRecords().then((function(e){q(e.data)})).catch((function(e){}))}),[]),(0,a.useEffect)((function(){H()}),[w]),(0,j.jsxs)(r.default,{permissionSlug:t,children:[(0,j.jsx)(s.mr,{heading:"Section Content of",buttonText:"Add New Content",onButtonClick:_,breadCrumbData:B,showAdd:!0===l,children:(0,j.jsx)("div",{children:(0,j.jsx)(N.Z,{onChange:function(e){return S({sectionId:e.toString()})},className:"w-200",defaultValue:w,placeholder:"Choose section",loading:V.loading,options:null===V||void 0===V||null===(e=V.data)||void 0===e?void 0:e.map((function(e){return{label:e.title,value:e.id}}))})})}),w?(0,j.jsxs)(j.Fragment,{children:[!0===d&&(0,j.jsx)(T,{tableData:null===A||void 0===A?void 0:A.data.pagesContent,tableLoading:A.loading,onEditIconClick:function(e){!1!==u?p((0,o.Z)((0,o.Z)({},f),{},{editType:"edit",recordId:e.id,openModal:!0})):c.ZP.error("You don't have permission to update this record")},reloadTableData:H}),!1===d&&(0,j.jsx)(Y.a$,{mainMessage:"You don't have permission to view this data"}),f.openModal&&(0,j.jsx)(y,{record:f.recordId,type:f.editType,reloadTableData:H,onCancel:_,openModal:f.openModal,permissions:n})]}):(0,j.jsx)(z.Z,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:150},description:(0,j.jsx)("span",{children:"Please select a page section to edit its content"})})]})}},59816:function(e,t,n){n.d(t,{Y:function(){return d}});var o=n(43144),i=n(15671),a=n(49075),r=n(3135),d=(0,o.Z)((function e(){var t=this;(0,i.Z)(this,e),this.endPoint="country",this.allEndpoint="country/all",this.getAllRecords=function(){return a.Z.get(t.allEndpoint)},this.getAvailableRecords=function(){return a.Z.get("".concat(t.endPoint,"/available-country"))},this.getRecordById=function(e){return a.Z.get("".concat(t.endPoint,"/").concat(e))},this.deleteRecord=function(e){return a.Z.delete("".concat(t.endPoint,"/").concat(e))},this.createRecord=function(e){return a.Z.post(t.endPoint+"/",e,{headers:r.C})},this.updateRecord=function(e,n){return a.Z.patch("".concat(t.endPoint,"/").concat(n),e,{headers:r.C})}}))},71522:function(e,t,n){n.d(t,{Y:function(){return d}});var o=n(43144),i=n(15671),a=n(49075),r=n(3135),d=(0,o.Z)((function e(){var t=this;(0,i.Z)(this,e),this.endPoint="site-pages-section",this.createRecord=function(e){return a.Z.post(t.endPoint+"/",e,{headers:r.C})},this.getAllRecords=function(e){return a.Z.get(t.endPoint,{params:e})},this.getRecordById=function(e){return a.Z.get("".concat(t.endPoint,"/").concat(e,"?all=true"))},this.updateRecord=function(e,n){return a.Z.patch("".concat(t.endPoint,"/").concat(n),e,{headers:r.C})},this.allowMultiples=function(e){return a.Z.patch("".concat(t.endPoint,"/allowMultiples/").concat(e))},this.disallowMultiples=function(e){return a.Z.patch("".concat(t.endPoint,"/disallowMultiples/").concat(e))},this.deleteRecord=function(e){return a.Z.delete("".concat(t.endPoint,"/").concat(e))}}))},23369:function(e,t,n){n.d(t,{f:function(){return o}});var o=function(e){return e.CREATE="createSitePagesContent",e.UPDATE="updateSitePagesContent",e.DELETE="deleteSitePagesContent",e.READ="readSitePagesContent",e}({})}}]);