"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[6761],{80646:function(e,n,t){t.r(n),t.d(n,{default:function(){return D}});var o=t(74165),i=t(15861),r=t(1413),a=t(29439),c=t(47313),d=t(31513),s=t(25019),l=t(55291),u=t(82626),p=t(3113),h=t(49355),m=t(46646),f=t(40169),Z=t(18223),x=t(59816),g=t(46417),v=(d.Z.Option,function(e){var n=e.openModal,t=e.onCancel,o=e.type,i=e.record,d=e.reloadTableData,v=e.permissions,b=v.createAccount,y=v.updateAccount,C=e.callback,j=s.Z.useForm(),w=(0,a.Z)(j,1)[0],k=new Z.Y,P=((0,c.useMemo)((function(){return new x.Y}),[]),(0,c.useState)()),A=(0,a.Z)(P,2),I=A[0],R=A[1],T=function(e){var n=(0,f.P)(e);if("string"==typeof n.message)R((0,r.Z)((0,r.Z)({},I),{},{error:n.message}));else{var t=(0,m.O)(n.message,[]);w.setFields(t),R((0,r.Z)((0,r.Z)({},I),{},{error:""}))}},L=(0,c.useCallback)((function(){k.getRecordById(i).then((function(e){e.data&&e.data.data&&(w.setFieldsValue((0,r.Z)({},e.data.data)),R((0,r.Z)((0,r.Z)({},e.data),{},{loading:!1})))})).catch((function(e){T(e)}))}),[w,i,k]);(0,c.useEffect)((function(){"edit"===o?(R({loading:!0}),L()):w.resetFields()}),[]);return(0,g.jsx)(u.P0,{visible:n,closable:!0,onCancel:t,titleText:"edit"===o?"Edit Account":"Add New Account",showFooter:!1,children:null!==I&&void 0!==I&&I.loading?(0,g.jsx)(h.Z,{items:3}):(0,g.jsxs)(s.Z,{className:p.Z.form,onFinish:function(e){switch(R((0,r.Z)((0,r.Z)({},I),{},{buttonLoading:!0})),o){case"edit":!0===y?k.updateRecord(e,i).then((function(e){d(),t(),R((function(e){return(0,r.Z)((0,r.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){T(e),R((function(e){return(0,r.Z)((0,r.Z)({},e),{},{buttonLoading:!1})}))})):(R((function(e){return(0,r.Z)((0,r.Z)({},e),{},{buttonLoading:!1})})),l.ZP.error("You don't have permission to update this record"));break;case"new":!0===b?k.createRecord(e).then((function(e){var n=(null===e||void 0===e?void 0:e.data).data;d(),C&&C(null===n||void 0===n?void 0:n.id),t(),R((function(e){return(0,r.Z)((0,r.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){T(e),R((function(e){return(0,r.Z)((0,r.Z)({},e),{},{buttonLoading:!1})}))})):(R((function(e){return(0,r.Z)((0,r.Z)({},e),{},{buttonLoading:!1})})),l.ZP.error("You don't have permission to create this record"))}},form:w,children:[(null===I||void 0===I?void 0:I.error)&&(0,g.jsx)(u.EQ,{description:null===I||void 0===I?void 0:I.error,isClosable:!0,onClose:function(){R((0,r.Z)((0,r.Z)({},I),{},{error:""}))}}),(0,g.jsx)(s.Z.Item,{name:"title",rules:[{required:!0,message:"Please add a title"}],children:(0,g.jsx)(u.t7,{size:"w100",label:"Title",asterisk:!0,type:"text",placeHolder:"Enter Account title"})}),(0,g.jsx)(s.Z.Item,{name:"accountCode",children:(0,g.jsx)(u.t7,{size:"w100",label:"Account Code",type:"text"})}),(0,g.jsx)(s.Z.Item,{name:"xeroType",children:(0,g.jsx)(u.t7,{size:"w100",label:"Xero Type",type:"text"})}),(0,g.jsx)(s.Z.Item,{name:"description",children:(0,g.jsx)(u.t7,{size:"w100",label:"Description",type:"text"})}),(0,g.jsx)(s.Z.Item,{name:"bankAccountNumber",children:(0,g.jsx)(u.t7,{size:"w100",label:"Bank Account Number",type:"text"})}),(0,g.jsx)(s.Z.Item,{name:"showInExpenseClaims",children:(0,g.jsx)(u.AP,{label:"Show In Expense Claims",options:[{value:!0,label:"Yes"},{value:!1,label:"No"}]})}),(0,g.jsxs)("div",{className:"d-flex justify-end",children:[(0,g.jsx)(u.op,{size:"normal",fontSize:"sm",onClick:t,type:"plain",children:"Cancel"}),(0,g.jsx)(u.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:null===I||void 0===I?void 0:I.buttonLoading,children:"edit"===o?"Edit Account":"Add Account"})]})]})})}),b=t(5900),y=t(86136),C=t(41586),j=t(98676),w=t(3109),k=t(85554),P=t(3798),A=function(e){var n=e.record,t=e.onEditIconClick,o=e.reloadTableData,i=e.permissions.deleteAccount,d=(0,c.useState)({confirmLoading:!1,openPopConfirm:!1}),s=(0,a.Z)(d,2),u=s[0],h=s[1],m=new Z.Y;return(0,g.jsxs)("div",{className:p.Z.actions,children:[(0,g.jsx)("span",{onClick:function(){return t(n)},children:(0,g.jsx)("img",{src:"/images/editicon.svg",alt:""})}),(0,g.jsx)(b.Z,{open:u.openPopConfirm,placement:"top",title:"Are you sure?",onConfirm:function(){if(h((0,r.Z)((0,r.Z)({},u),{},{confirmLoading:!0})),!1===i)return l.ZP.error("You don't have permission to delete this record, please contact your admin."),void h((0,r.Z)((0,r.Z)({},u),{},{openPopConfirm:!1}));m.deleteRecord(n.id).then((function(e){h((0,r.Z)((0,r.Z)({},u),{},{openPopConfirm:!1,confirmLoading:!1})),o()})).catch((function(e){h((0,r.Z)((0,r.Z)({},u),{},{confirmLoading:!1}))}))},onCancel:function(){return h((0,r.Z)((0,r.Z)({},u),{},{openPopConfirm:!1}))},okButtonProps:{loading:u.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:function(e){e||h((0,r.Z)((0,r.Z)({},u),{},{openPopConfirm:!1}))},children:(0,g.jsx)(j.Z,{className:p.Z.bg__red,onClick:function(){h((0,r.Z)((0,r.Z)({},u),{},{openPopConfirm:!0}))}})})]})};function I(e){var n=e.tableData,t=e.tableLoading,o=e.onEditIconClick,i=e.reloadTableData,r=e.meta,d=(e.filters,(0,k.v9)((function(e){return e.usersReducer})).userPermissions),s=(0,c.useState)(""),l=(0,a.Z)(s,2),u=l[0],p=l[1],h=(0,c.useState)({page:(null===r||void 0===r?void 0:r.page)||1,perPage:(null===r||void 0===r?void 0:r.perPage)||10}),m=(0,a.Z)(h,2),f=m[0],Z=m[1],x=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,n,t){return(0,P.k7)(t,f)},width:"60px"},{title:"Title",dataIndex:"title",key:"title",render:function(e,n){return(0,g.jsx)(w.Z,{color:"dark-main",size:"sm",weight:"bold",children:n.title})}},{title:"Description",dataIndex:"description",key:"description",render:function(e,n){return(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(w.Z,{color:"dark-main",size:"sm",weight:"bold",children:(null===n||void 0===n?void 0:n.description)||""})})}},{title:"Account Code",dataIndex:"accountCode",key:"accountCode",render:function(e,n){return(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(w.Z,{color:"dark-main",size:"sm",weight:"bold",children:n.accountCode})})}},{title:"Expense Claims",dataIndex:"showInExpenseClaims",key:"showInExpenseClaims",render:function(e,n){return(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(w.Z,{color:"dark-main",size:"sm",weight:"bold",children:n.showInExpenseClaims?"Yes":"No"})})}},{title:"Xero Reference",dataIndex:"xeroReference",key:"xeroReference",render:function(e,n){return(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(w.Z,{color:"dark-main",size:"sm",weight:"bold",children:n.xeroReference})})}},{title:"Xero Type",dataIndex:"xeroType",key:"xeroType",render:function(e,n){return(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(w.Z,{color:"dark-main",size:"sm",weight:"bold",children:n.xeroType})})}},{title:"Actions",dataIndex:"actions",key:"actions",render:function(e,n){return(0,g.jsx)(A,{record:n,onEditIconClick:o,reloadTableData:i,permissions:d})}}];return(0,g.jsxs)("div",{children:[(0,g.jsx)(y.Z,{type:"input",placeholder:"Search by title",onChange:function(e){p(e.target.value)},allowClear:!0,style:{border:"1.5px solid var(--color-border)",borderRadius:"0.25rem",width:"25%",marginBottom:"1rem"},prefix:(0,g.jsx)("img",{style:{padding:"0rem 0.5rem"},src:"/images/searchIcon.svg",alt:""})}),(0,g.jsx)(C.Z,{sticky:!0,dataSource:null===n||void 0===n?void 0:n.filter((function(e){var n,t,o,i;return(null===e||void 0===e||null===(n=e.title)||void 0===n||null===(t=n.toLowerCase())||void 0===t?void 0:t.includes(u.toLowerCase()))||(null===e||void 0===e||null===(o=e.accountCode)||void 0===o||null===(i=o.toLowerCase())||void 0===i?void 0:i.includes(u.toLowerCase()))})),columns:x,scroll:{x:991},loading:t,rowKey:function(e){return"Account-".concat(e.id)},pagination:{current:null===r||void 0===r?void 0:r.page,total:null===r||void 0===r?void 0:r.total,hideOnSinglePage:!0,pageSize:null===r||void 0===r?void 0:r.perPage,onChange:function(e,n){Z({page:e,perPage:n})}}})]})}var R=t(59491),T=t(18515),L=t(54060),S=t(29079),E=t(14086),z=t(19552),Y=[{text:"Home",isLink:!0,path:"/"},{isLink:!1,text:"Account"}];var D=function(){var e=(0,c.useState)(!1),n=(0,a.Z)(e,2),t=n[0],d=n[1],s=(0,P.aY)(E.n),p=(0,k.v9)((function(e){return e.usersReducer})).userPermissions,h=p.readAccount,m=p.createAccount,f=p.updateAccount,x=(0,c.useState)({page:1,perPage:25}),b=(0,a.Z)(x,1)[0],y=(0,c.useState)({editType:"new",recordId:0,openModal:!1}),C=(0,a.Z)(y,2),j=C[0],w=C[1],A=new Z.Y,D=new z.l,F=(0,S.$5)({method:A.getAllRecords,initialQuery:(0,r.Z)({},b)}),N=F.data,M=F.onRefresh,B=F.loading,O=F.meta,X=function(){!1!==m?w((0,r.Z)((0,r.Z)({},j),{},{openModal:!j.openModal,editType:"new"})):l.ZP.error("You don't have permission to create new record")},_=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.prev=1,e.next=4,D.syncAccounts();case 4:l.ZP.success("Synced successfully"),M(),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),n=(0,P.S3)(e.t0),l.ZP.error(n||"Something went wrong");case 12:return e.prev=12,d(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,8,12,15]])})));return function(){return e.apply(this,arguments)}}();return(0,g.jsxs)(L.Z,{permissionSlug:s,children:[(0,g.jsx)(u.mr,{heading:"Account",buttonText:"Add Account",onButtonClick:X,breadCrumbData:Y,showAdd:!0===m,excelExport:(0,g.jsx)(R.Z,{loading:t,style:{marginRight:"1rem",height:"2.25rem"},onClick:_,children:"Sync with Xero"})}),!0===h&&(0,g.jsx)(I,{tableData:N,tableLoading:B,onEditIconClick:function(e){!1!==f?w((0,r.Z)((0,r.Z)({},j),{},{editType:"edit",recordId:e.id,openModal:!0})):l.ZP.error("You don't have permission to update this record")},reloadTableData:M,meta:O,filters:b}),!1===h&&(0,g.jsx)(T.a$,{mainMessage:"You don't have permission to view this data"}),j.openModal&&(0,g.jsx)(v,{record:j.recordId,type:j.editType,reloadTableData:function(){return M()},onCancel:X,openModal:j.openModal,permissions:p})]})}},18223:function(e,n,t){t.d(n,{Y:function(){return a}});var o=t(43144),i=t(15671),r=t(49075),a=(0,o.Z)((function e(){var n=this;(0,i.Z)(this,e),this.endPoint="account",this.getAllRecords=function(e){return r.Z.get(n.endPoint,{params:e})},this.getRecordById=function(e){return r.Z.get("".concat(n.endPoint,"/").concat(e))},this.deleteRecord=function(e){return r.Z.delete("".concat(n.endPoint,"/").concat(e))},this.createRecord=function(e){return r.Z.post(n.endPoint,e)},this.updateRecord=function(e,t){return r.Z.patch("".concat(n.endPoint,"/").concat(t),e)}}))},59816:function(e,n,t){t.d(n,{Y:function(){return c}});var o=t(43144),i=t(15671),r=t(49075),a=t(3135),c=(0,o.Z)((function e(){var n=this;(0,i.Z)(this,e),this.endPoint="country",this.allEndpoint="country/all",this.getAllRecords=function(){return r.Z.get(n.allEndpoint)},this.getAvailableRecords=function(){return r.Z.get("".concat(n.endPoint,"/available-country"))},this.getRecordById=function(e){return r.Z.get("".concat(n.endPoint,"/").concat(e))},this.deleteRecord=function(e){return r.Z.delete("".concat(n.endPoint,"/").concat(e))},this.createRecord=function(e){return r.Z.post(n.endPoint+"/",e,{headers:a.C})},this.updateRecord=function(e,t){return r.Z.patch("".concat(n.endPoint,"/").concat(t),e,{headers:a.C})}}))}}]);