"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[8061],{68061:function(e,t,n){n.r(t),n.d(t,{default:function(){return T}});var a=n(4942),i=n(1413),r=n(29439),o=n(47313),d=n(7532),s=n(25019),c=n(55291),l=n(82626),u=n(17327),v=n(49355),m=n(46646),f=n(40169),p=n(43144),h=n(15671),y=n(49075),Z=(0,p.Z)((function e(){var t=this;(0,h.Z)(this,e),this.endPoint="credits-rate",this.getAllRecords=function(e){return y.Z.get(t.endPoint,{params:e})},this.getRecordById=function(e){return y.Z.get("".concat(t.endPoint,"/").concat(e))},this.createRecord=function(e){return y.Z.post(t.endPoint+"/",e)}})),g=n(59816),x=n(46417),b=function(e){var t=e.openModal,n=e.onCancel,a=e.type,d=e.reloadTableData,p=e.permissions.createCreditsRate,h=s.Z.useForm(),y=(0,r.Z)(h,1)[0],b=(0,o.useMemo)((function(){return new Z}),[]),C=(0,o.useMemo)((function(){return new g.Y}),[]),R=(0,o.useState)(),j=(0,r.Z)(R,2),k=j[0],A=j[1],I=(0,o.useState)([]),P=(0,r.Z)(I,2),w=P[0],S=P[1],D=(0,o.useCallback)((function(){C.getAllRecords().then((function(e){var t;null!==e&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.data&&S(e.data.data)}))}),[C]);(0,o.useEffect)((function(){"new"===a&&D()}),[a,D]),(0,o.useEffect)((function(){"edit"===a?A({loading:!0}):y.resetFields()}),[t,a,y]);return(0,x.jsx)(l.P0,{visible:t,closable:!0,onCancel:n,titleText:"edit"===a?"Edit Credit Rate":"Add New Credit Rate",showFooter:!1,children:null!==k&&void 0!==k&&k.loading?(0,x.jsx)(v.Z,{items:10}):(0,x.jsxs)(s.Z,{className:u.Z.form,onFinish:function(e){A((0,i.Z)((0,i.Z)({},k),{},{buttonLoading:!0})),e.countryId=Number(e.countryId),"new"===a?!0===p?b.createRecord(e).then((function(e){d(),n(),A((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){!function(e){var t=(0,f.P)(e);if("string"==typeof t.message)A((0,i.Z)((0,i.Z)({},k),{},{error:t.message}));else{var n=(0,m.O)(t.message,[]);y.setFields(n),A((0,i.Z)((0,i.Z)({},k),{},{error:""}))}}(e),A((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})}))})):(A((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})})),c.ZP.error("You do not have permission to create a new credit rate")):A((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})}))},form:y,children:[(null===k||void 0===k?void 0:k.error)&&(0,x.jsx)(l.EQ,{description:null===k||void 0===k?void 0:k.error,isClosable:!0,onClose:function(){A((0,i.Z)((0,i.Z)({},k),{},{error:""}))}}),(0,x.jsxs)("div",{children:[(0,x.jsx)(s.Z.Item,{name:"credits",rules:[{required:!0,message:"Please add credits"}],children:(0,x.jsx)(l.t7,{size:"w100",label:"Credits",asterisk:!0,type:"number"})}),(0,x.jsx)(s.Z.Item,{name:"rate",rules:[{required:!0,message:"Please add a rate"}],children:(0,x.jsx)(l.t7,{size:"w100",label:"Rate",asterisk:!0,type:"number"})})]}),(0,x.jsx)("div",{children:(0,x.jsx)(s.Z.Item,{name:"countryId",rules:[{required:!0,message:"Please select a country"}],children:(0,x.jsx)(l.AP,{label:"Country",options:null===w||void 0===w?void 0:w.map((function(e){return{label:e.name,value:e.id}}))})})}),(0,x.jsxs)("div",{className:u.Z.footer,children:[(0,x.jsx)(l.op,{size:"normal",fontSize:"sm",onClick:n,type:"plain",children:"Cancel"}),(0,x.jsx)(l.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:null===k||void 0===k?void 0:k.buttonLoading,children:"Submit"})]})]})})},C=n(66204),R=n(41586),j=n(3109),k=n(98505);function A(e){var t=e.tableData,n=e.tableLoading,a=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,t,n){return n+1},width:"60px"},{title:"Credits",dataIndex:"credits",key:"credits",render:function(e){return(0,x.jsx)(j.Z,{color:"dark-main",size:"sm",weight:"bold",children:e})}},{title:"Rate",dataIndex:"rate",key:"rate",render:function(e,t){return(0,x.jsx)(j.Z,{color:"dark-main",size:"sm",weight:"bold",children:"".concat(t.currency.symbol," ").concat(e.toFixed(2))})}},{title:"Rate Per Credit",dataIndex:"ratePerCredit",key:"ratePerCredit",render:function(e){return(0,x.jsx)(j.Z,{color:"dark-main",size:"sm",weight:"bold",children:e.toFixed(4)})}},{title:"Country",dataIndex:"country",key:"country",render:function(e){return(0,x.jsx)(j.Z,{color:"dark-main",size:"sm",weight:"bold",children:e.name})}},{title:"Active",dataIndex:"isActive",key:"isActive",render:function(e,t){return(0,x.jsx)("div",{children:!0===e?(0,x.jsx)(C.Z,{color:"#00A884",children:"Active"}):(0,x.jsx)(C.Z,{color:"#f50",children:"Inactive"})})}},{title:"Date Added",dataIndex:"addedDate",key:"addedDate",render:function(e){return(0,x.jsx)(j.Z,{color:"dark-sub",size:"sm",children:(0,k.Ny)(e,"dd M,yy-t")})},width:"200px"}];return(0,x.jsx)("div",{className:u.Z.antdTableWrapper,children:(0,x.jsx)(R.Z,{sticky:!0,dataSource:t,columns:a,pagination:!1,loading:n,rowKey:function(e){return"credits-rate-".concat(e.id)}})})}var I=n(37936),P=n(3798),w=function(e){return e.CREATE="createCreditsRate",e.UPDATE="updateCreditsRate",e.DELETE="deleteCreditsRate",e.READ="readCreditsRate",e}({}),S=n(85554),D=n(18515),E=[{text:"Home",isLink:!0,path:"/"},{isLink:!0,text:"Site Settings",path:"/siteSettings"},{isLink:!1,text:"Credits Rate"}];var T=function(){var e,t,n,s,u=(0,P.aY)(w),v=(0,S.v9)((function(e){return e.usersReducer})).userPermissions,m=v.readCreditsRate,f=v.createCreditsRate,p=v.updateCreditsRate,h=(0,o.useState)({editType:"new",recordId:0,openModal:!1}),y=(0,r.Z)(h,2),C=y[0],R=y[1],j=new Z,T=(0,o.useMemo)((function(){return new g.Y}),[]),z=(0,o.useState)({data:[]}),M=(0,r.Z)(z,2),L=M[0],N=M[1],O=(0,o.useState)([]),F=(0,r.Z)(O,2),Y=F[0],U=F[1],X=(0,o.useCallback)((function(){T.getAllRecords().then((function(e){e.data&&e.data.data&&U(e.data.data)}))}),[T]),q=function(){!1!==f?R((0,i.Z)((0,i.Z)({},C),{},{openModal:!C.openModal,editType:"new"})):c.ZP.error("You don't have permission to create new record")},B=(0,o.useState)({dateRange:[""],countryId:0,rate:0,matchOperator:"",isActive:null}),_=(0,r.Z)(B,2),H=_[0],K=_[1],Q=(0,o.useState)(!1),W=(0,r.Z)(Q,2),$=W[0],G=W[1],J=function(e){var t=null===e||void 0===e?void 0:e.target,n=t.name,r=t.value;if("rate"===n&&!(0,P.hj)(r))return void c.ZP.error("Rate must be only numbers");K((0,i.Z)((0,i.Z)({},H),{},(0,a.Z)({},n,r)))},V=(0,o.useCallback)((function(e,t){e&&(G(!0),K((0,i.Z)((0,i.Z)({},H),{},(0,a.Z)({},e,t))))}),[H]),ee=(0,o.useCallback)((function(e){N((0,i.Z)((0,i.Z)({},L),{},{loading:!0})),j.getAllRecords(e).then((function(e){N(e.data)})).catch((function(e){}))}),[j]),te=(0,o.useCallback)((function(){var e,t,n=(null===(e=H.dateRange)||void 0===e?void 0:e[0])||"",a=(null===(t=H.dateRange)||void 0===t?void 0:t[1])||"",i=n?(0,k.Ny)(n,"yy-mm-dd"):void 0,r=a?(0,k.Ny)(a,"yy-mm-dd"):void 0,o={countryId:H.countryId||void 0,rate:H.rate||void 0,matchOperator:H.matchOperator||void 0,isActive:H.isActive||void 0,fromDate:i,toDate:r};ee(o)}),[H]),ne=(0,o.useCallback)((function(e,t){var n,a,i=(null===(n=H.dateRange)||void 0===n?void 0:n[0])||"",r=(null===(a=H.dateRange)||void 0===a?void 0:a[1])||"",o=i?(0,k.Ny)(i,"yy-mm-dd"):void 0,d=r?(0,k.Ny)(r,"yy-mm-dd"):void 0,s={page:e,perPage:t,countryId:H.countryId||void 0,rate:H.rate||void 0,matchOperator:H.matchOperator||void 0,isActive:H.isActive||void 0,fromDate:o,toDate:d};ee(s)}),[H]);return(0,o.useEffect)((function(){$&&te();var e=setTimeout((function(){G(!1)}),2e3);return function(){return clearTimeout(e)}}),[$,H,te]),(0,o.useEffect)((function(){ee(),X()}),[]),(0,x.jsxs)(d.default,{permissionSlug:u,children:[(0,x.jsx)(l.mr,{heading:"Credits Rate",buttonText:"Add New Credits Rate",onButtonClick:q,breadCrumbData:E,showAdd:!0===f,filters:!0===m?(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{children:(0,x.jsx)(l.Xy,{type:"datepicker",label:"Date",name:"dateRange",onChange:function(e){K((0,i.Z)((0,i.Z)({},H),{},{dateRange:e}))},onReset:function(){return V("dateRange",[])},onUpdate:te})}),(0,x.jsx)("div",{children:(0,x.jsx)(l.Xy,{type:"input",label:"Rate",name:"rate",value:(null===H||void 0===H?void 0:H.rate)>0?String(null===H||void 0===H?void 0:H.rate):"",onChange:J,onReset:function(){return V("rate","")},onUpdate:te})}),(0,x.jsx)("div",{children:(0,x.jsx)(l.Xy,{type:"radio",label:"Rate Operator",name:"matchOperator",options:Object.entries(I.xC).map((function(e){var t=(0,r.Z)(e,2),n=t[0],a=t[1];return{label:(0,P.kC)(n),value:a}})),value:String(null===H||void 0===H?void 0:H.matchOperator),onChange:J,onReset:function(){return V("matchOperator","")},onUpdate:te})}),(0,x.jsx)("div",{children:(0,x.jsx)(l.Xy,{type:"radio",label:"Status",name:"isActive",options:[{label:"Active",value:"true"},{label:"Inactive",value:"false"}],value:null!==H.isActive?String(H.isActive):"",onChange:J,onReset:function(){return V("isActive","")},onUpdate:te})}),(0,x.jsx)("div",{children:(0,x.jsx)(l.Xy,{type:"radio",label:"Country",name:"countryId",options:Y.map((function(e){return{label:e.name,value:"".concat(e.id)}})),value:H.countryId>0?String(null===H||void 0===H?void 0:H.countryId):"",onChange:J,onReset:function(){return V("countryId","")},onUpdate:te})})]}):null}),!0===m&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(A,{tableData:L.data,tableLoading:L.loading,onEditIconClick:function(e){!1!==p?R((0,i.Z)((0,i.Z)({},C),{},{editType:"edit",recordId:e.id,openModal:!0})):c.ZP.error("You don't have permission to update record")},reloadTableData:ee}),(0,x.jsx)(l.tl,{total:null===L||void 0===L||null===(e=L.meta)||void 0===e?void 0:e.total,current:null===L||void 0===L||null===(t=L.meta)||void 0===t?void 0:t.page,defaultPageSize:null!==L&&void 0!==L&&null!==(n=L.meta)&&void 0!==n&&n.perPage?null===L||void 0===L||null===(s=L.meta)||void 0===s?void 0:s.perPage:10,pageSizeOptions:[10,20,50,100],onChange:ne})]}),!1===m&&(0,x.jsx)(D.a$,{mainMessage:"You don't have permission to view this data"}),C.openModal&&(0,x.jsx)(b,{type:C.editType,reloadTableData:ee,onCancel:q,openModal:C.openModal,permissions:v})]})}},59816:function(e,t,n){n.d(t,{Y:function(){return d}});var a=n(43144),i=n(15671),r=n(49075),o=n(3135),d=(0,a.Z)((function e(){var t=this;(0,i.Z)(this,e),this.endPoint="country",this.allEndpoint="country/all",this.getAllRecords=function(){return r.Z.get(t.allEndpoint)},this.getAvailableRecords=function(){return r.Z.get("".concat(t.endPoint,"/available-country"))},this.getRecordById=function(e){return r.Z.get("".concat(t.endPoint,"/").concat(e))},this.deleteRecord=function(e){return r.Z.delete("".concat(t.endPoint,"/").concat(e))},this.createRecord=function(e){return r.Z.post(t.endPoint+"/",e,{headers:o.C})},this.updateRecord=function(e,n){return r.Z.patch("".concat(t.endPoint,"/").concat(n),e,{headers:o.C})}}))}}]);