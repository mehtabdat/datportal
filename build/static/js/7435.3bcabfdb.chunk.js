"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[7435],{50008:function(e,n,t){t.d(n,{t:function(){return a}});var r=t(47312),o="styles_card__cH2rF",i=t(46417),a=function(){return(0,i.jsx)("div",{className:o,children:(0,i.jsx)(r.Z,{active:!0})})}},82930:function(e,n,t){t.r(n),t.d(n,{default:function(){return D}});var r=t(93433),o=t(1413),i=t(29439),a=t(82626),s=t(54060),l=t(22698),d=t(47313),c=t(9057),u=t(55291),f=t(49958),v=t(29079),p=t(95980),h=t(69309),m=t(25019),Z=t(31513),g=t(98276),x=t(3113),j=t(49355),y=t(46646),b=t(40169),P=t(35367),w=t(46417),R=h.Z.RangePicker,S=function(e){var n,t=e.openModal,r=e.onCancel,s=e.reloadTableData,l=e.permissions.createLeaveRequest,c=m.Z.useForm(),f=(0,i.Z)(c,1)[0],v=new p.c,h=(0,d.useState)(),S=(0,i.Z)(h,2),C=S[0],L=S[1],k=new P.F,F=(0,d.useState)([]),q=(0,i.Z)(F,2),z=q[0],I=q[1],N=(0,d.useCallback)((function(){k.getAllPublishedRecords({perPage:100}).then((function(e){I(e.data.data)})).catch((function(e){u.ZP.error(e.response.data.message)}))}),[]);(0,d.useEffect)((function(){f.resetFields(),0===z.length&&N()}),[t]);return(0,w.jsx)(a.P0,{visible:t,closable:!0,onCancel:r,titleText:"Add New Request",showFooter:!1,children:null!==C&&void 0!==C&&C.loading?(0,w.jsx)(j.Z,{items:10}):(0,w.jsxs)(m.Z,{className:x.Z.form,onFinish:function(e){var n;L((0,o.Z)((0,o.Z)({},C),{},{buttonLoading:!0}));var t=e.files,i=new FormData,a=["files"];Object.entries(e).forEach((function(n){a.includes(n[0])||("leaveDates"===n[0]?(i.append("leaveFrom",e.leaveDates[0]._d.toISOString()),i.append("leaveTo",e.leaveDates[1]._d.toISOString())):i.append(n[0],n[1]))}));var d=null===t||void 0===t||null===(n=t.fileList)||void 0===n?void 0:n.map((function(e){return e.originFileObj}));if(null!==d&&void 0!==d&&d.length)for(var c=0;c<d.length;c++)i.append("files[]",d[c]);!0===l?v.createRecord(i).then((function(e){s(),r(),L((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})})),f.resetFields()})).catch((function(e){!function(e){var n=(0,b.P)(e);if("string"==typeof n.message)L((0,o.Z)((0,o.Z)({},C),{},{error:n.message}));else{var t=(0,y.O)(n.message,[]);f.setFields(t),L((0,o.Z)((0,o.Z)({},C),{},{error:""}))}}(e),L((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})}))})):(L((function(e){return(0,o.Z)((0,o.Z)({},e),{},{buttonLoading:!1})})),u.ZP.error("You don't have permission to create this record"))},form:f,children:[(null===C||void 0===C?void 0:C.error)&&(0,w.jsx)(a.EQ,{description:null===C||void 0===C?void 0:C.error,isClosable:!0,onClose:function(){L((0,o.Z)((0,o.Z)({},C),{},{error:""}))}}),(0,w.jsx)("div",{children:(0,w.jsx)(m.Z.Item,{name:"purpose",rules:[{required:!0,message:"Please add a purpose"}],children:(0,w.jsx)(a.t7,{size:"w100",label:"Purpose",asterisk:!0,type:"textArea",placeHolder:"Enter Purpose"})})}),(0,w.jsxs)("div",{style:{flexDirection:"column",gap:0},children:[(0,w.jsxs)("div",{style:{fontSize:"var(--font-size-sm)",color:"var(--color-dark-main)"},children:["Leave dates",(0,w.jsx)("span",{style:{color:"var(--color-red-yp)"},children:" *"})]}),(0,w.jsx)(m.Z.Item,{name:"leaveDates",rules:[{required:!0,message:"Please enter leave dates."}],children:(0,w.jsx)(R,{style:{width:"100%"}})})]}),(0,w.jsx)("div",{children:(0,w.jsxs)(m.Z.Item,{name:"leaveTypeId",rules:[{required:!0,message:"Please select a leave type"}],children:[(0,w.jsxs)("label",{className:"font-size-sm color-dark-main",children:["Leave Type  ",(0,w.jsx)("span",{className:"color-red-yp",children:"*"})]}),(0,w.jsx)(Z.Z,{allowClear:!0,style:{width:"100%"},defaultValue:null===C||void 0===C||null===(n=C.data)||void 0===n?void 0:n.leaveTypeId,placeholder:"Search for the leave type",className:"selectAntdCustom",onChange:function(e){return f.setFieldsValue({leaveTypeId:e})},showSearch:!0,onSearch:function(e){},optionFilterProp:"label",options:null===z||void 0===z?void 0:z.map((function(e){return{label:e.title,value:e.id}})),notFoundContent:(0,w.jsx)(g.Z,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:100},description:(0,w.jsx)("span",{children:"No data found, Please search for the leave type"})})})]})}),(0,w.jsx)("div",{children:(0,w.jsx)(a.wA,{name:"files",required:!1,multiple:!0})}),(0,w.jsxs)("div",{className:"d-flex justify-end mt-4",children:[(0,w.jsx)(a.op,{size:"normal",fontSize:"sm",onClick:r,type:"plain",children:"Cancel"}),(0,w.jsx)(a.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:null===C||void 0===C?void 0:C.buttonLoading,children:"Add Request"})]})]})})},C=t(85554),L=t(94037),k=t(47364),F=t(42623),q=t(84825),z=t(50008),I=t(3798),N=[{text:"Home",isLink:!0,path:"/"},{isLink:!0,text:"My Services",path:"/myservices"},{isLink:!1,text:"Leave Request"}],D=function(){var e=(0,I.aY)(L.t),n=(0,C.v9)((function(e){return e.usersReducer})).userPermissions,t=n.createLeaveRequest,h=(n.readLeaveRequest,(0,d.useState)({recordId:0,openModal:!1})),m=(0,i.Z)(h,2),Z=m[0],g=m[1],x=(0,d.useState)(!1),j=(0,i.Z)(x,2),y=j[0],b=j[1],P=(0,d.useState)({page:1,perPage:6}),R=(0,i.Z)(P,2),D=R[0],_=(R[1],(0,d.useMemo)((function(){return new p.c}),[])),A=(0,v.$5)({method:_.getOwnRecords,initialQuery:(0,o.Z)({},D)}),M=A.data,T=A.onRefresh,E=(A.setData,A.loading),O=A.meta,H=function(){!1!==t?g((0,o.Z)((0,o.Z)({},Z),{},{openModal:!Z.openModal})):u.ZP.error("You don't have permission to create new record")},V=(0,d.useState)(""),B=(0,i.Z)(V,2),Q=B[0],Y=(B[1],(0,F.N)(Q,500)),$=(0,d.useState)([]),G=(0,i.Z)($,2),J=(G[0],G[1]),K=(0,d.useMemo)((function(){return new q.z}),[]),U=(0,d.useCallback)((function(){Y&&K.getAllRecords({name:Y}).then((function(e){J((function(n){var t,o,i=null===e||void 0===e||null===(t=e.data)||void 0===t||null===(o=t.data)||void 0===o?void 0:o.filter((function(e){return!(null!==n&&void 0!==n&&n.find((function(n){return n.id===e.id})))}));return[].concat((0,r.Z)(n),(0,r.Z)(i))}))})).catch((function(e){u.ZP.error(e.response.data.message)}))}),[Y]);return(0,d.useEffect)((function(){U()}),[U]),(0,w.jsxs)(s.Z,{permissionSlug:e,children:[(0,w.jsx)(a.mr,{heading:"Leave Request",breadCrumbData:N,showAdd:!0===t,buttonText:"New Request",onButtonClick:H}),(0,w.jsx)("section",{className:l.Z.container,children:E?(0,r.Z)(new Array(6)).map((function(e,n){return(0,w.jsx)(z.t,{},"shimmer".concat(n))})):0!==(null===M||void 0===M?void 0:M.length)?null===M||void 0===M?void 0:M.map((function(e,n){return(0,w.jsx)(k._,{leaveRequest:e,onClick:function(){g((0,o.Z)((0,o.Z)({},Z),{},{recordId:e.id})),b(!0)}},n)})):(0,w.jsx)("div",{style:{margin:"auto"},children:(0,w.jsx)(a.I$,{description:"No requests found for the given filters"})})}),(0,w.jsx)(f.Z,{hideOnSinglePage:!0,current:null===O||void 0===O?void 0:O.page,total:null===O||void 0===O?void 0:O.total,pageSize:(null===O||void 0===O?void 0:O.perPage)||0,onChange:function(e,n){T((0,o.Z)((0,o.Z)({},D),{},{page:e,perPage:n}))},style:{alignSelf:"flex-end"}}),y&&(0,w.jsx)(c.Q,{openDrawer:y,onClose:function(){return b(!1)},permissions:n,record:Z.recordId,reloadTableData:T}),(0,w.jsx)(S,{reloadTableData:T,onCancel:H,openModal:Z.openModal,permissions:n})]})}},35367:function(e,n,t){t.d(n,{F:function(){return a}});var r=t(43144),o=t(15671),i=t(49075),a=(0,r.Z)((function e(){var n=this;(0,o.Z)(this,e),this.endPoint="leave-type",this.getAllRecords=function(e){return i.Z.get(n.endPoint,{params:e})},this.getAllPublishedRecords=function(e){return i.Z.get(n.endPoint+"/find-published",{params:e})},this.getRecordById=function(e){return i.Z.get(i._+n.endPoint+"/"+e)},this.deleteRecord=function(e){return i.Z.delete(i._+n.endPoint+"/"+e)},this.createRecord=function(e){return i.Z.post(i._+n.endPoint,e)},this.updateRecord=function(e,t){return i.Z.patch(i._+n.endPoint+"/"+t,e)}}))},10177:function(e,n,t){var r=t(87462),o=t(47313),i=t(63961),a=t(16141),s=function(e,n){return o.createElement(a.Z,(0,r.Z)({},e,{ref:n,icon:i.Z}))};n.Z=o.forwardRef(s)},15491:function(e,n,t){t.d(n,{Z:function(){return l}});var r=t(87462),o=t(47313),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 00-2.3 5.6zm63.5 23.6L779.7 199l45.2 45.1-360.5 359.7-45.7 1.1.7-46.4z"}}]},name:"form",theme:"outlined"},a=t(16141),s=function(e,n){return o.createElement(a.Z,(0,r.Z)({},e,{ref:n,icon:i}))};var l=o.forwardRef(s)}}]);