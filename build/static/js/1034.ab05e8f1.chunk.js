"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[1034],{45960:function(e,n,t){var o=t(47313),i=t(8570),r=t(97258),s=t(47312),a=t(21680),l=t(37388),d=t(48897),c=t(29079),u=t(4619),v=t(83168),m=t(40096),h=t(99700),p=t(46417),f=i.Z.Text;n.Z=function(e){var n,t=e.onClose,i=e.open,_=e.id,j=(0,o.useMemo)((function(){return new u.C}),[]),x=m.Z.getLocalAccessToken(),g=(0,c.K2)({method:function(){return j.getRecordById(_)},condition:!!_&&i&&_>0}),y=g.data,Z=g.loading;return(0,p.jsx)(r.Z,{open:i,onClose:t,width:window.innerWidth>500?500:"100%",title:"".concat(null===y||void 0===y?void 0:y.title," Files"),placement:"right",destroyOnClose:!0,bodyStyle:{padding:"0px 25px"},children:Z?(0,p.jsx)(s.Z,{active:!0}):(0,p.jsx)(p.Fragment,{children:null===y||void 0===y||null===(n=y.Resources)||void 0===n?void 0:n.map((function(e,n){var t,o;return(0,p.jsxs)("div",{className:v.Z.permitFiles,children:[null!==(t=e.fileType)&&void 0!==t&&t.includes("image")?(0,p.jsx)(a.Z,{src:"".concat(d.Q7).concat(e.path,"?authKey=").concat(x),alt:e.title,width:100,height:70,style:{borderRadius:5,objectFit:"cover"}}):(0,p.jsx)(a.Z,{src:"/images/doc.png",alt:"Document-".concat(n),width:100,height:70,preview:!1,style:{objectFit:"contain"}}),(0,p.jsx)(f,{ellipsis:{tooltip:e.title},children:e.title||e.name}),!(null!==(o=e.fileType)&&void 0!==o&&o.includes("image"))&&(0,p.jsx)(l.Z,{title:"View Document",children:(0,p.jsx)("a",{href:"".concat(d.PO).concat(e.path),target:"_blank",rel:"noreferrer",children:(0,p.jsx)(h.O,{})})})]},n)}))})})}},69195:function(e,n,t){t.d(n,{Z:function(){return g}});var o=t(1413),i=t(29439),r=t(47313),s=t(8570),a=t(55291),l=t(78267),d=t(46155),c=t(37388),u=t(32344),v=t(69591),m="styles_dropdownOverlay__P2gn7",h="styles_dropdownContainer__cMktZ",p="styles_searchContainer__zM6QV",f="styles_searchInput__oZFQF",_=t(37831),j=t(80235),x=t(46417),g=(s.Z.Text,function(e){var n,t,s,g,y,Z=e.data,w=e.permissions,N=e.style,b=Z.projectStates,k=Z.project,P=k.data,S=k.onRefresh,C=(0,r.useMemo)((function(){return new v.Q}),[]),R=(0,r.useState)({data:b,query:""}),F=(0,i.Z)(R,2),I=F[0],M=F[1];return(0,r.useEffect)((function(){M({data:b,query:""})}),[b]),(0,x.jsx)(l.Z,{trigger:["click"],menu:{items:null===(n=I.data)||void 0===n?void 0:n.map((function(e){var n;return{key:"state-".concat(e.id),label:e.title,onClick:function(){return function(e){var n={projectId:P.id,projectStateId:e};!0===w.updateProject?C.updateProjectStatus(n).then((function(e){var n=e.data;a.ZP.success((null===n||void 0===n?void 0:n.message)||"States changed successfully"),S()})).catch((function(e){var n,t,o=null===e||void 0===e||null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.message;a.ZP.error(o||"Something went wrong")})):a.ZP.error("You do not have permission to update project States, please contact your administrator")}(e.id)},disabled:e.id===(null===P||void 0===P||null===(n=P.ProjectState)||void 0===n?void 0:n.id)}}))},overlayClassName:m,dropdownRender:function(e){var n;return(0,x.jsxs)("div",{className:h,children:[(0,x.jsx)("div",{className:p,children:(0,x.jsx)(_.Z,{placeHolder:"Search",size:"w100",value:I.query,onChange:function(e){var n,t=e.target.value||"",o=null===t||void 0===t||null===(n=t.trim())||void 0===n?void 0:n.toLowerCase(),i=b.filter((function(e){return e.title.toLowerCase().includes(o)}));M({data:i,query:o})},className:f})}),(0,x.jsx)(d.Z,{style:{marginBottom:10,marginTop:0}}),e,!(null!==(n=I.data)&&void 0!==n&&n.length)&&(0,x.jsx)(j.Z,{description:"No data found"})]})},children:(0,x.jsx)(c.Z,{title:null===P||void 0===P||null===(t=P.ProjectState)||void 0===t?void 0:t.title,children:(0,x.jsxs)("div",{style:(0,o.Z)({display:"flex",alignItems:"center",background:"".concat(null===P||void 0===P||null===(s=P.ProjectState)||void 0===s?void 0:s.bgColor),cursor:"pointer",color:"".concat((null===P||void 0===P||null===(g=P.ProjectState)||void 0===g?void 0:g.textColor)||"var(--color-dark-sub"),padding:"5px 10px",borderRadius:"5px",fontSize:"14px",whiteSpace:"nowrap"},N),children:[(0,x.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",display:"inline-block",maxWidth:window.innerWidth>1500?"30ch":"15ch"},children:(null===P||void 0===P||null===(y=P.ProjectState)||void 0===y?void 0:y.title)||"Select States"}),(0,x.jsx)(u.Z,{style:{marginLeft:5}})]})})})})},44287:function(e,n,t){t.r(n),t.d(n,{default:function(){return tt}});var o,i,r=t(93433),s=t(29439),a=t(47313),l=t(2135),d=t(55291),c=t(85554),u=t(54060),v=t(18515),m=t(78272),h=t(29079),p=t(69591),f=t(96702),_=t(73257),j=t(5883),x=t(4942),g=t(1413),y=t(58467),Z=t(66204),w=t(78267),N=t(5900),b=t(28080),k=t(30646),P=t(46155),S=t(6929),C=t(41068),R=t(95366),F=t(98676),I=t(37289),M=t(37936),T=t(82626),A=t(46417),z=function(e){return(0,A.jsx)("svg",(0,g.Z)((0,g.Z)({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"#fff",width:19,height:19},e),{},{children:(0,A.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 01.865-.501 48.172 48.172 0 003.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0012 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018z"})}))},D=t(74165),E=t(15861),B=t(11843),L=t(72652),U=t(21680),H=t(77278),O=t(59491),Y=t(63270),q=t(97258),Q=t(34450),V=t(53764),W=t(92466),K=t(32147),G=t(48897),X={divider:"styles_divider__2Jo1o",conversations:"styles_conversations__gqSl4",conversations_scroll:"styles_conversations_scroll__ybvFr",conversations_loader:"styles_conversations_loader__ixzU4",conversations_wrapper:"styles_conversations_wrapper__rvKy4",conversation:"styles_conversation__J5l2p",conversation_header:"styles_conversation_header__a2QBu",conversation_header_user:"styles_conversation_header_user__Aro45",conversation_header_date:"styles_conversation_header_date__c-NHr",conversation_header_delete:"styles_conversation_header_delete__Ey7U+",conversation__content:"styles_conversation__content__p0iFu",conversations_form:"styles_conversations_form__Fs5Lg",conversations_form_wrapper:"styles_conversations_form_wrapper__VzAIo",conversations_form_input_wrapper:"styles_conversations_form_input_wrapper__-qI7U",conversations_form_input:"styles_conversations_form_input__u3P5a",conversations_form_send:"styles_conversations_form_send__pmHTz",conversations_form_send_loader:"styles_conversations_form_send_loader__HzQbx",conversations_form_switch:"styles_conversations_form_switch__Bd8w6",conversations_form_actions:"styles_conversations_form_actions__AZuWs",card:"styles_card__CIJxi",card_wrapper_container:"styles_card_wrapper_container__PtRV6",card_wrapper:"styles_card_wrapper__+fNMV",card_wrapper_owner:"styles_card_wrapper_owner__nrRA4",card_content:"styles_card_content__tJewe",card_content_owner:"styles_card_content_owner__SDCfa",card_content_other:"styles_card_content_other__Whr2G",card_sender:"styles_card_sender__tr9yl",card_sender_owner:"styles_card_sender_owner__gFNuD",card_sender_other:"styles_card_sender_other__XLLJ2",card_sender_name:"styles_card_sender_name__FyB8x",card_sent_at:"styles_card_sent_at__rA8yr",card_message:"styles_card_message__TB62d",card_message_mention:"styles_card_message_mention__uy3rQ"},J=t(3798),$=t(10491),ee=t(86948),ne=t(49075),te=t(6050),oe=t(8773),ie=t(39548),re=t(50385),se=t(40096),ae=t(50725),le=t(70816),de=t.n(le),ce=function(e){var n,t,o,i,r,l,d,c=e.data,u=e.setSelectedFile,v=e.onRemoveConversation,m=e.projectMembers,h=se.Z.getUserData(),p=se.Z.getLocalAccessToken(),f=(null===c||void 0===c||null===(n=c.User)||void 0===n?void 0:n.id)===(null===h||void 0===h?void 0:h.id),_=new Date(null===c||void 0===c?void 0:c.addedDate).getTime()+9e5<(new Date).getTime(),j=(0,a.useState)(!1),x=(0,s.Z)(j,2),g=x[0],y=x[1];return(0,A.jsxs)("div",{className:"".concat(X.card_wrapper_container," ").concat(f?X.card_wrapper_owner:X.card_wrapper),onMouseEnter:function(){return y(!0)},onMouseLeave:function(){return y(!1)},children:[f&&g&&!_&&(0,A.jsx)(N.Z,{title:"Are you sure you want to delete this conversation?",okText:"Yes",cancelText:"No",placement:"left",zIndex:9999,onConfirm:function(){return v(null===c||void 0===c?void 0:c.id)},children:(0,A.jsx)(F.Z,{style:{color:"red"}})}),(0,A.jsxs)("div",{className:"".concat(X.card),children:[(0,A.jsx)("div",{className:X.card_avatar,children:!f&&(0,A.jsx)(oe.C,{src:"".concat(G.lj).concat(null===c||void 0===c||null===(t=c.User)||void 0===t?void 0:t.profile),icon:(0,A.jsx)(ie.Z,{}),size:"default"})}),(0,A.jsxs)("div",{className:"".concat(X.card_content," ").concat(f?X.card_content_owner:X.card_content_other),children:[(0,A.jsxs)("div",{className:"".concat(X.card_sender," ").concat(f?X.card_sender_owner:X.card_sender_other),children:[!f&&(0,A.jsx)(re.Z,{user:null===c||void 0===c?void 0:c.User,type:"user",zIndex:9999,children:(0,A.jsx)("p",{className:X.card_sender_name,children:"".concat(null===c||void 0===c||null===(o=c.User)||void 0===o?void 0:o.firstName," ").concat(null===c||void 0===c||null===(i=c.User)||void 0===i?void 0:i.lastName)})}),(0,A.jsx)("span",{className:X.card_sent_at,title:de()(c.addedDate).format("DD MMM, YYYY hh:mm A"),children:de()(c.addedDate).fromNow()})]}),(0,A.jsx)("div",{className:X.card_message,children:(0,A.jsx)("div",{dangerouslySetInnerHTML:{__html:null===c||void 0===c||null===(r=c.message)||void 0===r?void 0:r.replace(/@(\w+\s*\w*)/g,(function(e,n){var t=n.replace(/@|\(|\)/g,"");return(null===m||void 0===m?void 0:m.find((function(e){var n,o,i;return null===(n="".concat(null===e||void 0===e||null===(o=e.User)||void 0===o?void 0:o.firstName," ").concat(null===e||void 0===e||null===(i=e.User)||void 0===i?void 0:i.lastName))||void 0===n?void 0:n.includes(t)})))?"<span class=".concat(X.card_message_mention,">").concat(e,"</span>"):e}))}})}),(null===c||void 0===c||null===(l=c.Media)||void 0===l?void 0:l.length)>0&&(0,A.jsx)("div",{className:X.conversation__files,children:null===c||void 0===c||null===(d=c.Media)||void 0===d?void 0:d.map((function(e,n){var t;return(0,A.jsx)("div",{className:X.conversation__files_item,children:null!==(t=e.fileType)&&void 0!==t&&t.includes("image")?(0,A.jsx)(ae.Z,{images:["".concat(G.Q7).concat(e.path,"?authKey=").concat(p)],width:300,height:150,style:{borderRadius:5,objectFit:"cover"}}):(0,A.jsx)(U.Z,{src:"/images/doc.png",alt:"Document-".concat(n),preview:!1,width:300,height:150,style:{borderRadius:5,objectFit:"contain"},onClick:function(){return u({path:e.path,open:!0})}})},"media-".concat(n))}))})]})]})]})},ue=function(e){var n=e.setProjectConversations,t=e.conversations,o=t.data,i=t.meta,l=t.loading,c=e.projectId,u=e.onRefresh,v=e.permissions,m=e.projectMembers,h=se.Z.getUserData(),f=d.ZP.useMessage(),_=(0,s.Z)(f,2),j=_[0],x=_[1],y=B.Z.useNotification(),Z=(0,s.Z)(y,2),w=Z[0],N=Z[1],b=(0,a.useMemo)((function(){return new p.Q}),[]),k=(0,a.useMemo)((function(){return(null===o||void 0===o?void 0:o.length)<(null===i||void 0===i?void 0:i.total)}),[o,i]),S=(0,a.useMemo)((function(){return null===m||void 0===m?void 0:m.map((function(e){var n,t,o,i="".concat(null===e||void 0===e||null===(n=e.User)||void 0===n?void 0:n.firstName," ").concat(null===e||void 0===e||null===(t=e.User)||void 0===t?void 0:t.lastName),r=null===e||void 0===e||null===(o=e.User)||void 0===o?void 0:o.id;return{label:i,value:"[".concat(i,"](").concat(r,")")}}))}),[m]),C=(0,a.useState)({content:"",loading:!1}),R=(0,s.Z)(C,2),F=R[0],I=R[1],M=(0,a.useState)([]),z=(0,s.Z)(M,2),oe=z[0],ie=z[1],re=(0,a.useState)({path:"",open:!1}),ae=(0,s.Z)(re,2),le=ae[0],de=ae[1],ue=(0,a.useState)(!1),ve=(0,s.Z)(ue,2),me=ve[0],he=ve[1],pe=(0,a.useState)(!1),fe=(0,s.Z)(pe,2),_e=fe[0],je=fe[1],xe=(0,a.useRef)(null),ge=(0,a.useRef)();ge.current=me;var ye=function e(){he(!0),document.removeEventListener("click",e)},Ze=function(e){e.message?c&&(!0===v.updateProject?(I((function(e){return(0,g.Z)((0,g.Z)({},e),{},{loading:!0})})),b.addProjectConversation((0,g.Z)((0,g.Z)({},e),{},{projectId:c})).then((function(e){var t,o=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data;I({content:"",loading:!1}),n((function(e){return(0,g.Z)((0,g.Z)({},e),{},{data:[o].concat((0,r.Z)(e.data))})}))})).catch((function(e){var n=(0,J.S3)(e);d.ZP.error(n||"Something went wrong"),I((function(e){return(0,g.Z)((0,g.Z)({},e),{},{loading:!1})}))}))):d.ZP.error("You do not have permission to add conversations")):d.ZP.error("Please enter a conversation")},we=function(e){!0===v.updateProject?b.removeProjectConversations(e).then((function(t){var o;d.ZP.success((null===t||void 0===t||null===(o=t.data)||void 0===o?void 0:o.message)||"conversation deleted successfully"),u({projectId:c}),n((function(n){return(0,g.Z)((0,g.Z)({},n),{},{data:n.data.filter((function(n){return n.id!==e}))})}))})).catch((function(e){var n=(0,J.S3)(e);d.ZP.error(n||"Something went wrong")})):d.ZP.error("You do not have permission to delete conversations")},Ne=function(){var e=(0,E.Z)((0,D.Z)().mark((function e(n){var t,o,i,r,s,a;return(0,D.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.onSuccess,o=n.onError,i=n.file,r=new FormData,s={headers:{"content-type":"multipart/form-data"}},r.append("files[]",i),e.prev=4,!0!==v.updateProject){e.next=13;break}return e.next=8,ne.Z.post("project/uploadConversationFiles/".concat(c),r,s);case 8:t&&t({status:200}),ie([]),u({projectId:c}),e.next=15;break;case 13:throw ie([]),new Error("You do not have permission to upload files");case 15:e.next=23;break;case 17:e.prev=17,e.t0=e.catch(4),a=(0,J.S3)(e.t0),ie([]),"You do not have permission to upload files"===a?j.open({key:"permission",type:"error",duration:5,content:a}):j.open({key:"error",type:"error",content:a}),o&&o(new Error("Upload failed"));case 23:case"end":return e.stop()}}),e,null,[[4,17]])})));return function(n){return e.apply(this,arguments)}}(),be=(0,a.useCallback)((function(){if((null===i||void 0===i?void 0:i.page)<(null===i||void 0===i?void 0:i.pageCount)){var e,t=(null===o||void 0===o?void 0:o.length)||0,r=null===o||void 0===o||null===(e=o[t-1])||void 0===e?void 0:e.id,s={projectId:c,before:r};n((function(e){return(0,g.Z)((0,g.Z)({},e),{},{loading:!0})})),u(s)}}),[o,i,c]);return(0,a.useEffect)((function(){xe.current&&(xe.current.scrollTop=xe.current.scrollHeight)}),[null===o||void 0===o?void 0:o.length]),(0,a.useEffect)((function(){var e=(0,$.I)();return e.on("chat",(function(e){!function(e){if(e&&e.projectId){var t=e.Project,o=e.User;e.projectId===c&&n((function(n){return(0,g.Z)((0,g.Z)({},n),{},{loading:!1,data:[e].concat((0,r.Z)(n.data.filter((function(n){return n.id!==e.id}))))})})),e.projectId!==c&&w.info({placement:"bottomLeft",message:"New Message",description:(0,A.jsxs)("p",{className:"mb-0",children:["New message from ",(0,A.jsxs)("b",{children:[null===o||void 0===o?void 0:o.firstName," ",null===o||void 0===o?void 0:o.lastName]})," in ","",(0,A.jsxs)("a",{href:"/chats?projectId=".concat(null===e||void 0===e?void 0:e.projectId),target:"_blank",rel:"noreferrer",children:[(0,A.jsxs)("b",{children:[null===t||void 0===t?void 0:t.referenceNumber," | ",null===t||void 0===t?void 0:t.title]}),(0,A.jsx)(K.O1,{height:18,width:18,cursor:"pointer"})]})]})}),ge.current&&e.userId!==(null===h||void 0===h?void 0:h.id)&&(0,J._P)()}}(e)})),function(){e.disconnect(),(0,$.g)()}}),[]),(0,a.useEffect)((function(){return document.addEventListener("click",ye),function(){document.removeEventListener("click",ye)}}),[]),(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(a.Fragment,{children:x},"messageAlert"),(0,A.jsx)(a.Fragment,{children:N},"notificationAlert"),(0,A.jsxs)(Q.Z,{title:(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)("div",{className:"d-flex align-center justify-space-between w-100",children:[(0,A.jsx)(T.ZT,{color:"primary-main",size:"normal",weight:"bold",children:"Conversations"}),(0,A.jsx)("a",{href:"/chats?projectId=".concat(c),target:"_blank",rel:"noreferrer",children:(0,A.jsx)(K.Qq,{height:18,width:18,cursor:"pointer"})})]}),(0,A.jsx)(P.Z,{className:X.divider})]}),headStyle:{display:"unset",padding:0},bodyStyle:{padding:0},className:X.conversations,ref:xe,children:[!l&&0===(null===o||void 0===o?void 0:o.length)&&(0,A.jsx)(T.I$,{description:"No conversations yet"}),(0,A.jsxs)("div",{className:X.conversations_wrapper,style:{height:0!==(null===o||void 0===o?void 0:o.length)?365:"unset",widows:"100%"},children:[(null===o||void 0===o?void 0:o.length)>0&&(0,A.jsx)(ee.Z,{dataLength:o?o.length:0,height:365,hasMore:k,inverse:!0,loader:l&&(0,A.jsx)("div",{className:X.conversations_loader,children:(0,A.jsx)(L.Z,{indicator:(0,A.jsx)(V.Z,{style:{fontSize:20},spin:!0})})}),next:be,endMessage:o.length===(null===i||void 0===i?void 0:i.total)&&(0,A.jsx)("p",{className:"font-size-xs color-dark-sub",style:{textAlign:"center"},children:"End of conversations"}),className:X.conversations_scroll,children:null===o||void 0===o?void 0:o.map((function(e){return(0,A.jsx)(ce,{data:e,setSelectedFile:de,onRemoveConversation:we,projectMembers:m},e.id)}))}),(0,A.jsx)("div",{className:X.conversations_form,children:(0,A.jsx)("div",{className:X.conversations_form_wrapper,children:(0,A.jsxs)("div",{className:X.conversations_form_input_wrapper,children:[(0,A.jsx)("div",{style:{width:30},children:(0,A.jsx)(U.Z,{preview:!1,width:30,height:30,className:X.conversations_form_avatar,src:"".concat(G.lj).concat(null===h||void 0===h?void 0:h.profile),alt:"".concat(null===h||void 0===h?void 0:h.firstName," ").concat(null===h||void 0===h?void 0:h.lastName),style:{objectFit:"cover",borderRadius:"100%"}})}),(0,A.jsx)(H.Z,{fileList:oe,customRequest:Ne,showUploadList:!1,beforeUpload:function(e,n){return n.length>0&&(ie(n),!0)},children:(0,A.jsx)("div",{className:"px-1",children:(0,A.jsx)(O.Z,{size:"small",type:"text",style:{backgroundColor:"transparent"},icon:(0,A.jsx)(W.Z,{style:{fontSize:18}})})})}),(0,A.jsx)(Y.Z,{placeholder:"Tips: (Shift + Enter to send) (@ to mention)",className:"".concat(X.conversations_form_input," w-100"),autoSize:{minRows:1,maxRows:4},placement:"top",onKeyDown:function(e){if("Enter"===e.key&&_e){if(e.preventDefault(),""===F.content.trim())return;Ze({message:null===F||void 0===F?void 0:F.content})}else"Shift"===e.key&&je(!0)},onKeyUp:function(e){"Shift"===e.key&&je(!1)},options:null===S||void 0===S?void 0:S.map((function(e){return{label:e.label,value:e.value}})),value:F.content,onChange:function(e){I((function(n){return(0,g.Z)((0,g.Z)({},n),{},{content:null===e||void 0===e?void 0:e.replace(/\[(.*?)\]\(.*?\)/g,"$1")})}))}}),F.loading?(0,A.jsx)(L.Z,{indicator:(0,A.jsx)(V.Z,{style:{fontSize:20},spin:!0}),className:X.conversations_form_send_loader}):(0,A.jsx)(K.jE,{className:X.conversations_form_send,onClick:function(){return Ze({message:null===F||void 0===F?void 0:F.content})}})]})})})]})]}),le.open&&(0,A.jsx)(q.Z,{open:le.open,onClose:function(){return de({path:"",open:!1})},width:window.innerWidth>700?700:"100%",title:"Preview File",placement:"right",zIndex:9999,children:(0,A.jsx)(te.Z,{file:le.path})})]})},ve=t(37388),me=t(32697),he=t(71703),pe=t(42954),fe=t(3109),_e="styles_info_wrapper__XqeRp",je="styles_info__psbY2",xe="styles_info_item__YNzgG",ge="styles_info_item_value__GTcD0",ye="styles_infoWrapperInner__gCrFY",Ze="styles_milestone_item__9XKDd",we="styles_milestone_item_content__AryXe",Ne="styles_milestone_item_value__a0BqN",be="styles_milestone_item_status__Gyi1l",ke=t(80235),Pe=function(e){var n=e.data,t=e.onRefresh,o=null===n||void 0===n?void 0:n.Quotation,i=(0,a.useState)({open:!1,ids:[]}),l=(0,s.Z)(i,2),c=l[0],u=l[1],v=(0,a.useMemo)((function(){return new pe.K}),[]),m=function(e){var n=c.ids.filter((function(n){return n!==e}));u((function(e){return(0,g.Z)((0,g.Z)({},e),{},{open:!1,ids:n})}))};return(0,A.jsx)(b.Z,{className:_e,style:{borderRadius:5,marginTop:10},children:(0,A.jsxs)("div",{className:ye,children:[(0,A.jsxs)("div",{className:je,children:[(0,A.jsx)("div",{style:{backgroundColor:"var(--color-light)"},children:(0,A.jsx)(fe.Z,{weight:"semi",color:"dark-main",className:"ml-2 my-2",children:"Scope of Work"})}),null===o||void 0===o?void 0:o.map((function(e,n){return(0,A.jsx)("div",{className:xe,children:(0,A.jsx)("p",{className:ge,children:e.scopeOfWork})},"quotation-".concat(n))})),0===(null===o||void 0===o?void 0:o.length)&&(0,A.jsx)(ke.Z,{description:"No scope of work found",imageStyle:{height:50}})]}),(0,A.jsxs)("div",{className:je,children:[(0,A.jsx)("div",{style:{backgroundColor:"var(--color-light)"},children:(0,A.jsx)(fe.Z,{weight:"semi",color:"dark-main",className:"ml-2 my-2",children:"Milestones"})}),0===(null===o||void 0===o?void 0:o.length)&&(0,A.jsx)(ke.Z,{description:"No milestones found",imageStyle:{height:50}}),null===o||void 0===o?void 0:o.map((function(e){var n=null===e||void 0===e?void 0:e.QuotationMilestone;return(0,A.jsxs)("div",{children:[0===(null===n||void 0===n?void 0:n.length)&&(0,A.jsx)(ke.Z,{description:"No milestones found",imageStyle:{height:50}}),null===n||void 0===n?void 0:n.map((function(e,n){return(0,A.jsxs)("div",{className:Ze,style:{alignItems:"flex-start"},children:[e.status!==M._W["Not Completed"]?(0,A.jsx)(ve.Z,{title:"This milestone is already completed",children:(0,A.jsx)(he.Z,{style:{color:"var(--color-primary-main)"}})}):(0,A.jsx)(N.Z,{title:"This will mark the milestone as completed. Are you sure?",okText:"Yes",cancelText:"No",onConfirm:function(){var n;m(e.id),n=e.id,v.completeMilestone(n).then((function(e){var o;d.ZP.success((null===e||void 0===e||null===(o=e.data)||void 0===o?void 0:o.message)||"Milestone completed successfully");var i=c.ids.filter((function(e){return e!==n}));u((function(e){return(0,g.Z)((0,g.Z)({},e),{},{open:!1,ids:i})})),t()})).catch((function(e){var n=(0,J.S3)(e);d.ZP.error(n||"Something went wrong")}))},onCancel:function(){return m(e.id)},onOpenChange:function(n){return!n&&m(e.id)},children:(0,A.jsx)(me.Z,{checked:c.ids.includes(e.id),onChange:function(){return u((function(n){return(0,g.Z)((0,g.Z)({},n),{},{open:!0,ids:[].concat((0,r.Z)(n.ids),[e.id])})}))}})}),(0,A.jsx)("div",{className:we,children:(0,A.jsxs)("p",{className:Ne,style:{textDecoration:e.status!==M._W["Not Completed"]?"line-through":"none"},children:[(0,A.jsx)("span",{children:e.title}),(0,A.jsx)("span",{className:be,children:M._W[e.status]})]})})]},"milestone-".concat(n))}))]},"quotation-item-".concat(e.id))}))]})]})})},Se=t(86136),Ce=t(25019),Re=t(61677),Fe=t(86345),Ie="styles_title__2hqCg",Me="styles_holdBy__mzsA-",Te="styles_holdBy_user__P77uI",Ae="styles_holdBy_user_name__eps3o",ze=Se.Z.TextArea,De=function(e){var n,t,o,i=e.data,r=e.permissions,l=i.project,c=i.onRefresh,u=(0,a.useMemo)((function(){return new p.Q}),[]),v=Ce.Z.useForm(),m=(0,s.Z)(v,1)[0],h=(0,a.useState)({loading:!1,onHold:!1}),f=(0,s.Z)(h,2),_=f[0],j=f[1];return(0,a.useEffect)((function(){j((function(e){return(0,g.Z)((0,g.Z)({},e),{},{onHold:null===l||void 0===l?void 0:l.onHold})}))}),[l]),(0,A.jsx)(Re.Z,{destroyTooltipOnHide:!0,title:(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)("div",{className:Ie,children:["Project Status",(0,A.jsx)(Fe.Z,{defaultChecked:null===l||void 0===l?void 0:l.onHold,checkedChildren:"On Hold",unCheckedChildren:"Active",className:_.onHold?"on-hold-switch":"active",onChange:function(e){return j((function(n){return(0,g.Z)((0,g.Z)({},n),{},{onHold:e})}))}})]}),(null===l||void 0===l?void 0:l.comment)&&(0,A.jsxs)("div",{style:{marginTop:10},children:[(0,A.jsx)("span",{style:{fontWeight:600,fontStyle:"italic"},children:"Reason: \xa0"}),(0,A.jsx)("span",{className:"font-size-sm",style:{fontWeight:"normal"},children:null===l||void 0===l?void 0:l.comment})]}),(null===l||void 0===l?void 0:l.ProjectHoldBy)&&(0,A.jsxs)("div",{className:Me,children:[(0,A.jsx)("span",{style:{fontStyle:"italic"},children:null!==l&&void 0!==l&&l.onHold?"Hold By:":"Resumed By:"}),(0,A.jsxs)(re.Z,{type:"user",user:null===l||void 0===l?void 0:l.ProjectHoldBy,className:Te,children:[(0,A.jsx)(oe.C,{size:28,src:"".concat(G.lj).concat(null===l||void 0===l||null===(n=l.ProjectHoldBy)||void 0===n?void 0:n.profile),icon:(0,A.jsx)(ie.Z,{}),style:{border:"1px solid var(--color-border)"}}),(0,A.jsx)("p",{className:Ae,children:"".concat(null===l||void 0===l||null===(t=l.ProjectHoldBy)||void 0===t?void 0:t.firstName," ").concat(null===l||void 0===l||null===(o=l.ProjectHoldBy)||void 0===o?void 0:o.lastName)})]})]})]}),content:(0,A.jsxs)(Ce.Z,{form:m,onFinish:function(e){if(!0===r.updateProject){var n={comment:null===e||void 0===e?void 0:e.comment};j((function(e){return(0,g.Z)((0,g.Z)({},e),{},{loading:!0})})),!1===(null===l||void 0===l?void 0:l.onHold)?u.holdProject(n,null===l||void 0===l?void 0:l.id).then((function(e){var n=null===e||void 0===e?void 0:e.data;d.ZP.success((null===n||void 0===n?void 0:n.message)||"Project is now on hold"),c(),m.resetFields()})).catch((function(e){var n=(0,J.S3)(e);d.ZP.error(n||"Something went wrong")})).finally((function(){j((function(e){return(0,g.Z)((0,g.Z)({},e),{},{loading:!1})}))})):u.unholdProject(n,null===l||void 0===l?void 0:l.id).then((function(e){var n=null===e||void 0===e?void 0:e.data;d.ZP.success((null===n||void 0===n?void 0:n.message)||"Project is now active"),c(),m.resetFields()})).catch((function(e){var n=(0,J.S3)(e);d.ZP.error(n||"Something went wrong")})).finally((function(){j((function(e){return(0,g.Z)((0,g.Z)({},e),{},{loading:!1})}))}))}else d.ZP.error("You do not have permission to hold project, please contact your administrator")},layout:"vertical",children:[(0,A.jsx)(Ce.Z.Item,{name:"comment",rules:[{required:!0,message:"Please enter reason"}],style:{marginBottom:10,width:"100%"},children:(0,A.jsx)(ze,{placeholder:"Reason",style:{width:"100%"},autoSize:{minRows:1,maxRows:4}})}),(0,A.jsx)(O.Z,{type:"ghost",size:"small",htmlType:"submit",loading:null===_||void 0===_?void 0:_.loading,children:"Save"})]}),overlayClassName:"change-width",children:(0,A.jsx)(C.Z,{count:(0,A.jsx)("div",{style:{background:null!==l&&void 0!==l&&l.onHold?"#F5222D":"radial-gradient(#1C6758, #367E18, #5BB318)",boxShadow:"0px 2px 10px rgba(0, 0, 0, 0.4)",fontSize:20,width:20,height:20,borderRadius:"50%"}})})})},Ee=t(40293),Be=t(98505),Le=t(42623),Ue=t(84825),He=t(12079),Oe=t(66395),Ye="styles_details__FFG6F",qe="styles_details_item__ap0y2",Qe="styles_details_item_label__lrxJ5",Ve="styles_details_item_value__D0Ec-",We="styles_details_item_value_deadline__UTOwo",Ke="styles_details_item_value_org_name__y19J6",Ge="styles_details_item_value_submitted_by__wBq0w",Xe="styles_details_support_list__jnUqD",Je="styles_details_support_list_item__Y-M+k",$e="styles_details_support_list_item_name__YT3OR",en="styles_details_support_list_item_remove__GxU+a",nn="styles_details_clients_list__2CWtG",tn="styles_details_clients_list_item__6jYc8",on="styles_details_clients_list_item_name__ZKiFg",rn="styles_details_clients_list_item_remove__+yhf1",sn=t(48297),an=t(5190),ln=function(e){var n,t,o,i,l,c,u,v=e.data,m=e.permissions,h=e.onEdit,f=v.project,_=f.data,j=f.onRefresh,y=(0,a.useMemo)((function(){return new p.Q}),[]),w=(0,a.useMemo)((function(){return new Ue.z}),[]),b=(0,a.useMemo)((function(){return new sn.V}),[]),k=(0,a.useMemo)((function(){return new an.L}),[]),P=(0,a.useState)({}),S=(0,s.Z)(P,2),C=S[0],R=S[1],F=(0,a.useState)({}),I=(0,s.Z)(F,2),z=I[0],D=I[1],E=(0,a.useState)({endDate:{show:!1,value:""}}),B=(0,s.Z)(E,2),L=B[0],H=B[1],O=null===_||void 0===_?void 0:_.ProjectMembers,Y=null===O||void 0===O?void 0:O.find((function(e){return e.projectRole===M.nV.projectIncharge})),q=(null===O||void 0===O?void 0:O.filter((function(e){return e.projectRole===M.nV.supportEngineers})))||[],Q=null===_||void 0===_?void 0:_.ProjectClient,V=(0,a.useState)(""),W=(0,s.Z)(V,2),X=W[0],$=W[1],ee=(0,Le.N)(X,500),ne=(0,a.useState)(""),te=(0,s.Z)(ne,2),re=te[0],se=te[1],ae=(0,Le.N)(re,500),le=(0,a.useState)(""),ce=(0,s.Z)(le,2),ue=ce[0],me=ce[1],pe=(0,Le.N)(ue,500),fe=(0,a.useState)(""),_e=(0,s.Z)(fe,2),je=_e[0],xe=_e[1],ge=(0,Le.N)(je,500),ye=(0,a.useState)({data:[],loading:!1}),Ze=(0,s.Z)(ye,2),we=Ze[0],Ne=Ze[1],be=(0,a.useState)({data:[],loading:!1}),ke=(0,s.Z)(be,2),Pe=ke[0],Se=ke[1],Ce=(0,a.useState)({data:[],loading:!1}),Re=(0,s.Z)(Ce,2),Ie=Re[0],Me=Re[1],Te=(0,a.useState)({data:[],loading:!1}),Ae=(0,s.Z)(Te,2),ze=Ae[0],De=Ae[1],ln=function(e){De((function(e){return(0,g.Z)((0,g.Z)({},e),{},{loading:!0})})),(0,k.getAllRecords)(e).then((function(e){De((function(n){var t,o,i=null===e||void 0===e||null===(t=e.data)||void 0===t||null===(o=t.data)||void 0===o?void 0:o.filter((function(e){return!(null!==n&&void 0!==n&&n.data.find((function(n){return n.id===e.id})))}));return{data:[].concat((0,r.Z)(n.data),(0,r.Z)(i)),loading:!1}}))})).catch((function(e){d.ZP.error(e.response.data.message||"Something went wrong!"),De((function(e){return(0,g.Z)((0,g.Z)({},e),{},{loading:!1})}))}))},dn=(0,a.useCallback)((function(){var e;ae&&(e={name:ae},Ne((function(e){return(0,g.Z)((0,g.Z)({},e),{},{loading:!0})})),w.getAllRecords(e).then((function(e){Ne((function(n){var t,o,i=null===e||void 0===e||null===(t=e.data)||void 0===t||null===(o=t.data)||void 0===o?void 0:o.filter((function(e){return!(null!==n&&void 0!==n&&n.data.find((function(n){return n.id===e.id})))}));return{data:[].concat((0,r.Z)(n.data),(0,r.Z)(i)),loading:!1}}))})).catch((function(e){d.ZP.error(e.response.data.message||"Something went wrong!"),Ne((function(e){return(0,g.Z)((0,g.Z)({},e),{},{loading:!1})}))})))}),[ae]);(0,a.useEffect)((function(){dn()}),[dn]);var cn=(0,a.useCallback)((function(){var e;pe&&(e={name:pe},Se((function(e){return(0,g.Z)((0,g.Z)({},e),{},{loading:!0})})),w.getAllRecords(e).then((function(e){Se((function(n){var t,o,i=null===e||void 0===e||null===(t=e.data)||void 0===t||null===(o=t.data)||void 0===o?void 0:o.filter((function(e){return!(null!==n&&void 0!==n&&n.data.find((function(n){return n.id===e.id})))}));return{data:[].concat((0,r.Z)(n.data),(0,r.Z)(i)),loading:!1}}))})).catch((function(e){d.ZP.error(e.response.data.message||"Something went wrong!"),Se((function(e){return(0,g.Z)((0,g.Z)({},e),{},{loading:!1})}))})))}),[pe]);(0,a.useEffect)((function(){cn()}),[cn]);var un=(0,a.useCallback)((function(){ee&&function(e){Me((function(e){return(0,g.Z)((0,g.Z)({},e),{},{loading:!0})})),b.findPublished(e).then((function(e){Me((function(n){var t,o,i=null===e||void 0===e||null===(t=e.data)||void 0===t||null===(o=t.data)||void 0===o?void 0:o.filter((function(e){return!(null!==n&&void 0!==n&&n.data.find((function(n){return n.id===e.id})))}));return{data:[].concat((0,r.Z)(n.data),(0,r.Z)(i)),loading:!1}}))})).catch((function(e){d.ZP.error(e.response.data.message||"Something went wrong!"),Me((function(e){return(0,g.Z)((0,g.Z)({},e),{},{loading:!1})}))}))}({name:ee,organizationId:null===_||void 0===_?void 0:_.clientId})}),[ee]);(0,a.useEffect)((function(){un()}),[un]);var vn=(0,a.useCallback)((function(){ge?ln({name:ge}):ln()}),[ge]);(0,a.useEffect)((function(){vn()}),[vn]);var mn=function(e,n){if(!0===m.modifyProjectMembers)switch(n){case"client":y.removeProjectClients(null===_||void 0===_?void 0:_.id,e).then((function(e){var n;d.ZP.success(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message),j()})).catch((function(e){var n=(0,J.S3)(e);d.ZP.error(n||"Something went wrong!")}));break;case"user":y.removeProjectMembers(null===_||void 0===_?void 0:_.id,e).then((function(e){var n;d.ZP.success(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message),j()})).catch((function(e){var n=(0,J.S3)(e);d.ZP.error(n||"Something went wrong!")}))}else d.ZP.error("You don't have permission to remove project members")},hn=function(e){!0===m.modifyProjectMembers?y.updateProjectMembers((0,g.Z)({projectId:null===_||void 0===_?void 0:_.id},e)).then((function(e){var n;d.ZP.success(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message),j()})).catch((function(e){var n,t,o=null===e||void 0===e||null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.message;d.ZP.error(o)})):d.ZP.error("You don't have permission to update project members")};return(0,a.useEffect)((function(){Y&&Ne((0,g.Z)((0,g.Z)({},we),{},{data:[null===Y||void 0===Y?void 0:Y.User]}))}),[Y]),(0,A.jsxs)("section",{className:Ye,children:[(0,A.jsxs)("div",{className:qe,children:[(0,A.jsx)("p",{className:Qe,children:"Project Incharge"}),(0,A.jsx)("div",{style:{width:"70%"},children:_&&(0,A.jsx)(He.Z,{showPopover:!(null===Y||void 0===Y||!Y.User),user:null===Y||void 0===Y?void 0:Y.User,defaultValue:null===Y||void 0===Y||null===(n=Y.User)||void 0===n?void 0:n.uuid,loading:we.loading,onSearch:function(e){return se(e)},disableOption:[null===Y||void 0===Y||null===(t=Y.User)||void 0===t?void 0:t.uuid],placeholder:"Add Project Incharge",options:we.data.map((function(e){return{value:null===e||void 0===e?void 0:e.uuid,label:"".concat(null===e||void 0===e?void 0:e.firstName," ").concat(null===e||void 0===e?void 0:e.lastName),icon:(0,A.jsx)(oe.C,{size:32,src:"".concat(G.lj).concat(null===e||void 0===e?void 0:e.profile),icon:(0,A.jsx)(ie.Z,{})})}})),onSelect:function(e){var n=we.data.find((function(n){return(null===n||void 0===n?void 0:n.uuid)===e}));hn({projectInchargeId:null===n||void 0===n?void 0:n.id})}})})]}),(0,A.jsxs)("div",{className:qe,children:[(0,A.jsx)("p",{className:Qe,children:"Support Engineers"}),(0,A.jsxs)("div",{className:Xe,children:[null===q||void 0===q?void 0:q.map((function(e){var n=e.User;return(0,A.jsxs)("div",{className:Je,onMouseEnter:function(){return R((0,x.Z)({},null===n||void 0===n?void 0:n.uuid,!0))},onMouseLeave:function(){return R({})},children:[(0,A.jsxs)(Oe.Z,{type:"user",user:n,className:"d-flex align-center",children:[(0,A.jsx)(oe.C,{size:32,src:"".concat(G.lj).concat(null===n||void 0===n?void 0:n.profile),icon:(0,A.jsx)(ie.Z,{}),style:{border:"1px solid var(--color-border)"}}),(0,A.jsx)("p",{className:$e,children:"".concat(null===n||void 0===n?void 0:n.firstName," ").concat(null===n||void 0===n?void 0:n.lastName)})]}),C[null===n||void 0===n?void 0:n.uuid]&&(0,A.jsx)(N.Z,{placement:"left",okText:"Yes",cancelText:"No",title:"Are you sure to remove this support engineer?",onConfirm:function(){return mn(null===n||void 0===n?void 0:n.id,"user")},children:(0,A.jsx)(K.DX,{className:en,color:"var(--color-red-yp)"})})]},null===n||void 0===n?void 0:n.uuid)})),(0,A.jsx)(He.Z,{showPopover:!1,placeholder:"Add Support Engineer",notFoundDescription:"No Support Engineer Found, Search with name",loading:null===Pe||void 0===Pe?void 0:Pe.loading,onSearch:function(e){return me(e)},options:null===Pe||void 0===Pe||null===(o=Pe.data.filter((function(e){return!(null!==q&&void 0!==q&&q.find((function(n){var t;return(null===n||void 0===n||null===(t=n.User)||void 0===t?void 0:t.uuid)===(null===e||void 0===e?void 0:e.uuid)})))})))||void 0===o?void 0:o.map((function(e){return{value:null===e||void 0===e?void 0:e.uuid,label:"".concat(null===e||void 0===e?void 0:e.firstName," ").concat(null===e||void 0===e?void 0:e.lastName),icon:(0,A.jsx)(oe.C,{size:32,src:"".concat(G.lj).concat(null===e||void 0===e?void 0:e.profile),icon:(0,A.jsx)(ie.Z,{})})}})),onSelect:function(e){var n=Pe.data,t=null===n||void 0===n?void 0:n.find((function(n){return(null===n||void 0===n?void 0:n.uuid)===e}));hn({supportEngineersId:[null===t||void 0===t?void 0:t.id]})}})]})]}),(0,A.jsxs)("div",{className:qe,children:[(0,A.jsx)("p",{className:Qe,children:"Clients Members"}),(0,A.jsxs)("div",{className:nn,children:[null===Q||void 0===Q?void 0:Q.map((function(e){var n=e.Client,t=e.isRepresentative;return(0,A.jsxs)("div",{className:tn,onMouseEnter:function(){return D((0,x.Z)({},null===n||void 0===n?void 0:n.uuid,!0))},onMouseLeave:function(){return D({})},children:[(0,A.jsxs)(Oe.Z,{type:"client",client:n,className:"d-flex align-center",extra:(0,A.jsx)(A.Fragment,{children:(0,A.jsxs)("div",{className:"d-flex align-center",children:[(0,A.jsx)("p",{className:"color-dark-sub mb-0 mr-2",children:"Make as rep"}),(0,A.jsx)(ve.Z,{title:t&&"You can't make this client as representative as he/she is already a representative",placement:"bottomRight",children:(0,A.jsx)(Fe.Z,{checkedChildren:(0,A.jsx)(he.Z,{}),unCheckedChildren:(0,A.jsx)(Ee.Z,{}),defaultChecked:t,onChange:function(e){e&&hn({clientRepresentativeId:null===n||void 0===n?void 0:n.id})},disabled:t,size:"small",className:"color-dark-sub"})})]})}),children:[(0,A.jsx)(oe.C,{size:32,icon:(0,A.jsx)(ie.Z,{}),style:{border:"1px solid var(--color-border)"}}),(0,A.jsxs)("p",{className:on,children:[null===n||void 0===n?void 0:n.name,t&&(0,A.jsx)(Z.Z,{color:"var(--color-green-yp)",className:"ml-4",children:"Rep."})]})]}),z[null===n||void 0===n?void 0:n.uuid]&&(0,A.jsx)(N.Z,{placement:"left",okText:"Yes",cancelText:"No",title:"Are you sure to remove this client?",onConfirm:function(){return mn(null===n||void 0===n?void 0:n.id,"client")},children:(0,A.jsx)(K.DX,{className:rn,color:"var(--color-red-yp)"})})]},null===n||void 0===n?void 0:n.uuid)})),(0,A.jsx)(He.Z,{showPopover:!1,placeholder:"Add Client Member",notFoundDescription:"No Client Found, Search with name",loading:Ie.loading,onSearch:function(e){return $(e)},options:Ie.data.map((function(e){return{value:(null===e||void 0===e?void 0:e.uuid)||"",label:null===e||void 0===e?void 0:e.name,icon:(0,A.jsx)(oe.C,{size:32,src:"".concat(G.lj).concat(null===e||void 0===e?void 0:e.logo),icon:(0,A.jsx)(ie.Z,{})})}})),onSelect:function(e){var n=Ie.data.find((function(n){return(null===n||void 0===n?void 0:n.uuid)===e}));hn({clients:[null===n||void 0===n?void 0:n.id]})}})]})]}),(0,A.jsxs)("div",{className:qe,children:[(0,A.jsx)("p",{className:Qe,children:"Client"}),(null===_||void 0===_?void 0:_.Client)&&(0,A.jsxs)("div",{className:Ve,children:[(0,A.jsx)(oe.C,{size:32,src:"".concat(G.lj).concat(null===_||void 0===_||null===(i=_.Client)||void 0===i?void 0:i.logo),icon:(0,A.jsx)(ie.Z,{}),style:{border:"1px solid var(--color-border)"}}),(0,A.jsx)("p",{className:Ke,children:null===_||void 0===_||null===(l=_.Client)||void 0===l?void 0:l.name})]})]}),(0,A.jsxs)("div",{className:qe,children:[(0,A.jsx)("p",{className:Qe,children:"Total Hours Worked"}),(0,A.jsx)("p",{className:Ve,children:"N/A"})]}),(0,A.jsxs)("div",{className:qe,children:[(0,A.jsx)("p",{className:Qe,children:"Date Created"}),(0,A.jsx)("p",{className:Ve,children:(0,Be.Ny)(null===_||void 0===_?void 0:_.addedDate,"dd MM,yy")})]}),(0,A.jsxs)("div",{className:qe,children:[(0,A.jsx)("p",{className:Qe,children:"Start Date"}),(0,A.jsx)("p",{className:Ve,children:(0,Be.Ny)(null===_||void 0===_?void 0:_.startDate,"dd MM,yy")})]}),(0,A.jsxs)("div",{className:qe,children:[(0,A.jsx)("p",{className:Qe,children:"Deadline"}),(0,A.jsxs)("div",{className:Ve,children:[L.endDate.show?(0,A.jsx)(T.JA,{defaultValue:de()(null===_||void 0===_?void 0:_.endDate),onChange:function(e){return H((function(n){return(0,g.Z)((0,g.Z)({},n),{},{endDate:(0,g.Z)((0,g.Z)({},n.endDate),{},{value:(null===e||void 0===e?void 0:e.toString())||""})})}))},onBlur:function(){return H((function(e){return(0,g.Z)((0,g.Z)({},e),{},{endDate:{show:!1,value:""}})}))},onMouseDown:function(){return e=L.endDate.value,void(!0===m.updateProject?(e=new Date(e).toISOString(),y.updateRecord({endDate:e},null===_||void 0===_?void 0:_.id).then((function(e){var n;e&&(H((function(e){return(0,g.Z)((0,g.Z)({},e),{},{endDate:{show:!1,value:""}})})),j(),d.ZP.success((null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message)||"Deadline updated successfully"))})).catch((function(e){var n,t,o=(null===e||void 0===e||null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.message)||"Something went wrong!";d.ZP.error(o)}))):d.ZP.error("You don't have permission to update deadline"));var e}}):(0,A.jsx)("p",{className:"".concat(We," ").concat((0,J.H8)(null===_||void 0===_?void 0:_.endDate,(new Date).toISOString())?"color-red-yp":""),onClick:function(){return H((function(e){return(0,g.Z)((0,g.Z)({},e),{},{endDate:{show:!0,value:""}})}))},children:(0,Be.Ny)(null===_||void 0===_?void 0:_.endDate,"dd MM,yy")}),(null===_||void 0===_?void 0:_.isExtended)&&(0,A.jsx)(Z.Z,{color:"warning",className:"ml-2",children:"Extended"})]})]}),(null===_||void 0===_?void 0:_.reasonOfExtension)&&(0,A.jsxs)("div",{className:qe,children:[(0,A.jsx)("p",{className:Qe,children:"Reason of Extension"}),(0,A.jsx)("p",{className:Ve,children:null===_||void 0===_?void 0:_.reasonOfExtension})]}),(0,A.jsxs)("div",{className:qe,children:[(0,A.jsx)("p",{className:Qe,children:"Project Type"}),(0,A.jsx)("p",{className:Ve,children:null===_||void 0===_||null===(c=_.ProjectType)||void 0===c?void 0:c.title})]}),(0,A.jsxs)("div",{className:qe,children:[(0,A.jsx)("p",{className:Qe,children:"Submitted By"}),(0,A.jsx)("div",{style:{width:"70%"},children:null!==_&&void 0!==_&&_.submissionById?(0,A.jsx)(T.Ld,{bordered:!1,placeholder:"Select Company",notFoundDescription:"No Company Found, Search with name",className:"selectWithIcon",customOption:!0,onSearch:function(e){ze.data.find((function(n){return n.name.toLowerCase().includes(e.toLowerCase())}))||xe(e)},onSelect:function(e){return h({submissionById:e},null===_||void 0===_?void 0:_.id)},defaultValue:null===_||void 0===_?void 0:_.submissionById,options:null===(u=ze.data)||void 0===u?void 0:u.map((function(e){return{label:e.name,value:e.id,icon:(0,A.jsx)(U.Z,{src:"".concat(G.lj).concat(e.logo),alt:e.name,preview:!1,width:24,style:{objectFit:"contain"}})}}))}):(0,A.jsx)("p",{className:Ge,children:"N/A"})})]})]})},dn=t(15130),cn=t(88151),un=function(e){var n=e.onEdit,t=e.project.data,o=Ce.Z.useForm(),i=(0,s.Z)(o,1)[0],l=(0,a.useState)([]),d=(0,s.Z)(l,2),c=d[0],u=d[1],v=(0,a.useCallback)((function(e,o,s){switch(o){case"add":if(c.find((function(n){return n.link===e})))return;var a=[].concat((0,r.Z)(c),[{name:s,link:e}]);u(a),i.setFieldsValue({projectFilesLink:"",projectFilesLinkName:""}),n({projectFilesLink:a.join(",")},null===t||void 0===t?void 0:t.id);break;case"remove":var l=c.filter((function(n){return n.link!==e}));u(l),n({projectFilesLink:JSON.stringify(l)},null===t||void 0===t?void 0:t.id)}}),[c]);return(0,a.useEffect)((function(){try{var e=JSON.parse(null===t||void 0===t?void 0:t.projectFilesLink);u("string"===typeof e?[{link:e}]:e)}catch(n){console.log("Some error while parsing links")}}),[]),(0,A.jsxs)(Ce.Z,{form:i,children:[(0,A.jsxs)("div",{className:cn.Z.linkFormContainer,children:[(0,A.jsx)(Ce.Z.Item,{style:{width:"50%",marginTop:10},name:"projectFilesLinkName",children:(0,A.jsx)(T.t7,{label:"Link Name",placeHolder:"Name of the link",className:cn.Z.projectFilesLinkName,size:"w100"})}),(0,A.jsx)(Ce.Z.Item,{name:"projectFilesLink",rules:[{required:0===(null===c||void 0===c?void 0:c.length),message:"Please add at least one link."},{type:"url",message:"Please enter a valid url."},function(){return{validator:function(e,n){return n&&null!==c&&void 0!==c&&c.includes(n)?Promise.reject(new Error("This link is already added.")):Promise.resolve()}}}],style:{marginTop:10,width:"50%"},children:(0,A.jsx)(T.t7,{label:"Project Files Link",placeHolder:"Add project file link",size:"w100",suffix:(0,A.jsx)(K.wl,{style:{cursor:"pointer"},onClick:function(){var e=i.getFieldValue("projectFilesLink"),n=i.getFieldValue("projectFilesLinkName");v(e,"add",n)}})})})]}),(0,A.jsx)("div",{className:cn.Z.projectFileLinks,children:null===c||void 0===c?void 0:c.map((function(e,n){return(0,A.jsxs)("div",{className:cn.Z.projectFileLink,children:[(0,A.jsx)("a",{href:e.link,target:"_blank",rel:"noreferrer",children:e.name?e.name:e.link}),(0,A.jsx)(N.Z,{title:"Are you sure to delete this link?",okText:"Yes",cancelText:"No",placement:"left",onConfirm:function(){return v(e.link,"remove")},children:(0,A.jsx)(K.pJ,{className:cn.Z.projectFileLink__deleteIcon})})]},"".concat(e,"-").concat(n))}))})]})},vn=function(e){var n=e.data,t=e.permissions,o=n.project,i=n.projectFiles,r=Ce.Z.useForm(),l=(0,s.Z)(r,1)[0],c=d.ZP.useMessage(),u=(0,s.Z)(c,2),v=u[0],m=u[1],h=(0,a.useState)([]),p=(0,s.Z)(h,2),f=p[0],_=p[1],j=(0,a.useState)({status:"normal",progress:{}}),y=(0,s.Z)(j,2),Z=y[0],w=y[1],N=(0,a.useState)("other"),b=(0,s.Z)(N,2),P=b[0],S=b[1],C=function(){var e=(0,E.Z)((0,D.Z)().mark((function e(n){var r,s,a,l,d,c,u,m,h,p;return(0,D.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.onSuccess,s=n.onError,a=n.file,l=n.filename,d=new FormData,c={headers:{"content-type":"multipart/form-data"}},d.append("files[]",a),d.append("documentType",P),d.append("projectId",o.data.id.toString()),w({status:"active",progress:(0,x.Z)({},l,0)}),u=function(e){var n=e.loaded,t=e.total,o=0;null!==t&&void 0!==t&&(o=Math.floor(100*n/t)),w({status:"active",progress:(0,x.Z)({},l,o)})},e.prev=8,!0!==t.updateProject){e.next=19;break}return e.next=12,ne.Z.post("project/uploadProjectFiles",d,(0,g.Z)({onUploadProgress:u},c));case 12:r&&r({status:200}),w({status:"success",progress:(0,x.Z)({},l,100)}),_([]),i.onRefresh({projectId:o.data.id}),setTimeout((function(){w({status:"normal",progress:{}})}),3e3),e.next=20;break;case 19:throw new Error("You do not have permission to upload files");case 20:e.next=29;break;case 22:e.prev=22,e.t0=e.catch(8),"string"!==typeof(p=(null===(m=e.t0.response)||void 0===m||null===(h=m.data)||void 0===h?void 0:h.message)||e.t0.message||"Something went wrong")&&(p="Something went wrong"),"You do not have permission to upload files"===p?v.open({key:"permission",type:"error",duration:5,content:p}):v.open({key:"error",type:"error",content:p}),w({status:"exception",progress:(0,x.Z)({},l,0)}),s&&s(new Error("Upload failed"));case 29:case"end":return e.stop()}}),e,null,[[8,22]])})));return function(n){return e.apply(this,arguments)}}();return(0,A.jsxs)(A.Fragment,{children:[m,Z.progress&&Object.entries(Z.progress).map((function(e){var n=(0,s.Z)(e,2),t=n[0],o=n[1];return(0,A.jsx)(k.Z,{percent:o,status:Z.status,showInfo:!1},t)})),(0,A.jsxs)("div",{className:cn.Z.uploadSection,children:[(0,A.jsx)(T.AP,{className:cn.Z.uploadSection_content_select,placeholder:"Select Document Type",defaultValue:P,onChange:function(e){return S(e)},options:Object.entries(M.vZ).map((function(e){var n=(0,s.Z)(e,2),t=n[0];return{label:n[1],value:t}})),bordered:!1,clearIcon:!1,style:{width:120}}),(0,A.jsx)(Ce.Z,{form:l,layout:"vertical",children:(0,A.jsx)(T.wA,{name:"file",multiple:!0,listType:"picture-card",style:{marginTop:10},className:cn.Z.uploadSection_content_uploader,fileList:f,customRequest:C,beforeUpload:function(e,n){return n.length>0&&(_(n),!0)},customLabel:(0,A.jsxs)("div",{style:{marginTop:-20},children:[(0,A.jsx)("p",{className:"ant-upload-drag-icon mb-0",children:(0,A.jsx)("img",{src:"/images/picture.svg",alt:""})}),(0,A.jsx)("p",{className:"ant-upload-hint",children:"Drag here or click to upload"})]})})})]})]})},mn=t(62892),hn=t(69928),pn=function(e){var n,t,o=e.data,i=e.permissions,r=e.onEdit,l=o.project,d=o.projectFiles,c=(0,a.useState)("documents"),u=(0,s.Z)(c,2),v=u[0],m=u[1],h=(0,a.useState)(!1),p=(0,s.Z)(h,2),f=p[0],_=p[1];return(0,A.jsxs)("section",{children:[(0,A.jsx)(S.Z,{type:"card",renderTabBar:function(e,n){return(0,A.jsxs)(mn.Z,{offsetTop:0,offsetBottom:20,style:{zIndex:1},className:cn.Z.tabBar_header,children:[(0,A.jsx)(n,(0,g.Z)((0,g.Z)({},e),{},{className:"mb-0",style:{fontSize:"var(--font-size-md)"}})),"links"!==v&&(0,A.jsx)(O.Z,{type:"link",onClick:function(){return _(!0)},className:"ml-auto font-size-sm color-dark-main",style:{paddingBottom:"0px"},children:"Manage"})]})},className:"files-tab",items:[{label:"Documents",key:"documents",children:(0,A.jsx)(dn.Z,{data:null===d||void 0===d?void 0:d.data,meta:null===d||void 0===d?void 0:d.meta,onRefresh:null===d||void 0===d?void 0:d.onRefresh,projectId:null===l||void 0===l||null===(n=l.data)||void 0===n?void 0:n.id})},{label:"Links",key:"links",children:(0,A.jsx)(un,{onEdit:r,project:{data:null===l||void 0===l?void 0:l.data,onRefresh:null===l||void 0===l?void 0:l.onRefresh}})}],onChange:function(e){return m(e)}}),"links"!==v&&(0,A.jsx)(vn,{data:{project:l,projectFiles:d},permissions:i}),"links"!==v&&(0,A.jsx)(hn.Z,{projectId:null===l||void 0===l||null===(t=l.data)||void 0===t?void 0:t.id,isManageMediaOpen:f,setIsManageMediaOpen:_,shareFiles:!0,media:{loading:null===d||void 0===d?void 0:d.loading,data:null===d||void 0===d?void 0:d.data,onRefresh:null===d||void 0===d?void 0:d.onRefresh,meta:null===d||void 0===d?void 0:d.meta}})]})},fn=t(35432),_n=t(41586),jn=t(8570),xn="styles_sharedFiles__pa4B0",gn="styles_sharedFiles__details__04mXS",yn=jn.Z.Text,Zn=function(e){var n=e.onClose,t=e.open,o=e.data,i=e.batchNumber,r=se.Z.getLocalAccessToken();return(0,A.jsx)(q.Z,{open:t,onClose:n,width:window.innerWidth>500?500:"100%",title:"Shared Files with batch number ".concat(i),placement:"right",destroyOnClose:!0,bodyStyle:{padding:"0px 25px"},children:null===o||void 0===o?void 0:o.map((function(e,n){var t,o,i,s;return(0,A.jsxs)("div",{className:xn,children:[null!==(t=e.fileType)&&void 0!==t&&t.includes("image")?(0,A.jsx)(U.Z,{src:"".concat(G.Q7).concat(e.path,"?authKey=").concat(r),alt:e.title,width:100,height:70,style:{borderRadius:5,objectFit:"cover"},preview:!1}):(0,A.jsx)(U.Z,{src:"/images/doc.png",alt:"Document-".concat(n),width:100,height:70,preview:!1,style:{objectFit:"contain"}}),(0,A.jsxs)("div",{className:gn,children:[(0,A.jsx)(yn,{ellipsis:{tooltip:e.title},children:e.title}),(0,A.jsx)(yn,{ellipsis:{tooltip:e.documentType},children:M.vZ[e.documentType]}),(0,A.jsx)(ve.Z,{title:"".concat(null===e||void 0===e||null===(o=e.AddedBy)||void 0===o?void 0:o.firstName," ").concat(null===e||void 0===e||null===(i=e.AddedBy)||void 0===i?void 0:i.lastName),children:(0,A.jsx)(oe.C,{icon:(0,A.jsx)(ie.Z,{}),size:"small",src:"".concat(G.lj).concat(null===e||void 0===e||null===(s=e.AddedBy)||void 0===s?void 0:s.profile)})})]})]},n)}))})},wn=function(e){var n=e.data,t=e.loading,o=(0,a.useState)(),i=(0,s.Z)(o,2),r=i[0],l=i[1],d=[{title:(0,A.jsx)(T.ZT,{color:"dark-sub",weight:"semi",children:"Batch No."}),dataIndex:"batchNumber",key:"batchNumber",render:function(e){return(0,A.jsx)(T.ZT,{color:"dark-sub",children:e})}},{title:(0,A.jsx)(T.ZT,{color:"dark-sub",weight:"semi",children:"Total Files"}),dataIndex:"sharedFiles",key:"sharedFiles",render:function(e,n){return(0,A.jsx)(T.ZT,{color:"dark-sub",className:"text-underline cursor-pointer",onClick:function(){return l({open:!0,data:e,batchNumber:n.batchNumber})},children:"".concat(null===e||void 0===e?void 0:e.length," Files")})}},{title:(0,A.jsx)(T.ZT,{color:"dark-sub",weight:"semi",children:"Date Shared"}),dataIndex:"sharedDate",key:"sharedDate",render:function(e){return(0,A.jsx)(T.ZT,{color:"dark-sub",children:(0,Be.Ny)(e,"dd M,yy-t")})}}];return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(_n.Z,{dataSource:n,columns:d,pagination:!1,loading:t,rowKey:"batchNumber",onHeaderRow:function(e,n){return{style:{backgroundColor:"var(--color-light)"}}}}),(null===r||void 0===r?void 0:r.open)&&(0,A.jsx)(Zn,{open:null===r||void 0===r?void 0:r.open,batchNumber:null===r||void 0===r?void 0:r.batchNumber,onClose:function(){return l({open:!1,data:[],batchNumber:0})},data:null===r||void 0===r?void 0:r.data})]})},Nn=fn.Z.Panel,bn=function(e){var n=e.projectId,t=(0,a.useMemo)((function(){return new p.Q}),[]),o=(0,h.$5)({method:function(){return t.sharedFiles(n)}}),i=o.data,r=o.loading;return(0,A.jsx)("div",{children:(0,A.jsx)(fn.Z,{defaultActiveKey:["sharedFiles"],expandIconPosition:"end",children:(0,A.jsx)(Nn,{header:"Shared Files",children:(0,A.jsx)(wn,{data:i,loading:r})},"sharedFiles")})})},kn={wrapper:"styles_wrapper__IBRDg",chat:"styles_chat__v+uul",chat_icon:"styles_chat_icon__n5xIy",main:"styles_main__A9the",main_body:"styles_main_body__rUqVv",main_body_title_wrap:"styles_main_body_title_wrap__uqSwc",main_body_title:"styles_main_body_title__iFITH",main_body_instructions_wrap:"styles_main_body_instructions_wrap__zA5g8",main_body_instructions:"styles_main_body_instructions__SjDn8",main_body_stats:"styles_main_body_stats__MTvjr",main_body_stats_card:"styles_main_body_stats_card__Ai96W",main_body_stats_card_title:"styles_main_body_stats_card_title__kw3bT",main_body_stats_card_value:"styles_main_body_stats_card_value__tQ6jw",main_body_stats_progress:"styles_main_body_stats_progress__SXc39",main_body_content:"styles_main_body_content__tuwXz",divider:"styles_divider__7xhg6",sidebar:"styles_sidebar__jlEtZ",main__header:"styles_main__header__DM4S1",main__header__top:"styles_main__header__top__gtxhJ",main__header__priority:"styles_main__header__priority__FkvIH",main_header_dropdowns:"styles_main_header_dropdowns__QQwtX",main_header_dropdowns_icon:"styles_main_header_dropdowns_icon__1zC7I"},Pn=t(69195),Sn=t(72333),Cn="styles_badge__TSK4A",Rn="styles_actionButtons__sXd50",Fn=t(46860),In=jn.Z.Paragraph,Mn=function(e){var n=e.projectId,t=(0,c.v9)((function(e){return e.usersReducer})).userPermissions.readInvoice,o=(0,a.useMemo)((function(){return new Sn.b}),[]),i=(0,a.useState)({}),r=(0,s.Z)(i,2),l=r[0],d=r[1],u=(0,a.useMemo)((function(){return n&&!0===t}),[t,n]),v=(0,h.K2)({method:o.getAllRecords,initialQuery:{projectId:n},condition:u}),m=v.data,p=v.loading,f=[{title:(0,A.jsxs)("div",{className:"d-flex items-center",children:[(0,A.jsx)("p",{className:"mb-0",children:"Invoice Number"}),(0,A.jsx)(ve.Z,{title:"Create Invoice",children:(0,A.jsx)(Fn.w,{className:"ml-2",style:{cursor:"pointer"},stroke:"var(--color-dark-main)",onClick:function(){return window.location.href="/invoice?projectId=".concat(n,"&actionType=create")}})})]}),dataIndex:"id",key:"id",render:function(e,t){return(0,A.jsxs)("div",{className:"d-flex items-center",children:[(0,A.jsx)(fe.Z,{color:"dark-main",children:t.invoiceNumber||"INV-".concat(e)}),(0,A.jsx)("div",{className:Rn,children:l[e]&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(ve.Z,{title:function(){return(0,A.jsxs)(A.Fragment,{children:[t.status===M.UY.Generated&&"Edit Invoice",t.status===M.UY.Paid&&"Cannot edit invoice because it is paid",t.status===M.UY.Canceled&&"Cannot edit invoice because it is canceled",t.status===M.UY.Sent&&"Cannot edit invoice because it is sent to the client"]})},children:(0,A.jsx)(R.Z,{className:"ml-3",style:{cursor:"pointer"},onClick:function(){t.status===M.UY.Generated&&(window.location.href="/invoice?id=".concat(e,"&projectId=").concat(n,"&actionType=edit"))}})}),(0,A.jsx)(C.Z,{className:"ml-3",size:"small",count:(0,A.jsx)("div",{className:Cn,onClick:function(){return window.location.href="/invoice?id=".concat(e,"&projectId=").concat(n,"&actionType=preview")},children:(0,A.jsx)("span",{style:{fontSize:"10px"},children:"Preview"})})})]})})]})},width:240},{title:"Last Message",dataIndex:"total",key:"total",render:function(e,n){var t;return(0,A.jsx)(In,{className:"mb-0",ellipsis:{rows:4,expandable:!1},style:{width:"100%"},children:(null===(t=n.InvoiceFollowUp)||void 0===t?void 0:t.length)>0?n.InvoiceFollowUp[0].note:""})},width:400},{title:"Status",dataIndex:"status",key:"status",render:function(e){return(0,A.jsx)(fe.Z,{color:"dark-main",children:M.UY[e]})},width:120},{title:"Amount",dataIndex:"total",key:"total",render:function(e){return(0,A.jsx)(fe.Z,{color:"dark-main",children:(0,J.xG)(e)})},width:120}];return(0,A.jsx)(A.Fragment,{children:!0===t&&(0,A.jsx)(_n.Z,{dataSource:m,columns:f,pagination:!1,loading:p,sticky:!0,rowKey:"id",style:{minHeight:"200px",overflowY:"auto"},onHeaderRow:function(e,n){return{style:{backgroundColor:"var(--color-light)"}}},onRow:function(e){return{onMouseEnter:function(){return d((0,x.Z)({},e.id,!0))},onMouseLeave:function(){return d({})}}}})})},Tn=t(16067),An=t(4619),zn=t(45960),Dn="styles_actionButtons__X+qji",En={financeColors:(o={},(0,x.Z)(o,M.dq["Pending Payment"],"var(--color-yellow-dark)"),(0,x.Z)(o,M.dq.Paid,"var(--color-primary-main)"),(0,x.Z)(o,M.dq.Canceled,"var(--color-red-yp)"),o),clientColors:(i={},(0,x.Z)(i,M.B1["To be sent"],"var(--color-yellow-dark)"),(0,x.Z)(i,M.B1.Sent,"var(--color-primary-main)"),i)},Bn=function(e){var n=e.projectId,t=(0,c.v9)((function(e){return e.usersReducer})).userPermissions.readPermit,o=(0,a.useMemo)((function(){return new An.C}),[]),i=(0,a.useState)({}),r=(0,s.Z)(i,2),l=r[0],d=r[1],u=(0,a.useState)(),v=(0,s.Z)(u,2),m=v[0],p=v[1],f=(0,a.useMemo)((function(){return n&&!0===t}),[t,n]),_=(0,h.K2)({method:o.getAllRecords,initialQuery:{projectId:n},condition:f}),j=_.data,g=_.loading,y=[{title:(0,A.jsxs)("div",{className:"d-flex items-center",children:[(0,A.jsx)("p",{className:"mb-0",children:"Permits"}),(0,A.jsx)(ve.Z,{title:"Create Permits",children:(0,A.jsx)(Fn.w,{className:"ml-2",style:{cursor:"pointer"},stroke:"var(--color-dark-main)",onClick:function(){return window.location.href="/permits?projectId=".concat(n,"&actionType=create")}})})]}),dataIndex:"id",key:"id",render:function(e,t){var o,i;return(0,A.jsxs)("div",{className:"d-flex align-center justify-space-between",children:[(0,A.jsxs)("div",{className:"d-flex flex-column",children:[(0,A.jsx)(fe.Z,{color:"dark-main",size:"sm",children:t.title}),(0,A.jsxs)("div",{className:"d-flex justify-between",children:[(0,A.jsx)(fe.Z,{color:"dark-main",size:"sm",weight:"bold",children:"Authority:"}),(0,A.jsx)(fe.Z,{color:"dark-main",size:"sm",className:"ml-1",children:t.Authority.title})]}),(0,A.jsxs)("div",{className:"d-flex justify-between",children:[(0,A.jsx)(fe.Z,{color:"dark-main",size:"sm",weight:"bold",children:"Remarks:"}),(0,A.jsx)(fe.Z,{color:"dark-main",size:"sm",className:"ml-1",children:t.remarks})]}),(0,A.jsx)(fe.Z,{color:"dark-sub",size:"sm",className:"cursor-pointer text-underline mt-1",onClick:function(){var e;(null===t||void 0===t||null===(e=t._count)||void 0===e?void 0:e.Resources)>0&&p({open:!0,id:t.id})},children:"".concat((null===t||void 0===t||null===(o=t._count)||void 0===o?void 0:o.Resources)>0?"".concat(null===t||void 0===t||null===(i=t._count)||void 0===i?void 0:i.Resources," files Attached"):"No Attachments"," ")})]}),(0,A.jsx)("div",{className:Dn,children:l[e]&&(0,A.jsxs)("div",{className:"d-flex align-center",children:[(0,A.jsx)(ve.Z,{title:"View More",children:(0,A.jsx)(Tn.Z,{style:{cursor:"pointer"},onClick:function(){return window.location.href="/permits?id=".concat(e,"&projectId=").concat(n,"&actionType=view")}})}),(0,A.jsx)(ve.Z,{title:"Edit",children:(0,A.jsx)(R.Z,{className:"ml-3",style:{cursor:"pointer"},onClick:function(){return window.location.href="/permits?id=".concat(e,"&projectId=").concat(n,"&actionType=edit")}})})]})})]})},width:"400px"},{title:"Date/Status",dataIndex:"date",key:"date",render:function(e,n){var t=(0,J.H8)(null===n||void 0===n?void 0:n.expiryDate,(new Date).toISOString());return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)("div",{className:"d-flex justify-between",children:[(0,A.jsx)(fe.Z,{color:"dark-main",size:"sm",weight:"bold",children:"Approved:"}),(0,A.jsx)(fe.Z,{color:"dark-main",size:"sm",className:"ml-1",children:(0,Be.Ny)(n.approvedDate,"MM dd,yy")})]}),(0,A.jsxs)("div",{className:"d-flex justify-between",children:[(0,A.jsx)(fe.Z,{color:"dark-main",size:"sm",weight:"bold",children:"Expiry:"}),(0,A.jsx)(fe.Z,{color:"dark-main",size:"sm",className:"ml-1",children:(0,Be.Ny)(n.expiryDate,"MM dd,yy")})]}),(0,A.jsxs)("div",{className:"d-flex justify-between mt-2",children:[(0,A.jsx)(fe.Z,{color:"dark-main",size:"sm",weight:"bold",children:"Status:"}),(0,A.jsx)(fe.Z,{size:"sm",className:"ml-1 ".concat(t?"color-red-yp":"color-primary-main"),children:t?"Expired":"Active"})]})]})},width:"200px"},{title:"Finance Status",dataIndex:"financeStatus",key:"financeStatus",render:function(e){return(0,A.jsx)(fe.Z,{style:{color:En.financeColors[e]},children:M.dq[e]})},width:"150px"},{title:"Client Status",dataIndex:"clientStatus",key:"clientStatus",render:function(e){return(0,A.jsx)(fe.Z,{style:{color:En.clientColors[e]},children:M.B1[e]})},width:"150px"}];return(0,A.jsxs)(A.Fragment,{children:[!0===t&&(0,A.jsx)(_n.Z,{dataSource:j,columns:y,pagination:!1,loading:g,sticky:!0,rowKey:"id",style:{minHeight:"200px",overflowY:"auto"},onHeaderRow:function(e,n){return{style:{backgroundColor:"var(--color-light)"}}},onRow:function(e){return{onMouseEnter:function(){return d((0,x.Z)({},e.id,!0))},onMouseLeave:function(){return d({})}}},scroll:{x:1e3}}),(null===m||void 0===m?void 0:m.open)&&(0,A.jsx)(zn.Z,{id:m.id,open:m.open,onClose:function(){return p({open:!1,id:0})}})]})},Ln=t(70638),Un=t(22367),Hn="styles_actionButtons__NHZLf",On=function(e){var n=e.projectId,t=(0,c.v9)((function(e){return e.usersReducer})).userPermissions.readTransaction,o=(0,a.useMemo)((function(){return new Un.e}),[]),i=(0,a.useState)({}),r=(0,s.Z)(i,2),l=r[0],d=r[1],u=(0,a.useMemo)((function(){return n&&!0===t}),[t,n]),v=(0,h.K2)({method:o.getAllRecords,initialQuery:{projectId:n,onlyGovernmentFees:!0},condition:u}),m=v.data,p=v.loading,f=v.onRefresh,_=[{title:(0,A.jsxs)("div",{style:{overflow:"auto"},className:"d-flex align-center",children:[(0,A.jsx)(Ln.Z,{defaultValue:"onlyGovernmentFees",options:[{label:"Government Fees",value:"onlyGovernmentFees"},{label:"Invoice Payments",value:"onlyInvoicePayments"}],onChange:function(e){var t;return f((t={},(0,x.Z)(t,e,!0),(0,x.Z)(t,"projectId",n),t))}}),(0,A.jsx)(ve.Z,{title:"Create Government Fees",children:(0,A.jsx)(K.wl,{className:"ml-2",style:{cursor:"pointer"},stroke:"var(--color-dark-main)",onClick:function(){return window.location.href="/transactions?projectId=".concat(n,"&actionType=create")}})})]}),dataIndex:"id",key:"id",render:function(e,t){return(0,A.jsxs)("div",{className:"d-flex align-center justify-space-between",children:[(0,A.jsxs)("div",{className:"d-flex flex-column",children:[(0,A.jsx)(fe.Z,{color:"dark-main",size:"sm",children:t.title}),(0,A.jsxs)("div",{className:"d-flex items-center",children:[(0,A.jsx)(fe.Z,{color:"dark-main",size:"sm",weight:"bold",children:"Remarks:"}),(0,A.jsx)(fe.Z,{color:"dark-main",size:"sm",className:"ml-1",children:t.remarks})]})]}),(0,A.jsx)("div",{className:Hn,children:l[e]&&(0,A.jsxs)("div",{className:"d-flex align-center",children:[(0,A.jsx)(ve.Z,{title:"View More",children:(0,A.jsx)(Tn.Z,{style:{cursor:"pointer"},onClick:function(){return window.location.href="/transactions?id=".concat(e,"&projectId=").concat(n,"&actionType=view")}})}),(0,A.jsx)(ve.Z,{title:"Edit",children:(0,A.jsx)(R.Z,{className:"ml-3",style:{cursor:"pointer"},onClick:function(){return window.location.href="/transactions?id=".concat(e,"&projectId=").concat(n,"&actionType=edit")}})})]})})]})},width:"400px"},{title:"Overview",dataIndex:"overview",key:"overview",render:function(e,n){var t;return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)("div",{className:"d-flex justify-between",children:[(0,A.jsx)(fe.Z,{color:"dark-main",size:"sm",weight:"bold",children:"Reference:"}),(0,A.jsx)(fe.Z,{color:"dark-main",size:"sm",className:"ml-1",children:n.transactionReference})]}),(0,A.jsxs)("div",{className:"d-flex justify-between",children:[(0,A.jsx)(fe.Z,{color:"dark-main",size:"sm",weight:"bold",children:"Date:"}),(0,A.jsx)(fe.Z,{color:"dark-main",size:"sm",className:"ml-1",children:(0,Be.Ny)(n.transactionDate,"dd M,yy")})]}),(0,A.jsxs)("div",{className:"d-flex justify-between flex-wrap",children:[(0,A.jsx)(fe.Z,{color:"dark-main",size:"sm",weight:"bold",children:"Authority:"}),(0,A.jsx)(fe.Z,{color:"dark-main",size:"sm",className:"ml-1",children:null===n||void 0===n||null===(t=n.Authority)||void 0===t?void 0:t.title})]}),(null===n||void 0===n?void 0:n.receipt)&&(0,A.jsxs)("a",{href:"".concat(G.PO).concat(null===n||void 0===n?void 0:n.receipt),target:"_blank",rel:"noreferrer",title:" View Receipt",className:"d-flex align-center mt-2",children:[(0,A.jsx)(fe.Z,{color:"dark-main",size:"sm",children:"View Receipt"}),(0,A.jsx)(K.O1,{})]})]})},width:"350px"},{title:"Amount",dataIndex:"amount",key:"amount",render:function(e){return(0,A.jsx)(fe.Z,{color:"dark-main",children:(0,J.xG)(e)})},width:"200px"},{title:"Assigned To",dataIndex:"AssignedTo",key:"AssignedTo",render:function(e){return(0,A.jsxs)("div",{className:"d-flex align-center",children:[(0,A.jsx)(oe.C,{src:"".concat(G.lj).concat(null===e||void 0===e?void 0:e.profile),icon:(0,A.jsx)(ie.Z,{}),size:30}),(0,A.jsx)(fe.Z,{color:"dark-sub",size:"sm",className:"ml-1",children:"".concat(null!==e&&void 0!==e&&e.firstName&&null!==e&&void 0!==e&&e.lastName?"".concat(null===e||void 0===e?void 0:e.firstName," ").concat(null===e||void 0===e?void 0:e.lastName):"Not Assigned")})]})},width:"250px"},{title:"Status",dataIndex:"status",key:"status",render:function(e){return(0,A.jsx)(fe.Z,{color:"dark-main",children:M.LN[e]})},width:"150px"}];return(0,A.jsx)(A.Fragment,{children:!0===t&&(0,A.jsx)(_n.Z,{dataSource:m,columns:_,pagination:!1,loading:p,sticky:!0,rowKey:"id",style:{minHeight:"200px",overflowY:"auto"},onHeaderRow:function(e,n){return{style:{backgroundColor:"var(--color-light)"}}},onRow:function(e){return{onMouseEnter:function(){return d((0,x.Z)({},e.id,!0))},onMouseLeave:function(){return d({})}}},scroll:{x:1e3}})})},Yn=t(12997),qn="Project Estimate",Qn="Invoiced Amount",Vn="Other Expenses",Wn="To Be Invoiced",Kn="Invoice To Collect",Gn="Gov. Fees To Collect",Xn="Permit Expiring",Jn=function(e){var n,t,o,i,l,c,u,v,m,h,f,_,j,D,E,B,L,U,H,O,Y,q,Q,V,W,K,G,X,$,ee,ne,te,oe,ie,re,se,ae,le,de,ce,ve,me,he,pe,fe,_e,je,xe=e.permissions,ge=e.data,ye=e.onDelete,Ze=e.onEdit,we=e.setFetchFiles,Ne=(0,a.useMemo)((function(){return new p.Q}),[]),be=ge.project,ke=ge.projectFiles,Se=ge.projectStates,Ce=xe.readProject,Re=(0,y.s0)(),Fe=(0,a.useState)(!1),Ie=(0,s.Z)(Fe,2),Me=Ie[0],Te=Ie[1],Ae=(0,a.useState)({data:[],meta:{},loading:!1}),ze=(0,s.Z)(Ae,2),Ee=ze[0],Be=ze[1],Le=(0,a.useMemo)((function(){var e;return!!(null===be||void 0===be||null===(e=be.data)||void 0===e?void 0:e.id)&&!0===Ce&&!0===Me}),[Ce,null===be||void 0===be||null===(n=be.data)||void 0===n?void 0:n.id,Me]),Ue=(0,a.useCallback)((function(e){var n,t;if(null!==be&&void 0!==be&&null!==(n=be.data)&&void 0!==n&&n.id){var o=(0,g.Z)({projectId:null===be||void 0===be||null===(t=be.data)||void 0===t?void 0:t.id,perPage:7},e);Ne.getProjectConversations(o).then((function(e){var n=null===e||void 0===e?void 0:e.data,t=n.data,o=n.meta,i=null===t||void 0===t?void 0:t.filter((function(e){var n;return!(null!==Ee&&void 0!==Ee&&null!==(n=Ee.data)&&void 0!==n&&n.find((function(n){return n.id===e.id})))}));Be((function(e){return{data:[].concat((0,r.Z)((null===e||void 0===e?void 0:e.data)||[]),(0,r.Z)(i||[])),meta:o||{},loading:!1}}))})).catch((function(e){var n=(0,J.S3)(e);d.ZP.error(n||"Something went wrong"),Be((function(e){return{data:(null===e||void 0===e?void 0:e.data)||[],meta:(null===e||void 0===e?void 0:e.meta)||{},loading:!1}}))}))}}),[null===be||void 0===be||null===(t=be.data)||void 0===t?void 0:t.id,null===Ee||void 0===Ee?void 0:Ee.data]),He=(0,a.useState)("details"),Oe=(0,s.Z)(He,2),Ye=Oe[0],qe=Oe[1],Qe=(0,a.useState)(!1),Ve=(0,s.Z)(Qe,2),We=Ve[0],Ke=Ve[1],Ge=(0,a.useState)(!1),Xe=(0,s.Z)(Ge,2),Je=Xe[0],$e=Xe[1],en=(0,a.useState)({title:{value:"",show:!1},instructions:{value:"",show:!1}}),nn=(0,s.Z)(en,2),tn=nn[0],on=nn[1],rn=function(e){var n=e.name,t=e.value;on((function(e){return(0,g.Z)((0,g.Z)({},e),{},(0,x.Z)({},n,(0,g.Z)((0,g.Z)({},e[n]),{},{value:t})))}))},sn=function(e){var n=e.name,t=e.value;on((function(e){return(0,g.Z)((0,g.Z)({},e),{},(0,x.Z)({},n,(0,g.Z)((0,g.Z)({},e[n]),{},{show:t})))}))},an=function(e){var n,t=e.name,o=e.value;sn({name:t,value:!1}),""!==o&&Ze((0,x.Z)({},t,o),null===be||void 0===be||null===(n=be.data)||void 0===n?void 0:n.id)};return(0,a.useEffect)((function(){Le&&Ue()}),[Le]),(0,A.jsxs)("div",{className:kn.wrapper,children:[(0,A.jsxs)("section",{className:kn.main,children:[(0,A.jsxs)("div",{className:kn.main__header,children:[(0,A.jsxs)("div",{className:kn.main__header__top,children:[(0,A.jsx)(T.ZT,{type:"h1",size:"normal",color:"dark-sub",weight:"bold",className:"my-auto",children:null!==be&&void 0!==be&&null!==(o=be.data)&&void 0!==o&&o.referenceNumber?"".concat(null===be||void 0===be||null===(i=be.data)||void 0===i?void 0:i.referenceNumber):"No Reference Number"}),(0,A.jsx)(Z.Z,{className:kn.main__header__priority,color:null===(l=M.tt[null===be||void 0===be||null===(c=be.data)||void 0===c?void 0:c.priority])||void 0===l?void 0:l.color,children:null===(u=M.tt[null===be||void 0===be||null===(v=be.data)||void 0===v?void 0:v.priority])||void 0===u?void 0:u.title})]}),(0,A.jsxs)("div",{className:kn.main_header_dropdowns,children:[(0,A.jsx)(De,{permissions:xe,data:{project:be.data,onRefresh:be.onRefresh}}),(0,A.jsx)(Pn.Z,{permissions:xe,data:{projectStates:Se.data,project:{data:be.data,onRefresh:be.onRefresh}}}),(0,A.jsx)(w.Z,{trigger:["click"],open:We,onOpenChange:function(e){return Ke(e)},menu:{items:[{key:"edit",label:"Edit",icon:(0,A.jsx)(R.Z,{}),onClick:function(){var e;Re("/projects/edit?id=".concat(null===be||void 0===be||null===(e=be.data)||void 0===e?void 0:e.id))}},{key:"delete",label:(0,A.jsx)(N.Z,{title:"Are you sure to delete this project?",okText:"Yes",cancelText:"No",placement:"bottom",open:Je,onOpenChange:function(e){return $e(e)},onConfirm:function(){var e;return ye(null===be||void 0===be||null===(e=be.data)||void 0===e?void 0:e.id)},children:"Delete"}),icon:(0,A.jsx)(F.Z,{}),danger:!0,onClick:function(){return $e(!Je)}}]},children:(0,A.jsx)(I.Z,{className:kn.main_header_dropdowns_icon})})]})]}),(0,A.jsxs)("div",{className:kn.main_body,children:[(0,A.jsx)("div",{className:kn.main_body_title_wrap,children:null!==tn&&void 0!==tn&&tn.title.show?(0,A.jsx)(T.Vm,{onBlur:function(){return sn({name:"title",value:!1})},onMouseDown:function(){var e;return an({name:"title",value:null===tn||void 0===tn||null===(e=tn.title)||void 0===e?void 0:e.value})},onChange:function(e){return rn({name:"title",value:e.target.value})},defaultValue:null===be||void 0===be||null===(m=be.data)||void 0===m?void 0:m.title,style:{padding:"4px 0px",fontWeight:"var(--font-weight-md)"},size:"small"}):(0,A.jsx)("h3",{className:kn.main_body_title,onClick:function(){return sn({name:"title",value:!0})},children:(null===be||void 0===be||null===(h=be.data)||void 0===h?void 0:h.title)||"No title provided, click to add title"})}),(0,A.jsx)("div",{className:kn.main_body_instructions_wrap,onClick:function(){return sn({name:"instructions",value:!0})},children:null!==tn&&void 0!==tn&&tn.instructions.show?(0,A.jsx)(T.Hp,{autoSize:{minRows:8},onBlur:function(){return sn({name:"instructions",value:!1})},onMouseDown:function(){var e;return an({name:"instructions",value:null===tn||void 0===tn||null===(e=tn.instructions)||void 0===e?void 0:e.value})},onChange:function(e){return rn({name:"instructions",value:e.target.value})},defaultValue:null===be||void 0===be||null===(f=be.data)||void 0===f?void 0:f.instructions,className:"font-size-normal font-weight-normal pa-1",style:{fontWeight:"var(--font-weight-md)"}}):(0,A.jsx)("div",{className:kn.main_body_instructions,children:(null===be||void 0===be||null===(_=be.data)||void 0===_?void 0:_.instructions)||"No instructions provided, click to add instructions"})}),(null===be||void 0===be||null===(j=be.data)||void 0===j?void 0:j.FinanceReport)&&(0,A.jsxs)("div",{className:kn.main_body_stats,children:[(0,A.jsxs)(b.Z,{size:"small",className:kn.main_body_stats_card,children:[(0,A.jsx)("b",{children:qn}),(0,A.jsx)("p",{className:kn.main_body_stats_card_value,children:(0,J.xG)(null===be||void 0===be||null===(D=be.data)||void 0===D||null===(E=D.FinanceReport)||void 0===E?void 0:E.projectEstimate)||0})]}),(0,A.jsxs)(b.Z,{size:"small",className:kn.main_body_stats_card,children:[(0,A.jsx)("b",{children:Qn}),(0,A.jsx)("p",{className:kn.main_body_stats_card_value,children:(0,J.xG)(null===be||void 0===be||null===(B=be.data)||void 0===B||null===(L=B.FinanceReport)||void 0===L?void 0:L.invoicedAmount)||0}),(0,A.jsxs)("div",{className:kn.main_body_stats_progress,children:[(0,A.jsxs)("p",{className:"mb-0 font-size-xs",style:{fontWeight:400},children:[(null===be||void 0===be||null===(U=be.data)||void 0===U||null===(H=U.FinanceReport)||void 0===H||null===(O=H.invoicedPercentage)||void 0===O?void 0:O.toFixed(2))||0,"% of ",qn]}),(0,A.jsx)(k.Z,{strokeColor:{from:"#108ee9",to:"#87d068"},percent:(null===be||void 0===be||null===(Y=be.data)||void 0===Y||null===(q=Y.FinanceReport)||void 0===q?void 0:q.invoicedPercentage)||0,status:"active",showInfo:!1})]})]}),(0,A.jsxs)(b.Z,{size:"small",className:kn.main_body_stats_card,children:[(0,A.jsx)("b",{children:Vn}),(0,A.jsx)("p",{className:kn.main_body_stats_card_value,children:(0,J.xG)(null===be||void 0===be||null===(Q=be.data)||void 0===Q||null===(V=Q.FinanceReport)||void 0===V?void 0:V.timeAndExpensesAmount)||0})]}),(0,A.jsxs)(b.Z,{size:"small",className:kn.main_body_stats_card,children:[(0,A.jsx)("b",{children:Wn}),(0,A.jsx)("p",{className:kn.main_body_stats_card_value,children:(0,J.xG)(null===be||void 0===be||null===(W=be.data)||void 0===W||null===(K=W.FinanceReport)||void 0===K?void 0:K.toBeInvoicedAmount)||0}),(0,A.jsxs)("div",{className:kn.main_body_stats_progress,children:[(0,A.jsxs)("p",{className:"mb-0 font-size-xs",style:{fontWeight:400},children:[(null===be||void 0===be||null===(G=be.data)||void 0===G||null===(X=G.FinanceReport)||void 0===X||null===($=X.toBeInvoicedAmountPercentage)||void 0===$?void 0:$.toFixed(2))||0,"% of ",qn]}),(0,A.jsx)(k.Z,{strokeColor:{from:"#108ee9",to:"#87d068"},percent:(null===be||void 0===be||null===(ee=be.data)||void 0===ee||null===(ne=ee.FinanceReport)||void 0===ne?void 0:ne.toBeInvoicedAmountPercentage)||0,status:"active",showInfo:!1,size:"small"})]})]}),(0,A.jsxs)(b.Z,{size:"small",className:kn.main_body_stats_card,bodyStyle:{display:"flex",margin:"auto 0",flexDirection:"column"},children:[(0,A.jsxs)("p",{className:"".concat(kn.main_body_stats_card_title," mb-1"),children:[Kn,": ","",(null===be||void 0===be||null===(te=be.data)||void 0===te||null===(oe=te.FinanceReport)||void 0===oe?void 0:oe.invoiceToCollectPayment)||0]}),(0,A.jsxs)("p",{className:"".concat(kn.main_body_stats_card_title," mb-1"),style:{color:(null===be||void 0===be||null===(ie=be.data)||void 0===ie||null===(re=ie.FinanceReport)||void 0===re?void 0:re.governmentFeesToCollect)>0?"var(--color-red-yp)":""},children:[Gn,": ","",(null===be||void 0===be||null===(se=be.data)||void 0===se||null===(ae=se.FinanceReport)||void 0===ae?void 0:ae.governmentFeesToCollect)||0]}),(0,A.jsxs)("p",{className:"".concat(kn.main_body_stats_card_title," mb-0"),style:{color:(null===be||void 0===be||null===(le=be.data)||void 0===le||null===(de=le.FinanceReport)||void 0===de?void 0:de.permitExpiringThisMonth)>0?"var(--color-red-yp)":""},children:[Xn,": ","",(null===be||void 0===be||null===(ce=be.data)||void 0===ce||null===(ve=ce.FinanceReport)||void 0===ve?void 0:ve.permitExpiringThisMonth)||0]})]})]}),(0,A.jsx)("div",{className:"mb-4",children:(0,A.jsx)(Pe,{data:null===be||void 0===be?void 0:be.data,onRefresh:be.onRefresh})})]}),(0,A.jsx)(Mn,{projectId:null===be||void 0===be||null===(me=be.data)||void 0===me?void 0:me.id}),(0,A.jsx)(Bn,{projectId:null===be||void 0===be||null===(he=be.data)||void 0===he?void 0:he.id}),(0,A.jsx)(On,{projectId:null===be||void 0===be||null===(pe=be.data)||void 0===pe?void 0:pe.id})]}),(0,A.jsx)(P.Z,{className:kn.divider,type:"vertical"}),(0,A.jsx)("section",{className:kn.sidebar,children:(0,A.jsx)(S.Z,{style:{overflowX:"hidden"},className:"sidebar_tabs",activeKey:Ye,onChange:function(e){var n=e;qe(n),"files"===n&&we(!0)},renderTabBar:function(e,n){return(0,A.jsx)("div",{className:kn.tabBar_header,children:(0,A.jsx)(n,(0,g.Z)((0,g.Z)({},e),{},{className:"mb-2",style:{fontSize:"var(--font-size-md)"}}))})},items:[{label:"Details",key:"details",children:(0,A.jsx)(ln,{permissions:xe,onEdit:Ze,data:{project:{data:null===be||void 0===be?void 0:be.data,onRefresh:be.onRefresh}}})},{label:(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("span",{className:"mr-2",children:"Files"}),(0,A.jsx)(C.Z,{count:(null===be||void 0===be||null===(fe=be.data)||void 0===fe||null===(_e=fe._count)||void 0===_e?void 0:_e.Resources)||0,showZero:!0,color:"#faad14"})]}),key:"files",children:(0,A.jsx)(pn,{permissions:xe,data:{project:{data:null===be||void 0===be?void 0:be.data,onRefresh:be.onRefresh},projectFiles:{data:null===ke||void 0===ke?void 0:ke.data,onRefresh:ke.onRefresh,meta:null===ke||void 0===ke?void 0:ke.meta,loading:null===ke||void 0===ke?void 0:ke.loading}},onEdit:Ze})},{label:"Reports",key:"reports",children:(0,A.jsx)(bn,{projectId:null===be||void 0===be||null===(je=be.data)||void 0===je?void 0:je.id})}]})}),(0,A.jsx)("div",{className:kn.chat,children:(0,A.jsx)(w.Z,{trigger:["click"],open:Me,dropdownRender:function(){var e,n;return(0,A.jsx)(ue,{projectId:null===be||void 0===be||null===(e=be.data)||void 0===e?void 0:e.id,conversations:Ee,setProjectConversations:Be,onRefresh:Ue,permissions:xe,projectMembers:null===be||void 0===be||null===(n=be.data)||void 0===n?void 0:n.ProjectMembers})},overlayStyle:{width:400,boxShadow:"0px 0px 10px 0px rgba(0,0,0,0.1)"},children:(0,A.jsx)("div",{className:kn.chat_icon,onClick:function(){return Te(!Me)},children:Me?(0,A.jsx)(Yn.D,{color:"#fff"}):(0,A.jsx)(z,{width:24,height:24})})})})]})},$n=t(21600),et=t(5140),nt=[{text:"Home",isLink:!0,path:"/"},{text:"Projects",isLink:!0,path:"/projects?all=true"}],tt=function(){var e=(0,l.lr)(),n=(0,s.Z)(e,1)[0],t=Object.values(f.n).map((function(e){return e})),o=(0,c.v9)((function(e){return e.usersReducer})).userPermissions,i=o.readProject,x=o.deleteProject,g=o.updateProject,y=(0,a.useState)(!1),Z=(0,s.Z)(y,2),w=Z[0],N=Z[1],b=window.location.pathname.split("/")[2],k=(0,a.useMemo)((function(){return new p.Q}),[]),P=(0,a.useMemo)((function(){return new _.x}),[]),S=(0,a.useMemo)((function(){return!!b&&!0===i}),[b,i]),C=(0,a.useMemo)((function(){return!!n.get("id")&&!0===i&&!0===w}),[i,w]),R=(0,h.K2)({method:function(){return k.getRecordBySlug(b)},condition:S}),F=R.data,I=R.loading,M=R.onRefresh,T=R.error,z=(0,h.$5)({method:P.getPublishedRecords,initialQuery:{perPage:50}}),D=z.data,E=z.onRefresh,B=z.loading,L=(0,h.K2)({method:k.getProjectResources,initialQuery:{projectId:n.get("id"),perPage:12},condition:C}),U=L.data,H=L.onRefresh,O=L.loading,Y=L.meta,q=(0,a.useMemo)((function(){return F&&!I?[].concat(nt,[{text:F.title,isLink:!1}]):nt}),[F,I]);return(0,a.useEffect)((function(){S&&M()}),[S]),(0,A.jsxs)(u.Z,{permissionSlug:[].concat((0,r.Z)(t),[j.H.READ,j.H.CREATE,j.H.UPDATE,$n.B.READ,$n.B.CREATE,$n.B.UPDATE,et.O.READ,et.O.CREATE,et.O.UPDATE]),children:[(0,A.jsx)(m.Z,{data:q}),!0===i&&F&&!I&&(0,A.jsx)(Jn,{permissions:o,onDelete:function(e){!0===x?k.deleteRecord(e).then((function(){d.ZP.success("Project deleted successfully"),window.location.href="/projects?all=true"})).catch((function(e){var n=e.response.data.message||"Something went wrong!";d.ZP.error(n)})):d.ZP.error("You don't have permission to delete this project, Please contact your admin")},onEdit:function(e,n){!0===g?k.updateRecord(e,n).then((function(e){var n=e.data;d.ZP.success(n.message),M()})).catch((function(e){var n=e.response.data.message||"Something went wrong!";d.ZP.error(n)})):d.ZP.error("You don't have permission to update this project, Please contact your admin")},setFetchFiles:N,data:{project:{data:F,onRefresh:M,loading:I},projectFiles:{data:U,onRefresh:H,loading:O,meta:Y},projectStates:{data:D,onRefresh:E,loading:B}}}),!1===i&&!I&&!F&&(0,A.jsx)(v.a$,{mainMessage:"You don't have permission to view this data"}),"Cannot read properties of null (reading 'id')"===T&&!I&&(0,A.jsx)(v.tL,{mainMessage:"Project not found",subMessage:"Please check the URL or contact your administrator"})]})}},48297:function(e,n,t){t.d(n,{V:function(){return s}});var o=t(43144),i=t(15671),r=t(49075),s=(0,o.Z)((function e(){var n=this;(0,i.Z)(this,e),this.endPoint="client",this.getAllRecords=function(e){return r.Z.get(n.endPoint,{params:e})},this.getRecordById=function(e){return r.Z.get("".concat(n.endPoint,"/").concat(e))},this.findPublished=function(e){return r.Z.get("".concat(n.endPoint,"/find-published"),{params:e})},this.deleteRecord=function(e){return r.Z.delete("".concat(n.endPoint,"/").concat(e))},this.createRecord=function(e){return r.Z.post(n.endPoint,e)},this.updateRecord=function(e,t){return r.Z.patch("".concat(n.endPoint,"/").concat(t),e)}}))},72333:function(e,n,t){t.d(n,{b:function(){return a}});var o=t(43144),i=t(15671),r=t(49075),s=t(3135),a=(0,o.Z)((function e(){var n=this;(0,i.Z)(this,e),this.endPoint="invoice",this.getAllRecords=function(e){return r.Z.get(n.endPoint,{params:e})},this.getRecordById=function(e){return r.Z.get("".concat(n.endPoint,"/findOne/").concat(e))},this.createRecord=function(e){return r.Z.post(n.endPoint,e,{headers:s.C})},this.updateRecord=function(e,t){return r.Z.patch("".concat(n.endPoint,"/updateOne/").concat(t),e,{headers:s.C})},this.submitInvoice=function(e){return r.Z.patch("".concat(n.endPoint,"/submitInvoice/").concat(e))},this.changeStatus=function(e,t){return console.log(t),r.Z.patch("".concat(n.endPoint,"/changeStatus/").concat(e),t)},this.deleteRecord=function(e){return r.Z.delete("".concat(n.endPoint,"/remove/").concat(e))},this.markAsSent=function(e){return r.Z.patch("".concat(n.endPoint,"/markAsSent/").concat(e))},this.prepareUniqueInvoiceNumber=function(){return r.Z.get("".concat(n.endPoint,"/prepareUniqueInvoiceNumber"))},this.checkForDuplicacy=function(e){return r.Z.get("".concat(n.endPoint,"/checkForDuplicacy"),{params:e})},this.quickUpdate=function(e,t){return r.Z.patch("".concat(n.endPoint,"/quickUpdate/").concat(e),t)},this.addNote=function(e,t){return r.Z.post("".concat(n.endPoint,"/addNote/").concat(e),t)},this.getNoteById=function(e){return r.Z.get("".concat(n.endPoint,"/notes/").concat(e))},this.removeNote=function(e){return r.Z.delete("".concat(n.endPoint,"/removeNote/").concat(e))},this.getLogsById=function(e,t){return r.Z.get("".concat(n.endPoint,"/logs/").concat(e),{params:t})},this.markConcernAsResolved=function(e){return r.Z.patch("".concat(n.endPoint,"/markConcernAsResolved/").concat(e))},this.getCounts=function(){return r.Z.get("".concat(n.endPoint,"/getCounts"))}}))},5190:function(e,n,t){t.d(n,{L:function(){return a}});var o=t(43144),i=t(15671),r=t(49075),s=t(3135),a=(0,o.Z)((function e(){var n=this;(0,i.Z)(this,e),this.endPoint="organization",this.getAllRecords=function(e){return r.Z.get(n.endPoint,{params:e})},this.findPublished=function(e){return r.Z.get(n.endPoint+"/find-published",{params:e})},this.getRecordById=function(e){return r.Z.get("".concat(n.endPoint,"/").concat(e))},this.deleteRecord=function(e){return r.Z.delete("".concat(n.endPoint,"/").concat(e))},this.createRecord=function(e){return r.Z.post(n.endPoint,e,{headers:s.C})},this.updateRecord=function(e,t){return r.Z.patch("".concat(n.endPoint,"/").concat(t),e,{headers:s.C})},this.getTenants=function(){return r.Z.get("xero/getTenants")}}))},4619:function(e,n,t){t.d(n,{C:function(){return a}});var o=t(43144),i=t(15671),r=t(49075),s=t(3135),a=(0,o.Z)((function e(){var n=this;(0,i.Z)(this,e),this.endPoint="permits",this.getAllRecords=function(e){return r.Z.get(n.endPoint,{params:e})},this.getRecordById=function(e){return r.Z.get("".concat(n.endPoint,"/").concat(e))},this.deleteRecord=function(e){return r.Z.delete("".concat(n.endPoint,"/").concat(e))},this.createRecord=function(e){return r.Z.post(n.endPoint,e,{headers:s.C})},this.updateRecord=function(e,t){return r.Z.patch("".concat(n.endPoint,"/").concat(t),e,{headers:s.C})}}))},73257:function(e,n,t){t.d(n,{x:function(){return s}});var o=t(43144),i=t(15671),r=t(49075),s=(0,o.Z)((function e(){var n=this;(0,i.Z)(this,e),this.endPoint="project-state",this.getAllRecords=function(e){return r.Z.get(n.endPoint,{params:e})},this.getPublishedRecords=function(e){return r.Z.get("".concat(n.endPoint,"/find-published"),{params:e})},this.getRecordById=function(e){return r.Z.get(n.endPoint+"/"+e)},this.deleteRecord=function(e){return r.Z.delete(n.endPoint+"/"+e)},this.createRecord=function(e){return r.Z.post(n.endPoint,e)},this.updateRecord=function(e,t){return r.Z.patch(n.endPoint+"/"+t,e)}}))},42954:function(e,n,t){t.d(n,{K:function(){return a}});var o=t(43144),i=t(15671),r=t(49075),s=t(3135),a=(0,o.Z)((function e(){var n=this;(0,i.Z)(this,e),this.endPoint="quotation",this.getAllRecords=function(e){return r.Z.get(n.endPoint,{params:e})},this.getRecordById=function(e){return r.Z.get("".concat(n.endPoint,"/findOne/").concat(e))},this.createRecord=function(e){return r.Z.post(n.endPoint,e,{headers:s.C})},this.autoCreateFromApprovedQuotation=function(e){return r.Z.post("".concat(n.endPoint,"/autoCreateProjectFromApprovedQuotation/"),e)},this.updateRecord=function(e,t){return r.Z.patch("".concat(n.endPoint,"/updateOne/").concat(t),e)},this.submitQuotation=function(e){return r.Z.patch("".concat(n.endPoint,"/submitQuotation/").concat(e))},this.changeStatus=function(e,t){return r.Z.patch("".concat(n.endPoint,"/changeStatus/").concat(e),{status:t})},this.deleteRecord=function(e){return r.Z.delete("".concat(n.endPoint,"/remove/").concat(e))},this.completeMilestone=function(e){return r.Z.patch("".concat(n.endPoint,"/completeMilestone/").concat(e))},this.markAsSent=function(e){return r.Z.patch("".concat(n.endPoint,"/markAsSent/").concat(e))},this.prepareUniqueQuoteNumber=function(e){return r.Z.get("".concat(n.endPoint,"/prepareUniqueQuoteNumber"),{params:e})},this.checkForDuplicacy=function(e){return r.Z.get("".concat(n.endPoint,"/checkForDuplicacy"),{params:e})},this.quickUpdate=function(e,t){return r.Z.patch("".concat(n.endPoint,"/quickUpdate/").concat(e),t)}}))},22367:function(e,n,t){t.d(n,{e:function(){return a}});var o=t(43144),i=t(15671),r=t(49075),s=t(3135),a=(0,o.Z)((function e(){var n=this;(0,i.Z)(this,e),this.endPoint="transactions",this.getAllRecords=function(e){return r.Z.get(n.endPoint,{params:e})},this.getRecordById=function(e){return r.Z.get("".concat(n.endPoint,"/").concat(e))},this.deleteRecord=function(e){return r.Z.delete("".concat(n.endPoint,"/").concat(e))},this.createRecord=function(e){return r.Z.post(n.endPoint,e,{headers:s.C})},this.updateRecord=function(e,t){return r.Z.patch("".concat(n.endPoint,"/").concat(t),e,{headers:s.C})},this.assignTransaction=function(e,t){return r.Z.patch("".concat(n.endPoint,"/assignTransaction/").concat(t),e)}}))},83168:function(e,n){n.Z={opacity_6:"styles_opacity_6__dSE+L",dropdown:"styles_dropdown__kCFpG",overlay:"styles_overlay__sHjx4",overlay_item:"styles_overlay_item__H5qIX",overlay_popConfirm:"styles_overlay_popConfirm__Tb0jB",disabledButton:"styles_disabledButton__HUZB9",permitFiles:"styles_permitFiles__d0BJX",permitFiles__details:"styles_permitFiles__details__0LeEx"}}}]);