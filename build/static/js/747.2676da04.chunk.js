"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[747],{70815:function(e,n,t){t.d(n,{r:function(){return f}});var o=t(1413),a=t(29439),i=t(45987),r=t(55291),s=t(86345),l=t(47313),d=t(40169),c=t(46417),u=["onChange","checked","recordId","allowChange"],f=function(e){var n=e.onChange,t=e.checked,f=e.recordId,g=e.allowChange,m=void 0===g||g,v=(0,i.Z)(e,u),p=(0,l.useState)({loading:!1,checked:!1}),h=(0,a.Z)(p,2),Z=h[0],x=h[1];return(0,l.useEffect)((function(){x((0,o.Z)((0,o.Z)({},Z),{},{checked:t}))}),[t]),(0,c.jsx)(s.Z,{checked:Z.checked,onChange:function(e){!0===m?(x((0,o.Z)((0,o.Z)({},Z),{},{loading:!0})),n(e,f,v).then((function(n){x((0,o.Z)((0,o.Z)({},Z),{},{checked:e,loading:!1})),r.ZP.success(n.data.message)})).catch((function(e){x((0,o.Z)((0,o.Z)({},Z),{},{loading:!1}));var n=(0,d.P)(e);"string"===typeof n.message?r.ZP.error(n.message):r.ZP.error("Something went wrong")}))):r.ZP.error("You don't have permission to change this record, please contact your admin.")},loading:Z.loading})}},10747:function(e,n,t){t.r(n),t.d(n,{default:function(){return B}});var o=t(4942),a=t(1413),i=t(29439),r=t(47313),s=t(7532),l=t(25019),d=t(55291),c=t(82626),u=t(17327),f=t(49355),g=t(3798),m=t(46646),v=t(40169),p=t(90489),h=t(36131),Z=t(46417),x=function(e){var n=e.openModal,t=e.onCancel,o=e.type,s=e.record,x=e.reloadTableData,y=e.permissions,C=y.createFaqs,j=y.updateFaqs,b=l.Z.useForm(),I=(0,i.Z)(b,1)[0],k=(0,r.useMemo)((function(){return new p.h}),[]),P=(0,r.useMemo)((function(){return new h.H}),[]),S=(0,r.useState)(),w=(0,i.Z)(S,2),q=w[0],F=w[1],T=(0,r.useState)([]),N=(0,i.Z)(T,2),E=N[0],A=N[1],D=function(e){var n=(0,v.P)(e);if("string"==typeof n.message)F((0,a.Z)((0,a.Z)({},q),{},{error:n.message}));else{var t=(0,m.O)(n.message,[]);I.setFields(t),F((0,a.Z)((0,a.Z)({},q),{},{error:""}))}},L=(0,r.useCallback)((function(){k.getRecordById(s).then((function(e){var n;e.data&&e.data.data&&(I.setFieldsValue((0,a.Z)({isPublished:e.data.data.isPublished,faqsCategoryId:null===(n=e.data.data)||void 0===n?void 0:n.faqsCategoryId},e.data.data)),F((0,a.Z)((0,a.Z)({},e.data),{},{loading:!1})))})).catch((function(e){D(e)}))}),[I,s,k]),M=(0,r.useCallback)((function(){P.getAllRecords({perPage:100}).then((function(e){e.data&&e.data.data&&A(e.data.data)}))}),[P]);(0,r.useEffect)((function(){"edit"===o?(F({loading:!0}),L()):I.resetFields(),M()}),[n,o,I,L,M]);var _=function(e){var n=e.target,t=(0,g.V3)(n.value);I.setFieldsValue({slug:t})};return(0,Z.jsx)(c.P0,{visible:n,closable:!0,onCancel:t,titleText:"edit"===o?"Edit FAQ":"Add New FAQ",showFooter:!1,children:null!==q&&void 0!==q&&q.loading?(0,Z.jsx)(f.Z,{items:10}):(0,Z.jsxs)(l.Z,{className:u.Z.form,onFinish:function(e){switch(F((0,a.Z)((0,a.Z)({},q),{},{buttonLoading:!0})),o){case"edit":!0===j?k.updateRecord(e,null===q||void 0===q?void 0:q.data.id).then((function(e){x(),t(),F((function(e){return(0,a.Z)((0,a.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){D(e),F((function(e){return(0,a.Z)((0,a.Z)({},e),{},{buttonLoading:!1})}))})):(F((function(e){return(0,a.Z)((0,a.Z)({},e),{},{buttonLoading:!1})})),d.ZP.error("You don't have permission to update this record"));break;case"new":!0===C?k.createRecord(e).then((function(e){x(),t(),F((function(e){return(0,a.Z)((0,a.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){D(e),F((function(e){return(0,a.Z)((0,a.Z)({},e),{},{buttonLoading:!1})}))})):(F((function(e){return(0,a.Z)((0,a.Z)({},e),{},{buttonLoading:!1})})),d.ZP.error("You don't have permission to create this record"))}},form:I,children:[(null===q||void 0===q?void 0:q.error)&&(0,Z.jsx)(c.EQ,{description:null===q||void 0===q?void 0:q.error,isClosable:!0,onClose:function(){F((0,a.Z)((0,a.Z)({},q),{},{error:""}))}}),(0,Z.jsx)("div",{children:(0,Z.jsx)(l.Z.Item,{name:"faqsCategoryId",children:(0,Z.jsx)(c.AP,{label:"FAQ Category",placeholder:"Please select an FAQ Category",options:null===E||void 0===E?void 0:E.map((function(e){return{label:null===e||void 0===e?void 0:e.title,value:e.id}}))})})}),(0,Z.jsx)("div",{children:(0,Z.jsx)(l.Z.Item,{name:"title",rules:[{required:!0,message:"Please add a title"}],children:(0,Z.jsx)(c.t7,{size:"w100",label:"Title",asterisk:!0,type:"text",onChange:_})})}),(0,Z.jsx)("div",{className:"mt-3",children:(0,Z.jsx)(c.LD,{form:I,name:"description"})}),(0,Z.jsx)("div",{children:(0,Z.jsx)(l.Z.Item,{name:"slug",rules:[{required:!0,message:"Please add a slug"}],children:(0,Z.jsx)(c.t7,{onChange:_,size:"w100",label:"Slug",asterisk:!0,type:"text"})})}),(0,Z.jsx)("div",{children:(0,Z.jsx)(l.Z.Item,{name:"isPublished",children:(0,Z.jsx)(c.AP,{label:"Published",options:[{value:!0,label:"Yes"},{value:!1,label:"No"}]})})}),(0,Z.jsxs)("div",{className:u.Z.footer,children:[(0,Z.jsx)(c.op,{size:"normal",fontSize:"sm",onClick:t,type:"plain",children:"Cancel"}),(0,Z.jsx)(c.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:null===q||void 0===q?void 0:q.buttonLoading,children:"Submit"})]})]})})},y=t(5900),C=t(41586),j=t(98676),b=t(8570),I=t(70815),k=t(85554),P=t(25227),S=(b.Z.Paragraph,function(e){var n=e.record,t=e.onEditIconClick,o=e.reloadTableData,s=e.onImageClick,l=e.permissions.deleteFaqs,c=(0,r.useState)({confirmLoading:!1,openPopConfirm:!1}),f=(0,i.Z)(c,2),g=f[0],m=f[1],v=(0,r.useMemo)((function(){return new p.h}),[]);return(0,Z.jsxs)("div",{className:u.Z.actions,children:[(0,Z.jsx)("span",{onClick:function(){return s(n)},children:(0,Z.jsx)(P.X,{color:"#fff"})}),(0,Z.jsx)("span",{onClick:function(){return t(n)},children:(0,Z.jsx)("img",{src:"/images/editicon.svg",alt:""})}),(0,Z.jsx)(y.Z,{open:g.openPopConfirm,placement:"top",title:"Are you sure?",onConfirm:function(){if(m((0,a.Z)((0,a.Z)({},g),{},{confirmLoading:!0})),!1===l)return d.ZP.error("You don't have permission to delete this record, please contact your admin."),void m((0,a.Z)((0,a.Z)({},g),{},{openPopConfirm:!1}));v.deleteRecord(n.id).then((function(e){m((0,a.Z)((0,a.Z)({},g),{},{openPopConfirm:!1,confirmLoading:!1})),o()})).catch((function(e){m((0,a.Z)((0,a.Z)({},g),{},{confirmLoading:!1}))}))},onCancel:function(){return m((0,a.Z)((0,a.Z)({},g),{},{openPopConfirm:!1}))},okButtonProps:{loading:g.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:function(e){e||m((0,a.Z)((0,a.Z)({},g),{},{openPopConfirm:!1}))},children:(0,Z.jsx)(j.Z,{className:u.Z.bg__red,onClick:function(){m((0,a.Z)((0,a.Z)({},g),{},{openPopConfirm:!0}))}})})]})});function w(e){var n=e.tableData,t=e.tableLoading,o=e.onEditIconClick,a=e.reloadTableData,i=e.onImageClick,r=(0,k.v9)((function(e){return e.usersReducer})).userPermissions,s=new p.h,l=function(e,n){return s.updateRecord({isPublished:e},n)},d=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,n,t){return t+1},width:"5%"},{title:"Title",dataIndex:"title",key:"title",render:function(e,n){return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)("p",{className:"font-size-sm font-weight-bold color-dark-main",children:n.title})})}},{title:"Slug",dataIndex:"slug",key:"slug",render:function(e,n){return(0,Z.jsx)("p",{className:"font-size-sm font-weight-bold color-dark-main",children:e})}},{title:"Published",dataIndex:"isPublished",key:"isPublished",render:function(e,n){return(0,Z.jsx)(I.r,{checked:e,onChange:l,recordId:n.id})}},{title:"Actions",dataIndex:"actions",key:"actions",render:function(e,n){return(0,Z.jsx)(S,{record:n,onEditIconClick:o,reloadTableData:a,permissions:r,onImageClick:i})}}];return(0,Z.jsx)("div",{className:u.Z.antdTableWrapper,children:(0,Z.jsx)(C.Z,{sticky:!0,dataSource:n,columns:d,pagination:!1,scroll:{x:991},loading:t,rowKey:function(e){return"site-faqs-".concat(e.id)}})})}var q=t(42623),F=function(e){return e.CREATE="createFaqs",e.UPDATE="updateFaqs",e.DELETE="deleteFaqs",e.READ="readFaqs",e}({}),T=t(18515),N=t(74165),E=t(93433),A=t(15861),D=t(77278),L=t(59491),M="styles_form__AR2jA",_="styles_formItems__vE78a",R="styles_footer__H4y1y",z="styles_dragger__7Dbra",Y="styles_numberOfUploads__-VauD",U="styles_uploadedImages__1+yUa",Q=t(48897),H=b.Z.Paragraph,O=function(e){var n=e.openModal,t=e.onCancel,o=e.recordId,a=l.Z.useForm(),s=(0,i.Z)(a,1)[0],u=(0,r.useState)([]),f=(0,i.Z)(u,2),g=f[0],m=f[1],v=(0,r.useMemo)((function(){return new p.h}),[]),h=function(){var e=(0,A.Z)((0,N.Z)().mark((function e(n,t){return(0,N.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{v.removeImages(n).then((function(){m((function(e){return(0,E.Z)(e.filter((function(e,n){return n!==t})))})),d.ZP.success("Image Deleted Successfully")})).catch((function(e){var n,t;d.ZP.error((null===e||void 0===e||null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.message)||"Error Deleting Images")}))}catch(o){console.error("Error Deleting Images",o)}case 1:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),x=function(){var e=(0,A.Z)((0,N.Z)().mark((function e(n){var t,a,i,r;return(0,N.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.onSuccess,a=n.onError,i=n.file,(r=new FormData).append("files[]",i),r.append("faqId",String(o));try{v.uploadImages(r).then((function(e){m((function(n){return[].concat((0,E.Z)(n),[e.data.data[0]])})),t("ok")})).catch((function(e){a({err:e})}))}catch(s){a({err:s})}case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),C=(0,r.useCallback)((0,A.Z)((0,N.Z)().mark((function e(){return(0,N.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{v.getAllImages(o).then((function(e){m(e.data.data)})).catch((function(e){var n,t;d.ZP.error((null===e||void 0===e||null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.message)||"Error Fetching Images")}))}catch(n){console.error("Error Fetching Images",n)}case 1:case"end":return e.stop()}}),e)}))),[o,v]);return(0,r.useEffect)((function(){n&&C()}),[n]),(0,Z.jsx)(c.P0,{visible:n,closable:!0,onCancel:t,titleText:"Upload Images",showFooter:!1,children:(0,Z.jsxs)(l.Z,{onFinish:function(){return t()},form:s,className:M,children:[(0,Z.jsxs)("div",{className:_,children:[(0,Z.jsx)(l.Z.Item,{name:"images",children:(0,Z.jsxs)(D.Z.Dragger,{accept:".png,.jpg,.jpeg",className:z,multiple:!0,name:"file",maxCount:20,customRequest:x,showUploadList:!1,children:[(0,Z.jsx)("p",{className:"ant-upload-hint",children:"Drag image here or click to upload"}),(0,Z.jsx)("div",{className:Y,children:"".concat(g.length,"/20")})]})}),(0,Z.jsx)("div",{className:U,children:(0,Z.jsx)(c.jO,{images:g.map((function(e){return"".concat(Q.lj).concat(e.path)})),style:{borderRadius:5,objectFit:"cover",border:"1px solid #ddd"},width:115,height:70,overlayVisible:!0,overlay:function(e){var n=g[e];return(0,Z.jsx)("p",{className:"mb-0 font-weight-bold",children:(null===n||void 0===n?void 0:n.file)||"Untitled"})},extra:function(e){var n=null===g||void 0===g?void 0:g.find((function(n,t){var o;return t===Number(null===e||void 0===e||null===(o=e.key)||void 0===o?void 0:o.split("-")[1])})),t=g.findIndex((function(n,t){var o;return t===Number(null===e||void 0===e||null===(o=e.key)||void 0===o?void 0:o.split("-")[1])}));return(0,Z.jsxs)("div",{className:"d-flex flex-column justify-content-between align-items-center",children:[(0,Z.jsx)(H,{className:"mb-0 px-1",style:{width:110},ellipsis:{rows:1,expandable:!0,symbol:"more.."},children:(null===n||void 0===n?void 0:n.file)||"Untitled"}),(0,Z.jsx)(y.Z,{title:"Are you sure?",okText:"Yes",cancelText:"No",onConfirm:function(){return h(null===n||void 0===n?void 0:n.id,t)},children:(0,Z.jsx)(L.Z,{danger:!0,type:"primary",size:"small",style:{fontSize:10,margin:"0 auto"},children:"Remove"})})]})}})})]}),(0,Z.jsxs)("div",{className:R,children:[(0,Z.jsx)(c.op,{size:"normal",fontSize:"sm",type:"plain",onClick:t,children:"Cancel"}),(0,Z.jsx)(c.op,{type:"primary",size:"normal",htmlType:"submit",children:"Done"})]})]})})},V=[{text:"Home",isLink:!0,path:"/"},{isLink:!0,text:"Site Settings",path:"/siteSettings"},{isLink:!1,text:"FAQs"}];var B=function(){var e,n,t,l,u=(0,g.aY)(F),f=(0,k.v9)((function(e){return e.usersReducer})).userPermissions,m=f.readFaqs,v=f.createFaqs,y=f.updateFaqs,C=(0,r.useState)({editType:"new",recordId:0,openModal:!1}),j=(0,i.Z)(C,2),b=j[0],I=j[1],P=(0,r.useMemo)((function(){return new p.h}),[]),S=(0,r.useMemo)((function(){return new h.H}),[]),N=(0,r.useState)(""),E=(0,i.Z)(N,2),A=E[0],D=E[1],L=(0,q.N)(A,500),M=(0,r.useState)({title:"",faqsCategoryId:0,faqsCategorySlug:""}),_=(0,i.Z)(M,2),R=_[0],z=_[1],Y=(0,r.useState)(!1),U=(0,i.Z)(Y,2),Q=U[0],H=U[1],B=(0,r.useState)({isLoading:!1,error:{},data:[]}),X=(0,i.Z)(B,2),K=X[0],W=X[1],$=(0,r.useState)({openModal:!1,recordId:0}),G=(0,i.Z)($,2),J=G[0],ee=G[1],ne=(0,r.useState)([]),te=(0,i.Z)(ne,2),oe=te[0],ae=te[1],ie=function(e){var n=null===e||void 0===e?void 0:e.target,t=n.name,i=n.value;z((0,a.Z)((0,a.Z)({},R),{},(0,o.Z)({},t,i)))},re=function(){!1!==v?I((0,a.Z)((0,a.Z)({},b),{},{openModal:!b.openModal,editType:"new"})):d.ZP.error("You don't have permission to create new record")},se=(0,r.useCallback)((function(e){W((0,a.Z)((0,a.Z)({},K),{},{loading:!0})),P.getAllRecords(e).then((function(e){W(e.data)})).catch((function(e){var n,t;d.ZP.error(null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.message)}))}),[P,K]),le=(0,r.useCallback)((function(){S.getAllRecords({perPage:100}).then((function(e){ae(e.data.data)})).catch((function(e){}))}),[S]),de=(0,r.useCallback)((function(){var e={title:L||void 0,faqsCategoryId:(null===R||void 0===R?void 0:R.faqsCategoryId)||void 0,faqsCategorySlug:(null===R||void 0===R?void 0:R.faqsCategorySlug)||void 0};se(e)}),[R,P]),ce=(0,r.useCallback)((function(e,n){W((0,a.Z)((0,a.Z)({},K),{},{loading:!0}));var t={page:e,perPage:n,title:L||void 0,faqsCategoryId:(null===R||void 0===R?void 0:R.faqsCategoryId)||void 0,faqsCategorySlug:(null===R||void 0===R?void 0:R.faqsCategorySlug)||void 0};se(t)}),[P,R,K]);return(0,r.useEffect)((function(){if(L){var e={title:L||void 0,faqsCategoryId:(null===R||void 0===R?void 0:R.faqsCategoryId)||void 0,faqsCategorySlug:(null===R||void 0===R?void 0:R.faqsCategorySlug)||void 0};se(e)}else se()}),[L]),(0,r.useEffect)((function(){le()}),[]),(0,r.useEffect)((function(){Q&&de();var e=setTimeout((function(){H(!1)}),2e3);return function(){return clearTimeout(e)}}),[Q,R,de]),(0,Z.jsxs)(s.default,{permissionSlug:u,children:[(0,Z.jsx)(c.mr,{heading:"FAQs",buttonText:"Add New FAQ",onButtonClick:re,breadCrumbData:V,showAdd:!0===v,filters:!0===m?(0,Z.jsxs)("div",{children:[(0,Z.jsx)("div",{children:(0,Z.jsx)(c.t7,{placeHolder:"Search...",icon:(0,Z.jsx)("img",{src:"/images/searchIcon.svg",alt:"Search Icon"}),size:"w100",value:A,onChange:function(e){var n=e.currentTarget.value;D(n)}})}),(0,Z.jsx)("div",{children:(0,Z.jsx)(c.Xy,{type:"radio",label:"Category",name:"faqsCategoryId",value:String(null===R||void 0===R?void 0:R.faqsCategoryId),options:null===oe||void 0===oe?void 0:oe.map((function(e){return{label:null===e||void 0===e?void 0:e.title,value:"".concat(e.id)}})),onChange:ie,onReset:function(){H(!0),z((0,a.Z)((0,a.Z)({},R),{},{faqsCategoryId:0}))},onUpdate:de})}),(0,Z.jsx)("div",{children:(0,Z.jsx)(c.Xy,{type:"input",label:"Slug",name:"faqsCategorySlug",value:String(null===R||void 0===R?void 0:R.faqsCategorySlug),onChange:ie,onReset:function(){H(!0),z((0,a.Z)((0,a.Z)({},R),{},{faqsCategorySlug:""}))},onUpdate:de})})]}):null}),!0===m&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(w,{tableData:K.data,tableLoading:K.loading,onEditIconClick:function(e){!1!==y?I((0,a.Z)((0,a.Z)({},b),{},{editType:"edit",recordId:e.id,openModal:!0})):d.ZP.error("You don't have permission to update record")},reloadTableData:se,onImageClick:function(e){!1!==y?ee((0,a.Z)((0,a.Z)({},J),{},{openModal:!0,recordId:e.id})):d.ZP.error("You don't have permission to update record")}}),(0,Z.jsx)(c.tl,{total:null===K||void 0===K||null===(e=K.meta)||void 0===e?void 0:e.total,current:null===K||void 0===K||null===(n=K.meta)||void 0===n?void 0:n.page,defaultPageSize:null!==K&&void 0!==K&&null!==(t=K.meta)&&void 0!==t&&t.perPage?null===K||void 0===K||null===(l=K.meta)||void 0===l?void 0:l.perPage:10,pageSizeOptions:[10,20,50,100],onChange:ce})]}),!1===m&&(0,Z.jsx)(T.a$,{mainMessage:"You don't have permission to view this data"}),b.openModal&&(0,Z.jsx)(x,{record:b.recordId,type:b.editType,reloadTableData:se,onCancel:re,openModal:b.openModal,permissions:f}),J.openModal&&(0,Z.jsx)(O,{recordId:J.recordId,onCancel:function(){ee((0,a.Z)((0,a.Z)({},J),{},{openModal:!1}))},openModal:J.openModal})]})}}}]);