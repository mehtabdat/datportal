"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[3706],{70815:function(e,t,n){n.d(t,{r:function(){return m}});var a=n(1413),o=n(29439),r=n(45987),i=n(55291),s=n(86345),d=n(47313),c=n(40169),l=n(46417),u=["onChange","checked","recordId","allowChange"],m=function(e){var t=e.onChange,n=e.checked,m=e.recordId,h=e.allowChange,Z=void 0===h||h,f=(0,r.Z)(e,u),y=(0,d.useState)({loading:!1,checked:!1}),p=(0,o.Z)(y,2),g=p[0],x=p[1];return(0,d.useEffect)((function(){x((0,a.Z)((0,a.Z)({},g),{},{checked:n}))}),[n]),(0,l.jsx)(s.Z,{checked:g.checked,onChange:function(e){!0===Z?(x((0,a.Z)((0,a.Z)({},g),{},{loading:!0})),t(e,m,f).then((function(t){x((0,a.Z)((0,a.Z)({},g),{},{checked:e,loading:!1})),i.ZP.success(t.data.message)})).catch((function(e){x((0,a.Z)((0,a.Z)({},g),{},{loading:!1}));var t=(0,c.P)(e);"string"===typeof t.message?i.ZP.error(t.message):i.ZP.error("Something went wrong")}))):i.ZP.error("You don't have permission to change this record, please contact your admin.")},loading:g.loading})}},13706:function(e,t,n){n.r(t),n.d(t,{default:function(){return D}});var a=n(1413),o=n(29439),r=n(47313),i=n(7532),s=n(25019),d=n(55291),c=n(82626),l=n(17327),u=n(49355),m=n(46646),h=n(40169),Z=n(43144),f=n(15671),y=n(49075),p=(0,Z.Z)((function e(){var t=this;(0,f.Z)(this,e),this.endPoint="payment-gateway",this.getAllRecords=function(){return y.Z.get(t.endPoint)},this.getRecordById=function(e){return y.Z.get("".concat(t.endPoint,"/").concat(e))},this.deleteRecord=function(e){return y.Z.delete("".concat(t.endPoint,"/").concat(e))},this.createRecord=function(e){return y.Z.post(t.endPoint+"/",e)},this.updateRecord=function(e,n){return y.Z.patch("".concat(t.endPoint,"/").concat(n),e)}})),g=n(59816),x=n(3798),P=n(46417),v=function(e){var t=e.openModal,n=e.onCancel,i=e.type,Z=e.record,f=e.reloadTableData,y=e.permissions,v=y.createPaymentGateway,w=y.updatePaymentGateway,b=s.Z.useForm(),j=(0,o.Z)(b,1)[0],k=(0,r.useMemo)((function(){return new g.Y}),[]),C=(0,r.useMemo)((function(){return new p}),[]),I=(0,r.useState)([]),R=(0,o.Z)(I,2),L=R[0],T=R[1],S=(0,r.useState)(),N=(0,o.Z)(S,2),G=N[0],z=N[1],A=function(e){var t=(0,h.P)(e);if("string"==typeof t.message)z((0,a.Z)((0,a.Z)({},G),{},{error:t.message}));else{var n=(0,m.O)(t.message,[]);j.setFields(n),z((0,a.Z)((0,a.Z)({},G),{},{error:""}))}},E=(0,r.useCallback)((function(){C.getRecordById(Z).then((function(e){e.data&&e.data.data&&(j.setFieldsValue((0,a.Z)((0,a.Z)({},e.data.data),{},{isPublished:e.data.data.isPublished,test:e.data.data.test})),z((0,a.Z)((0,a.Z)({},e.data),{},{loading:!1})))})).catch((function(e){A(e)}))}),[j,Z,C]),D=(0,r.useCallback)((function(){k.getAllRecords().then((function(e){e.data&&e.data.data&&T(e.data.data)}))}),[k]);(0,r.useEffect)((function(){"edit"===i?(z({loading:!0}),E(),D()):(D(),j.resetFields())}),[t,i,j,E,D]);return(0,P.jsx)(c.P0,{visible:t,closable:!0,onCancel:n,titleText:"edit"===i?"Edit Payment Gateway":"Add New Payment Gateway",showFooter:!1,children:null!==G&&void 0!==G&&G.loading?(0,P.jsx)(u.Z,{items:10}):(0,P.jsxs)(s.Z,{className:l.Z.form,onFinish:function(e){z((0,a.Z)((0,a.Z)({},G),{},{buttonLoading:!0}));var t=(0,x.Dm)(e.gatewayURL);switch(i){case"edit":!0===w?C.updateRecord((0,a.Z)((0,a.Z)({},e),{},{gatewayURL:t}),null===G||void 0===G?void 0:G.data.id).then((function(e){f(),n(),z((function(e){return(0,a.Z)((0,a.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){A(e),z((function(e){return(0,a.Z)((0,a.Z)({},e),{},{buttonLoading:!1})}))})):(z((function(e){return(0,a.Z)((0,a.Z)({},e),{},{buttonLoading:!1})})),d.ZP.error("You don't have permission to update this record"));break;case"new":!0===v?C.createRecord((0,a.Z)((0,a.Z)({},e),{},{gatewayURL:t})).then((function(e){f(),n(),z((function(e){return(0,a.Z)((0,a.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){A(e),z((function(e){return(0,a.Z)((0,a.Z)({},e),{},{buttonLoading:!1})}))})):(z((function(e){return(0,a.Z)((0,a.Z)({},e),{},{buttonLoading:!1})})),d.ZP.error("You don't have permission to create this record"))}},form:j,children:[(null===G||void 0===G?void 0:G.error)&&(0,P.jsx)(c.EQ,{description:null===G||void 0===G?void 0:G.error,isClosable:!0,onClose:function(){z((0,a.Z)((0,a.Z)({},G),{},{error:""}))}}),(0,P.jsx)("div",{children:(0,P.jsx)(s.Z.Item,{name:"title",rules:[{required:!0,message:"Please add payment gateway title"}],children:(0,P.jsx)(c.t7,{size:"w100",label:"Title",asterisk:!0,type:"text"})})}),(0,P.jsxs)("div",{children:[(0,P.jsx)(s.Z.Item,{name:"slug",rules:[{required:!0,message:"Please add payment gateway slug"}],children:(0,P.jsx)(c.t7,{size:"w100",label:"Slug",asterisk:!0,type:"text",onChange:function(e){var t=e.target,n=(0,x.V3)(t.value);j.setFieldsValue({slug:n})}})}),(0,P.jsx)(s.Z.Item,{name:"storeId",rules:[{required:!0,message:"Please add store id"}],children:(0,P.jsx)(c.t7,{size:"w100",label:"Store Id",asterisk:!0,type:"text"})})]}),(0,P.jsxs)("div",{children:[(0,P.jsx)(s.Z.Item,{name:"gatewayPublicKey",rules:[{required:!0,message:"Please add public key"}],children:(0,P.jsx)(c.t7,{size:"w100",label:"Public Key",asterisk:!0,type:"text"})}),(0,P.jsx)(s.Z.Item,{name:"gatewayPrivateKey",rules:[{required:!0,message:"Please add private key"}],children:(0,P.jsx)(c.t7,{size:"w100",label:"Private Key",asterisk:!0,type:"text"})})]}),(0,P.jsxs)("div",{children:[(0,P.jsx)(s.Z.Item,{name:"gatewayURL",rules:[{required:!0,message:"Please add payment gateway url "}],children:(0,P.jsx)(c.t7,{size:"w100",label:"Gateway URL",asterisk:!0,type:"text"})}),(0,P.jsx)(s.Z.Item,{name:"countryId",rules:[{required:!0,message:"Please Select a country!"}],children:(0,P.jsx)(c.AP,{label:"Country",placeholder:"Please select country",options:null===L||void 0===L?void 0:L.map((function(e){return{label:e.name,value:e.id}})),asterisk:!0})})]}),(0,P.jsxs)("div",{children:[(0,P.jsx)(s.Z.Item,{name:"test",children:(0,P.jsx)(c.AP,{label:"Test",options:[{value:!0,label:"Yes"},{value:!1,label:"No"}]})}),(0,P.jsx)(s.Z.Item,{name:"isPublished",children:(0,P.jsx)(c.AP,{label:"Published",options:[{value:!0,label:"Yes"},{value:!1,label:"No"}]})})]}),(0,P.jsxs)("div",{className:l.Z.footer,children:[(0,P.jsx)(c.op,{size:"normal",fontSize:"sm",onClick:n,type:"plain",children:"Cancel"}),(0,P.jsx)(c.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:null===G||void 0===G?void 0:G.buttonLoading,children:"Submit"})]})]})})},w=n(8570),b=n(5900),j=n(41586),k=n(98676),C=n(3109),I=n(70815),R=n(32147),L=n(98505),T=n(85554),S=w.Z.Paragraph,N=function(e){var t=e.record,n=e.onEditIconClick,i=e.reloadTableData,s=e.permissions.deletePaymentGateway,c=(0,r.useState)({confirmLoading:!1,openPopConfirm:!1}),u=(0,o.Z)(c,2),m=u[0],h=u[1],Z=(0,r.useMemo)((function(){return new p}),[]);return(0,P.jsxs)("div",{className:l.Z.actions,children:[(0,P.jsx)("span",{onClick:function(){return n(t)},children:(0,P.jsx)("img",{src:"/images/editicon.svg",alt:""})}),(0,P.jsx)(b.Z,{open:m.openPopConfirm,placement:"top",title:"Are you sure?",onConfirm:function(){if(h((0,a.Z)((0,a.Z)({},m),{},{confirmLoading:!0})),!1===s)return d.ZP.error("You don't have permission to delete this record, please contact your admin."),void h((0,a.Z)((0,a.Z)({},m),{},{openPopConfirm:!1}));Z.deleteRecord(t.id).then((function(e){h((0,a.Z)((0,a.Z)({},m),{},{openPopConfirm:!1,confirmLoading:!1})),i()})).catch((function(e){h((0,a.Z)((0,a.Z)({},m),{},{confirmLoading:!1}))}))},onCancel:function(){return h((0,a.Z)((0,a.Z)({},m),{},{openPopConfirm:!1}))},okButtonProps:{loading:m.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:function(e){e||h((0,a.Z)((0,a.Z)({},m),{},{openPopConfirm:!1}))},children:(0,P.jsx)(k.Z,{className:l.Z.bg__red,onClick:function(){h((0,a.Z)((0,a.Z)({},m),{},{openPopConfirm:!0}))}})})]})};function G(e){var t=e.tableData,n=e.tableLoading,a=e.onEditIconClick,i=e.reloadTableData,s=(0,T.v9)((function(e){return e.usersReducer})).userPermissions,d=new p,c=function(e,t){return d.updateRecord({isPublished:e},t)},u=function(e,t){return d.updateRecord({test:e},t)},m=(0,r.useState)(!1),h=(0,o.Z)(m,2),Z=h[0],f=h[1],y=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,t,n){return n+1},width:"6%"},{title:"Title",dataIndex:"title",key:"title",render:function(e,t){return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(C.Z,{color:"dark-main",size:"normal",children:e}),(0,P.jsx)(C.Z,{color:"dark-main",size:"xs",className:"my-1",children:"Slug: ".concat(t.slug)}),(0,P.jsx)(C.Z,{color:"dark-main",size:"xs",children:"Gateway URL: ".concat(t.gatewayURL)})]})}},{title:"API Keys",dataIndex:"gatewayPublicKey",key:"gatewayPublicKey",render:function(e,t){return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(C.Z,{color:"dark-main",size:"sm",className:"mb-1",children:"Public: ".concat(e)}),Z?(0,P.jsxs)("div",{className:"d-flex align-center",children:[(0,P.jsx)(R.ON,{close:!0,onClick:function(){return f(!1)},className:"mr-2 cursor-pointer"}),(0,P.jsxs)(S,{ellipsis:{rows:2,expandable:!1},copyable:{text:t.gatewayPrivateKey},className:"font-size-sm color-dark-main pa-0 ma-0",children:["Private: ",t.gatewayPrivateKey]})]}):(0,P.jsxs)("div",{className:"d-flex",children:[(0,P.jsx)(R.ON,{onClick:function(){return f(!0)},className:"mr-2 cursor-pointer"}),(0,P.jsx)(C.Z,{color:"dark-main",size:"sm",children:"Private: ".concat(t.gatewayPrivateKey.replace(/./g,"*"))})]})]})},width:"15%"},{title:"Store ID",dataIndex:"storeId",key:"storeId",render:function(e){return(0,P.jsx)(C.Z,{color:"dark-main",size:"sm",children:e})}},{title:"Date Added",dataIndex:"addedDate",key:"addedDate",render:function(e){return(0,P.jsx)(C.Z,{color:"dark-sub",size:"sm",children:(0,L.Ny)(e,"dd MM yy")})}},{title:"Test",dataIndex:"test",key:"test",render:function(e,t){return(0,P.jsx)(I.r,{checked:e,onChange:u,recordId:t.id,allowChange:s.updatePaymentGateway})}},{title:"Published",dataIndex:"isPublished",key:"isPublished",render:function(e,t){return(0,P.jsx)(I.r,{checked:e,onChange:c,recordId:t.id,allowChange:s.updatePaymentGateway})}},{title:"Actions",dataIndex:"actions",key:"actions",render:function(e,t){return(0,P.jsx)(N,{record:t,onEditIconClick:a,reloadTableData:i,permissions:s})}}];return(0,P.jsx)("div",{className:l.Z.antdTableWrapper,children:(0,P.jsx)(j.Z,{sticky:!0,dataSource:t,columns:y,pagination:!1,scroll:{x:991},loading:n,rowKey:function(e){return"site-payment-gateway-".concat(e.id)}})})}var z=function(e){return e.CREATE="createPaymentGateway",e.UPDATE="updatePaymentGateway",e.DELETE="deletePaymentGateway",e.READ="readPaymentGateway",e}({}),A=n(18515),E=[{text:"Home",isLink:!0,path:"/"},{isLink:!0,text:"Site Settings",path:"/siteSettings"},{isLink:!1,text:"Payment Gateway"}];var D=function(){var e=(0,x.aY)(z),t=(0,T.v9)((function(e){return e.usersReducer})).userPermissions,n=t.readPaymentGateway,s=t.createPaymentGateway,l=t.updatePaymentGateway,u=(0,r.useState)({editType:"new",recordId:0,openModal:!1}),m=(0,o.Z)(u,2),h=m[0],Z=m[1],f=new p,y=(0,r.useState)({data:[]}),g=(0,o.Z)(y,2),w=g[0],b=g[1],j=function(){!1!==s?Z((0,a.Z)((0,a.Z)({},h),{},{openModal:!h.openModal,editType:"new"})):d.ZP.error("You don't have permission to create new record")},k=function(){b((0,a.Z)((0,a.Z)({},w),{},{loading:!0})),f.getAllRecords().then((function(e){b(e.data)})).catch((function(e){}))};return(0,r.useEffect)((function(){k()}),[]),(0,P.jsxs)(i.default,{permissionSlug:e,children:[(0,P.jsx)(c.mr,{heading:"Payment Gateway",buttonText:"Add Payment Gateway",onButtonClick:j,breadCrumbData:E,showAdd:!0===s}),!0===n&&(0,P.jsx)(G,{tableData:w.data,tableLoading:w.loading,onEditIconClick:function(e){!1!==l?Z((0,a.Z)((0,a.Z)({},h),{},{editType:"edit",recordId:e.id,openModal:!0})):d.ZP.error("You don't have permission to update record")},reloadTableData:k}),!1===s&&(0,P.jsx)(A.a$,{mainMessage:"You don't have permission to view this data"}),h.openModal&&(0,P.jsx)(v,{record:h.recordId,type:h.editType,reloadTableData:k,onCancel:j,openModal:h.openModal,permissions:t})]})}},59816:function(e,t,n){n.d(t,{Y:function(){return s}});var a=n(43144),o=n(15671),r=n(49075),i=n(3135),s=(0,a.Z)((function e(){var t=this;(0,o.Z)(this,e),this.endPoint="country",this.allEndpoint="country/all",this.getAllRecords=function(){return r.Z.get(t.allEndpoint)},this.getAvailableRecords=function(){return r.Z.get("".concat(t.endPoint,"/available-country"))},this.getRecordById=function(e){return r.Z.get("".concat(t.endPoint,"/").concat(e))},this.deleteRecord=function(e){return r.Z.delete("".concat(t.endPoint,"/").concat(e))},this.createRecord=function(e){return r.Z.post(t.endPoint+"/",e,{headers:i.C})},this.updateRecord=function(e,n){return r.Z.patch("".concat(t.endPoint,"/").concat(n),e,{headers:i.C})}}))}}]);