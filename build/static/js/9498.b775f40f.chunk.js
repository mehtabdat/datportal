"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[9498],{70815:function(e,n,t){t.d(n,{r:function(){return p}});var a=t(1413),i=t(29439),o=t(45987),r=t(55291),d=t(86345),s=t(47313),l=t(40169),c=t(46417),u=["onChange","checked","recordId","allowChange"],p=function(e){var n=e.onChange,t=e.checked,p=e.recordId,m=e.allowChange,g=void 0===m||m,h=(0,o.Z)(e,u),f=(0,s.useState)({loading:!1,checked:!1}),x=(0,i.Z)(f,2),Z=x[0],v=x[1];return(0,s.useEffect)((function(){v((0,a.Z)((0,a.Z)({},Z),{},{checked:t}))}),[t]),(0,c.jsx)(d.Z,{checked:Z.checked,onChange:function(e){!0===g?(v((0,a.Z)((0,a.Z)({},Z),{},{loading:!0})),n(e,p,h).then((function(n){v((0,a.Z)((0,a.Z)({},Z),{},{checked:e,loading:!1})),r.ZP.success(n.data.message)})).catch((function(e){v((0,a.Z)((0,a.Z)({},Z),{},{loading:!1}));var n=(0,l.P)(e);"string"===typeof n.message?r.ZP.error(n.message):r.ZP.error("Something went wrong")}))):r.ZP.error("You don't have permission to change this record, please contact your admin.")},loading:Z.loading})}},69498:function(e,n,t){t.r(n),t.d(n,{default:function(){return D}});var a=t(93433),i=t(1413),o=t(29439),r=t(47313),d=t(82626),s=t(7532),l=t(25019),c=t(55291),u=t(45705),p=t(17327),m=t(49355),g=t(46646),h=t(40169),f=t(5190),x=t(37936),Z=t(42623),v=t(48897),j=t(50006),b=t(3798),_=t(46417),y=function(e){var n,t,s,y,C,w,k,P,I,E=e.openModal,z=e.onCancel,L=e.type,S=e.record,N=e.reloadTableData,T=e.permissions,O=T.createOrganization,A=T.updateOrganization,R=l.Z.useForm(),D=(0,o.Z)(R,1)[0],H=new f.L,B=new j.N,F=(0,r.useState)(),M=(0,o.Z)(F,2),W=M[0],Y=M[1],q=(0,r.useState)({isLoading:!0,data:[]}),U=(0,o.Z)(q,2),V=U[0],Q=U[1],G=(0,r.useState)(!1),K=(0,o.Z)(G,2),$=K[0],X=K[1],J=(0,r.useState)(""),ee=(0,o.Z)(J,2),ne=ee[0],te=ee[1],ae=(0,Z.N)(ne,500),ie=(0,r.useState)([]),oe=(0,o.Z)(ie,2),re=oe[0],de=oe[1];(0,r.useEffect)((function(){ae&&H.getAllRecords({name:ae,fetchParentOnly:!0}).then((function(e){var n=e.data;de((function(e){var t,i=null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.filter((function(n){return!(null!==e&&void 0!==e&&e.find((function(e){return e.id===n.id})))}));return[].concat((0,a.Z)(e),(0,a.Z)(i))}))})).catch((function(e){c.ZP.error(e.response.data.message)}))}),[ae]);var se=function(e){var n=(0,h.P)(e);if("string"==typeof n.message)Y((0,i.Z)((0,i.Z)({},W),{},{error:n.message}));else{var t=(0,g.O)(n.message,[]);D.setFields(t),Y((0,i.Z)((0,i.Z)({},W),{},{error:""}))}},le=(0,r.useCallback)((function(){H.getRecordById(S).then((function(e){e.data&&e.data.data&&(D.setFieldsValue((0,i.Z)((0,i.Z)({},e.data.data),{},{type:String(e.data.data.type),isPublished:e.data.data.isPublished})),X(2===Number(e.data.data.type)),Y((0,i.Z)((0,i.Z)({},e.data),{},{loading:!1})))})).catch((function(e){se(e)}))}),[D,S,H]);(0,r.useEffect)((function(){"edit"===L?(Y({loading:!0}),le()):D.resetFields()}),[E,L,D]),(0,r.useEffect)((function(){B.getAllRecords().then((function(e){var n=e.data;Q((0,i.Z)((0,i.Z)({},V),{},{data:null===n||void 0===n?void 0:n.data,isLoading:!1}))})).catch((function(e){var n=(0,b.S3)(e);c.ZP.error(n),Q((0,i.Z)((0,i.Z)({},V),{},{isLoading:!1}))}))}),[]);return(0,_.jsx)(d.P0,{visible:E,closable:!0,onCancel:z,titleText:"edit"===L?"Edit Organization":"Add New Organization",showFooter:!1,children:null!==W&&void 0!==W&&W.loading?(0,_.jsx)(m.Z,{items:10}):(0,_.jsxs)(l.Z,{className:p.Z.form,onFinish:function(e){var n=new FormData,t=["logo","digitalStamp"];switch(Object.entries(e).forEach((function(e){t.includes(e[0])||e[1]&&null!==e[1]&&n.append(e[0],e[1])})),e.logo&&"string"!==typeof e.logo&&e.logo.fileList.length>0&&n.append("logo",e.logo.fileList[0].originFileObj),e.digitalStamp&&"string"!==typeof e.digitalStamp&&e.digitalStamp.fileList.length>0&&n.append("digitalStamp",e.digitalStamp.fileList[0].originFileObj),Y((0,i.Z)((0,i.Z)({},W),{},{buttonLoading:!0})),L){case"edit":!0===A?H.updateRecord(n,S).then((function(e){N(),z(),Y((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){se(e),Y((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})}))})):(Y((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})})),c.ZP.error("You don't have permission to update this record"));break;case"new":!0===O?H.createRecord(n).then((function(e){N(),z(),Y((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})}))})).catch((function(e){se(e),Y((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})}))})):(Y((function(e){return(0,i.Z)((0,i.Z)({},e),{},{buttonLoading:!1})})),c.ZP.error("You don't have permission to create this record"))}},form:D,children:[(null===W||void 0===W?void 0:W.error)&&(0,_.jsx)(d.EQ,{description:null===W||void 0===W?void 0:W.error,isClosable:!0,onClose:function(){Y((0,i.Z)((0,i.Z)({},W),{},{error:""}))}}),(0,_.jsx)("div",{children:(0,_.jsx)(l.Z.Item,{name:"name",rules:[{required:!0,message:"Please add a name"}],children:(0,_.jsx)(d.t7,{size:"w100",label:"Name",asterisk:!0,type:"text",placeHolder:"Enter organization name"})})}),(0,_.jsx)("div",{children:(0,_.jsx)(l.Z.Item,{name:"organizationCode",rules:[{required:!0,message:"Please add a code"}],help:(0,_.jsx)("small",{children:"This code will be used as a prefix to quotation, invoices. Eg: INV-DATP3400, INV-LUX2300, QU-DATP3400"}),children:(0,_.jsx)(d.t7,{size:"w100",label:"Organization Code",asterisk:!0,type:"text",placeHolder:"Enter organization code"})})}),(0,_.jsx)("div",{children:(0,_.jsx)(l.Z.Item,{name:"description",children:(0,_.jsx)(d.t7,{size:"w100",label:"Description",type:"text",placeHolder:"Enter description"})})}),(0,_.jsx)("div",{children:(0,_.jsx)(l.Z.Item,{name:"taxRegistrationNumber",children:(0,_.jsx)(d.t7,{size:"w100",label:"Tax Registration Number",type:"text",placeHolder:"Enter tax registration number"})})}),(0,_.jsx)("div",{children:(0,_.jsx)(l.Z.Item,{name:"bankAccountNumber",children:(0,_.jsx)(d.t7,{size:"w100",label:"Bank Account Number",type:"text",placeHolder:"Enter bank account number"})})}),(0,_.jsx)("div",{children:(0,_.jsx)(l.Z.Item,{name:"bankIBAN",children:(0,_.jsx)(d.t7,{size:"w100",label:"Bank IBAN Number",type:"text",placeHolder:"Enter bank IBAN number"})})}),(0,_.jsx)("div",{children:(0,_.jsx)(l.Z.Item,{name:"bankAccountHolderName",children:(0,_.jsx)(d.t7,{size:"w100",label:"Bank Account Holder Name",type:"text",placeHolder:"Bank Account Holder Name"})})}),(0,_.jsx)("div",{children:(0,_.jsx)(l.Z.Item,{name:"bankName",children:(0,_.jsx)(d.t7,{size:"w100",label:"Bank Name",type:"text",placeHolder:"Enter name"})})}),(0,_.jsx)("div",{children:(0,_.jsx)(l.Z.Item,{name:"bankSwiftCode",children:(0,_.jsx)(d.t7,{size:"w100",label:"Bank Swift Code",type:"text",placeHolder:"Enter Bank Swift Code"})})}),(0,_.jsx)("div",{children:(0,_.jsx)(l.Z.Item,{name:"email",rules:[{required:!0,message:"Please add a email",type:"email"}],children:(0,_.jsx)(d.t7,{size:"w100",label:"Email",asterisk:!0,type:"text",placeHolder:"Enter email"})})}),(0,_.jsx)("div",{children:(0,_.jsxs)(u.Z.Compact,{children:[(0,_.jsx)(l.Z.Item,{style:{width:"15%"},name:"phoneCode",rules:[{required:!0,message:"Please add phone code",max:3}],children:(0,_.jsx)(d.t7,{size:"w100",label:"Phone code",asterisk:!0,type:"text",placeHolder:"Enter code",defaultValue:"971"})}),(0,_.jsx)(l.Z.Item,{style:{width:"85%"},name:"phone",rules:[{required:!0,message:"Please add phone number"}],children:(0,_.jsx)(d.t7,{size:"w100",label:"Phone",asterisk:!0,type:"text",placeHolder:"Enter phone"})})]})}),(0,_.jsx)("div",{children:(0,_.jsx)(l.Z.Item,{name:"whatsapp",children:(0,_.jsx)(d.t7,{size:"w100",label:"Whatsapp",type:"text",placeHolder:"Enter whatsapp"})})}),(0,_.jsx)("div",{children:(0,_.jsx)(l.Z.Item,{name:"address",children:(0,_.jsx)(d.t7,{size:"w100",label:"Address",type:"text",placeHolder:"Enter address"})})}),(0,_.jsx)("div",{children:(0,_.jsx)(l.Z.Item,{name:"locationMap",children:(0,_.jsx)(d.t7,{size:"w100",label:"Location map",type:"text",placeHolder:"Enter Location map"})})}),(0,_.jsxs)("div",{children:[(0,_.jsx)(l.Z.Item,{name:"type",rules:[{required:!0,message:"Please select a type"}],children:(0,_.jsx)(d.Ld,{label:"Select Organization Type",notFoundDescription:"No organization type found., Please search for organization type.",onSearch:function(){},options:null===(n=Object.entries(x.V6))||void 0===n?void 0:n.map((function(e){var n=(0,o.Z)(e,2),t=n[0];return{label:n[1],value:t}})),onChange:function(e){D.setFieldsValue({type:e}),X(2===Number(e))}})}),$&&(0,_.jsx)("div",{children:(0,_.jsx)(l.Z.Item,{name:"parentId",rules:[{required:!0,message:"Please select a organization"}],children:(0,_.jsx)(d.Ld,{label:"Select Organization",notFoundDescription:"No Organizations found., Please search for Organizations.",onSearch:function(e){return te(e)},options:null===re||void 0===re?void 0:re.map((function(e){return{label:e.name,value:e.id}})),onChange:function(e){return D.setFieldsValue({parentId:e})}})})})]}),(0,_.jsx)("div",{children:(0,_.jsx)(l.Z.Item,{name:"workingHoursId",rules:[{required:!0,message:"Please select a working hour for the company"}],children:(0,_.jsx)(d.AP,{label:"Choose working hour",asterisk:!0,style:{borderWidth:"2px"},placeholder:"Select Working Hour",options:null===V||void 0===V?void 0:V.data.map((function(e){return{label:e.title,value:e.id}}))})})}),(0,_.jsx)("div",{children:(0,_.jsx)(d.wA,{name:"logo",customLabel:"Upload logo here",defaultFileList:"edit"===L&&W&&(null===(t=W.data)||void 0===t?void 0:t.logo)&&[{uid:null===(s=W.data)||void 0===s?void 0:s.id,name:null===(y=W.data)||void 0===y?void 0:y.logo,status:"done",url:v.lj+(null===(C=W.data)||void 0===C?void 0:C.logo)}]})}),(0,_.jsx)("div",{children:(0,_.jsx)(d.wA,{name:"digitalStamp",customLabel:"Upload digital stamp here",defaultFileList:"edit"===L&&W&&(null===(w=W.data)||void 0===w?void 0:w.digitalStamp)&&[{uid:null===(k=W.data)||void 0===k?void 0:k.id,name:null===(P=W.data)||void 0===P?void 0:P.digitalStamp,status:"done",url:v.lj+(null===(I=W.data)||void 0===I?void 0:I.digitalStamp)}]})}),(0,_.jsxs)("div",{className:"d-flex justify-end",children:[(0,_.jsx)(d.op,{size:"normal",fontSize:"sm",onClick:z,type:"plain",children:"Cancel"}),(0,_.jsx)(d.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:null===W||void 0===W?void 0:W.buttonLoading,children:"edit"===L?"Submit":"Add Organization"})]})]})})},C=t(5900),w=t(41586),k=t(98676),P=t(3109),I=t(70815),E=t(85554),z={logoImage:"styles_logoImage__bo9KZ",resetWrap:"styles_resetWrap__Acfl-",freeText:"styles_freeText__5A+zw",actions:"styles_actions__0mgmP",bg__red:"styles_bg__red__WasAv",form:"styles_form__bK++1",addLanguagesWrap:"styles_addLanguagesWrap__tEQke",addLanguages:"styles_addLanguages__Z3ILv",upload:"styles_upload__1io85",footer:"styles_footer__C6Clh",dropdown:"styles_dropdown__Iko4q",overlay:"styles_overlay__AWNo3",overlay_item:"styles_overlay_item__7YHQY",overlay_card_item:"styles_overlay_card_item__ZjZg7",viewIcon:"styles_viewIcon__MVMTv",overlay_popConfirm:"styles_overlay_popConfirm__+G86d",disabledButton:"styles_disabledButton__UgulN",freeBtn:"styles_freeBtn__Ofk7F",openingHours:"styles_openingHours__IUqBB",container:"styles_container__lIPWc",wrapper:"styles_wrapper__w8xTM",title:"styles_title__kZvPu",closed:"styles_closed__Y0tNM"},L=function(e){var n=e.record,t=e.onEditIconClick,a=e.reloadTableData,d=e.permissions.deleteOrganization,s=(0,r.useState)({confirmLoading:!1,openPopConfirm:!1}),l=(0,o.Z)(s,2),u=l[0],m=l[1],g=new f.L;return(0,_.jsxs)("div",{className:p.Z.actions,children:[(0,_.jsx)("span",{onClick:function(){return t(n)},children:(0,_.jsx)("img",{src:"/images/editicon.svg",alt:""})}),(0,_.jsx)(C.Z,{open:u.openPopConfirm,placement:"top",title:"Are you sure?",onConfirm:function(){if(m((0,i.Z)((0,i.Z)({},u),{},{confirmLoading:!0})),!1===d)return c.ZP.error("You don't have permission to delete this record, please contact your admin."),void m((0,i.Z)((0,i.Z)({},u),{},{openPopConfirm:!1}));g.deleteRecord(n.id).then((function(e){m((0,i.Z)((0,i.Z)({},u),{},{openPopConfirm:!1,confirmLoading:!1})),a()})).catch((function(e){m((0,i.Z)((0,i.Z)({},u),{},{confirmLoading:!1}))}))},onCancel:function(){return m((0,i.Z)((0,i.Z)({},u),{},{openPopConfirm:!1}))},okButtonProps:{loading:u.confirmLoading},okText:"Yes",cancelText:"No",onOpenChange:function(e){e||m((0,i.Z)((0,i.Z)({},u),{},{openPopConfirm:!1}))},children:(0,_.jsx)(k.Z,{className:p.Z.bg__red,onClick:function(){m((0,i.Z)((0,i.Z)({},u),{},{openPopConfirm:!0}))}})})]})};function S(e){var n=e.tableData,t=e.tableLoading,a=e.onEditIconClick,o=e.reloadTableData,r=e.meta,d=e.filters,s=(0,E.v9)((function(e){return e.usersReducer})).userPermissions,l=new f.L,c=function(e,n){return l.updateRecord({isPublished:e},n)},u=[{title:"S.No",dataIndex:"index",key:"index",render:function(e,n,t){return t+1},width:"5%"},{title:"Title",dataIndex:"name",key:"name",render:function(e,n){var t;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(P.Z,{color:"dark-main",size:"sm",weight:"bold",children:"".concat(n.organizationCode," - ").concat(e)}),(0,_.jsx)("div",{className:z.container,children:null===n||void 0===n||null===(t=n.WorkingHours)||void 0===t?void 0:t.hours.map((function(e,n){return(0,_.jsx)("div",{children:(0,_.jsxs)("div",{className:z.wrapper,children:[(0,_.jsx)("span",{className:z.title,children:e.name}),e.closed?(0,_.jsx)("span",{className:z.closed,children:"Closed"}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("span",{children:[e.open," - ",e.close]}),(0,_.jsxs)("span",{children:[e.totalHours," hours"]})]})]})},"opening-hours"+n+9999*Math.random())}))})]})},width:"280px"},{title:"Logo",dataIndex:"logo",key:"logo",render:function(e,n){return(0,_.jsx)("img",{width:50,height:50,src:v.lj+n.logo,style:{objectFit:"contain"}})}},{title:"Type",dataIndex:"type",key:"type",render:function(e){return(0,_.jsx)(P.Z,{color:"dark-main",size:"sm",weight:"bold",children:x.V6[e]})}},{title:"Published",dataIndex:"isPublished",key:"isPublished",render:function(e,n){return(0,_.jsx)(I.r,{checked:e,onChange:c,recordId:n.id,allowChange:s.updateOrganization})}},{title:"Actions",dataIndex:"actions",key:"actions",render:function(e,n){return(0,_.jsx)(L,{record:n,onEditIconClick:a,reloadTableData:o,permissions:s})}}];return(0,_.jsx)("div",{className:p.Z.antdTableWrapper,children:(0,_.jsx)(w.Z,{sticky:!0,dataSource:n,columns:u,pagination:{current:null===r||void 0===r?void 0:r.page,total:null===r||void 0===r?void 0:r.total,hideOnSinglePage:!0,pageSize:null===r||void 0===r?void 0:r.perPage,onChange:function(e,n){o((0,i.Z)((0,i.Z)({},d),{},{page:e,perPage:n}))}},scroll:{x:991},loading:t,rowKey:function(e){return"organization-".concat(e.id)}})})}var N=t(3113),T=function(e){return e.CREATE="createOrganization",e.UPDATE="updateOrganization",e.DELETE="deleteOrganization",e.READ="readOrganization",e.READ_ALL="readAllOrganization",e.READ_ELIGIBLE_CREDITS_REFUND="readEligibleCreditsRefund",e.REQUEST_ELIGIBLE_CREDITS_REFUND="requestEligibleCreditsRefund",e.PUBLISH="publishOrganization",e.SUSPEND="suspendOrganization",e.CREATE_COMMENTS="createOrganizationComments",e.READ_COMMENTS="readOrganizationComments",e.DELETE_COMMENTS="deleteOrganizationComments",e.READ_CREDITS_TRANSACTION_HISTORY="readCreditsTransactionsHistory",e}({}),O=t(18515),A=t(29079),R=[{text:"Home",isLink:!0,path:"/"},{isLink:!0,text:"Site Settings",path:"/siteSettings"},{isLink:!1,text:"Organization Settings"}];var D=function(){var e=(0,b.aY)(T),n=(0,E.v9)((function(e){return e.usersReducer})).userPermissions,t=n.readAllOrganization,l=n.createOrganization,u=n.updateOrganization,p=(0,r.useState)({editType:"new",recordId:0,openModal:!1}),m=(0,o.Z)(p,2),g=m[0],h=m[1],x=new f.L,Z=(0,r.useState)({page:1,perPage:10}),v=(0,o.Z)(Z,2),j=v[0],C=(v[1],(0,A.$5)({method:x.getAllRecords,initialQuery:(0,i.Z)({},j)})),w=C.data,k=C.onRefresh,P=(C.setData,C.loading),I=C.meta,z=function(){!1!==l?h((0,i.Z)((0,i.Z)({},g),{},{openModal:!g.openModal,editType:"new"})):c.ZP.error("You don't have permission to create new record")};return(0,_.jsxs)(s.default,{permissionSlug:[].concat((0,a.Z)(e),["topupCredits"]),children:[(0,_.jsx)(d.mr,{heading:"Organizations",buttonText:"New Organization",onButtonClick:z,breadCrumbData:R,showAdd:!0===l}),!0===t&&(0,_.jsx)("div",{className:N.Z.antdTableWrapper,children:(0,_.jsx)(S,{tableData:w,tableLoading:P,onEditIconClick:function(e){!1!==u?h((0,i.Z)((0,i.Z)({},g),{},{editType:"edit",recordId:e.id,openModal:!0})):c.ZP.error("You don't have permission to update this record")},reloadTableData:k,meta:I,filters:j})}),!1===t&&(0,_.jsx)(O.a$,{mainMessage:"You don't have permission to view this data"}),(0,_.jsx)(y,{record:g.recordId,type:g.editType,reloadTableData:k,onCancel:z,openModal:g.openModal,permissions:n})]})}},5190:function(e,n,t){t.d(n,{L:function(){return d}});var a=t(43144),i=t(15671),o=t(49075),r=t(3135),d=(0,a.Z)((function e(){var n=this;(0,i.Z)(this,e),this.endPoint="organization",this.getAllRecords=function(e){return o.Z.get(n.endPoint,{params:e})},this.findPublished=function(e){return o.Z.get(n.endPoint+"/find-published",{params:e})},this.getRecordById=function(e){return o.Z.get("".concat(n.endPoint,"/").concat(e))},this.deleteRecord=function(e){return o.Z.delete("".concat(n.endPoint,"/").concat(e))},this.createRecord=function(e){return o.Z.post(n.endPoint,e,{headers:r.C})},this.updateRecord=function(e,t){return o.Z.patch("".concat(n.endPoint,"/").concat(t),e,{headers:r.C})},this.getTenants=function(){return o.Z.get("xero/getTenants")}}))}}]);