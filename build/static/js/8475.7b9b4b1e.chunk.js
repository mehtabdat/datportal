(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[8475],{50008:function(e,t,n){"use strict";n.d(t,{t:function(){return o}});var i=n(47312),s="styles_card__cH2rF",r=n(46417),o=function(){return(0,r.jsx)("div",{className:s,children:(0,r.jsx)(i.Z,{active:!0})})}},99359:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return W}});var i=n(1413),s=n(93433),r=n(29439),o=n(82626),a=n(54060),l="styles_container__-gKCe",d="styles_onlyMyTask__OvTeJ",c=n(47313),u=n(69309),m=n(55291),v=n(49958),p=n(29079),h=n(38323),f=n(85554),x=n(55455),y=n(42623),j=n(84825),_=n(37035),R=n(54945),Z=n(37936),b=n(3798),g=n(50008),A=n(46417),N=(u.Z.RangePicker,[{text:"Home",isLink:!0,path:"/"},{isLink:!0,text:"Employee Requests",path:"/employee-requests/?all"},{isLink:!1,text:"Reimbursements"}]),W=function(){var e,t,n=(0,b.aY)(x.Z),u=(0,f.v9)((function(e){return e.usersReducer})).userPermissions,W=(u.createReimbursement,(0,c.useState)({userId:void 0,fetchOpenRequest:!0,status:void 0,fromDate:void 0,toDate:void 0,page:1,perPage:6})),D=(0,r.Z)(W,2),w=D[0],S=D[1],P=(0,c.useState)({recordId:0}),C=(0,r.Z)(P,2),T=C[0],k=C[1],z=(0,c.useState)(!1),B=(0,r.Z)(z,2),I=B[0],E=B[1],O=(0,c.useMemo)((function(){return new h.g}),[]),q=(0,p.$5)({method:O.getAllRecords,initialQuery:{perPage:25,fetchOpenRequest:!0}}),M=q.data,F=q.onRefresh,H=(q.setData,q.loading),L=q.meta,K=(0,c.useState)(""),Q=(0,r.Z)(K,2),U=Q[0],J=Q[1],V=(0,y.N)(U,500),G=(0,c.useState)([]),Y=(0,r.Z)(G,2),X=Y[0],$=Y[1],ee=(0,c.useMemo)((function(){return new j.z}),[]),te=(0,c.useCallback)((function(){V&&ee.getAllRecords({name:V}).then((function(e){$((function(t){var n,i,r=null===e||void 0===e||null===(n=e.data)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.filter((function(e){return!(null!==t&&void 0!==t&&t.find((function(t){return t.id===e.id})))}));return[].concat((0,s.Z)(t),(0,s.Z)(r))}))})).catch((function(e){m.ZP.error(e.response.data.message)}))}),[V]);return(0,c.useEffect)((function(){te()}),[te]),(0,A.jsxs)(a.Z,{permissionSlug:n,children:[(0,A.jsx)(o.mr,{heading:"Reimbursements",breadCrumbData:N,filters:(0,A.jsxs)("div",{style:{marginTop:"1.5rem"},children:[(0,A.jsx)("div",{children:(0,A.jsx)(o.Xy,{type:"radio",label:"User",name:"userId",withSearch:!0,options:null===X||void 0===X?void 0:X.map((function(e){return{label:e.firstName+" "+e.lastName,value:e.id.toString()}})),onChange:function(e){var t=(0,i.Z)((0,i.Z)({},w),{},{userId:e.target.value});S(t)},value:null===(e=w.userId)||void 0===e?void 0:e.toString(),onReset:function(){var e=(0,i.Z)((0,i.Z)({},w),{},{userId:void 0});S(e),F(e),J("")},onUpdate:function(){return F(w)},searchTerm:U,onSearch:function(e){return J(e.currentTarget.value)}})}),(0,A.jsx)("div",{children:(0,A.jsx)(o.Xy,{type:"radio",label:"Status",name:"status",withSearch:!1,options:Object.entries(Z.W9).map((function(e){var t=(0,r.Z)(e,2),n=t[0],i=t[1];return{label:(0,b.kC)(i.status.replaceAll("_"," ")),value:n}})),onChange:function(e){var t=(0,i.Z)((0,i.Z)({},w),{},{status:e.target.value});S(t)},value:null===(t=w.status)||void 0===t?void 0:t.toString(),onReset:function(){var e=(0,i.Z)((0,i.Z)({},w),{},{status:void 0});S(e),F(e)},onUpdate:function(){return F(w)}})}),(0,A.jsx)("div",{children:(0,A.jsx)(o.Xy,{type:"datepicker",label:"Date",name:"dateRange",onChange:function(e){var t,n,s,r,o=(0,i.Z)((0,i.Z)({},w),{},{fromDate:e?null===(t=e[0])||void 0===t||null===(n=t._d)||void 0===n?void 0:n.toISOString().substring(0,10):void 0,toDate:e?null===(s=e[1])||void 0===s||null===(r=s._d)||void 0===r?void 0:r.toISOString().substring(0,10):void 0});S(o)},onReset:function(){var e=(0,i.Z)((0,i.Z)({},w),{},{fromDate:void 0,toDate:void 0});S(e),F(e)},onUpdate:function(){return F(w)}})}),(0,A.jsx)("div",{style:{backgroundColor:w.fetchOpenRequest?"var(--color-dark-main)":void 0,color:w.fetchOpenRequest?"var(--color-inactive)":void 0},onClick:function(){var e=(0,i.Z)((0,i.Z)({},w),{},{fetchOpenRequest:!w.fetchOpenRequest||void 0});S(e),F(e)},className:d,children:"Open Requests Only"})]})}),(0,A.jsx)("section",{className:l,children:H?(0,s.Z)(new Array(6)).map((function(e,t){return(0,A.jsx)(g.t,{},"shimmer".concat(t))})):0!==(null===M||void 0===M?void 0:M.length)?null===M||void 0===M?void 0:M.map((function(e,t){return(0,A.jsx)(R.l,{reimbursement:e,onClick:function(){k((0,i.Z)((0,i.Z)({},T),{},{recordId:e.id})),E(!0)}},t)})):(0,A.jsx)("div",{style:{margin:"auto"},children:(0,A.jsx)(o.I$,{description:"No requests found for the given filters, please modify the search criteria"})})}),(0,A.jsx)(v.Z,{hideOnSinglePage:!0,current:null===L||void 0===L?void 0:L.page,total:null===L||void 0===L?void 0:L.total,pageSize:(null===L||void 0===L?void 0:L.perPage)||0,onChange:function(e,t){F((0,i.Z)((0,i.Z)({},w),{},{page:e,perPage:t}))},style:{alignSelf:"flex-end"}}),I&&(0,A.jsx)(_.P,{openDrawer:I,onClose:function(){return E(!1)},permissions:u,record:T.recordId,reloadTableData:F})]})}},37035:function(e,t,n){"use strict";n.d(t,{P:function(){return N}});var i=n(1413),s=n(29439),r=n(51534),o=n(82334),a=n(48694),l=n(8570),d=n(25019),c=n(55291),u=n(97258),m=n(21680),v=n(39180),p=n(82626),h={drawerContainer:"styles_drawerContainer__Er2-S",hrWrap:"styles_hrWrap__NMpdo",title:"styles_title__AQIvt",attachmentsWrap:"styles_attachmentsWrap__J2rNl",attachment:"styles_attachment__DrKTS",amountWrap:"styles_amountWrap__PMMKh",priceText:"styles_priceText__+3T2i",resourceWrap:"styles_resourceWrap__MNtyY",footerWrap:"styles_footerWrap__h9Z8j",buttonWrap:"styles_buttonWrap__KZJnN",financeWrap:"styles_financeWrap__QIYRD",actionsWrap:"styles_actionsWrap__tFW63"},f=n(37936),x=n(47313),y=n(38323),j=n(29079),_=n(49075),R=n(40096),Z=n(98505),b=n(48897),g=n(46417),A=l.Z.Text,N=function(e){var t,n,l,N,W,D,w=e.openDrawer,S=e.onClose,P=e.record,C=e.permissions,T=e.reloadTableData,k=C.reimbursementHRApproval,z=C.reimbursementFinanceApproval,B=(R.Z.getUserData(),d.Z.useForm()),I=(0,s.Z)(B,1)[0];r.GlobalWorkerOptions.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(r.version,"/pdf.worker.js");var E=R.Z.getLocalAccessToken(),O=(0,x.useState)(!1),q=(0,s.Z)(O,2),M=q[0],F=q[1],H=new y.g,L=(0,j.$5)({method:function(){return H.getRecordById(P)}}),K=L.data,Q=L.onRefresh;(0,x.useEffect)((function(){var e={comment:"",reimbursementReceipts:[]};null===K||void 0===K||K.ReimbursementReceipt.forEach((function(t){e.reimbursementReceipts.push((0,i.Z)((0,i.Z)({},t),{},{approvedAmount:t.claimedAmount}))})),I.setFieldsValue(e)}),[K]);return(0,g.jsx)("section",{className:h.container,children:(0,g.jsx)(u.Z,{title:"RMB-".concat(null===K||void 0===K?void 0:K.id," - (").concat(null!==K&&void 0!==K&&K.status?null===(t=f.W9[null===K||void 0===K?void 0:K.status])||void 0===t?void 0:t.status:"",")"),placement:"right",size:"large",width:window.innerWidth>768?"60%":"100%",onClose:S,open:w,children:(0,g.jsx)(d.Z,{className:h.form,onFinish:function(e){F(!0);var t,n={comment:e.comment,reimbursementReceipts:[]};e.status||(null===e||void 0===e||null===(t=e.reimbursementReceipts)||void 0===t||t.forEach((function(e){var t;null===(t=n.reimbursementReceipts)||void 0===t||t.push({receiptId:e.id,approvedAmount:e.approvedAmount,status:e.status,comment:e.comment})})));k||z?e.status?H.financeActionReimbursement({comment:e.comment,status:null===e||void 0===e?void 0:e.status},P).then((function(){T(),F(!1),Q()})).catch((function(){c.ZP.error("Something went wrong"),F(!1)})):H.hrActionReimbursement(n,P).then((function(){T(),F(!1),Q()})).catch((function(){c.ZP.error("Something went wrong"),F(!1)})):(c.ZP.error("You don't have permission to create this record"),F(!1))},form:I,children:(0,g.jsxs)("div",{className:h.drawerContainer,children:[(0,g.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("b",{children:"Name:"}),"\xa0","".concat((null===K||void 0===K||null===(n=K.RequestBy)||void 0===n?void 0:n.firstName)||""," ").concat((null===K||void 0===K||null===(l=K.RequestBy)||void 0===l?void 0:l.lastName)||"")]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("b",{children:"Date:"}),"\xa0",(0,Z.Ny)((null===K||void 0===K?void 0:K.addedDate)||"","MM dd,yy")]})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("b",{children:"Purpose:"}),(0,g.jsx)("div",{style:{fontSize:"var(--font-size-normal)"},children:null===K||void 0===K?void 0:K.purpose})]}),(null===K||void 0===K?void 0:K.status)!==f.QJ.withdrawn&&(0,g.jsxs)("div",{className:h.hrWrap,children:[null!==K&&void 0!==K&&K.ReimbursementReceipt?(0,g.jsx)(d.Z.List,{name:"reimbursementReceipts",initialValue:null===K||void 0===K?void 0:K.ReimbursementReceipt,children:function(e,t,n){var i=n.errors;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{className:h.title,children:"HR Department Actions"}),(0,g.jsx)("div",{className:h.attachmentsWrap,children:e.map((function(t,n){var i,s,r,l,c;return(0,g.jsxs)("div",{className:h.attachment,children:[(0,g.jsxs)("div",{className:h.resourceWrap,children:[null!==K&&void 0!==K&&K.ReimbursementReceipt[n].file.includes("pdf")?(0,g.jsx)("a",{href:"".concat(b.PO).concat(null===K||void 0===K||null===(i=K.ReimbursementReceipt[n])||void 0===i?void 0:i.file),target:"_blank",rel:"noreferrer",children:(0,g.jsx)(o.Z,{file:"".concat(_._,"resources/all/").concat(null===K||void 0===K?void 0:K.ReimbursementReceipt[n].file,"?authKey=").concat(E),children:(0,g.jsx)(a.Z,{renderTextLayer:!1,pageNumber:1})})}):(0,g.jsx)(m.Z,{style:{objectFit:"cover",borderRadius:"0.25rem 0.25rem 0 0"},width:150,height:100,src:"".concat(_._,"resources/all/").concat(null===K||void 0===K?void 0:K.ReimbursementReceipt[n].file,"?authKey=").concat(E)}),(0,g.jsx)("div",{style:{padding:"0.25rem 0.5rem",borderRadius:"0.25rem",display:"flex",flexDirection:"column"},children:(0,g.jsx)(A,{style:{width:125,fontSize:"var(--font-size-xs)"},strong:!0,ellipsis:!0,children:null===K||void 0===K||null===(s=K.ReimbursementReceipt[n])||void 0===s?void 0:s.title})})]}),(0,g.jsx)("div",{children:null!==K&&void 0!==K&&K.AdminActions.find((function(e){return"hr"===e.Department.slug}))?(0,g.jsxs)("div",{className:h.priceText,children:[(0,g.jsx)("b",{style:{fontSize:"var(--font-size-sm)"},children:"Amount"}),(0,g.jsxs)("div",{style:{textDecoration:(null===K||void 0===K?void 0:K.ReimbursementReceipt[n].approvedAmount)!==(null===K||void 0===K?void 0:K.ReimbursementReceipt[n].claimedAmount)?"line-through":"unset"},children:["AED ",null===K||void 0===K?void 0:K.ReimbursementReceipt[n].claimedAmount]}),(null===K||void 0===K?void 0:K.ReimbursementReceipt[n].approvedAmount)!==K.ReimbursementReceipt[n].claimedAmount?(0,g.jsxs)("div",{className:h.approvedAmount,children:["AED ",null===K||void 0===K?void 0:K.ReimbursementReceipt[n].approvedAmount]}):null]}):(0,g.jsx)("div",{children:k?(0,g.jsx)(d.Z.Item,{style:{minWidth:"80%"},name:[null===(r=e[n])||void 0===r?void 0:r.name,"approvedAmount"],rules:[{required:!0,message:"Please add a amount",type:"number"}],children:(0,g.jsx)(p.t7,{prefix:"AED",defaultValue:null===K||void 0===K||null===(l=K.ReimbursementReceipt[n])||void 0===l?void 0:l.claimedAmount,size:"w100",label:(0,g.jsx)("b",{children:"Amount"}),asterisk:!0,type:"number",placeHolder:"Enter amount"})}):"No action from HR yet"})}),(0,g.jsxs)("div",{className:h.buttonWrap,children:[(0,g.jsx)("br",{}),null!==K&&void 0!==K&&K.AdminActions.find((function(e){return"hr"===e.Department.slug}))?(0,g.jsx)("div",{style:{textTransform:"capitalize"},children:f.W9[null===K||void 0===K?void 0:K.ReimbursementReceipt[n].status].status}):k&&(0,g.jsx)(d.Z.Item,{name:[null===(c=e[n])||void 0===c?void 0:c.name,"status"],rules:[{required:!0,message:"Please select a status"}],children:(0,g.jsx)(v.ZP.Group,{options:f.Rj,optionType:"button",buttonStyle:"solid"})})]})]},null===K||void 0===K?void 0:K.ReimbursementReceipt[n].id)}))}),(0,g.jsx)(d.Z.ErrorList,{errors:i})]})}}):null,(0,g.jsxs)("div",{className:h.footerWrap,style:k?{borderTop:"1px solid var(--color-border)"}:void 0,children:[null!==K&&void 0!==K&&K.AdminActions.find((function(e){return"hr"===e.Department.slug}))?(0,g.jsxs)("div",{className:h.priceText,children:[(0,g.jsx)("b",{style:{fontSize:"var(--font-size-sm)"},children:"Comment"}),(0,g.jsx)("div",{children:null===K||void 0===K||null===(N=K.AdminActions.find((function(e){return"hr"===e.Department.slug})))||void 0===N?void 0:N.comment})]}):k&&(0,g.jsx)(d.Z.Item,{name:"comment",style:{minWidth:"60%",margin:0},children:(0,g.jsx)(p.t7,{size:"w100",label:(0,g.jsx)("b",{children:"Comment"}),type:"textArea",placeHolder:"Enter comment"})}),null!==K&&void 0!==K&&K.AdminActions.find((function(e){return"hr"===e.Department.slug}))?null:k&&(0,g.jsxs)("div",{className:h.buttonWrap,children:[(0,g.jsx)(p.op,{size:"normal",fontSize:"sm",onClick:S,type:"plain",children:"Cancel"}),(0,g.jsx)(p.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:M,children:"Save"})]})]})]}),(null===K||void 0===K?void 0:K.status)!==f.QJ.withdrawn&&null!==K&&void 0!==K&&K.AdminActions.find((function(e){return"hr"===e.Department.slug}))?(0,g.jsxs)("div",{className:h.financeWrap,children:[(0,g.jsx)("div",{className:h.title,children:"Finance Department Actions"}),(0,g.jsx)("div",{className:h.actionsWrap,children:null!==K&&void 0!==K&&K.AdminActions.find((function(e){return"finance"===e.Department.slug}))?(0,g.jsx)("div",{style:{textTransform:"capitalize",lineHeight:"1rem"},children:f.W9[null===K||void 0===K||null===(W=K.AdminActions)||void 0===W?void 0:W.find((function(e){return"finance"===e.Department.slug})).status].status}):z?(0,g.jsx)(d.Z.Item,{name:"status",rules:[{required:!0,message:"Please select a status"}],children:(0,g.jsx)(v.ZP.Group,{options:f.AO,optionType:"button",buttonStyle:"solid"})}):"No action from Finance yet"}),(0,g.jsxs)("div",{className:h.footerWrap,children:[null!==K&&void 0!==K&&K.AdminActions.find((function(e){return"finance"===e.Department.slug}))?(0,g.jsxs)("div",{className:h.priceText,children:[(0,g.jsx)("b",{style:{fontSize:"var(--font-size-sm)"},children:"Comment"}),(0,g.jsx)("div",{children:null===K||void 0===K||null===(D=K.AdminActions.find((function(e){return"finance"===e.Department.slug})))||void 0===D?void 0:D.comment})]}):z&&(0,g.jsx)(d.Z.Item,{name:"comment",style:{minWidth:"60%",margin:0},children:(0,g.jsx)(p.t7,{size:"w100",label:(0,g.jsx)("b",{children:"Comment"}),type:"textArea",placeHolder:"Enter comment"})}),null!==K&&void 0!==K&&K.AdminActions.find((function(e){return"finance"===e.Department.slug}))?null:z&&(0,g.jsxs)("div",{className:h.buttonWrap,children:[(0,g.jsx)(p.op,{size:"normal",fontSize:"sm",onClick:S,type:"plain",children:"Cancel"}),(0,g.jsx)(p.op,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:M,children:"Save"})]})]})]}):null]})})})})}},54945:function(e,t,n){"use strict";n.d(t,{l:function(){return u}});var i=n(8570),s=n(28080),r=n(10177),o=n(37936),a=n(32047),l=n(98505),d=n(46417),c=i.Z.Paragraph,u=function(e){var t,n,i=e.reimbursement,u=e.onClick,m=e.isFullWidth;return(0,d.jsx)(s.Z,{hoverable:!0,onClick:u,bodyStyle:{height:"100%"},className:"".concat(a.Z.card," ").concat(m?a.Z.fullWidth:""),children:(0,d.jsxs)("div",{className:a.Z.cardBody,children:[(0,d.jsxs)("div",{className:a.Z.cardBodyTop,children:[(0,d.jsxs)("div",{className:a.Z.cardTitle,children:["RMB-",i.id]}),(0,d.jsxs)("div",{className:a.Z.topRight,children:[i._count.ReimbursementReceipt>0&&(0,d.jsxs)("div",{className:a.Z.file,children:[(0,d.jsx)(r.Z,{}),"\xa0",i._count.ReimbursementReceipt]}),(0,d.jsx)("div",{className:a.Z.status,style:{backgroundColor:null===(t=o.W9[i.status])||void 0===t?void 0:t.color},children:null===(n=o.W9[i.status])||void 0===n?void 0:n.status})]})]}),(0,d.jsxs)("div",{className:a.Z.cardBodyMiddle,children:[(0,d.jsx)(c,{ellipsis:{rows:2},className:a.Z.purpose,children:i.purpose}),(0,d.jsxs)("div",{className:"font-size-sm",children:["Requested by: ",i.RequestBy.firstName+" "+i.RequestBy.lastName]})]}),(0,d.jsxs)("div",{className:a.Z.cardBodyEnd,children:[(0,d.jsxs)("div",{className:a.Z.amountWrap,children:[(0,d.jsxs)("div",{className:a.Z.claimedAmount+" "+(i.approvedAmount&&i.approvedAmount!==i.claimedAmount?a.Z.strike:void 0),children:["AED ",i.claimedAmount]}),i.approvedAmount&&i.approvedAmount!==i.claimedAmount?(0,d.jsxs)("div",{className:a.Z.approvedAmount,children:["AED ",i.approvedAmount]}):null]}),(0,d.jsx)("div",{className:a.Z.date,children:(0,l.Ny)(i.addedDate,"dd M,yy")})]})]})})}},38323:function(e,t,n){"use strict";n.d(t,{g:function(){return l}});var i=n(1413),s=n(43144),r=n(15671),o=n(3135),a=n(49075),l=(0,s.Z)((function e(){var t=this;(0,r.Z)(this,e),this.endPoint="reimbursement",this.getAllRecords=function(e){return a.Z.get(a._+t.endPoint,{params:(0,i.Z)({sortByField:"order",sortOrder:"asc",perPage:4},e)})},this.getOwnRecords=function(e){return a.Z.get(a._+t.endPoint+"/own",{params:(0,i.Z)({},e)})},this.getRecordById=function(e){return a.Z.get(a._+t.endPoint+"/findOne/"+e)},this.deleteRecord=function(e){return a.Z.delete(a._+t.endPoint+"/remove/"+e)},this.createRecord=function(e){return a.Z.post(a._+t.endPoint,e,{headers:o.C})},this.withdrawReimbursement=function(e){return a.Z.patch(a._+t.endPoint+"/withdraw/".concat(e))},this.hrActionReimbursement=function(e,n){return a.Z.patch(a._+t.endPoint+"/hrAction/".concat(n),e)},this.financeActionReimbursement=function(e,n){return a.Z.patch(a._+t.endPoint+"/financeAction/".concat(n),e)}}))},10177:function(e,t,n){"use strict";var i=n(87462),s=n(47313),r=n(63961),o=n(16141),a=function(e,t){return s.createElement(o.Z,(0,i.Z)({},e,{ref:t,icon:r.Z}))};t.Z=s.forwardRef(a)},32047:function(e,t){"use strict";t.Z={container:"styles_container__10UZR",card:"styles_card__mlV-B",cardBody:"styles_cardBody__RqQKz",cardBodyTop:"styles_cardBodyTop__Q+-77",cardTitle:"styles_cardTitle__GffgO",topRight:"styles_topRight__0d8S1",status:"styles_status__a8NDb",file:"styles_file__4-LMZ",cardBodyMiddle:"styles_cardBodyMiddle__U4hmp",purpose:"styles_purpose__+N+JR",cardBodyEnd:"styles_cardBodyEnd__Ys1WR",amountWrap:"styles_amountWrap__G89N-",claimedAmount:"styles_claimedAmount__wVTjV",strike:"styles_strike__tgzwX",approvedAmount:"styles_approvedAmount__EuyDi",date:"styles_date__j73Cx",fullWidth:"styles_fullWidth__P0jx1"}},93414:function(){},70172:function(){},2001:function(){},33779:function(){},66558:function(){},82258:function(){}}]);