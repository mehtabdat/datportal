"use strict";(self.webpackChunkdat_projects=self.webpackChunkdat_projects||[]).push([[7265],{27265:function(e,a,t){t.r(a),t.d(a,{default:function(){return q}});var n=t(29439),r=t(55291),i=t(47313),o=t(85554),s=function(e){return e.CREATE="createPackage",e.UPDATE="updatePackage",e.DELETE="deletePackage",e.READ="readPackage",e}({}),d=t(74165),l=t(1413),c=t(15861),u=t(49075),p=t(3640),v=function(e,a){return function(){var t=(0,c.Z)((0,d.Z)().mark((function t(n,r){var i,o,s,c,v,f,Z,g;return(0,d.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=r().packageReducer,o=i.packageData,s=i.singlePackageData,c=e?s:o,v=e?p.Wm:p.Gn,f=e?"package/".concat(e,"?all=true"):"package",n({type:v,payload:(0,l.Z)((0,l.Z)({},c),{},{loading:!0})}),t.prev=5,t.next=8,u.Z.get(f);case 8:g=t.sent,n({type:v,payload:(0,l.Z)((0,l.Z)({},c),{},{loading:!1,data:null===g||void 0===g||null===(Z=g.data)||void 0===Z?void 0:Z.data})}),a&&a(),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(5),n({type:v,payload:(0,l.Z)((0,l.Z)({},c),{},{loading:!1,errorData:t.t0})});case 16:case"end":return t.stop()}}),t,null,[[5,13]])})));return function(e,a){return t.apply(this,arguments)}}()},f=function(e,a,t){return function(){var n=(0,c.Z)((0,d.Z)().mark((function n(r,i){var o,s,c;return(0,d.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=i().packageReducer.editPackageData,r({type:p.IH,payload:(0,l.Z)((0,l.Z)({},o),{},{loading:!0})}),n.prev=2,n.next=5,u.Z.patch("package/".concat(null===a||void 0===a?void 0:a.id),e);case 5:c=n.sent,r({type:p.IH,payload:(0,l.Z)((0,l.Z)({},o),{},{loading:!1,data:null===c||void 0===c||null===(s=c.data)||void 0===s?void 0:s.data})}),t&&t(),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(2),r({type:p.IH,payload:(0,l.Z)((0,l.Z)({},o),{},{loading:!1,errorData:n.t0})});case 13:case"end":return n.stop()}}),n,null,[[2,10]])})));return function(e,a){return n.apply(this,arguments)}}()},Z=t(82626),g=t(18515),h=t(7532),y=t(25019),m=t(37831),k=t(60350),x="styles_actions__xlfpA",b="styles_bg__red__Y5lqx",j="styles_form__q6M9k",P="styles_footer__zjJnu",w=t(85336),D=t(12351),C=t(34979),I=t(48897),z=t(3798),N=t(46417),R=function(e){var a,t,s,d,c,u=e.openModal,p=e.onCancel,f=e.onFinish,g=e.buttonLoading,h=e.initialValues,x=e.type,b=(0,o.I0)(),R=y.Z.useForm(),F=(0,n.Z)(R,1)[0],Y=(0,o.v9)((function(e){return e.countryReducer})).countryData,_=(0,o.v9)((function(e){return e.packageReducer})).singlePackageData;return(0,i.useEffect)((function(){b((0,C.a)())}),[b]),(0,i.useEffect)((function(){if("edit"===x&&Object.keys(_.data).length){var e,a,t,n,r=null===(e=_.data)||void 0===e?void 0:e.localization;F.setFieldsValue((0,l.Z)({isPublished:null===(a=_.data)||void 0===a?void 0:a.isPublished,translations:r,credits:null===(t=_.data)||void 0===t?void 0:t.credits,durations:null===(n=_.data)||void 0===n?void 0:n.duration},_.data))}else F.resetFields()}),[F,_,x]),(0,i.useEffect)((function(){"edit"===x&&b(v(h.id))}),[b,h.id,x]),(0,N.jsx)(k.Z,{visible:u,onCancel:p,titleText:"Add Package",showFooter:!1,children:(0,N.jsxs)(y.Z,{className:j,onFinish:f,form:F,children:[(0,N.jsxs)("div",{children:[(0,N.jsx)(y.Z.Item,{name:"slug",rules:[{required:!0,message:"Please enter the Role Slug!"},{pattern:new RegExp("(^([-A-Z]|[a-z])*$)"),message:"Only letters and hyphen is allowed"}],children:(0,N.jsx)(m.Z,{size:"w100",label:"Slug",asterisk:!0,hint:"Only letters and hyphen is allowed",onChange:function(e){var a=e.target,t=(0,z.V3)(a.value);F.setFieldsValue({slug:t})}})}),(0,N.jsx)(y.Z.Item,{name:"credits",rules:[{required:!0,message:"Please enter the Credits!"}],children:(0,N.jsx)(m.Z,{size:"w100",label:"Credits",asterisk:!0,type:"text"})})]}),(0,N.jsx)("div",{children:(0,N.jsx)(y.Z.Item,{name:"countryId",rules:[{required:!0,message:"Please select an option!"}],children:(0,N.jsx)(w.Z,{asterisk:!0,label:"Country",options:Y.data.map((function(e){return{value:e.id,label:e.name}}))})})}),(0,N.jsxs)("div",{children:[(0,N.jsx)(y.Z.Item,{name:"duration",rules:[{required:!0,message:"Please enter the duration!"},{pattern:new RegExp("(^([0-9])*$)"),message:"Please enter a valid duration!"}],children:(0,N.jsx)(m.Z,{size:"w100",label:"Duration",asterisk:!0,type:"text",onChange:function(e){e.target.value>90&&(r.ZP.error("Duration should not be more than 90 days"),e.target.value=90)}})}),(0,N.jsx)(y.Z.Item,{name:"isPublished",children:(0,N.jsx)(w.Z,{label:"Published",options:[{value:!0,label:"Yes"},{value:!1,label:"No"}]})})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)(y.Z.Item,{name:"makeFeatured",children:(0,N.jsx)(w.Z,{label:"Featured",options:[{value:!0,label:"Yes"},{value:!1,label:"No"}]})}),(0,N.jsx)(y.Z.Item,{name:"makePremium",children:(0,N.jsx)(w.Z,{label:"Premium",options:[{value:!0,label:"Yes"},{value:!1,label:"No"}]})})]}),(0,N.jsx)(Z.WH,{title:"Title & Description",formName:"translations",description:!0,form:F,defaultValue:null===_||void 0===_||null===(a=_.data)||void 0===a?void 0:a.localization}),(0,N.jsx)("div",{className:"d-flex flex-column",children:(0,N.jsx)(Z.wA,{name:"icon",title:"Icon",defaultFileList:"edit"===x&&_&&(null===(t=_.data)||void 0===t?void 0:t.icon)&&[{uid:null===(s=_.data)||void 0===s?void 0:s.id,name:null===(d=_.data)||void 0===d?void 0:d.icon,status:"done",url:I.lj+(null===(c=_.data)||void 0===c?void 0:c.icon)}]})}),(0,N.jsxs)("div",{className:P,children:[(0,N.jsx)(D.Z,{size:"normal",fontSize:"sm",onClick:p,type:"plain",children:"Cancel"}),(0,N.jsx)(D.Z,{type:"primary",size:"normal",fontSize:"sm",htmlType:"submit",loading:g,children:"Submit"})]})]})})},F=t(5900),Y=t(86345),_=t(41586),S=t(98676),E=t(98505),A=t(3109),L=function(e){var a=e.record,t=e.openModal,n=e.permissions.deletePackage,s=(0,o.I0)(),f=(0,i.useCallback)((function(e){!0===n?s(function(e,a){return function(){var t=(0,c.Z)((0,d.Z)().mark((function t(n,r){var i,o,s;return(0,d.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=r().packageReducer.deletePackageData,n({type:p.ho,payload:(0,l.Z)((0,l.Z)({},i),{},{loading:!0})}),t.prev=2,t.next=5,u.Z.delete("package/".concat(e));case 5:s=t.sent,n({type:p.ho,payload:(0,l.Z)((0,l.Z)({},i),{},{loading:!1,data:null===s||void 0===s||null===(o=s.data)||void 0===o?void 0:o.data})}),a&&a(),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),n({type:p.ho,payload:(0,l.Z)((0,l.Z)({},i),{},{loading:!1,errorData:t.t0})});case 13:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e,a){return t.apply(this,arguments)}}()}(e,(function(){return s(v())}))):r.ZP.error("You don't have permission to delete this record, please contact your admin.")}),[s]);return(0,N.jsxs)("div",{className:x,children:[(0,N.jsx)("span",{onClick:function(){return t(a)},children:(0,N.jsx)("img",{src:"/images/editicon.svg",alt:""})}),(0,N.jsx)(F.Z,{placement:"top",title:"Are you sure?",onConfirm:function(){return f(a.id)},okText:"Yes",cancelText:"No",children:(0,N.jsx)(S.Z,{className:b})})]})};function T(e){var a=e.tableData,t=e.tableLoading,n=e.openModal,i=(0,o.v9)((function(e){return e.usersReducer})).userPermissions,s=(0,o.I0)(),d=(0,o.v9)((function(e){return e.packageReducer})).editPackageData,l=[{title:"S.No",dataIndex:"name",key:"index",render:function(e,a,t){return t+1},width:"5%"},{title:"Title",dataIndex:["localization","0"],key:"title",render:function(e){return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(A.Z,{color:"dark-main",size:"sm",weight:"bold",children:null===e||void 0===e?void 0:e.title}),(0,N.jsx)("div",{className:"color-dark-sub font-size-xs",dangerouslySetInnerHTML:{__html:null===e||void 0===e?void 0:e.description}})]})}},{title:"Country",dataIndex:["country","name"],key:"country",render:function(e){return(0,N.jsx)(A.Z,{color:"dark-sub",size:"sm",children:e})}},{title:"Credits",dataIndex:"credits",key:"credits",render:function(e){return(0,N.jsx)(A.Z,{color:"dark-sub",size:"sm",children:e})}},{title:"Features",dataIndex:"features",key:"features",render:function(e,a){return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(A.Z,{color:"dark-sub",size:"sm",children:"Featured: ".concat(!0===a.makeFeatured?"Yes":"No")}),(0,N.jsx)(A.Z,{color:"dark-sub",size:"sm",className:"my-1",children:"Premium: ".concat(!0===a.makePremium?"Yes":"No")}),(0,N.jsx)(A.Z,{color:"dark-sub",size:"sm",children:"Duration: ".concat(a.duration," days")})]})}},{title:"Added Date",dataIndex:"addedDate",key:"addedDate",render:function(e){return(0,N.jsx)(A.Z,{color:"dark-sub",size:"sm",children:(0,E.Ny)(e,"dd M,yy")})}},{title:"Published",dataIndex:"isPublished",key:"isPublished",render:function(e,a){return(0,N.jsx)(Y.Z,{checked:e,onChange:function(e){return function(e,a){!0===i.updatePackage?s(f({isPublished:e?"true":"false"},a,(function(){return s(v())}))):r.ZP.error("You don't have permission to update this record, please contact your admin.")}(e,a)},loading:d.loading})}},{title:"Actions",dataIndex:"actions",key:"actions",render:function(e,a){return(0,N.jsx)(L,{record:a,openModal:n,permissions:i})}}];return(0,N.jsx)(_.Z,{sticky:!0,dataSource:a,columns:l,pagination:!1,loading:t})}var M=[{text:"Home",isLink:!0,path:"/"},{isLink:!0,text:"Site Settings",path:"/siteSettings"},{isLink:!1,text:"Package Settings"}];var q=function(){var e=(0,z.aY)(s),a=(0,o.v9)((function(e){return e.usersReducer})).userPermissions,t=a.readPackage,y=a.createPackage,m=a.updatePackage,k=(0,o.I0)(),x=(0,i.useState)(!1),b=(0,n.Z)(x,2),j=b[0],P=b[1],w=(0,i.useState)("new"),D=(0,n.Z)(w,2),C=D[0],I=D[1],F=(0,i.useState)({}),Y=(0,n.Z)(F,2),_=Y[0],S=Y[1],E=(0,o.v9)((function(e){return e.packageReducer})),A=E.packageData,L=E.addPackageData,q=E.editPackageData;(0,i.useEffect)((function(){k(v())}),[k]);var H=(0,i.useCallback)((function(){!1!==y?(I("new"),P(!j),S({})):r.ZP.error("You don't have permission to create new package")}),[j]),O=(0,i.useCallback)((function(e){!1!==m?(S(e),I("edit"),P(!j)):r.ZP.error("You don't have permission to update this package")}),[j]),V=(0,i.useCallback)((function(e){var a,t,n=new FormData,i=["icon","translations"];switch(Object.entries(e).forEach((function(e){i.includes(e[0])||n.append(e[0],e[1])})),e.icon&&"string"!==typeof e.icon&&e.icon.fileList.length>0&&n.append("icon",e.icon.fileList[0].originFileObj),e.translations&&e.translations.forEach((function(e,a){n.append("translations[".concat(a+1,"][language]"),e.language),n.append("translations[".concat(a+1,"][title]"),e.title),n.append("translations[".concat(a+1,"][description]"),e.description)})),C){case"new":!0===y?k((a=n,t=function(){k(v()),H()},function(){var e=(0,c.Z)((0,d.Z)().mark((function e(n,r){var i,o,s;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r().packageReducer.addPackageData,n({type:p.oN,payload:(0,l.Z)((0,l.Z)({},i),{},{loading:!0})}),e.prev=2,e.next=5,u.Z.post("package",a,{headers:{"Content-Type":"multipart/form-data"}});case 5:s=e.sent,n({type:p.oN,payload:(0,l.Z)((0,l.Z)({},i),{},{loading:!1,data:null===s||void 0===s||null===(o=s.data)||void 0===o?void 0:o.data})}),t&&t(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),n({type:p.oN,payload:(0,l.Z)((0,l.Z)({},i),{},{loading:!1,errorData:e.t0})});case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(a,t){return e.apply(this,arguments)}}())):r.ZP.error("You don't have permission to create new package");break;case"edit":!0===m?k(f(n,_,(function(){k(v()),H()}))):r.ZP.error("You don't have permission to update this package")}}),[C,k,H,_]);return(0,N.jsxs)(h.default,{permissionSlug:e,children:[(0,N.jsx)(Z.mr,{heading:"Package Settings",buttonText:"Add New Package",onButtonClick:H,breadCrumbData:M,showAdd:!0===y}),!0===t&&(0,N.jsx)(T,{tableData:A.data,tableLoading:A.loading,openModal:O}),!1===t&&(0,N.jsx)(g.a$,{mainMessage:"You don't have permission to view this data"}),(0,N.jsx)(R,{initialValues:_,type:C,onFinish:V,onCancel:H,openModal:j,buttonLoading:L.loading||q.loading})]})}},34979:function(e,a,t){t.d(a,{WO:function(){return c},a:function(){return d},g5:function(){return u},wy:function(){return l}});var n=t(74165),r=t(1413),i=t(15861),o=t(49075),s=t(69848),d=function(e){return function(){var a=(0,i.Z)((0,n.Z)().mark((function a(t,i){var d,l,c;return(0,n.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return d=i().countryReducer.countryData,t({type:s.ZK,payload:(0,r.Z)((0,r.Z)({},d),{},{loading:!0})}),a.prev=2,a.next=5,o.Z.get("country");case 5:c=a.sent,t({type:s.ZK,payload:(0,r.Z)((0,r.Z)({},d),{},{loading:!1,data:null===c||void 0===c||null===(l=c.data)||void 0===l?void 0:l.data})}),e&&e(),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(2),t({type:s.ZK,payload:(0,r.Z)((0,r.Z)({},d),{},{loading:!1,errorData:a.t0})});case 13:case"end":return a.stop()}}),a,null,[[2,10]])})));return function(e,t){return a.apply(this,arguments)}}()},l=function(e,a){return function(){var t=(0,i.Z)((0,n.Z)().mark((function t(i,d){var l,c,u;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=d().countryReducer.deleteCountryData,i({type:s.as,payload:(0,r.Z)((0,r.Z)({},l),{},{loading:!0})}),t.prev=2,t.next=5,o.Z.delete("country/".concat(e));case 5:u=t.sent,i({type:s.as,payload:(0,r.Z)((0,r.Z)({},l),{},{loading:!1,data:null===u||void 0===u||null===(c=u.data)||void 0===c?void 0:c.data})}),a&&a(),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),i({type:s.as,payload:(0,r.Z)((0,r.Z)({},l),{},{loading:!1,errorData:t.t0})});case 13:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e,a){return t.apply(this,arguments)}}()},c=function(e,a){return function(){var t=(0,i.Z)((0,n.Z)().mark((function t(i,d){var l,c,u;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=d().countryReducer.addCountryData,i({type:s.jb,payload:(0,r.Z)((0,r.Z)({},l),{},{loading:!0})}),t.prev=2,t.next=5,o.Z.post("country",e);case 5:u=t.sent,i({type:s.jb,payload:(0,r.Z)((0,r.Z)({},l),{},{loading:!1,data:null===u||void 0===u||null===(c=u.data)||void 0===c?void 0:c.data})}),a&&a(),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),i({type:s.jb,payload:(0,r.Z)((0,r.Z)({},l),{},{loading:!1,errorData:t.t0})});case 13:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e,a){return t.apply(this,arguments)}}()},u=function(e,a,t){return function(){var d=(0,i.Z)((0,n.Z)().mark((function i(d,l){var c,u,p;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=l().countryReducer.editCountryData,d({type:s.Yg,payload:(0,r.Z)((0,r.Z)({},c),{},{loading:!0})}),n.prev=2,n.next=5,o.Z.patch("country/".concat(null===a||void 0===a?void 0:a.id),e);case 5:p=n.sent,d({type:s.Yg,payload:(0,r.Z)((0,r.Z)({},c),{},{loading:!1,data:null===p||void 0===p||null===(u=p.data)||void 0===u?void 0:u.data})}),t&&t(),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(2),d({type:s.Yg,payload:(0,r.Z)((0,r.Z)({},c),{},{loading:!1,errorData:n.t0})});case 13:case"end":return n.stop()}}),i,null,[[2,10]])})));return function(e,a){return d.apply(this,arguments)}}()}}}]);